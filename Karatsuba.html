<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Karatsuba</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--postfix-projections</a> <a id="45" class="Pragma">--safe</a> <a id="52" class="Symbol">#-}</a>

<a id="57" class="Keyword">module</a> <a id="64" href="Karatsuba.html" class="Module">Karatsuba</a> <a id="74" class="Keyword">where</a>

<a id="81" class="Keyword">open</a> <a id="86" class="Keyword">import</a> <a id="93" href="Prelude.html" class="Module">Prelude</a>
<a id="101" class="Keyword">open</a> <a id="106" class="Keyword">import</a> <a id="113" href="Data.List.html" class="Module">Data.List</a>
<a id="123" class="Keyword">open</a> <a id="128" class="Keyword">import</a> <a id="135" href="TreeFold.html" class="Module">TreeFold</a>
<a id="144" class="Keyword">open</a> <a id="149" class="Keyword">import</a> <a id="156" href="Data.Integer.html" class="Module">Data.Integer</a>
<a id="169" class="Keyword">open</a> <a id="174" class="Keyword">import</a> <a id="181" href="Data.Integer.Literals.html" class="Module">Data.Integer.Literals</a>
<a id="203" class="Keyword">open</a> <a id="208" class="Keyword">import</a> <a id="215" href="Data.Nat.Literals.html" class="Module">Data.Nat.Literals</a>
<a id="233" class="Keyword">import</a> <a id="240" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="249" class="Symbol">as</a> <a id="252" class="Module">ℕ</a>
<a id="254" class="Keyword">import</a> <a id="261" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="281" class="Symbol">as</a> <a id="284" class="Module">ℕ</a>
<a id="286" class="Keyword">open</a> <a id="291" class="Keyword">import</a> <a id="298" href="Literals.Number.html" class="Module">Literals.Number</a>
<a id="314" class="Keyword">open</a> <a id="319" class="Keyword">import</a> <a id="326" href="Data.List.Syntax.html" class="Module">Data.List.Syntax</a>

<a id="Diff"></a><a id="344" href="Karatsuba.html#344" class="Function">Diff</a> <a id="349" class="Symbol">:</a> <a id="351" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="356" href="Level.html#239" class="Generalizable">a</a> <a id="358" class="Symbol">→</a> <a id="360" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="365" href="Level.html#239" class="Generalizable">a</a>
<a id="367" href="Karatsuba.html#344" class="Function">Diff</a> <a id="372" href="Karatsuba.html#372" class="Bound">A</a> <a id="374" class="Symbol">=</a> <a id="376" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="381" href="Karatsuba.html#372" class="Bound">A</a> <a id="383" class="Symbol">→</a> <a id="385" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="390" href="Karatsuba.html#372" class="Bound">A</a>

<a id="⌈⌉"></a><a id="393" href="Karatsuba.html#393" class="Function">⌈⌉</a> <a id="396" class="Symbol">:</a> <a id="398" href="Karatsuba.html#344" class="Function">Diff</a> <a id="403" href="Level.html#255" class="Generalizable">A</a>
<a id="405" href="Karatsuba.html#393" class="Function">⌈⌉</a> <a id="408" class="Symbol">=</a> <a id="410" href="Function.html#533" class="Function">id</a>

<a id="⌈_⌉"></a><a id="414" href="Karatsuba.html#414" class="Function Operator">⌈_⌉</a> <a id="418" class="Symbol">:</a> <a id="420" href="Level.html#255" class="Generalizable">A</a> <a id="422" class="Symbol">→</a> <a id="424" href="Karatsuba.html#344" class="Function">Diff</a> <a id="429" href="Level.html#255" class="Generalizable">A</a>
<a id="431" href="Karatsuba.html#414" class="Function Operator">⌈_⌉</a> <a id="435" class="Symbol">=</a> <a id="437" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a>

<a id="⌊_⌋"></a><a id="442" href="Karatsuba.html#442" class="Function Operator">⌊_⌋</a> <a id="446" class="Symbol">:</a> <a id="448" href="Karatsuba.html#344" class="Function">Diff</a> <a id="453" href="Level.html#255" class="Generalizable">A</a> <a id="455" class="Symbol">→</a> <a id="457" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="462" href="Level.html#255" class="Generalizable">A</a>
<a id="464" href="Karatsuba.html#442" class="Function Operator">⌊</a> <a id="466" href="Karatsuba.html#466" class="Bound">xs</a> <a id="469" href="Karatsuba.html#442" class="Function Operator">⌋</a> <a id="471" class="Symbol">=</a> <a id="473" href="Karatsuba.html#466" class="Bound">xs</a> <a id="476" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="480" class="Keyword">record</a> <a id="K"></a><a id="487" href="Karatsuba.html#487" class="Record">K</a> <a id="489" class="Symbol">(</a><a id="490" href="Karatsuba.html#490" class="Bound">A</a> <a id="492" class="Symbol">:</a> <a id="494" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="499" href="Level.html#239" class="Generalizable">a</a><a id="500" class="Symbol">)</a> <a id="502" class="Symbol">:</a> <a id="504" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="509" href="Karatsuba.html#499" class="Bound">a</a> <a id="511" class="Keyword">where</a>
  <a id="519" class="Keyword">constructor</a> <a id="k"></a><a id="531" href="Karatsuba.html#531" class="InductiveConstructor">k</a>
  <a id="535" class="Keyword">field</a>
    <a id="K.shift"></a><a id="545" href="Karatsuba.html#545" class="Field">shift</a> <a id="551" class="Symbol">:</a> <a id="553" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="K.lo"></a><a id="559" href="Karatsuba.html#559" class="Field">lo</a> <a id="K.hi"></a><a id="562" href="Karatsuba.html#562" class="Field">hi</a> <a id="565" class="Symbol">:</a> <a id="567" href="Karatsuba.html#344" class="Function">Diff</a> <a id="572" href="Karatsuba.html#490" class="Bound">A</a>
    <a id="K.out"></a><a id="578" href="Karatsuba.html#578" class="Field">out</a> <a id="582" class="Symbol">:</a> <a id="584" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="589" href="Karatsuba.html#490" class="Bound">A</a>
<a id="591" class="Keyword">open</a> <a id="596" href="Karatsuba.html#487" class="Module">K</a>

<a id="599" class="Keyword">infixl</a> <a id="606" class="Number">6</a> <a id="608" href="Karatsuba.html#612" class="Function Operator">_⊕_</a>
<a id="_⊕_"></a><a id="612" href="Karatsuba.html#612" class="Function Operator">_⊕_</a> <a id="616" class="Symbol">:</a> <a id="618" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="623" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="625" class="Symbol">→</a> <a id="627" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="632" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="634" class="Symbol">→</a> <a id="636" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="641" href="Data.Integer.html#204" class="Datatype">ℤ</a>
<a id="643" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="652" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="654" href="Karatsuba.html#654" class="Bound">ys</a>       <a id="663" class="Symbol">=</a> <a id="665" href="Karatsuba.html#654" class="Bound">ys</a>
<a id="668" class="Symbol">(</a><a id="669" href="Karatsuba.html#669" class="Bound">x</a> <a id="671" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="673" href="Karatsuba.html#673" class="Bound">xs</a><a id="675" class="Symbol">)</a> <a id="677" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="679" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="688" class="Symbol">=</a> <a id="690" href="Karatsuba.html#669" class="Bound">x</a> <a id="692" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="694" href="Karatsuba.html#673" class="Bound">xs</a>
<a id="697" class="Symbol">(</a><a id="698" href="Karatsuba.html#698" class="Bound">x</a> <a id="700" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="702" href="Karatsuba.html#702" class="Bound">xs</a><a id="704" class="Symbol">)</a> <a id="706" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="708" class="Symbol">(</a><a id="709" href="Karatsuba.html#709" class="Bound">y</a> <a id="711" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="713" href="Karatsuba.html#713" class="Bound">ys</a><a id="715" class="Symbol">)</a> <a id="717" class="Symbol">=</a> <a id="719" class="Symbol">(</a><a id="720" href="Karatsuba.html#698" class="Bound">x</a> <a id="722" href="Data.Integer.html#537" class="Function Operator">+</a> <a id="724" href="Karatsuba.html#709" class="Bound">y</a><a id="725" class="Symbol">)</a> <a id="727" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="729" class="Symbol">(</a><a id="730" href="Karatsuba.html#702" class="Bound">xs</a> <a id="733" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="735" href="Karatsuba.html#713" class="Bound">ys</a><a id="737" class="Symbol">)</a>

<a id="pair"></a><a id="740" href="Karatsuba.html#740" class="Function">pair</a> <a id="745" class="Symbol">:</a> <a id="747" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="752" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="754" class="Symbol">→</a> <a id="756" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="761" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="763" class="Symbol">→</a> <a id="765" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="770" class="Symbol">(</a><a id="771" href="Karatsuba.html#487" class="Record">K</a> <a id="773" href="Data.Integer.html#204" class="Datatype">ℤ</a><a id="774" class="Symbol">)</a>
<a id="776" href="Karatsuba.html#740" class="Function">pair</a> <a id="781" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>         <a id="792" href="Karatsuba.html#792" class="Bound">ys</a>       <a id="801" class="Symbol">=</a> <a id="803" href="Data.List.Base.html#1042" class="Function">map</a> <a id="807" class="Symbol">(λ</a> <a id="810" href="Karatsuba.html#810" class="Bound">y</a> <a id="812" class="Symbol">→</a> <a id="814" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="816" class="Number">1</a> <a id="818" href="Karatsuba.html#393" class="Function">⌈⌉</a> <a id="821" href="Karatsuba.html#414" class="Function Operator">⌈</a> <a id="823" href="Karatsuba.html#810" class="Bound">y</a> <a id="825" href="Karatsuba.html#414" class="Function Operator">⌉</a> <a id="827" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="829" class="Symbol">)</a> <a id="831" href="Karatsuba.html#792" class="Bound">ys</a>
<a id="834" href="Karatsuba.html#740" class="Function">pair</a> <a id="839" href="Karatsuba.html#839" class="Bound">xs</a><a id="841" class="Symbol">@(_</a> <a id="845" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="847" class="Symbol">_)</a> <a id="850" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>       <a id="859" class="Symbol">=</a> <a id="861" href="Data.List.Base.html#1042" class="Function">map</a> <a id="865" class="Symbol">(λ</a> <a id="868" href="Karatsuba.html#868" class="Bound">x</a> <a id="870" class="Symbol">→</a> <a id="872" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="874" class="Number">1</a> <a id="876" href="Karatsuba.html#414" class="Function Operator">⌈</a> <a id="878" href="Karatsuba.html#868" class="Bound">x</a> <a id="880" href="Karatsuba.html#414" class="Function Operator">⌉</a> <a id="882" href="Karatsuba.html#393" class="Function">⌈⌉</a> <a id="885" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="887" class="Symbol">)</a> <a id="889" href="Karatsuba.html#839" class="Bound">xs</a>
<a id="892" href="Karatsuba.html#740" class="Function">pair</a> <a id="897" class="Symbol">(</a><a id="898" href="Karatsuba.html#898" class="Bound">x</a> <a id="900" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="902" href="Karatsuba.html#902" class="Bound">xs</a><a id="904" class="Symbol">)</a>   <a id="908" class="Symbol">(</a><a id="909" href="Karatsuba.html#909" class="Bound">y</a> <a id="911" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="913" href="Karatsuba.html#913" class="Bound">ys</a><a id="915" class="Symbol">)</a> <a id="917" class="Symbol">=</a> <a id="919" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="921" class="Number">1</a> <a id="923" href="Karatsuba.html#414" class="Function Operator">⌈</a> <a id="925" href="Karatsuba.html#898" class="Bound">x</a> <a id="927" href="Karatsuba.html#414" class="Function Operator">⌉</a> <a id="929" href="Karatsuba.html#414" class="Function Operator">⌈</a> <a id="931" href="Karatsuba.html#909" class="Bound">y</a> <a id="933" href="Karatsuba.html#414" class="Function Operator">⌉</a> <a id="935" href="Data.Vec.Sigma.html#459" class="Function Operator">[</a> <a id="937" href="Karatsuba.html#898" class="Bound">x</a> <a id="939" href="Data.Integer.html#775" class="Function Operator">*</a> <a id="941" href="Karatsuba.html#909" class="Bound">y</a> <a id="943" href="Data.Vec.Sigma.html#459" class="Function Operator">]</a> <a id="945" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="947" href="Karatsuba.html#740" class="Function">pair</a> <a id="952" href="Karatsuba.html#902" class="Bound">xs</a> <a id="955" href="Karatsuba.html#913" class="Bound">ys</a>

<a id="pad"></a><a id="959" href="Karatsuba.html#959" class="Function">pad</a> <a id="963" class="Symbol">:</a> <a id="965" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="967" class="Symbol">→</a> <a id="969" href="Karatsuba.html#344" class="Function">Diff</a> <a id="974" href="Data.Integer.html#204" class="Datatype">ℤ</a> 
<a id="977" href="Karatsuba.html#959" class="Function">pad</a> <a id="981" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="989" class="Symbol">=</a> <a id="991" href="Karatsuba.html#393" class="Function">⌈⌉</a>
<a id="994" href="Karatsuba.html#959" class="Function">pad</a> <a id="998" class="Symbol">(</a><a id="999" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1003" href="Karatsuba.html#1003" class="Bound">n</a><a id="1004" class="Symbol">)</a> <a id="1006" class="Symbol">=</a> <a id="1008" href="Karatsuba.html#414" class="Function Operator">⌈</a> <a id="1010" class="Number">0</a> <a id="1012" href="Karatsuba.html#414" class="Function Operator">⌉</a> <a id="1014" href="Function.html#97" class="Function Operator">∘</a> <a id="1016" href="Karatsuba.html#959" class="Function">pad</a> <a id="1020" href="Karatsuba.html#1003" class="Bound">n</a>

<a id="1023" class="Comment">-- The first parameter in these functions is just used for termination checking.</a>
<a id="1104" class="Keyword">mutual</a>
  <a id="1113" class="Keyword">infixl</a> <a id="1120" class="Number">7</a> <a id="1122" href="Karatsuba.html#1131" class="Function Operator">⟨_⟩_⊛_</a>
  <a id="⟨_⟩_⊛_"></a><a id="1131" href="Karatsuba.html#1131" class="Function Operator">⟨_⟩_⊛_</a> <a id="1138" class="Symbol">:</a> <a id="1140" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1142" class="Symbol">→</a> <a id="1144" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1149" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="1151" class="Symbol">→</a> <a id="1153" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1158" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="1160" class="Symbol">→</a> <a id="1162" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1167" href="Data.Integer.html#204" class="Datatype">ℤ</a>
  <a id="1171" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="1173" href="Karatsuba.html#1173" class="Bound">n</a> <a id="1175" href="Karatsuba.html#1131" class="Function Operator">⟩</a> <a id="1177" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>             <a id="1192" href="Karatsuba.html#1131" class="Function Operator">⊛</a> <a id="1194" class="Symbol">_</a>              <a id="1209" class="Symbol">=</a> <a id="1211" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="1216" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="1218" href="Karatsuba.html#1218" class="Bound">n</a> <a id="1220" href="Karatsuba.html#1131" class="Function Operator">⟩</a>    <a id="1225" class="Symbol">(_</a> <a id="1228" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1230" class="Symbol">_)</a>     <a id="1237" href="Karatsuba.html#1131" class="Function Operator">⊛</a> <a id="1239" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>             <a id="1254" class="Symbol">=</a> <a id="1256" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="1261" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="1263" href="Karatsuba.html#1263" class="Bound">n</a> <a id="1265" href="Karatsuba.html#1131" class="Function Operator">⟩</a>    <a id="1270" class="Symbol">(</a><a id="1271" href="Karatsuba.html#1271" class="Bound">x</a> <a id="1273" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1275" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1277" class="Symbol">)</a>    <a id="1282" href="Karatsuba.html#1131" class="Function Operator">⊛</a> <a id="1284" href="Karatsuba.html#1284" class="Bound">ys</a><a id="1286" class="Symbol">@(_</a> <a id="1290" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1292" class="Symbol">_)</a>     <a id="1299" class="Symbol">=</a> <a id="1301" href="Data.List.Base.html#1042" class="Function">map</a> <a id="1305" class="Symbol">(</a><a id="1306" href="Karatsuba.html#1271" class="Bound">x</a> <a id="1308" href="Data.Integer.html#775" class="Function Operator">*_</a><a id="1310" class="Symbol">)</a> <a id="1312" href="Karatsuba.html#1284" class="Bound">ys</a>
  <a id="1317" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="1319" href="Karatsuba.html#1319" class="Bound">n</a> <a id="1321" href="Karatsuba.html#1131" class="Function Operator">⟩</a> <a id="1323" href="Karatsuba.html#1323" class="Bound">xs</a><a id="1325" class="Symbol">@(_</a> <a id="1329" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1331" class="Symbol">_</a> <a id="1333" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1335" class="Symbol">_)</a> <a id="1338" href="Karatsuba.html#1131" class="Function Operator">⊛</a>    <a id="1343" class="Symbol">(</a><a id="1344" href="Karatsuba.html#1344" class="Bound">y</a> <a id="1346" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1348" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="1350" class="Symbol">)</a>    <a id="1355" class="Symbol">=</a> <a id="1357" href="Data.List.Base.html#1042" class="Function">map</a> <a id="1361" class="Symbol">(</a><a id="1362" href="Karatsuba.html#1344" class="Bound">y</a> <a id="1364" href="Data.Integer.html#775" class="Function Operator">*_</a><a id="1366" class="Symbol">)</a> <a id="1368" href="Karatsuba.html#1323" class="Bound">xs</a>
  <a id="1373" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="1375" href="Karatsuba.html#1375" class="Bound">n</a> <a id="1377" href="Karatsuba.html#1131" class="Function Operator">⟩</a> <a id="1379" href="Karatsuba.html#1379" class="Bound">xs</a><a id="1381" class="Symbol">@(_</a> <a id="1385" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1387" class="Symbol">_</a> <a id="1389" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1391" class="Symbol">_)</a> <a id="1394" href="Karatsuba.html#1131" class="Function Operator">⊛</a> <a id="1396" href="Karatsuba.html#1396" class="Bound">ys</a><a id="1398" class="Symbol">@(_</a> <a id="1402" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1404" class="Symbol">_</a> <a id="1406" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1408" class="Symbol">_)</a> <a id="1411" class="Symbol">=</a> <a id="1413" href="TreeFold.html#2679" class="Function">treeFold1</a> <a id="1423" href="Karatsuba.html#1453" class="Function Operator">⟨</a> <a id="1425" href="Karatsuba.html#1375" class="Bound">n</a> <a id="1427" href="Karatsuba.html#1453" class="Function Operator">⟩_◆_</a> <a id="1432" class="Symbol">(</a><a id="1433" href="Karatsuba.html#740" class="Function">pair</a> <a id="1438" href="Karatsuba.html#1379" class="Bound">xs</a> <a id="1441" href="Karatsuba.html#1396" class="Bound">ys</a><a id="1443" class="Symbol">)</a> <a id="1445" class="Symbol">.</a><a id="1446" href="Karatsuba.html#578" class="Field">out</a>

  <a id="⟨_⟩_◆_"></a><a id="1453" href="Karatsuba.html#1453" class="Function Operator">⟨_⟩_◆_</a> <a id="1460" class="Symbol">:</a> <a id="1462" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1464" class="Symbol">→</a> <a id="1466" href="Karatsuba.html#487" class="Record">K</a> <a id="1468" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="Karatsuba.html#487" class="Record">K</a> <a id="1474" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="1476" class="Symbol">→</a> <a id="1478" href="Karatsuba.html#487" class="Record">K</a> <a id="1480" href="Data.Integer.html#204" class="Datatype">ℤ</a>
  <a id="1484" class="Symbol">(</a><a id="1485" href="Karatsuba.html#1453" class="Function Operator">⟨</a> <a id="1487" class="Symbol">_</a>     <a id="1493" href="Karatsuba.html#1453" class="Function Operator">⟩</a> <a id="1495" href="Karatsuba.html#1495" class="Bound">xs</a>           <a id="1508" href="Karatsuba.html#1453" class="Function Operator">◆</a> <a id="1510" href="Karatsuba.html#1510" class="Bound">ys</a>          <a id="1522" class="Symbol">)</a> <a id="1524" class="Symbol">.</a><a id="1525" href="Karatsuba.html#545" class="Field">shift</a> <a id="1531" class="Symbol">=</a> <a id="1533" href="Karatsuba.html#1495" class="Bound">xs</a> <a id="1536" class="Symbol">.</a><a id="1537" href="Karatsuba.html#545" class="Field">shift</a> <a id="1543" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1547" href="Karatsuba.html#1510" class="Bound">ys</a> <a id="1550" class="Symbol">.</a><a id="1551" href="Karatsuba.html#545" class="Field">shift</a>
  <a id="1559" class="Symbol">(</a><a id="1560" href="Karatsuba.html#1453" class="Function Operator">⟨</a> <a id="1562" class="Symbol">_</a>     <a id="1568" href="Karatsuba.html#1453" class="Function Operator">⟩</a> <a id="1570" href="Karatsuba.html#1570" class="Bound">xs</a>           <a id="1583" href="Karatsuba.html#1453" class="Function Operator">◆</a> <a id="1585" href="Karatsuba.html#1585" class="Bound">ys</a>          <a id="1597" class="Symbol">)</a> <a id="1599" class="Symbol">.</a><a id="1600" href="Karatsuba.html#559" class="Field">lo</a>    <a id="1606" class="Symbol">=</a> <a id="1608" href="Karatsuba.html#1570" class="Bound">xs</a> <a id="1611" class="Symbol">.</a><a id="1612" href="Karatsuba.html#559" class="Field">lo</a> <a id="1615" href="Function.html#97" class="Function Operator">∘</a> <a id="1617" href="Karatsuba.html#1585" class="Bound">ys</a> <a id="1620" class="Symbol">.</a><a id="1621" href="Karatsuba.html#559" class="Field">lo</a>
  <a id="1626" class="Symbol">(</a><a id="1627" href="Karatsuba.html#1453" class="Function Operator">⟨</a> <a id="1629" class="Symbol">_</a>     <a id="1635" href="Karatsuba.html#1453" class="Function Operator">⟩</a> <a id="1637" href="Karatsuba.html#1637" class="Bound">xs</a>           <a id="1650" href="Karatsuba.html#1453" class="Function Operator">◆</a> <a id="1652" href="Karatsuba.html#1652" class="Bound">ys</a>          <a id="1664" class="Symbol">)</a> <a id="1666" class="Symbol">.</a><a id="1667" href="Karatsuba.html#562" class="Field">hi</a>    <a id="1673" class="Symbol">=</a> <a id="1675" href="Karatsuba.html#1637" class="Bound">xs</a> <a id="1678" class="Symbol">.</a><a id="1679" href="Karatsuba.html#562" class="Field">hi</a> <a id="1682" href="Function.html#97" class="Function Operator">∘</a> <a id="1684" href="Karatsuba.html#1652" class="Bound">ys</a> <a id="1687" class="Symbol">.</a><a id="1688" href="Karatsuba.html#562" class="Field">hi</a>
  <a id="1693" class="Symbol">(</a><a id="1694" href="Karatsuba.html#1453" class="Function Operator">⟨</a> <a id="1696" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="1702" href="Karatsuba.html#1453" class="Function Operator">⟩</a> <a id="1704" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="1706" href="Karatsuba.html#1706" class="Bound">m</a> <a id="1708" href="Karatsuba.html#1708" class="Bound">x0</a> <a id="1711" href="Karatsuba.html#1711" class="Bound">y0</a> <a id="1714" href="Karatsuba.html#1714" class="Bound">z0</a> <a id="1717" href="Karatsuba.html#1453" class="Function Operator">◆</a> <a id="1719" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="1721" href="Karatsuba.html#1721" class="Bound">n</a> <a id="1723" href="Karatsuba.html#1723" class="Bound">x1</a> <a id="1726" href="Karatsuba.html#1726" class="Bound">y1</a> <a id="1729" href="Karatsuba.html#1729" class="Bound">z2</a><a id="1731" class="Symbol">)</a> <a id="1733" class="Symbol">.</a><a id="1734" href="Karatsuba.html#578" class="Field">out</a>   <a id="1740" class="Symbol">=</a> <a id="1742" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a> <a id="1745" class="Comment">-- should not happen</a>
  <a id="1768" class="Symbol">(</a><a id="1769" href="Karatsuba.html#1453" class="Function Operator">⟨</a> <a id="1771" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1775" href="Karatsuba.html#1775" class="Bound">t</a> <a id="1777" href="Karatsuba.html#1453" class="Function Operator">⟩</a> <a id="1779" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="1781" href="Karatsuba.html#1781" class="Bound">m</a> <a id="1783" href="Karatsuba.html#1783" class="Bound">x0</a> <a id="1786" href="Karatsuba.html#1786" class="Bound">y0</a> <a id="1789" href="Karatsuba.html#1789" class="Bound">z0</a> <a id="1792" href="Karatsuba.html#1453" class="Function Operator">◆</a> <a id="1794" href="Karatsuba.html#531" class="InductiveConstructor">k</a> <a id="1796" href="Karatsuba.html#1796" class="Bound">n</a> <a id="1798" href="Karatsuba.html#1798" class="Bound">x1</a> <a id="1801" href="Karatsuba.html#1801" class="Bound">y1</a> <a id="1804" href="Karatsuba.html#1804" class="Bound">z2</a><a id="1806" class="Symbol">)</a> <a id="1808" class="Symbol">.</a><a id="1809" href="Karatsuba.html#578" class="Field">out</a>   <a id="1815" class="Symbol">=</a> <a id="1817" href="Karatsuba.html#959" class="Function">pad</a> <a id="1821" href="Karatsuba.html#1781" class="Bound">m</a> <a id="1823" class="Symbol">(</a><a id="1824" href="Karatsuba.html#959" class="Function">pad</a> <a id="1828" href="Karatsuba.html#1781" class="Bound">m</a> <a id="1830" href="Karatsuba.html#1804" class="Bound">z2</a> <a id="1833" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="1835" href="Karatsuba.html#1858" class="Function">z1</a><a id="1837" class="Symbol">)</a> <a id="1839" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="1841" href="Karatsuba.html#1789" class="Bound">z0</a>
    <a id="1848" class="Keyword">where</a>
    <a id="1858" href="Karatsuba.html#1858" class="Function">z1</a> <a id="1861" class="Symbol">:</a> <a id="1863" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1868" href="Data.Integer.html#204" class="Datatype">ℤ</a>
    <a id="1874" href="Karatsuba.html#1858" class="Function">z1</a> <a id="1877" class="Symbol">=</a> <a id="1879" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="1881" href="Karatsuba.html#1775" class="Bound">t</a> <a id="1883" href="Karatsuba.html#1131" class="Function Operator">⟩</a> <a id="1885" class="Symbol">(</a><a id="1886" href="Karatsuba.html#442" class="Function Operator">⌊</a> <a id="1888" href="Karatsuba.html#1783" class="Bound">x0</a> <a id="1891" href="Karatsuba.html#442" class="Function Operator">⌋</a> <a id="1893" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="1895" href="Karatsuba.html#442" class="Function Operator">⌊</a> <a id="1897" href="Karatsuba.html#1798" class="Bound">x1</a> <a id="1900" href="Karatsuba.html#442" class="Function Operator">⌋</a><a id="1901" class="Symbol">)</a> <a id="1903" href="Karatsuba.html#1131" class="Function Operator">⊛</a> <a id="1905" class="Symbol">(</a><a id="1906" href="Karatsuba.html#442" class="Function Operator">⌊</a> <a id="1908" href="Karatsuba.html#1786" class="Bound">y0</a> <a id="1911" href="Karatsuba.html#442" class="Function Operator">⌋</a> <a id="1913" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="1915" href="Karatsuba.html#442" class="Function Operator">⌊</a> <a id="1917" href="Karatsuba.html#1801" class="Bound">y1</a> <a id="1920" href="Karatsuba.html#442" class="Function Operator">⌋</a><a id="1921" class="Symbol">)</a> <a id="1923" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="1925" class="Symbol">(</a><a id="1926" href="Data.List.Base.html#1042" class="Function">map</a> <a id="1930" href="Data.Integer.html#332" class="Function">negate</a> <a id="1937" href="Karatsuba.html#1789" class="Bound">z0</a> <a id="1940" href="Karatsuba.html#612" class="Function Operator">⊕</a> <a id="1942" href="Data.List.Base.html#1042" class="Function">map</a> <a id="1946" href="Data.Integer.html#332" class="Function">negate</a> <a id="1953" href="Karatsuba.html#1804" class="Bound">z2</a><a id="1955" class="Symbol">)</a>

<a id="_⊛_"></a><a id="1958" href="Karatsuba.html#1958" class="Function Operator">_⊛_</a> <a id="1962" class="Symbol">:</a> <a id="1964" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1969" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="1971" class="Symbol">→</a> <a id="1973" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1978" href="Data.Integer.html#204" class="Datatype">ℤ</a> <a id="1980" class="Symbol">→</a> <a id="1982" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1987" href="Data.Integer.html#204" class="Datatype">ℤ</a>
<a id="1989" href="Karatsuba.html#1989" class="Bound">xs</a> <a id="1992" href="Karatsuba.html#1958" class="Function Operator">⊛</a> <a id="1994" href="Karatsuba.html#1994" class="Bound">ys</a> <a id="1997" class="Symbol">=</a> <a id="1999" href="Karatsuba.html#1131" class="Function Operator">⟨</a> <a id="2001" href="Data.List.Base.html#845" class="Function">length</a> <a id="2008" href="Karatsuba.html#1989" class="Bound">xs</a> <a id="2011" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="2015" href="Data.List.Base.html#845" class="Function">length</a> <a id="2022" href="Karatsuba.html#1994" class="Bound">ys</a> <a id="2025" href="Karatsuba.html#1131" class="Function Operator">⟩</a> <a id="2027" href="Karatsuba.html#1989" class="Bound">xs</a> <a id="2030" href="Karatsuba.html#1131" class="Function Operator">⊛</a> <a id="2032" href="Karatsuba.html#1994" class="Bound">ys</a>

<a id="2036" href="Karatsuba.html#2036" class="Function">_</a> <a id="2038" class="Symbol">:</a> <a id="2040" href="Data.Vec.Sigma.html#459" class="Function Operator">[</a> <a id="2042" class="Number">2</a> <a id="2044" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2046" class="Number">5</a> <a id="2048" href="Data.Vec.Sigma.html#459" class="Function Operator">]</a> <a id="2050" href="Karatsuba.html#1958" class="Function Operator">⊛</a> <a id="2052" href="Data.Vec.Sigma.html#459" class="Function Operator">[</a> <a id="2054" class="Number">1</a> <a id="2056" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2058" class="Number">1</a> <a id="2060" href="Data.Vec.Sigma.html#459" class="Function Operator">]</a> <a id="2062" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2064" href="Data.Vec.Sigma.html#459" class="Function Operator">[</a> <a id="2066" class="Number">2</a> <a id="2068" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2070" class="Number">7</a> <a id="2072" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2074" class="Number">5</a> <a id="2076" href="Data.Vec.Sigma.html#459" class="Function Operator">]</a>
<a id="2078" class="Symbol">_</a> <a id="2080" class="Symbol">=</a> <a id="2082" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
</pre></body></html>