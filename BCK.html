<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>BCK</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="BCK.html" class="Module">BCK</a> <a id="46" class="Keyword">where</a>

<a id="53" class="Keyword">open</a> <a id="58" class="Keyword">import</a> <a id="65" href="Prelude.html" class="Module">Prelude</a> <a id="73" class="Keyword">hiding</a> <a id="80" class="Symbol">(</a><a id="81" href="Level.html#296" class="Generalizable">B</a><a id="82" class="Symbol">;</a> <a id="84" href="Level.html#310" class="Generalizable">C</a><a id="85" class="Symbol">)</a>

<a id="88" class="Keyword">infixl</a> <a id="95" class="Number">4</a> <a id="97" href="BCK.html#126" class="InductiveConstructor Operator">_$$_</a>
<a id="102" class="Keyword">data</a> <a id="BCK"></a><a id="107" href="BCK.html#107" class="Datatype">BCK</a> <a id="111" class="Symbol">:</a> <a id="113" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="118" class="Keyword">where</a>
  <a id="BCK._$$_"></a><a id="126" href="BCK.html#126" class="InductiveConstructor Operator">_$$_</a> <a id="131" class="Symbol">:</a> <a id="133" href="BCK.html#107" class="Datatype">BCK</a> <a id="137" class="Symbol">→</a> <a id="139" href="BCK.html#107" class="Datatype">BCK</a> <a id="143" class="Symbol">→</a> <a id="145" href="BCK.html#107" class="Datatype">BCK</a>
  <a id="BCK.B"></a><a id="151" href="BCK.html#151" class="InductiveConstructor">B</a> <a id="BCK.C"></a><a id="153" href="BCK.html#153" class="InductiveConstructor">C</a> <a id="BCK.K"></a><a id="155" href="BCK.html#155" class="InductiveConstructor">K</a> <a id="157" class="Symbol">:</a> <a id="159" href="BCK.html#107" class="Datatype">BCK</a>

<a id="164" class="Keyword">open</a> <a id="169" class="Keyword">import</a> <a id="176" href="Data.List.html" class="Module">Data.List</a>

<a id="stack⊙"></a><a id="187" href="BCK.html#187" class="Function">stack⊙</a> <a id="194" class="Symbol">:</a> <a id="196" href="BCK.html#107" class="Datatype">BCK</a> <a id="200" class="Symbol">→</a> <a id="202" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="207" href="BCK.html#107" class="Datatype">BCK</a> <a id="211" class="Symbol">→</a> <a id="213" href="Data.Maybe.Base.html#91" class="Datatype">Maybe</a> <a id="219" href="BCK.html#107" class="Datatype">BCK</a>
<a id="223" href="BCK.html#187" class="Function">stack⊙</a> <a id="230" class="Symbol">(</a><a id="231" href="BCK.html#231" class="Bound">f</a> <a id="233" href="BCK.html#126" class="InductiveConstructor Operator">$$</a> <a id="236" href="BCK.html#236" class="Bound">x</a><a id="237" class="Symbol">)</a> <a id="239" href="BCK.html#239" class="Bound">xs</a> <a id="242" class="Symbol">=</a> <a id="244" href="BCK.html#187" class="Function">stack⊙</a> <a id="251" href="BCK.html#231" class="Bound">f</a> <a id="253" class="Symbol">(</a><a id="254" href="BCK.html#236" class="Bound">x</a> <a id="256" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="258" href="BCK.html#239" class="Bound">xs</a><a id="260" class="Symbol">)</a>
<a id="262" href="BCK.html#187" class="Function">stack⊙</a> <a id="269" href="BCK.html#151" class="InductiveConstructor">B</a> <a id="271" class="Symbol">(</a><a id="272" href="BCK.html#272" class="Bound">f</a> <a id="274" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="276" href="BCK.html#276" class="Bound">g</a> <a id="278" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="280" href="BCK.html#280" class="Bound">x</a> <a id="282" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="284" href="BCK.html#284" class="Bound">xs</a><a id="286" class="Symbol">)</a> <a id="288" class="Symbol">=</a> <a id="290" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="295" class="Symbol">(</a><a id="296" href="Data.List.Base.html#463" class="Function">foldl</a> <a id="302" href="BCK.html#126" class="InductiveConstructor Operator">_$$_</a> <a id="307" class="Symbol">(</a><a id="308" href="BCK.html#272" class="Bound">f</a> <a id="310" href="BCK.html#126" class="InductiveConstructor Operator">$$</a> <a id="313" class="Symbol">(</a><a id="314" href="BCK.html#276" class="Bound">g</a> <a id="316" href="BCK.html#126" class="InductiveConstructor Operator">$$</a> <a id="319" href="BCK.html#280" class="Bound">x</a><a id="320" class="Symbol">))</a> <a id="323" href="BCK.html#284" class="Bound">xs</a><a id="325" class="Symbol">)</a>
<a id="327" href="BCK.html#187" class="Function">stack⊙</a> <a id="334" href="BCK.html#153" class="InductiveConstructor">C</a> <a id="336" class="Symbol">(</a><a id="337" href="BCK.html#337" class="Bound">f</a> <a id="339" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="341" href="BCK.html#341" class="Bound">x</a> <a id="343" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="345" href="BCK.html#345" class="Bound">y</a> <a id="347" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="349" href="BCK.html#349" class="Bound">xs</a><a id="351" class="Symbol">)</a> <a id="353" class="Symbol">=</a> <a id="355" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="360" class="Symbol">(</a><a id="361" href="Data.List.Base.html#463" class="Function">foldl</a> <a id="367" href="BCK.html#126" class="InductiveConstructor Operator">_$$_</a> <a id="372" class="Symbol">(</a><a id="373" href="BCK.html#337" class="Bound">f</a> <a id="375" href="BCK.html#126" class="InductiveConstructor Operator">$$</a> <a id="378" href="BCK.html#345" class="Bound">y</a> <a id="380" href="BCK.html#126" class="InductiveConstructor Operator">$$</a> <a id="383" href="BCK.html#341" class="Bound">x</a><a id="384" class="Symbol">)</a> <a id="386" href="BCK.html#349" class="Bound">xs</a><a id="388" class="Symbol">)</a>
<a id="390" href="BCK.html#187" class="Function">stack⊙</a> <a id="397" href="BCK.html#155" class="InductiveConstructor">K</a> <a id="399" class="Symbol">(</a><a id="400" href="BCK.html#400" class="Bound">x</a> <a id="402" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="404" href="BCK.html#404" class="Bound">y</a> <a id="406" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="408" href="BCK.html#408" class="Bound">xs</a><a id="410" class="Symbol">)</a> <a id="412" class="Symbol">=</a> <a id="414" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="419" class="Symbol">(</a><a id="420" href="Data.List.Base.html#463" class="Function">foldl</a> <a id="426" href="BCK.html#126" class="InductiveConstructor Operator">_$$_</a> <a id="431" href="BCK.html#400" class="Bound">x</a> <a id="433" href="BCK.html#408" class="Bound">xs</a><a id="435" class="Symbol">)</a>
<a id="437" href="BCK.html#187" class="CatchallClause Function">stack⊙</a><a id="443" class="CatchallClause"> </a><a id="444" class="CatchallClause Symbol">_</a><a id="445" class="CatchallClause"> </a><a id="446" class="CatchallClause Symbol">_</a> <a id="448" class="Symbol">=</a> <a id="450" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a>

<a id="stack"></a><a id="459" href="BCK.html#459" class="Function">stack</a> <a id="465" class="Symbol">:</a> <a id="467" href="BCK.html#107" class="Datatype">BCK</a> <a id="471" class="Symbol">→</a> <a id="473" href="Data.Maybe.Base.html#91" class="Datatype">Maybe</a> <a id="479" href="BCK.html#107" class="Datatype">BCK</a>
<a id="483" href="BCK.html#459" class="Function">stack</a> <a id="489" href="BCK.html#489" class="Bound">xs</a> <a id="492" class="Symbol">=</a> <a id="494" href="BCK.html#187" class="Function">stack⊙</a> <a id="501" href="BCK.html#489" class="Bound">xs</a> <a id="504" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>

<a id="size⊙"></a><a id="508" href="BCK.html#508" class="Function">size⊙</a> <a id="514" class="Symbol">:</a> <a id="516" href="BCK.html#107" class="Datatype">BCK</a> <a id="520" class="Symbol">→</a> <a id="522" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="524" class="Symbol">→</a> <a id="526" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="528" href="BCK.html#508" class="Function">size⊙</a> <a id="534" class="Symbol">(</a><a id="535" href="BCK.html#535" class="Bound">xs</a> <a id="538" href="BCK.html#126" class="InductiveConstructor Operator">$$</a> <a id="541" href="BCK.html#541" class="Bound">ys</a><a id="543" class="Symbol">)</a> <a id="545" class="Symbol">=</a> <a id="547" href="BCK.html#508" class="Function">size⊙</a> <a id="553" href="BCK.html#535" class="Bound">xs</a> <a id="556" href="Function.html#97" class="Function Operator">∘</a> <a id="558" href="BCK.html#508" class="Function">size⊙</a> <a id="564" href="BCK.html#541" class="Bound">ys</a>
<a id="567" href="BCK.html#508" class="Function">size⊙</a> <a id="573" href="BCK.html#151" class="InductiveConstructor">B</a> <a id="575" class="Symbol">=</a> <a id="577" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a>
<a id="581" href="BCK.html#508" class="Function">size⊙</a> <a id="587" href="BCK.html#153" class="InductiveConstructor">C</a> <a id="589" class="Symbol">=</a> <a id="591" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a>
<a id="595" href="BCK.html#508" class="Function">size⊙</a> <a id="601" href="BCK.html#155" class="InductiveConstructor">K</a> <a id="603" class="Symbol">=</a> <a id="605" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a>

<a id="size"></a><a id="610" href="BCK.html#610" class="Function">size</a> <a id="615" class="Symbol">:</a> <a id="617" href="BCK.html#107" class="Datatype">BCK</a> <a id="621" class="Symbol">→</a> <a id="623" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="625" href="BCK.html#610" class="Function">size</a> <a id="630" href="BCK.html#630" class="Bound">xs</a> <a id="633" class="Symbol">=</a> <a id="635" href="BCK.html#508" class="Function">size⊙</a> <a id="641" href="BCK.html#630" class="Bound">xs</a> <a id="644" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>

<a id="650" class="Keyword">open</a> <a id="655" class="Keyword">import</a> <a id="662" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a>

<a id="_M&lt;ᴮ_"></a><a id="683" href="BCK.html#683" class="Function Operator">_M&lt;ᴮ_</a> <a id="689" class="Symbol">:</a> <a id="691" href="Data.Maybe.Base.html#91" class="Datatype">Maybe</a> <a id="697" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="699" class="Symbol">→</a> <a id="701" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="703" class="Symbol">→</a> <a id="705" href="Agda.Builtin.Bool.html#163" class="Datatype">Bool</a>
<a id="710" href="BCK.html#710" class="Bound">n</a> <a id="712" href="BCK.html#683" class="Function Operator">M&lt;ᴮ</a> <a id="716" href="BCK.html#716" class="Bound">m</a> <a id="718" class="Symbol">=</a> <a id="720" href="Data.Maybe.Base.html#172" class="Function">maybe</a> <a id="726" href="Agda.Builtin.Bool.html#188" class="InductiveConstructor">true</a> <a id="731" class="Symbol">(</a><a id="732" href="Data.Nat.Properties.html#150" class="Primitive Operator">_&lt;ᴮ</a> <a id="736" href="BCK.html#716" class="Bound">m</a><a id="737" class="Symbol">)</a> <a id="739" href="BCK.html#710" class="Bound">n</a>

<a id="_M&lt;_"></a><a id="742" href="BCK.html#742" class="Function Operator">_M&lt;_</a> <a id="747" class="Symbol">:</a> <a id="749" href="Data.Maybe.Base.html#91" class="Datatype">Maybe</a> <a id="755" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="757" class="Symbol">→</a> <a id="759" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="761" class="Symbol">→</a> <a id="763" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="768" href="BCK.html#768" class="Bound">n</a> <a id="770" href="BCK.html#742" class="Function Operator">M&lt;</a> <a id="773" href="BCK.html#773" class="Bound">m</a> <a id="775" class="Symbol">=</a> <a id="777" href="Data.Bool.Truth.html#158" class="Function">T</a> <a id="779" class="Symbol">(</a><a id="780" href="BCK.html#768" class="Bound">n</a> <a id="782" href="BCK.html#683" class="Function Operator">M&lt;ᴮ</a> <a id="786" href="BCK.html#773" class="Bound">m</a><a id="787" class="Symbol">)</a>

<a id="790" class="Keyword">open</a> <a id="795" class="Keyword">import</a> <a id="802" href="Data.Maybe.html" class="Module">Data.Maybe</a>


<a id="815" class="Comment">-- size⊙&lt; : ∀ x xs n → mapMaybe size (stack⊙ x xs) M&lt; foldl (flip size⊙) (size x) xs</a>
<a id="900" class="Comment">-- size⊙&lt; (f $$ x) xs = {!!}</a>
<a id="929" class="Comment">-- size⊙&lt; B (f ∷ g ∷ x ∷ xs) = {!!}</a>
<a id="965" class="Comment">-- size⊙&lt; C (f ∷ x ∷ y ∷ xs) = {!!}</a>
<a id="1001" class="Comment">-- size⊙&lt; K (x ∷ y ∷ xs) = {!!}</a>
<a id="1033" class="Comment">-- size⊙&lt; _ _ = {!!}</a>

<a id="1055" class="Comment">-- size&lt; : ∀ x → mapMaybe size (stack x) M&lt; size x</a>
<a id="1106" class="Comment">-- size&lt; x = size⊙&lt; x []</a>
</pre></body></html>