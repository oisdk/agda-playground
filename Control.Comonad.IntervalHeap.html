<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Comonad.IntervalHeap</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--no-positivity-check</a> <a id="35" class="Pragma">--no-termination-check</a> <a id="58" class="Pragma">--allow-unsolved-metas</a> <a id="81" class="Symbol">#-}</a>

<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="Algebra.html" class="Module">Algebra</a>
<a id="106" class="Keyword">open</a> <a id="111" class="Keyword">import</a> <a id="118" href="Prelude.html" class="Module">Prelude</a>
<a id="126" class="Keyword">open</a> <a id="131" class="Keyword">import</a> <a id="138" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="154" class="Keyword">open</a> <a id="159" class="Keyword">import</a> <a id="166" href="WellFounded.html" class="Module">WellFounded</a>
<a id="178" class="Keyword">open</a> <a id="183" class="Keyword">import</a> <a id="190" href="Algebra.Monus.html" class="Module">Algebra.Monus</a>
<a id="204" class="Keyword">open</a> <a id="209" class="Keyword">import</a> <a id="216" href="Data.Maybe.html" class="Module">Data.Maybe</a>

<a id="228" class="Keyword">module</a> <a id="235" href="Control.Comonad.IntervalHeap.html" class="Module">Control.Comonad.IntervalHeap</a> <a id="264" class="Symbol">{</a><a id="265" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a><a id="266" class="Symbol">}</a> <a id="268" class="Symbol">{</a><a id="269" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a> <a id="271" class="Symbol">:</a> <a id="273" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="278" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a><a id="279" class="Symbol">}</a>
  <a id="283" class="Symbol">(</a><a id="284" href="Control.Comonad.IntervalHeap.html#284" class="Bound">mon</a> <a id="288" class="Symbol">:</a> <a id="290" href="Algebra.Monus.html#5383" class="Record">TMAPOM</a> <a id="297" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a><a id="298" class="Symbol">)</a>
  <a id="302" class="Symbol">{</a><a id="303" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="305" class="Symbol">:</a> <a id="307" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a> <a id="309" class="Symbol">→</a> <a id="311" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="316" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a> <a id="318" class="Symbol">→</a> <a id="320" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="325" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a><a id="326" class="Symbol">}</a>
  <a id="330" class="Symbol">(</a><a id="331" href="Control.Comonad.IntervalHeap.html#331" class="Bound">comon</a> <a id="337" class="Symbol">:</a> <a id="339" href="Algebra.html#11231" class="Record">GradedComonad</a> <a id="353" class="Symbol">(</a><a id="354" href="Algebra.html#2539" class="Function">TMAPOM.monoid</a> <a id="368" href="Control.Comonad.IntervalHeap.html#284" class="Bound">mon</a><a id="371" class="Symbol">)</a> <a id="373" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a><a id="374" class="Symbol">)</a>
  <a id="378" class="Keyword">where</a>

<a id="385" class="Keyword">open</a> <a id="390" href="Algebra.Monus.html#5383" class="Module">TMAPOM</a> <a id="397" href="Control.Comonad.IntervalHeap.html#284" class="Bound">mon</a>
<a id="401" class="Keyword">open</a> <a id="406" href="Algebra.html#11231" class="Module">GradedComonad</a> <a id="420" href="Control.Comonad.IntervalHeap.html#331" class="Bound">comon</a> <a id="426" class="Keyword">renaming</a> <a id="435" class="Symbol">(</a><a id="436" href="Algebra.html#12800" class="Function">map</a> <a id="440" class="Symbol">to</a> <a id="443" class="Function">cmap</a><a id="447" class="Symbol">)</a>

<a id="Weighted"></a><a id="450" href="Control.Comonad.IntervalHeap.html#450" class="Function">Weighted</a> <a id="459" class="Symbol">:</a> <a id="461" class="Symbol">(</a><a id="462" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a> <a id="464" class="Symbol">→</a> <a id="466" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="471" href="Level.html#266" class="Generalizable">a</a> <a id="473" class="Symbol">→</a> <a id="475" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="480" href="Level.html#268" class="Generalizable">b</a><a id="481" class="Symbol">)</a> <a id="483" class="Symbol">→</a> <a id="485" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="490" href="Level.html#266" class="Generalizable">a</a> <a id="492" class="Symbol">→</a> <a id="494" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="499" class="Symbol">(</a><a id="500" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a> <a id="502" href="Agda.Primitive.html#961" class="Primitive Operator">ℓ⊔</a> <a id="505" href="Level.html#268" class="Generalizable">b</a><a id="506" class="Symbol">)</a>
<a id="508" href="Control.Comonad.IntervalHeap.html#450" class="Function">Weighted</a> <a id="517" href="Control.Comonad.IntervalHeap.html#517" class="Bound">C</a> <a id="519" href="Control.Comonad.IntervalHeap.html#519" class="Bound">A</a> <a id="521" class="Symbol">=</a> <a id="523" href="Data.Sigma.Base.html#173" class="Function">∃</a> <a id="525" href="Control.Comonad.IntervalHeap.html#525" class="Bound">w</a> <a id="527" href="Data.Sigma.Base.html#173" class="Function">×</a> <a id="529" href="Control.Comonad.IntervalHeap.html#517" class="Bound">C</a> <a id="531" href="Control.Comonad.IntervalHeap.html#525" class="Bound">w</a> <a id="533" href="Control.Comonad.IntervalHeap.html#519" class="Bound">A</a>

<a id="536" class="Keyword">private</a> <a id="544" class="Keyword">variable</a> <a id="553" href="Control.Comonad.IntervalHeap.html#553" class="Generalizable">u</a> <a id="555" href="Control.Comonad.IntervalHeap.html#555" class="Generalizable">v</a> <a id="557" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="559" class="Symbol">:</a> <a id="561" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a>

<a id="564" class="Keyword">module</a> <a id="OnFunctor"></a><a id="571" href="Control.Comonad.IntervalHeap.html#571" class="Module">OnFunctor</a> <a id="581" class="Symbol">{</a><a id="582" href="Control.Comonad.IntervalHeap.html#582" class="Bound">𝐹</a> <a id="584" class="Symbol">:</a> <a id="586" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="591" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a> <a id="593" class="Symbol">→</a> <a id="595" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="600" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a><a id="601" class="Symbol">}</a> <a id="603" class="Symbol">(</a><a id="604" href="Control.Comonad.IntervalHeap.html#604" class="Bound">functor</a> <a id="612" class="Symbol">:</a> <a id="614" href="Algebra.html#5850" class="Record">Functor</a> <a id="622" href="Control.Comonad.IntervalHeap.html#582" class="Bound">𝐹</a><a id="623" class="Symbol">)</a> <a id="625" class="Keyword">where</a>
  <a id="633" class="Keyword">open</a> <a id="638" href="Algebra.html#5850" class="Module">Functor</a> <a id="646" href="Control.Comonad.IntervalHeap.html#604" class="Bound">functor</a> <a id="654" class="Keyword">renaming</a> <a id="663" class="Symbol">(</a><a id="664" href="Algebra.html#5903" class="Field">map</a> <a id="668" class="Symbol">to</a> <a id="671" class="Field">fmap</a><a id="675" class="Symbol">)</a>

  <a id="680" class="Keyword">record</a> <a id="OnFunctor.Cofree⁺"></a><a id="687" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="695" class="Symbol">(</a><a id="696" href="Control.Comonad.IntervalHeap.html#696" class="Bound">w</a> <a id="698" class="Symbol">:</a> <a id="700" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a><a id="701" class="Symbol">)</a> <a id="703" class="Symbol">(</a><a id="704" href="Control.Comonad.IntervalHeap.html#704" class="Bound">A</a> <a id="706" class="Symbol">:</a> <a id="708" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="713" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a><a id="714" class="Symbol">)</a> <a id="716" class="Symbol">:</a> <a id="718" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="723" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a> <a id="725" class="Keyword">where</a>
    <a id="735" class="Keyword">constructor</a> <a id="OnFunctor.⟪_⟫"></a><a id="747" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟪_⟫</a>
    <a id="755" class="Keyword">field</a> <a id="OnFunctor.Cofree⁺.step"></a><a id="761" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="766" class="Symbol">:</a> <a id="768" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="770" href="Control.Comonad.IntervalHeap.html#696" class="Bound">w</a> <a id="772" class="Symbol">(</a><a id="773" href="Control.Comonad.IntervalHeap.html#704" class="Bound">A</a> <a id="775" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="777" href="Control.Comonad.IntervalHeap.html#582" class="Bound">𝐹</a> <a id="779" class="Symbol">(</a><a id="780" href="Control.Comonad.IntervalHeap.html#450" class="Function">Weighted</a> <a id="789" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="797" href="Control.Comonad.IntervalHeap.html#704" class="Bound">A</a><a id="798" class="Symbol">))</a>
  <a id="803" class="Keyword">open</a> <a id="808" href="Control.Comonad.IntervalHeap.html#687" class="Module">Cofree⁺</a> <a id="816" class="Keyword">public</a>

  <a id="OnFunctor.Cofree"></a><a id="826" href="Control.Comonad.IntervalHeap.html#826" class="Function">Cofree</a> <a id="833" class="Symbol">:</a> <a id="835" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="840" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a> <a id="842" class="Symbol">→</a> <a id="844" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="849" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a>
  <a id="853" href="Control.Comonad.IntervalHeap.html#826" class="Function">Cofree</a> <a id="860" class="Symbol">=</a> <a id="862" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="870" href="Algebra.html#1438" class="Function">ε</a>

  <a id="OnFunctor.extend′"></a><a id="875" href="Control.Comonad.IntervalHeap.html#875" class="Function">extend′</a> <a id="883" class="Symbol">:</a> <a id="885" class="Symbol">(</a><a id="886" href="Control.Comonad.IntervalHeap.html#826" class="Function">Cofree</a> <a id="893" href="Level.html#282" class="Generalizable">A</a> <a id="895" class="Symbol">→</a> <a id="897" href="Level.html#296" class="Generalizable">B</a><a id="898" class="Symbol">)</a> <a id="900" class="Symbol">→</a> <a id="902" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="910" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="912" href="Level.html#282" class="Generalizable">A</a> <a id="914" class="Symbol">→</a> <a id="916" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="924" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="926" href="Level.html#296" class="Generalizable">B</a>
  <a id="930" href="Control.Comonad.IntervalHeap.html#875" class="Function">extend′</a> <a id="938" href="Control.Comonad.IntervalHeap.html#938" class="Bound">f</a> <a id="940" href="Control.Comonad.IntervalHeap.html#940" class="Bound">x</a> <a id="942" class="Symbol">.</a><a id="943" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="948" class="Symbol">=</a> <a id="950" href="Control.Comonad.IntervalHeap.html#940" class="Bound">x</a> <a id="952" class="Symbol">.</a><a id="953" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="958" href="Algebra.html#11584" class="Function">=&gt;&gt;[</a> <a id="963" href="Algebra.html#1537" class="Function">∙ε</a> <a id="966" class="Symbol">_</a> <a id="968" href="Algebra.html#11584" class="Function">]</a> <a id="970" class="Symbol">λ</a> <a id="972" href="Control.Comonad.IntervalHeap.html#972" class="Bound">ys</a> <a id="975" class="Symbol">→</a> <a id="977" href="Control.Comonad.IntervalHeap.html#938" class="Bound">f</a> <a id="979" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟪</a> <a id="981" href="Control.Comonad.IntervalHeap.html#972" class="Bound">ys</a> <a id="984" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟫</a> <a id="986" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="988" href="Control.Comonad.IntervalHeap.html#671" class="Field">fmap</a> <a id="993" class="Symbol">(</a><a id="994" href="Data.Sigma.Base.html#1314" class="Function">map₂</a> <a id="999" class="Symbol">(</a><a id="1000" href="Control.Comonad.IntervalHeap.html#875" class="Function">extend′</a> <a id="1008" href="Control.Comonad.IntervalHeap.html#938" class="Bound">f</a><a id="1009" class="Symbol">))</a> <a id="1012" class="Symbol">(</a><a id="1013" href="Agda.Builtin.Sigma.html#263" class="Field">snd</a> <a id="1017" class="Symbol">(</a><a id="1018" href="Algebra.html#11290" class="Field">extract</a> <a id="1026" href="Control.Comonad.IntervalHeap.html#972" class="Bound">ys</a><a id="1028" class="Symbol">))</a> 

  <a id="OnFunctor.extract′"></a><a id="1035" href="Control.Comonad.IntervalHeap.html#1035" class="Function">extract′</a> <a id="1044" class="Symbol">:</a> <a id="1046" href="Control.Comonad.IntervalHeap.html#826" class="Function">Cofree</a> <a id="1053" href="Level.html#282" class="Generalizable">A</a> <a id="1055" class="Symbol">→</a> <a id="1057" href="Level.html#282" class="Generalizable">A</a>
  <a id="1061" href="Control.Comonad.IntervalHeap.html#1035" class="Function">extract′</a> <a id="1070" class="Symbol">=</a> <a id="1072" href="Agda.Builtin.Sigma.html#251" class="Field">fst</a> <a id="1076" href="Function.html#97" class="Function Operator">∘</a> <a id="1078" href="Algebra.html#11290" class="Field">extract</a> <a id="1086" href="Function.html#97" class="Function Operator">∘</a> <a id="1088" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a>

  <a id="OnFunctor.traceT"></a><a id="1096" href="Control.Comonad.IntervalHeap.html#1096" class="Function">traceT</a> <a id="1103" class="Symbol">:</a> <a id="1105" class="Symbol">(</a><a id="1106" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1108" href="Algebra.html#1438" class="Function">ε</a> <a id="1110" href="Level.html#282" class="Generalizable">A</a> <a id="1112" class="Symbol">→</a> <a id="1114" href="Level.html#296" class="Generalizable">B</a><a id="1115" class="Symbol">)</a> <a id="1117" class="Symbol">→</a> <a id="1119" class="Symbol">(</a><a id="1120" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1122" href="Algebra.html#1438" class="Function">ε</a> <a id="1124" href="Level.html#282" class="Generalizable">A</a> <a id="1126" class="Symbol">→</a> <a id="1128" href="Control.Comonad.IntervalHeap.html#582" class="Bound">𝐹</a> <a id="1130" class="Symbol">(</a><a id="1131" href="Control.Comonad.IntervalHeap.html#450" class="Function">Weighted</a> <a id="1140" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1142" href="Level.html#282" class="Generalizable">A</a><a id="1143" class="Symbol">))</a> <a id="1146" class="Symbol">→</a> <a id="1148" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1150" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="1152" href="Level.html#282" class="Generalizable">A</a> <a id="1154" class="Symbol">→</a> <a id="1156" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="1164" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="1166" href="Level.html#296" class="Generalizable">B</a>
  <a id="1170" href="Control.Comonad.IntervalHeap.html#1096" class="Function">traceT</a> <a id="1177" href="Control.Comonad.IntervalHeap.html#1177" class="Bound">f</a> <a id="1179" href="Control.Comonad.IntervalHeap.html#1179" class="Bound">c</a> <a id="1181" href="Control.Comonad.IntervalHeap.html#1181" class="Bound">r</a> <a id="1183" class="Symbol">.</a><a id="1184" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="1189" class="Symbol">=</a> <a id="1191" href="Control.Comonad.IntervalHeap.html#1181" class="Bound">r</a> <a id="1193" href="Algebra.html#11584" class="Function">=&gt;&gt;[</a> <a id="1198" href="Algebra.html#1537" class="Function">∙ε</a> <a id="1201" class="Symbol">_</a> <a id="1203" href="Algebra.html#11584" class="Function">]</a> <a id="1205" class="Symbol">λ</a> <a id="1207" href="Control.Comonad.IntervalHeap.html#1207" class="Bound">rs</a> <a id="1210" class="Symbol">→</a> <a id="1212" href="Control.Comonad.IntervalHeap.html#1177" class="Bound">f</a> <a id="1214" href="Control.Comonad.IntervalHeap.html#1207" class="Bound">rs</a> <a id="1217" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1219" href="Control.Comonad.IntervalHeap.html#671" class="Field">fmap</a> <a id="1224" class="Symbol">(</a><a id="1225" href="Data.Sigma.Base.html#1314" class="Function">map₂</a> <a id="1230" class="Symbol">(</a><a id="1231" href="Control.Comonad.IntervalHeap.html#1096" class="Function">traceT</a> <a id="1238" href="Control.Comonad.IntervalHeap.html#1177" class="Bound">f</a> <a id="1240" href="Control.Comonad.IntervalHeap.html#1179" class="Bound">c</a><a id="1241" class="Symbol">))</a> <a id="1244" class="Symbol">(</a><a id="1245" href="Control.Comonad.IntervalHeap.html#1179" class="Bound">c</a> <a id="1247" href="Control.Comonad.IntervalHeap.html#1207" class="Bound">rs</a><a id="1249" class="Symbol">)</a>

  <a id="OnFunctor.iterT"></a><a id="1254" href="Control.Comonad.IntervalHeap.html#1254" class="Function">iterT</a> <a id="1260" class="Symbol">:</a> <a id="1262" class="Symbol">(</a><a id="1263" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1265" href="Algebra.html#1438" class="Function">ε</a> <a id="1267" href="Level.html#282" class="Generalizable">A</a> <a id="1269" class="Symbol">→</a> <a id="1271" href="Control.Comonad.IntervalHeap.html#582" class="Bound">𝐹</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Control.Comonad.IntervalHeap.html#450" class="Function">Weighted</a> <a id="1283" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1285" href="Level.html#282" class="Generalizable">A</a><a id="1286" class="Symbol">))</a> <a id="1289" class="Symbol">→</a> <a id="1291" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1293" href="Algebra.html#1438" class="Function">ε</a> <a id="1295" href="Level.html#282" class="Generalizable">A</a> <a id="1297" class="Symbol">→</a> <a id="1299" href="Control.Comonad.IntervalHeap.html#826" class="Function">Cofree</a> <a id="1306" href="Level.html#282" class="Generalizable">A</a>
  <a id="1310" href="Control.Comonad.IntervalHeap.html#1254" class="Function">iterT</a> <a id="1316" class="Symbol">=</a> <a id="1318" href="Control.Comonad.IntervalHeap.html#1096" class="Function">traceT</a> <a id="1325" href="Algebra.html#11290" class="Field">extract</a>

  <a id="OnFunctor.ana"></a><a id="1336" href="Control.Comonad.IntervalHeap.html#1336" class="Function">ana</a> <a id="1340" class="Symbol">:</a> <a id="1342" class="Symbol">(</a><a id="1343" href="Control.Comonad.IntervalHeap.html#1343" class="Bound">𝐺</a> <a id="1345" class="Symbol">:</a> <a id="1347" href="Control.Comonad.IntervalHeap.html#269" class="Bound">𝑆</a> <a id="1349" class="Symbol">→</a> <a id="1351" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1356" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a><a id="1357" class="Symbol">)</a> <a id="1359" class="Symbol">→</a> <a id="1361" class="Symbol">(∀</a> <a id="1364" class="Symbol">{</a><a id="1365" href="Control.Comonad.IntervalHeap.html#1365" class="Bound">w</a><a id="1366" class="Symbol">}</a> <a id="1368" class="Symbol">→</a> <a id="1370" href="Control.Comonad.IntervalHeap.html#1343" class="Bound">𝐺</a> <a id="1372" href="Control.Comonad.IntervalHeap.html#1365" class="Bound">w</a> <a id="1374" class="Symbol">→</a> <a id="1376" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1378" href="Control.Comonad.IntervalHeap.html#1365" class="Bound">w</a> <a id="1380" class="Symbol">(</a><a id="1381" href="Level.html#282" class="Generalizable">A</a> <a id="1383" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="1385" href="Control.Comonad.IntervalHeap.html#582" class="Bound">𝐹</a> <a id="1387" class="Symbol">(</a><a id="1388" href="Data.Sigma.Base.html#173" class="Function">∃</a> <a id="1390" href="Control.Comonad.IntervalHeap.html#1390" class="Bound">u</a> <a id="1392" href="Data.Sigma.Base.html#173" class="Function">×</a> <a id="1394" href="Control.Comonad.IntervalHeap.html#1343" class="Bound">𝐺</a> <a id="1396" href="Control.Comonad.IntervalHeap.html#1390" class="Bound">u</a><a id="1397" class="Symbol">)))</a> <a id="1401" class="Symbol">→</a> <a id="1403" href="Control.Comonad.IntervalHeap.html#1343" class="Bound">𝐺</a> <a id="1405" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="1407" class="Symbol">→</a> <a id="1409" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="1417" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="1419" href="Level.html#282" class="Generalizable">A</a>
  <a id="1423" href="Control.Comonad.IntervalHeap.html#1336" class="Function">ana</a> <a id="1427" href="Control.Comonad.IntervalHeap.html#1427" class="Bound">𝐺</a> <a id="1429" href="Control.Comonad.IntervalHeap.html#1429" class="Bound">alg</a> <a id="1433" href="Control.Comonad.IntervalHeap.html#1433" class="Bound">x</a> <a id="1435" class="Symbol">.</a><a id="1436" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="1441" class="Symbol">=</a> <a id="1443" href="Control.Comonad.IntervalHeap.html#443" class="Function">cmap</a> <a id="1448" class="Symbol">(</a><a id="1449" href="Data.Sigma.Base.html#1314" class="Function">map₂</a> <a id="1454" class="Symbol">(</a><a id="1455" href="Control.Comonad.IntervalHeap.html#671" class="Field">fmap</a> <a id="1460" class="Symbol">(</a><a id="1461" href="Data.Sigma.Base.html#1314" class="Function">map₂</a> <a id="1466" class="Symbol">(</a><a id="1467" href="Control.Comonad.IntervalHeap.html#1336" class="Function">ana</a> <a id="1471" href="Control.Comonad.IntervalHeap.html#1427" class="Bound">𝐺</a> <a id="1473" href="Control.Comonad.IntervalHeap.html#1429" class="Bound">alg</a><a id="1476" class="Symbol">))))</a> <a id="1481" class="Symbol">(</a><a id="1482" href="Control.Comonad.IntervalHeap.html#1429" class="Bound">alg</a> <a id="1486" href="Control.Comonad.IntervalHeap.html#1433" class="Bound">x</a><a id="1487" class="Symbol">)</a>

<a id="1490" class="Keyword">module</a> <a id="AsHeap"></a><a id="1497" href="Control.Comonad.IntervalHeap.html#1497" class="Module">AsHeap</a> <a id="1504" class="Symbol">(</a><a id="1505" href="Control.Comonad.IntervalHeap.html#1505" class="Bound Operator">_&lt;*&gt;_</a> <a id="1511" class="Symbol">:</a> <a id="1513" class="Symbol">∀</a> <a id="1515" class="Symbol">{</a><a id="1516" href="Control.Comonad.IntervalHeap.html#1516" class="Bound">w</a> <a id="1518" href="Control.Comonad.IntervalHeap.html#1518" class="Bound">A</a> <a id="1520" href="Control.Comonad.IntervalHeap.html#1520" class="Bound">B</a><a id="1521" class="Symbol">}</a> <a id="1523" class="Symbol">→</a> <a id="1525" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1527" href="Control.Comonad.IntervalHeap.html#1516" class="Bound">w</a> <a id="1529" class="Symbol">(</a><a id="1530" href="Control.Comonad.IntervalHeap.html#1518" class="Bound">A</a> <a id="1532" class="Symbol">→</a> <a id="1534" href="Control.Comonad.IntervalHeap.html#1520" class="Bound">B</a><a id="1535" class="Symbol">)</a> <a id="1537" class="Symbol">→</a> <a id="1539" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1541" href="Control.Comonad.IntervalHeap.html#1516" class="Bound">w</a> <a id="1543" href="Control.Comonad.IntervalHeap.html#1518" class="Bound">A</a> <a id="1545" class="Symbol">→</a> <a id="1547" href="Control.Comonad.IntervalHeap.html#303" class="Bound">𝑊</a> <a id="1549" href="Control.Comonad.IntervalHeap.html#1516" class="Bound">w</a> <a id="1551" href="Control.Comonad.IntervalHeap.html#1520" class="Bound">B</a><a id="1552" class="Symbol">)</a> <a id="1554" class="Keyword">where</a>
  <a id="1562" class="Keyword">open</a> <a id="1567" class="Keyword">import</a> <a id="1574" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="1595" class="Keyword">using</a> <a id="1601" class="Symbol">(</a><a id="1602" href="Data.List.Properties.html#4144" class="Function">listFunctor</a><a id="1613" class="Symbol">)</a>
  <a id="1617" class="Keyword">open</a> <a id="1622" class="Keyword">import</a> <a id="1629" href="Data.List.html" class="Module">Data.List</a> <a id="1639" class="Keyword">using</a> <a id="1645" class="Symbol">(</a><a id="1646" href="Agda.Builtin.List.html#147" class="Datatype">List</a><a id="1650" class="Symbol">;</a> <a id="1652" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">_∷_</a><a id="1655" class="Symbol">;</a> <a id="1657" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1659" class="Symbol">)</a>
  <a id="1663" class="Keyword">open</a> <a id="1668" href="Control.Comonad.IntervalHeap.html#571" class="Module">OnFunctor</a> <a id="1678" href="Data.List.Properties.html#4144" class="Function">listFunctor</a>
  <a id="AsHeap.Heap"></a><a id="1692" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="1697" class="Symbol">:</a> <a id="1699" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1704" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a> <a id="1706" class="Symbol">→</a> <a id="1708" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="1713" href="Control.Comonad.IntervalHeap.html#265" class="Bound">s</a>
  <a id="1717" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="1722" class="Symbol">=</a> <a id="1724" href="Control.Comonad.IntervalHeap.html#450" class="Function">Weighted</a> <a id="1733" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> 

  <a id="AsHeap._∪_"></a><a id="1745" href="Control.Comonad.IntervalHeap.html#1745" class="Function Operator">_∪_</a> <a id="1749" class="Symbol">:</a> <a id="1751" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="1756" href="Level.html#282" class="Generalizable">A</a> <a id="1758" class="Symbol">→</a> <a id="1760" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="1765" href="Level.html#282" class="Generalizable">A</a> <a id="1767" class="Symbol">→</a> <a id="1769" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="1774" href="Level.html#282" class="Generalizable">A</a>
  <a id="1778" class="Symbol">(</a><a id="1779" href="Control.Comonad.IntervalHeap.html#1779" class="Bound">xʷ</a> <a id="1782" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1784" href="Control.Comonad.IntervalHeap.html#1784" class="Bound">xs</a><a id="1786" class="Symbol">)</a> <a id="1788" href="Control.Comonad.IntervalHeap.html#1745" class="Function Operator">∪</a> <a id="1790" class="Symbol">(</a><a id="1791" href="Control.Comonad.IntervalHeap.html#1791" class="Bound">yʷ</a> <a id="1794" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1796" href="Control.Comonad.IntervalHeap.html#1796" class="Bound">ys</a><a id="1798" class="Symbol">)</a> <a id="1800" class="Keyword">with</a> <a id="1805" href="Control.Comonad.IntervalHeap.html#1779" class="Bound">xʷ</a> <a id="1808" href="Algebra.Monus.html#4838" class="Function Operator">≤|≥</a> <a id="1812" href="Control.Comonad.IntervalHeap.html#1791" class="Bound">yʷ</a>
  <a id="1817" class="Symbol">...</a> <a id="1821" class="Symbol">|</a> <a id="1823" href="Data.Sum.html#226" class="InductiveConstructor">inl</a> <a id="1827" class="Symbol">(</a><a id="1828" href="Control.Comonad.IntervalHeap.html#1828" class="Bound">k</a> <a id="1830" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1832" href="Control.Comonad.IntervalHeap.html#1832" class="Bound">y≡x∙k</a><a id="1837" class="Symbol">)</a> <a id="1839" class="Symbol">=</a> <a id="1841" class="Bound">xʷ</a> <a id="1844" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1846" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟪</a> <a id="1848" class="Symbol">(</a><a id="1849" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="1854" class="Bound">ys</a> <a id="1857" href="Algebra.html#11584" class="Function">=&gt;&gt;[</a> <a id="1862" href="Cubical.Foundations.Prelude.html#968" class="Function">sym</a> <a id="1866" href="Control.Comonad.IntervalHeap.html#1832" class="Bound">y≡x∙k</a> <a id="1872" href="Algebra.html#11584" class="Function">]</a> <a id="1874" class="Symbol">λ</a> <a id="1876" class="Symbol">{</a> <a id="1878" href="Control.Comonad.IntervalHeap.html#1878" class="Bound">y</a> <a id="1880" class="Symbol">(</a><a id="1881" href="Control.Comonad.IntervalHeap.html#1881" class="Bound">x</a> <a id="1883" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1885" href="Control.Comonad.IntervalHeap.html#1885" class="Bound">xs</a><a id="1887" class="Symbol">)</a> <a id="1889" class="Symbol">→</a> <a id="1891" href="Control.Comonad.IntervalHeap.html#1881" class="Bound">x</a> <a id="1893" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1895" class="Symbol">((</a><a id="1897" href="Control.Comonad.IntervalHeap.html#1828" class="Bound">k</a> <a id="1899" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1901" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟪</a> <a id="1903" href="Control.Comonad.IntervalHeap.html#1878" class="Bound">y</a> <a id="1905" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟫</a><a id="1906" class="Symbol">)</a> <a id="1908" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1910" href="Control.Comonad.IntervalHeap.html#1885" class="Bound">xs</a><a id="1912" class="Symbol">)})</a> <a id="1916" href="Control.Comonad.IntervalHeap.html#1505" class="Bound Operator">&lt;*&gt;</a> <a id="1920" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="1925" class="Bound">xs</a> <a id="1928" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟫</a>
  <a id="1932" class="Symbol">...</a> <a id="1936" class="Symbol">|</a> <a id="1938" href="Data.Sum.html#244" class="InductiveConstructor">inr</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Control.Comonad.IntervalHeap.html#1943" class="Bound">k</a> <a id="1945" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1947" href="Control.Comonad.IntervalHeap.html#1947" class="Bound">x≡y∙k</a><a id="1952" class="Symbol">)</a> <a id="1954" class="Symbol">=</a> <a id="1956" class="Bound">yʷ</a> <a id="1959" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1961" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟪</a> <a id="1963" class="Symbol">(</a><a id="1964" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="1969" class="Bound">xs</a> <a id="1972" href="Algebra.html#11584" class="Function">=&gt;&gt;[</a> <a id="1977" href="Cubical.Foundations.Prelude.html#968" class="Function">sym</a> <a id="1981" href="Control.Comonad.IntervalHeap.html#1947" class="Bound">x≡y∙k</a> <a id="1987" href="Algebra.html#11584" class="Function">]</a> <a id="1989" class="Symbol">λ</a> <a id="1991" class="Symbol">{</a> <a id="1993" href="Control.Comonad.IntervalHeap.html#1993" class="Bound">x</a> <a id="1995" class="Symbol">(</a><a id="1996" href="Control.Comonad.IntervalHeap.html#1996" class="Bound">y</a> <a id="1998" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2000" href="Control.Comonad.IntervalHeap.html#2000" class="Bound">ys</a><a id="2002" class="Symbol">)</a> <a id="2004" class="Symbol">→</a> <a id="2006" href="Control.Comonad.IntervalHeap.html#1996" class="Bound">y</a> <a id="2008" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2010" class="Symbol">((</a><a id="2012" href="Control.Comonad.IntervalHeap.html#1943" class="Bound">k</a> <a id="2014" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="2016" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟪</a> <a id="2018" href="Control.Comonad.IntervalHeap.html#1993" class="Bound">x</a> <a id="2020" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟫</a><a id="2021" class="Symbol">)</a> <a id="2023" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2025" href="Control.Comonad.IntervalHeap.html#2000" class="Bound">ys</a><a id="2027" class="Symbol">)})</a> <a id="2031" href="Control.Comonad.IntervalHeap.html#1505" class="Bound Operator">&lt;*&gt;</a> <a id="2035" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a> <a id="2040" class="Bound">ys</a> <a id="2043" href="Control.Comonad.IntervalHeap.html#747" class="InductiveConstructor Operator">⟫</a>

  <a id="AsHeap.merge⁺"></a><a id="2048" href="Control.Comonad.IntervalHeap.html#2048" class="Function">merge⁺</a> <a id="2055" class="Symbol">:</a> <a id="2057" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="2062" href="Level.html#282" class="Generalizable">A</a> <a id="2064" class="Symbol">→</a> <a id="2066" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2071" class="Symbol">(</a><a id="2072" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="2077" href="Level.html#282" class="Generalizable">A</a><a id="2078" class="Symbol">)</a> <a id="2080" class="Symbol">→</a> <a id="2082" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="2087" href="Level.html#282" class="Generalizable">A</a>
  <a id="2091" href="Control.Comonad.IntervalHeap.html#2048" class="Function">merge⁺</a> <a id="2098" href="Control.Comonad.IntervalHeap.html#2098" class="Bound">x</a> <a id="2100" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2103" class="Symbol">=</a> <a id="2105" href="Control.Comonad.IntervalHeap.html#2098" class="Bound">x</a>
  <a id="2109" href="Control.Comonad.IntervalHeap.html#2048" class="Function">merge⁺</a> <a id="2116" href="Control.Comonad.IntervalHeap.html#2116" class="Bound">x₁</a> <a id="2119" class="Symbol">(</a><a id="2120" href="Control.Comonad.IntervalHeap.html#2120" class="Bound">x₂</a> <a id="2123" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2125" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="2127" class="Symbol">)</a> <a id="2129" class="Symbol">=</a> <a id="2131" href="Control.Comonad.IntervalHeap.html#2116" class="Bound">x₁</a> <a id="2134" href="Control.Comonad.IntervalHeap.html#1745" class="Function Operator">∪</a> <a id="2136" href="Control.Comonad.IntervalHeap.html#2120" class="Bound">x₂</a>
  <a id="2141" href="Control.Comonad.IntervalHeap.html#2048" class="Function">merge⁺</a> <a id="2148" href="Control.Comonad.IntervalHeap.html#2148" class="Bound">x₁</a> <a id="2151" class="Symbol">(</a><a id="2152" href="Control.Comonad.IntervalHeap.html#2152" class="Bound">x₂</a> <a id="2155" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2157" href="Control.Comonad.IntervalHeap.html#2157" class="Bound">x₃</a> <a id="2160" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2162" href="Control.Comonad.IntervalHeap.html#2162" class="Bound">xs</a><a id="2164" class="Symbol">)</a> <a id="2166" class="Symbol">=</a> <a id="2168" class="Symbol">(</a><a id="2169" href="Control.Comonad.IntervalHeap.html#2148" class="Bound">x₁</a> <a id="2172" href="Control.Comonad.IntervalHeap.html#1745" class="Function Operator">∪</a> <a id="2174" href="Control.Comonad.IntervalHeap.html#2152" class="Bound">x₂</a><a id="2176" class="Symbol">)</a> <a id="2178" href="Control.Comonad.IntervalHeap.html#1745" class="Function Operator">∪</a> <a id="2180" href="Control.Comonad.IntervalHeap.html#2048" class="Function">merge⁺</a> <a id="2187" href="Control.Comonad.IntervalHeap.html#2157" class="Bound">x₃</a> <a id="2190" href="Control.Comonad.IntervalHeap.html#2162" class="Bound">xs</a>

  <a id="AsHeap.merge"></a><a id="2196" href="Control.Comonad.IntervalHeap.html#2196" class="Function">merge</a> <a id="2202" class="Symbol">:</a> <a id="2204" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2209" class="Symbol">(</a><a id="2210" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="2215" href="Level.html#282" class="Generalizable">A</a><a id="2216" class="Symbol">)</a> <a id="2218" class="Symbol">→</a> <a id="2220" href="Agda.Builtin.Maybe.html#135" class="Datatype">Maybe</a> <a id="2226" class="Symbol">(</a><a id="2227" href="Control.Comonad.IntervalHeap.html#1692" class="Function">Heap</a> <a id="2232" href="Level.html#282" class="Generalizable">A</a><a id="2233" class="Symbol">)</a>
  <a id="2237" href="Control.Comonad.IntervalHeap.html#2196" class="Function">merge</a> <a id="2243" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a> <a id="2246" class="Symbol">=</a> <a id="2248" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>
  <a id="2258" href="Control.Comonad.IntervalHeap.html#2196" class="Function">merge</a> <a id="2264" class="Symbol">(</a><a id="2265" href="Control.Comonad.IntervalHeap.html#2265" class="Bound">x</a> <a id="2267" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="2269" href="Control.Comonad.IntervalHeap.html#2269" class="Bound">xs</a><a id="2271" class="Symbol">)</a> <a id="2273" class="Symbol">=</a> <a id="2275" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="2280" class="Symbol">(</a><a id="2281" href="Control.Comonad.IntervalHeap.html#2048" class="Function">merge⁺</a> <a id="2288" href="Control.Comonad.IntervalHeap.html#2265" class="Bound">x</a> <a id="2290" href="Control.Comonad.IntervalHeap.html#2269" class="Bound">xs</a><a id="2292" class="Symbol">)</a>

  
  <a id="2300" class="Keyword">open</a> <a id="2305" class="Keyword">import</a> <a id="2312" href="Data.Maybe.Properties.html" class="Module">Data.Maybe.Properties</a> <a id="2334" class="Keyword">using</a> <a id="2340" class="Symbol">(</a><a id="2341" href="Data.Maybe.Properties.html#865" class="Function">maybeFunctor</a><a id="2353" class="Symbol">)</a>
  <a id="2357" class="Keyword">open</a> <a id="2362" class="Keyword">import</a> <a id="2369" href="Data.Maybe.html" class="Module">Data.Maybe</a> <a id="2380" class="Keyword">using</a> <a id="2386" class="Symbol">(</a><a id="2387" href="Data.Maybe.Base.html#262" class="Function">mapMaybe</a><a id="2395" class="Symbol">)</a>

  <a id="2400" class="Keyword">module</a> <a id="AsHeap.L"></a><a id="2407" href="Control.Comonad.IntervalHeap.html#2407" class="Module">L</a> <a id="2409" class="Symbol">=</a> <a id="2411" href="Control.Comonad.IntervalHeap.html#571" class="Module">OnFunctor</a> <a id="2421" href="Data.Maybe.Properties.html#865" class="Function">maybeFunctor</a>

  <a id="AsHeap.search"></a><a id="2437" href="Control.Comonad.IntervalHeap.html#2437" class="Function">search</a> <a id="2444" class="Symbol">:</a> <a id="2446" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="2454" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="2456" href="Level.html#282" class="Generalizable">A</a> <a id="2458" class="Symbol">→</a> <a id="2460" href="Control.Comonad.IntervalHeap.html#687" class="Record">L.Cofree⁺</a> <a id="2470" href="Control.Comonad.IntervalHeap.html#557" class="Generalizable">w</a> <a id="2472" href="Level.html#282" class="Generalizable">A</a>
  <a id="2476" href="Control.Comonad.IntervalHeap.html#2437" class="Function">search</a> <a id="2483" class="Symbol">=</a> <a id="2485" href="Control.Comonad.IntervalHeap.html#1336" class="Function">L.ana</a> <a id="2491" class="Symbol">(</a><a id="2492" href="Function.html#369" class="Function">flip</a> <a id="2497" href="Control.Comonad.IntervalHeap.html#687" class="Record">Cofree⁺</a> <a id="2505" class="Symbol">_)</a> <a id="2508" class="Symbol">(</a><a id="2509" href="Control.Comonad.IntervalHeap.html#443" class="Function">cmap</a> <a id="2514" class="Symbol">(</a><a id="2515" href="Data.Sigma.Base.html#1314" class="Function">map₂</a> <a id="2520" href="Control.Comonad.IntervalHeap.html#2196" class="Function">merge</a><a id="2525" class="Symbol">)</a> <a id="2527" href="Function.html#97" class="Function Operator">∘</a> <a id="2529" href="Control.Comonad.IntervalHeap.html#761" class="Field">step</a><a id="2533" class="Symbol">)</a>

  <a id="2538" class="Keyword">data</a> <a id="AsHeap.Tree"></a><a id="2543" href="Control.Comonad.IntervalHeap.html#2543" class="Datatype">Tree</a> <a id="2548" class="Symbol">{</a><a id="2549" href="Control.Comonad.IntervalHeap.html#2549" class="Bound">a</a><a id="2550" class="Symbol">}</a> <a id="2552" class="Symbol">(</a><a id="2553" href="Control.Comonad.IntervalHeap.html#2553" class="Bound">A</a> <a id="2555" class="Symbol">:</a> <a id="2557" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2562" href="Control.Comonad.IntervalHeap.html#2549" class="Bound">a</a><a id="2563" class="Symbol">)</a> <a id="2565" class="Symbol">:</a> <a id="2567" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2572" href="Control.Comonad.IntervalHeap.html#2549" class="Bound">a</a> <a id="2574" class="Keyword">where</a>
    <a id="AsHeap.Tree.[_]"></a><a id="2584" href="Control.Comonad.IntervalHeap.html#2584" class="InductiveConstructor Operator">[_]</a> <a id="2588" class="Symbol">:</a> <a id="2590" href="Control.Comonad.IntervalHeap.html#2553" class="Bound">A</a> <a id="2592" class="Symbol">→</a> <a id="2594" href="Control.Comonad.IntervalHeap.html#2543" class="Datatype">Tree</a> <a id="2599" href="Control.Comonad.IntervalHeap.html#2553" class="Bound">A</a>
    <a id="AsHeap.Tree._*_"></a><a id="2605" href="Control.Comonad.IntervalHeap.html#2605" class="InductiveConstructor Operator">_*_</a> <a id="2609" class="Symbol">:</a> <a id="2611" href="Control.Comonad.IntervalHeap.html#2543" class="Datatype">Tree</a> <a id="2616" href="Control.Comonad.IntervalHeap.html#2553" class="Bound">A</a> <a id="2618" class="Symbol">→</a> <a id="2620" href="Control.Comonad.IntervalHeap.html#2543" class="Datatype">Tree</a> <a id="2625" href="Control.Comonad.IntervalHeap.html#2553" class="Bound">A</a> <a id="2627" class="Symbol">→</a> <a id="2629" href="Control.Comonad.IntervalHeap.html#2543" class="Datatype">Tree</a> <a id="2634" href="Control.Comonad.IntervalHeap.html#2553" class="Bound">A</a>

  <a id="AsHeap.List⁺"></a><a id="2639" href="Control.Comonad.IntervalHeap.html#2639" class="Function">List⁺</a> <a id="2645" class="Symbol">:</a> <a id="2647" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="2652" class="Symbol">→</a> <a id="2654" href="Agda.Primitive.html#388" class="Primitive">Type</a>
  <a id="2661" href="Control.Comonad.IntervalHeap.html#2639" class="Function">List⁺</a> <a id="2667" href="Control.Comonad.IntervalHeap.html#2667" class="Bound">A</a> <a id="2669" class="Symbol">=</a> <a id="2671" href="Control.Comonad.IntervalHeap.html#2667" class="Bound">A</a> <a id="2673" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="2675" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="2680" href="Control.Comonad.IntervalHeap.html#2667" class="Bound">A</a>

  <a id="2685" class="Comment">-- huffman′ : Heap A → Tree A</a>
  <a id="2717" class="Comment">-- huffman′ = {!!}</a>
  
<a id="2739" class="Comment">-- data Heap (A : Type s) : Type s where</a>
<a id="2780" class="Comment">--   _◃_ : (w : 𝑆) → (xs : 𝐹 w (A × List (Heap A))) → Heap A</a>

<a id="2842" class="Comment">-- extend : (Heap A → B) → Heap A → Heap B</a>
<a id="2885" class="Comment">-- extend f (w ◃ xs) = w ◃ (xs =&gt;&gt;[ ∙ε w ] (λ ys → f (ε ◃ ys) , Lmap (extend f) (snd (extract ys))))</a>

<a id="2987" class="Comment">-- module _ (2-monoid : ∀ {A B w} → 𝐹 w A → 𝐹 w B → 𝐹 w (A × B)) where</a>
<a id="3058" class="Comment">--   _∪_ : Heap A → Heap A → Heap A</a>
<a id="3094" class="Comment">--   (xw ◃ xs) ∪ (yw ◃ ys) with xw ≤|≥ yw</a>
<a id="3136" class="Comment">--   ... | inl (k , p) = xw ◃ map (λ { (y , (x , xs)) → x , (k ◃ y) ∷ xs }) (2-monoid (ys =&gt;&gt;[ sym p ] id) xs)</a>
<a id="3247" class="Comment">--   ... | inr (k , p) = yw ◃ map (λ { (x , (y , ys)) → y , (k ◃ x) ∷ ys }) (2-monoid (xs =&gt;&gt;[ sym p ] id) ys)</a>

<a id="3359" class="Comment">-- -- mutual</a>
<a id="3372" class="Comment">-- --   record Heap (A : Type a) : Type (s ℓ⊔ a) where</a>
<a id="3427" class="Comment">-- --     inductive; constructor _◃_</a>
<a id="3464" class="Comment">-- --     field</a>
<a id="3480" class="Comment">-- --       hd : A</a>
<a id="3499" class="Comment">-- --       tl : Next A</a>

<a id="3524" class="Comment">-- --   record Next {a} (A : Type a) : Type (s ℓ⊔ a) where</a>
<a id="3583" class="Comment">-- --     coinductive; constructor ⟪_⟫</a>
<a id="3622" class="Comment">-- --     field next : Span A</a>

<a id="3653" class="Comment">-- --   data Span {a} (A : Type a) : Type (s ℓ⊔ a) where</a>
<a id="3710" class="Comment">-- --     [] : Span A</a>
<a id="3732" class="Comment">-- --     until : (s : 𝑆) → (s≢ε : s ≢ ε) → (xs : Heap A) → Span A</a>
<a id="3799" class="Comment">-- -- open Heap public</a>
<a id="3822" class="Comment">-- -- open Next public</a>

<a id="3846" class="Comment">-- -- State : Type a → Type _</a>
<a id="3876" class="Comment">-- -- State A = 𝑆 → A × 𝑆</a>

<a id="3903" class="Comment">-- -- pop′ : (s : 𝑆) → Acc _&lt;_ s → Heap A → A × 𝑆</a>
<a id="3953" class="Comment">-- -- pop′ s₂ a xs with xs .tl .next</a>
<a id="3990" class="Comment">-- -- pop′ s₂ a xs | [] = xs .hd , ε</a>
<a id="4027" class="Comment">-- -- pop′ s₂ a xs | until s₁ s₁≢ε ys with s₁ ≤? s₂</a>
<a id="4079" class="Comment">-- -- pop′ s₂ a xs | until s₁ s₁≢ε ys | no s₁≰s₂ = xs .hd , fst (&lt;⇒≤ s₁≰s₂)</a>
<a id="4155" class="Comment">-- -- pop′ s₂ (acc wf) xs | until s₁ s₁≢ε ys | yes (k₁ , s₂≡s₁∙k₁) = pop′ k₁ (wf k₁ lemma) ys</a>
<a id="4249" class="Comment">-- --   where</a>
<a id="4263" class="Comment">-- --   lemma : k₁ &lt; s₂</a>
<a id="4287" class="Comment">-- --   lemma (k₂ , k₁≡s₂∙k₂) = s₁≢ε (zeroSumFree s₁ k₂ (sym (cancel k₁ _ _ p)))</a>
<a id="4368" class="Comment">-- --     where</a>
<a id="4384" class="Comment">-- --     p : k₁ ∙ ε ≡ k₁ ∙ (s₁ ∙ k₂)</a>
<a id="4422" class="Comment">-- --     p = ∙ε k₁ ; k₁≡s₂∙k₂ ; cong (_∙ k₂) s₂≡s₁∙k₁ ; cong (_∙ k₂) (comm s₁ k₁) ; assoc k₁ s₁ k₂</a>

<a id="4523" class="Comment">-- -- pop : Heap A → State A</a>
<a id="4552" class="Comment">-- -- pop xs s = pop′ s (wf s) xs</a>

<a id="4587" class="Comment">-- -- mutual</a>
<a id="4600" class="Comment">-- --   stepFrom : State A → (s : 𝑆) → Dec (s ≡ ε) → Span A</a>
<a id="4660" class="Comment">-- --   stepFrom f s (yes p) = []</a>
<a id="4694" class="Comment">-- --   stepFrom f s (no ¬p) = until s ¬p (tabulate (f ∘ (s ∙_)))</a>

<a id="4761" class="Comment">-- --   tabulate : State A → Heap A</a>
<a id="4797" class="Comment">-- --   tabulate f =</a>
<a id="4818" class="Comment">-- --     let x , s = f ε</a>
<a id="4844" class="Comment">-- --     in x ◃ λ where .next → stepFrom f s (s ≟ ε)</a>

<a id="4899" class="Comment">-- -- pop-ε : (xs : Heap A) (a : Acc _&lt;_ ε) → pop′ ε a xs .fst ≡ xs .hd</a>
<a id="4971" class="Comment">-- -- pop-ε xs _ with xs .tl .next</a>
<a id="5006" class="Comment">-- -- pop-ε xs _ | [] = refl</a>
<a id="5035" class="Comment">-- -- pop-ε xs _ | until s s≢ε ys with s ≤? ε</a>
<a id="5081" class="Comment">-- -- pop-ε xs _ | until s s≢ε ys | no  s≰ε = refl</a>
<a id="5132" class="Comment">-- -- pop-ε xs _ | until s s≢ε ys | yes s≤ε = ⊥-elim (s≢ε (antisym s≤ε (positive s)))</a>

<a id="5219" class="Comment">-- -- -- slide : Heap A → Heap A</a>
<a id="5252" class="Comment">-- -- -- slide xs with xs .tl .next</a>
<a id="5288" class="Comment">-- -- -- slide xs | [] = xs</a>
<a id="5316" class="Comment">-- -- -- slide xs | [] = []</a>

<a id="5345" class="Comment">-- -- -- pop-tl : ∀ (x : A) s₁ (s₁≢ε : s₁ ≢ ε) xs s₂ → pop (x ◃ ⟪ until s₁ s₁≢ε xs ⟫) (s₁ ∙ s₂) ≡ pop xs s₂</a>
<a id="5453" class="Comment">-- -- -- pop-tl x s₁ s₁≢ε xs s₂ with s₁ ≤? (s₁ ∙ s₂)</a>
<a id="5506" class="Comment">-- -- -- pop-tl x s₁ s₁≢ε xs s₂ | no  s₁≰s₁∙s₂ = ⊥-elim (s₁≰s₁∙s₂ (s₂ , refl))</a>
<a id="5585" class="Comment">-- -- -- pop-tl x s₁ s₁≢ε xs s₂ | yes (k , s₁≤s₁∙s₂) =</a>
<a id="5640" class="Comment">-- -- --   let p = cancel s₁ s₂ k s₁≤s₁∙s₂</a>
<a id="5683" class="Comment">-- -- --   in {!!} ; cong (λ w → pop′ s₂ w xs) (isPropAcc {!!} (wf s₂))</a>

<a id="5756" class="Comment">-- -- -- seg-leftInv′ : (x : Heap A) → tabulate (pop x) ≡ x</a>
<a id="5816" class="Comment">-- -- -- seg-leftInv′ x = {!!}</a>

<a id="5848" class="Comment">-- -- -- mutual</a>
<a id="5864" class="Comment">-- -- --   seg-leftInv′ : (xs : Heap A) → stepFrom (pop xs) (pop xs ε .snd) (pop xs ε .snd ≟ ε) ≡ xs .tl .next</a>
<a id="5975" class="Comment">-- -- --   seg-leftInv′ (x ◃ xs) with pop (x ◃ xs) ε .snd ≟ ε</a>
<a id="6037" class="Comment">-- -- --   seg-leftInv′ (x ◃ xs) | yes s≡ε = {!!}</a>
<a id="6087" class="Comment">-- -- --   seg-leftInv′ (x ◃ xs) | no  s≢ε = {!!}</a>

<a id="6138" class="Comment">-- -- --   seg-leftInv : (x : Heap A) → tabulate (pop x) ≡ x</a>
<a id="6199" class="Comment">-- -- --   seg-leftInv (x ◃ xs) i .hd = pop-ε (x ◃ xs) (wf ε) i</a>
<a id="6263" class="Comment">-- -- --   seg-leftInv (x ◃ xs) i .tl .next = seg-leftInv′ (x ◃ xs) i</a>

<a id="6334" class="Comment">-- -- -- state-iso : Heap A ⇔ State A</a>
<a id="6372" class="Comment">-- -- -- state-iso .fun = pop</a>
<a id="6402" class="Comment">-- -- -- state-iso .inv = tabulate</a>
<a id="6437" class="Comment">-- -- -- state-iso .rightInv = {!!}</a>
<a id="6473" class="Comment">-- -- -- state-iso .leftInv  = {!!}</a>
</pre></body></html>