<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Comonad.IntervalHeap</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Pragma">--guardedness</a> <a id="66" class="Symbol">#-}</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Algebra.html" class="Module">Algebra</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Prelude.html" class="Module">Prelude</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="WellFounded.html" class="Module">WellFounded</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Algebra.Monus.html" class="Module">Algebra.Monus</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Data.Maybe.html" class="Module">Data.Maybe</a>

<a id="213" class="Keyword">module</a> <a id="220" href="Control.Comonad.IntervalHeap.html" class="Module">Control.Comonad.IntervalHeap</a> <a id="249" class="Symbol">{</a><a id="250" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a><a id="251" class="Symbol">}</a>
  <a id="255" class="Symbol">(</a><a id="256" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a> <a id="260" class="Symbol">:</a> <a id="262" href="Algebra.Monus.html#4810" class="Record">TMAPOM</a> <a id="269" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a><a id="270" class="Symbol">)</a>
  <a id="274" class="Symbol">(</a><a id="275" href="Control.Comonad.IntervalHeap.html#275" class="Bound">wf</a> <a id="278" class="Symbol">:</a> <a id="280" href="WellFounded.html#383" class="Function">WellFounded</a> <a id="292" class="Symbol">(</a><a id="293" href="Relation.Binary.html#1847" class="Function Operator">TMAPOM._&lt;_</a> <a id="304" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a><a id="307" class="Symbol">))</a>
  <a id="312" class="Symbol">(</a><a id="313" href="Control.Comonad.IntervalHeap.html#313" class="Bound">cancel</a> <a id="320" class="Symbol">:</a> <a id="322" href="Algebra.html#1011" class="Function">Cancellativeˡ</a> <a id="336" class="Symbol">(</a><a id="337" href="Algebra.html#1421" class="Function Operator">TMAPOM._∙_</a> <a id="348" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a><a id="351" class="Symbol">))</a>
  <a id="356" class="Keyword">where</a>

<a id="363" class="Keyword">open</a> <a id="368" href="Algebra.Monus.html#4810" class="Module">TMAPOM</a> <a id="375" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a>

<a id="380" class="Keyword">mutual</a>
  <a id="389" class="Keyword">record</a> <a id="Heap"></a><a id="396" href="Control.Comonad.IntervalHeap.html#396" class="Record">Heap</a> <a id="401" class="Symbol">(</a><a id="402" href="Control.Comonad.IntervalHeap.html#402" class="Bound">A</a> <a id="404" class="Symbol">:</a> <a id="406" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="411" href="Level.html#239" class="Generalizable">a</a><a id="412" class="Symbol">)</a> <a id="414" class="Symbol">:</a> <a id="416" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="421" class="Symbol">(</a><a id="422" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a> <a id="424" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="427" href="Control.Comonad.IntervalHeap.html#411" class="Bound">a</a><a id="428" class="Symbol">)</a> <a id="430" class="Keyword">where</a>
    <a id="440" class="Keyword">inductive</a><a id="449" class="Symbol">;</a> <a id="451" class="Keyword">constructor</a> <a id="_◃_"></a><a id="463" href="Control.Comonad.IntervalHeap.html#463" class="InductiveConstructor Operator">_◃_</a>
    <a id="471" class="Keyword">field</a>
      <a id="Heap.hd"></a><a id="483" href="Control.Comonad.IntervalHeap.html#483" class="Field">hd</a> <a id="486" class="Symbol">:</a> <a id="488" href="Control.Comonad.IntervalHeap.html#402" class="Bound">A</a>
      <a id="Heap.tl"></a><a id="496" href="Control.Comonad.IntervalHeap.html#496" class="Field">tl</a> <a id="499" class="Symbol">:</a> <a id="501" href="Control.Comonad.IntervalHeap.html#518" class="Record">Next</a> <a id="506" href="Control.Comonad.IntervalHeap.html#402" class="Bound">A</a>

  <a id="511" class="Keyword">record</a> <a id="Next"></a><a id="518" href="Control.Comonad.IntervalHeap.html#518" class="Record">Next</a> <a id="523" class="Symbol">{</a><a id="524" href="Control.Comonad.IntervalHeap.html#524" class="Bound">a</a><a id="525" class="Symbol">}</a> <a id="527" class="Symbol">(</a><a id="528" href="Control.Comonad.IntervalHeap.html#528" class="Bound">A</a> <a id="530" class="Symbol">:</a> <a id="532" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="537" href="Control.Comonad.IntervalHeap.html#524" class="Bound">a</a><a id="538" class="Symbol">)</a> <a id="540" class="Symbol">:</a> <a id="542" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="547" class="Symbol">(</a><a id="548" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a> <a id="550" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="553" href="Control.Comonad.IntervalHeap.html#524" class="Bound">a</a><a id="554" class="Symbol">)</a> <a id="556" class="Keyword">where</a>
    <a id="566" class="Keyword">coinductive</a><a id="577" class="Symbol">;</a> <a id="579" class="Keyword">constructor</a> <a id="⟪_⟫"></a><a id="591" href="Control.Comonad.IntervalHeap.html#591" class="CoinductiveConstructor Operator">⟪_⟫</a>
    <a id="599" class="Keyword">field</a> <a id="Next.next"></a><a id="605" href="Control.Comonad.IntervalHeap.html#605" class="Field">next</a> <a id="610" class="Symbol">:</a> <a id="612" href="Control.Comonad.IntervalHeap.html#627" class="Datatype">Span</a> <a id="617" href="Control.Comonad.IntervalHeap.html#528" class="Bound">A</a>

  <a id="622" class="Keyword">data</a> <a id="Span"></a><a id="627" href="Control.Comonad.IntervalHeap.html#627" class="Datatype">Span</a> <a id="632" class="Symbol">{</a><a id="633" href="Control.Comonad.IntervalHeap.html#633" class="Bound">a</a><a id="634" class="Symbol">}</a> <a id="636" class="Symbol">(</a><a id="637" href="Control.Comonad.IntervalHeap.html#637" class="Bound">A</a> <a id="639" class="Symbol">:</a> <a id="641" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="646" href="Control.Comonad.IntervalHeap.html#633" class="Bound">a</a><a id="647" class="Symbol">)</a> <a id="649" class="Symbol">:</a> <a id="651" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="656" class="Symbol">(</a><a id="657" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a> <a id="659" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="662" href="Control.Comonad.IntervalHeap.html#633" class="Bound">a</a><a id="663" class="Symbol">)</a> <a id="665" class="Keyword">where</a>
    <a id="Span.[]"></a><a id="675" href="Control.Comonad.IntervalHeap.html#675" class="InductiveConstructor">[]</a> <a id="678" class="Symbol">:</a> <a id="680" href="Control.Comonad.IntervalHeap.html#627" class="Datatype">Span</a> <a id="685" href="Control.Comonad.IntervalHeap.html#637" class="Bound">A</a>
    <a id="Span.until"></a><a id="691" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="697" class="Symbol">:</a> <a id="699" class="Symbol">(</a><a id="700" href="Control.Comonad.IntervalHeap.html#700" class="Bound">s</a> <a id="702" class="Symbol">:</a> <a id="704" href="Algebra.html#1401" class="Function">𝑆</a><a id="705" class="Symbol">)</a> <a id="707" class="Symbol">→</a> <a id="709" class="Symbol">(</a><a id="710" href="Control.Comonad.IntervalHeap.html#710" class="Bound">s≢ε</a> <a id="714" class="Symbol">:</a> <a id="716" href="Control.Comonad.IntervalHeap.html#700" class="Bound">s</a> <a id="718" href="Path.html#524" class="Function Operator">≢</a> <a id="720" href="Algebra.html#1444" class="Function">ε</a><a id="721" class="Symbol">)</a> <a id="723" class="Symbol">→</a> <a id="725" class="Symbol">(</a><a id="726" href="Control.Comonad.IntervalHeap.html#726" class="Bound">xs</a> <a id="729" class="Symbol">:</a> <a id="731" href="Control.Comonad.IntervalHeap.html#396" class="Record">Heap</a> <a id="736" href="Control.Comonad.IntervalHeap.html#637" class="Bound">A</a><a id="737" class="Symbol">)</a> <a id="739" class="Symbol">→</a> <a id="741" href="Control.Comonad.IntervalHeap.html#627" class="Datatype">Span</a> <a id="746" href="Control.Comonad.IntervalHeap.html#637" class="Bound">A</a>
<a id="748" class="Keyword">open</a> <a id="753" href="Control.Comonad.IntervalHeap.html#396" class="Module">Heap</a> <a id="758" class="Keyword">public</a>
<a id="765" class="Keyword">open</a> <a id="770" href="Control.Comonad.IntervalHeap.html#518" class="Module">Next</a> <a id="775" class="Keyword">public</a>

<a id="State"></a><a id="783" href="Control.Comonad.IntervalHeap.html#783" class="Function">State</a> <a id="789" class="Symbol">:</a> <a id="791" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="796" href="Level.html#239" class="Generalizable">a</a> <a id="798" class="Symbol">→</a> <a id="800" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="805" class="Symbol">_</a>
<a id="807" href="Control.Comonad.IntervalHeap.html#783" class="Function">State</a> <a id="813" href="Control.Comonad.IntervalHeap.html#813" class="Bound">A</a> <a id="815" class="Symbol">=</a> <a id="817" href="Algebra.html#1401" class="Function">𝑆</a> <a id="819" class="Symbol">→</a> <a id="821" href="Control.Comonad.IntervalHeap.html#813" class="Bound">A</a> <a id="823" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="825" href="Algebra.html#1401" class="Function">𝑆</a>

<a id="pop′"></a><a id="828" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="833" class="Symbol">:</a> <a id="835" class="Symbol">(</a><a id="836" href="Control.Comonad.IntervalHeap.html#836" class="Bound">s</a> <a id="838" class="Symbol">:</a> <a id="840" href="Algebra.html#1401" class="Function">𝑆</a><a id="841" class="Symbol">)</a> <a id="843" class="Symbol">→</a> <a id="845" href="WellFounded.html#85" class="Datatype">Acc</a> <a id="849" href="Relation.Binary.html#1847" class="Function Operator">_&lt;_</a> <a id="853" href="Control.Comonad.IntervalHeap.html#836" class="Bound">s</a> <a id="855" class="Symbol">→</a> <a id="857" href="Control.Comonad.IntervalHeap.html#396" class="Record">Heap</a> <a id="862" href="Level.html#255" class="Generalizable">A</a> <a id="864" class="Symbol">→</a> <a id="866" href="Level.html#255" class="Generalizable">A</a> <a id="868" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="870" href="Algebra.html#1401" class="Function">𝑆</a>
<a id="872" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="877" href="Control.Comonad.IntervalHeap.html#877" class="Bound">s₂</a> <a id="880" href="Control.Comonad.IntervalHeap.html#880" class="Bound">a</a> <a id="882" href="Control.Comonad.IntervalHeap.html#882" class="Bound">xs</a> <a id="885" class="Keyword">with</a> <a id="890" href="Control.Comonad.IntervalHeap.html#882" class="Bound">xs</a> <a id="893" class="Symbol">.</a><a id="894" href="Control.Comonad.IntervalHeap.html#496" class="Field">tl</a> <a id="897" class="Symbol">.</a><a id="898" href="Control.Comonad.IntervalHeap.html#605" class="Field">next</a>
<a id="903" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="908" href="Control.Comonad.IntervalHeap.html#908" class="Bound">s₂</a> <a id="911" href="Control.Comonad.IntervalHeap.html#911" class="Bound">a</a> <a id="913" href="Control.Comonad.IntervalHeap.html#913" class="Bound">xs</a> <a id="916" class="Symbol">|</a> <a id="918" href="Control.Comonad.IntervalHeap.html#675" class="InductiveConstructor">[]</a> <a id="921" class="Symbol">=</a> <a id="923" href="Control.Comonad.IntervalHeap.html#913" class="Bound">xs</a> <a id="926" class="Symbol">.</a><a id="927" href="Control.Comonad.IntervalHeap.html#483" class="Field">hd</a> <a id="930" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="932" href="Algebra.html#1444" class="Function">ε</a>
<a id="934" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="939" href="Control.Comonad.IntervalHeap.html#939" class="Bound">s₂</a> <a id="942" href="Control.Comonad.IntervalHeap.html#942" class="Bound">a</a> <a id="944" href="Control.Comonad.IntervalHeap.html#944" class="Bound">xs</a> <a id="947" class="Symbol">|</a> <a id="949" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="955" href="Control.Comonad.IntervalHeap.html#955" class="Bound">s₁</a> <a id="958" href="Control.Comonad.IntervalHeap.html#958" class="Bound">s₁≢ε</a> <a id="963" href="Control.Comonad.IntervalHeap.html#963" class="Bound">ys</a> <a id="966" class="Keyword">with</a> <a id="971" href="Control.Comonad.IntervalHeap.html#955" class="Bound">s₁</a> <a id="974" href="Relation.Binary.html#3432" class="Function Operator">≤?</a> <a id="977" href="Control.Comonad.IntervalHeap.html#939" class="Bound">s₂</a>
<a id="980" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="985" href="Control.Comonad.IntervalHeap.html#985" class="Bound">s₂</a> <a id="988" href="Control.Comonad.IntervalHeap.html#988" class="Bound">a</a> <a id="990" href="Control.Comonad.IntervalHeap.html#990" class="Bound">xs</a> <a id="993" class="Symbol">|</a> <a id="995" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="1001" href="Control.Comonad.IntervalHeap.html#1001" class="Bound">s₁</a> <a id="1004" href="Control.Comonad.IntervalHeap.html#1004" class="Bound">s₁≢ε</a> <a id="1009" href="Control.Comonad.IntervalHeap.html#1009" class="Bound">ys</a> <a id="1012" class="Symbol">|</a> <a id="1014" href="Relation.Nullary.Decidable.html#433" class="InductiveConstructor">no</a> <a id="1017" href="Control.Comonad.IntervalHeap.html#1017" class="Bound">s₁≰s₂</a> <a id="1023" class="Symbol">=</a> <a id="1025" href="Control.Comonad.IntervalHeap.html#990" class="Bound">xs</a> <a id="1028" class="Symbol">.</a><a id="1029" href="Control.Comonad.IntervalHeap.html#483" class="Field">hd</a> <a id="1032" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1034" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a> <a id="1038" class="Symbol">(</a><a id="1039" href="Relation.Binary.html#3080" class="Function">&lt;⇒≤</a> <a id="1043" href="Control.Comonad.IntervalHeap.html#1017" class="Bound">s₁≰s₂</a><a id="1048" class="Symbol">)</a>
<a id="1050" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="1055" href="Control.Comonad.IntervalHeap.html#1055" class="Bound">s₂</a> <a id="1058" class="Symbol">(</a><a id="1059" href="WellFounded.html#161" class="InductiveConstructor">acc</a> <a id="1063" href="Control.Comonad.IntervalHeap.html#1063" class="Bound">wf</a><a id="1065" class="Symbol">)</a> <a id="1067" href="Control.Comonad.IntervalHeap.html#1067" class="Bound">xs</a> <a id="1070" class="Symbol">|</a> <a id="1072" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="1078" href="Control.Comonad.IntervalHeap.html#1078" class="Bound">s₁</a> <a id="1081" href="Control.Comonad.IntervalHeap.html#1081" class="Bound">s₁≢ε</a> <a id="1086" href="Control.Comonad.IntervalHeap.html#1086" class="Bound">ys</a> <a id="1089" class="Symbol">|</a> <a id="1091" href="Relation.Nullary.Decidable.html#399" class="InductiveConstructor">yes</a> <a id="1095" class="Symbol">(</a><a id="1096" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1099" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1101" href="Control.Comonad.IntervalHeap.html#1101" class="Bound">s₂≡s₁∙k₁</a><a id="1109" class="Symbol">)</a> <a id="1111" class="Symbol">=</a> <a id="1113" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="1118" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1121" class="Symbol">(</a><a id="1122" href="Control.Comonad.IntervalHeap.html#1063" class="Bound">wf</a> <a id="1125" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1128" href="Control.Comonad.IntervalHeap.html#1148" class="Function">lemma</a><a id="1133" class="Symbol">)</a> <a id="1135" href="Control.Comonad.IntervalHeap.html#1086" class="Bound">ys</a>
  <a id="1140" class="Keyword">where</a>
  <a id="1148" href="Control.Comonad.IntervalHeap.html#1148" class="Function">lemma</a> <a id="1154" class="Symbol">:</a> <a id="1156" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1159" href="Relation.Binary.html#1847" class="Function Operator">&lt;</a> <a id="1161" href="Control.Comonad.IntervalHeap.html#1055" class="Bound">s₂</a>
  <a id="1166" href="Control.Comonad.IntervalHeap.html#1148" class="Function">lemma</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Control.Comonad.IntervalHeap.html#1173" class="Bound">k₂</a> <a id="1176" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1178" href="Control.Comonad.IntervalHeap.html#1178" class="Bound">k₁≡s₂∙k₂</a><a id="1186" class="Symbol">)</a> <a id="1188" class="Symbol">=</a> <a id="1190" href="Control.Comonad.IntervalHeap.html#1081" class="Bound">s₁≢ε</a> <a id="1195" class="Symbol">(</a><a id="1196" href="Algebra.Monus.html#5177" class="Function">zeroSumFree</a> <a id="1208" href="Control.Comonad.IntervalHeap.html#1078" class="Bound">s₁</a> <a id="1211" href="Control.Comonad.IntervalHeap.html#1173" class="Bound">k₂</a> <a id="1214" class="Symbol">(</a><a id="1215" href="Cubical.Foundations.Id.html#703" class="Function">sym</a> <a id="1219" class="Symbol">(</a><a id="1220" href="Control.Comonad.IntervalHeap.html#313" class="Bound">cancel</a> <a id="1227" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1230" class="Symbol">_</a> <a id="1232" class="Symbol">_</a> <a id="1234" href="Control.Comonad.IntervalHeap.html#1253" class="Function">p</a><a id="1235" class="Symbol">)))</a>
    <a id="1243" class="Keyword">where</a>
    <a id="1253" href="Control.Comonad.IntervalHeap.html#1253" class="Function">p</a> <a id="1255" class="Symbol">:</a> <a id="1257" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1260" href="Algebra.html#1421" class="Function Operator">∙</a> <a id="1262" href="Algebra.html#1444" class="Function">ε</a> <a id="1264" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1266" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1269" href="Algebra.html#1421" class="Function Operator">∙</a> <a id="1271" class="Symbol">(</a><a id="1272" href="Control.Comonad.IntervalHeap.html#1078" class="Bound">s₁</a> <a id="1275" href="Algebra.html#1421" class="Function Operator">∙</a> <a id="1277" href="Control.Comonad.IntervalHeap.html#1173" class="Bound">k₂</a><a id="1279" class="Symbol">)</a>
    <a id="1285" href="Control.Comonad.IntervalHeap.html#1253" class="Function">p</a> <a id="1287" class="Symbol">=</a> <a id="1289" href="Algebra.html#1537" class="Function">∙ε</a> <a id="1292" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1295" href="Cubical.Foundations.Id.html#737" class="Function Operator">;</a> <a id="1297" href="Control.Comonad.IntervalHeap.html#1178" class="Bound">k₁≡s₂∙k₂</a> <a id="1306" href="Cubical.Foundations.Id.html#737" class="Function Operator">;</a> <a id="1308" href="Cubical.Foundations.Id.html#772" class="Function">cong</a> <a id="1313" class="Symbol">(</a><a id="1314" href="Algebra.html#1421" class="Function Operator">_∙</a> <a id="1317" href="Control.Comonad.IntervalHeap.html#1173" class="Bound">k₂</a><a id="1319" class="Symbol">)</a> <a id="1321" href="Control.Comonad.IntervalHeap.html#1101" class="Bound">s₂≡s₁∙k₁</a> <a id="1330" href="Cubical.Foundations.Id.html#737" class="Function Operator">;</a> <a id="1332" href="Cubical.Foundations.Id.html#772" class="Function">cong</a> <a id="1337" class="Symbol">(</a><a id="1338" href="Algebra.html#1421" class="Function Operator">_∙</a> <a id="1341" href="Control.Comonad.IntervalHeap.html#1173" class="Bound">k₂</a><a id="1343" class="Symbol">)</a> <a id="1345" class="Symbol">(</a><a id="1346" href="Algebra.html#2901" class="Function">comm</a> <a id="1351" href="Control.Comonad.IntervalHeap.html#1078" class="Bound">s₁</a> <a id="1354" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a><a id="1356" class="Symbol">)</a> <a id="1358" href="Cubical.Foundations.Id.html#737" class="Function Operator">;</a> <a id="1360" href="Algebra.html#1459" class="Function">assoc</a> <a id="1366" href="Control.Comonad.IntervalHeap.html#1096" class="Bound">k₁</a> <a id="1369" href="Control.Comonad.IntervalHeap.html#1078" class="Bound">s₁</a> <a id="1372" href="Control.Comonad.IntervalHeap.html#1173" class="Bound">k₂</a>

<a id="pop"></a><a id="1376" href="Control.Comonad.IntervalHeap.html#1376" class="Function">pop</a> <a id="1380" class="Symbol">:</a> <a id="1382" href="Control.Comonad.IntervalHeap.html#396" class="Record">Heap</a> <a id="1387" href="Level.html#255" class="Generalizable">A</a> <a id="1389" class="Symbol">→</a> <a id="1391" href="Control.Comonad.IntervalHeap.html#783" class="Function">State</a> <a id="1397" href="Level.html#255" class="Generalizable">A</a>
<a id="1399" href="Control.Comonad.IntervalHeap.html#1376" class="Function">pop</a> <a id="1403" href="Control.Comonad.IntervalHeap.html#1403" class="Bound">xs</a> <a id="1406" href="Control.Comonad.IntervalHeap.html#1406" class="Bound">s</a> <a id="1408" class="Symbol">=</a> <a id="1410" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="1415" href="Control.Comonad.IntervalHeap.html#1406" class="Bound">s</a> <a id="1417" class="Symbol">(</a><a id="1418" href="Control.Comonad.IntervalHeap.html#275" class="Bound">wf</a> <a id="1421" href="Control.Comonad.IntervalHeap.html#1406" class="Bound">s</a><a id="1422" class="Symbol">)</a> <a id="1424" href="Control.Comonad.IntervalHeap.html#1403" class="Bound">xs</a>

<a id="1428" class="Keyword">mutual</a>
  <a id="stepFrom"></a><a id="1437" href="Control.Comonad.IntervalHeap.html#1437" class="Function">stepFrom</a> <a id="1446" class="Symbol">:</a> <a id="1448" href="Control.Comonad.IntervalHeap.html#783" class="Function">State</a> <a id="1454" href="Level.html#255" class="Generalizable">A</a> <a id="1456" class="Symbol">→</a> <a id="1458" class="Symbol">(</a><a id="1459" href="Control.Comonad.IntervalHeap.html#1459" class="Bound">s</a> <a id="1461" class="Symbol">:</a> <a id="1463" href="Algebra.html#1401" class="Function">𝑆</a><a id="1464" class="Symbol">)</a> <a id="1466" class="Symbol">→</a> <a id="1468" href="Relation.Nullary.Decidable.html#261" class="Record">Dec</a> <a id="1472" class="Symbol">(</a><a id="1473" href="Control.Comonad.IntervalHeap.html#1459" class="Bound">s</a> <a id="1475" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1477" href="Algebra.html#1444" class="Function">ε</a><a id="1478" class="Symbol">)</a> <a id="1480" class="Symbol">→</a> <a id="1482" href="Control.Comonad.IntervalHeap.html#627" class="Datatype">Span</a> <a id="1487" href="Level.html#255" class="Generalizable">A</a>
  <a id="1491" href="Control.Comonad.IntervalHeap.html#1437" class="Function">stepFrom</a> <a id="1500" href="Control.Comonad.IntervalHeap.html#1500" class="Bound">f</a> <a id="1502" href="Control.Comonad.IntervalHeap.html#1502" class="Bound">s</a> <a id="1504" class="Symbol">(</a><a id="1505" href="Relation.Nullary.Decidable.html#399" class="InductiveConstructor">yes</a> <a id="1509" href="Control.Comonad.IntervalHeap.html#1509" class="Bound">p</a><a id="1510" class="Symbol">)</a> <a id="1512" class="Symbol">=</a> <a id="1514" href="Control.Comonad.IntervalHeap.html#675" class="InductiveConstructor">[]</a>
  <a id="1519" href="Control.Comonad.IntervalHeap.html#1437" class="Function">stepFrom</a> <a id="1528" href="Control.Comonad.IntervalHeap.html#1528" class="Bound">f</a> <a id="1530" href="Control.Comonad.IntervalHeap.html#1530" class="Bound">s</a> <a id="1532" class="Symbol">(</a><a id="1533" href="Relation.Nullary.Decidable.html#433" class="InductiveConstructor">no</a> <a id="1536" href="Control.Comonad.IntervalHeap.html#1536" class="Bound">¬p</a><a id="1538" class="Symbol">)</a> <a id="1540" class="Symbol">=</a> <a id="1542" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="1548" href="Control.Comonad.IntervalHeap.html#1530" class="Bound">s</a> <a id="1550" href="Control.Comonad.IntervalHeap.html#1536" class="Bound">¬p</a> <a id="1553" class="Symbol">(</a><a id="1554" href="Control.Comonad.IntervalHeap.html#1580" class="Function">tabulate</a> <a id="1563" class="Symbol">(</a><a id="1564" href="Control.Comonad.IntervalHeap.html#1528" class="Bound">f</a> <a id="1566" href="Function.html#97" class="Function Operator">∘</a> <a id="1568" class="Symbol">(</a><a id="1569" href="Control.Comonad.IntervalHeap.html#1530" class="Bound">s</a> <a id="1571" href="Algebra.html#1421" class="Function Operator">∙_</a><a id="1573" class="Symbol">)))</a>

  <a id="tabulate"></a><a id="1580" href="Control.Comonad.IntervalHeap.html#1580" class="Function">tabulate</a> <a id="1589" class="Symbol">:</a> <a id="1591" href="Control.Comonad.IntervalHeap.html#783" class="Function">State</a> <a id="1597" href="Level.html#255" class="Generalizable">A</a> <a id="1599" class="Symbol">→</a> <a id="1601" href="Control.Comonad.IntervalHeap.html#396" class="Record">Heap</a> <a id="1606" href="Level.html#255" class="Generalizable">A</a>
  <a id="1610" href="Control.Comonad.IntervalHeap.html#1580" class="Function">tabulate</a> <a id="1619" href="Control.Comonad.IntervalHeap.html#1619" class="Bound">f</a> <a id="1621" class="Symbol">=</a>
    <a id="1627" class="Keyword">let</a> <a id="1631" href="Control.Comonad.IntervalHeap.html#1631" class="Bound">x</a> <a id="1633" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1635" href="Control.Comonad.IntervalHeap.html#1635" class="Bound">s</a> <a id="1637" class="Symbol">=</a> <a id="1639" href="Control.Comonad.IntervalHeap.html#1619" class="Bound">f</a> <a id="1641" href="Algebra.html#1444" class="Function">ε</a>
    <a id="1647" class="Keyword">in</a> <a id="1650" href="Control.Comonad.IntervalHeap.html#1631" class="Bound">x</a> <a id="1652" href="Control.Comonad.IntervalHeap.html#463" class="InductiveConstructor Operator">◃</a> <a id="1654" class="Symbol">λ</a> <a id="1656" class="Keyword">where</a> <a id="1662" class="Symbol">.</a><a id="1663" href="Control.Comonad.IntervalHeap.html#605" class="Field">next</a> <a id="1668" class="Symbol">→</a> <a id="1670" href="Control.Comonad.IntervalHeap.html#1437" class="Function">stepFrom</a> <a id="1679" href="Control.Comonad.IntervalHeap.html#1619" class="Bound">f</a> <a id="1681" href="Control.Comonad.IntervalHeap.html#1635" class="Bound">s</a> <a id="1683" class="Symbol">(</a><a id="1684" href="Control.Comonad.IntervalHeap.html#1635" class="Bound">s</a> <a id="1686" href="Relation.Binary.html#3696" class="Function Operator">≟</a> <a id="1688" href="Algebra.html#1444" class="Function">ε</a><a id="1689" class="Symbol">)</a>

<a id="pop-ε"></a><a id="1692" href="Control.Comonad.IntervalHeap.html#1692" class="Function">pop-ε</a> <a id="1698" class="Symbol">:</a> <a id="1700" class="Symbol">(</a><a id="1701" href="Control.Comonad.IntervalHeap.html#1701" class="Bound">xs</a> <a id="1704" class="Symbol">:</a> <a id="1706" href="Control.Comonad.IntervalHeap.html#396" class="Record">Heap</a> <a id="1711" href="Level.html#255" class="Generalizable">A</a><a id="1712" class="Symbol">)</a> <a id="1714" class="Symbol">(</a><a id="1715" href="Control.Comonad.IntervalHeap.html#1715" class="Bound">a</a> <a id="1717" class="Symbol">:</a> <a id="1719" href="WellFounded.html#85" class="Datatype">Acc</a> <a id="1723" href="Relation.Binary.html#1847" class="Function Operator">_&lt;_</a> <a id="1727" href="Algebra.html#1444" class="Function">ε</a><a id="1728" class="Symbol">)</a> <a id="1730" class="Symbol">→</a> <a id="1732" href="Control.Comonad.IntervalHeap.html#828" class="Function">pop′</a> <a id="1737" href="Algebra.html#1444" class="Function">ε</a> <a id="1739" href="Control.Comonad.IntervalHeap.html#1715" class="Bound">a</a> <a id="1741" href="Control.Comonad.IntervalHeap.html#1701" class="Bound">xs</a> <a id="1744" class="Symbol">.</a><a id="1745" href="Agda.Builtin.Sigma.html#252" class="Field">fst</a> <a id="1749" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1751" href="Control.Comonad.IntervalHeap.html#1701" class="Bound">xs</a> <a id="1754" class="Symbol">.</a><a id="1755" href="Control.Comonad.IntervalHeap.html#483" class="Field">hd</a>
<a id="1758" href="Control.Comonad.IntervalHeap.html#1692" class="Function">pop-ε</a> <a id="1764" href="Control.Comonad.IntervalHeap.html#1764" class="Bound">xs</a> <a id="1767" class="Symbol">_</a> <a id="1769" class="Keyword">with</a> <a id="1774" href="Control.Comonad.IntervalHeap.html#1764" class="Bound">xs</a> <a id="1777" class="Symbol">.</a><a id="1778" href="Control.Comonad.IntervalHeap.html#496" class="Field">tl</a> <a id="1781" class="Symbol">.</a><a id="1782" href="Control.Comonad.IntervalHeap.html#605" class="Field">next</a>
<a id="1787" href="Control.Comonad.IntervalHeap.html#1692" class="Function">pop-ε</a> <a id="1793" href="Control.Comonad.IntervalHeap.html#1793" class="Bound">xs</a> <a id="1796" class="Symbol">_</a> <a id="1798" class="Symbol">|</a> <a id="1800" href="Control.Comonad.IntervalHeap.html#675" class="InductiveConstructor">[]</a> <a id="1803" class="Symbol">=</a> <a id="1805" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
<a id="1810" href="Control.Comonad.IntervalHeap.html#1692" class="Function">pop-ε</a> <a id="1816" href="Control.Comonad.IntervalHeap.html#1816" class="Bound">xs</a> <a id="1819" class="Symbol">_</a> <a id="1821" class="Symbol">|</a> <a id="1823" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="1829" href="Control.Comonad.IntervalHeap.html#1829" class="Bound">s</a> <a id="1831" href="Control.Comonad.IntervalHeap.html#1831" class="Bound">s≢ε</a> <a id="1835" href="Control.Comonad.IntervalHeap.html#1835" class="Bound">ys</a> <a id="1838" class="Keyword">with</a> <a id="1843" href="Control.Comonad.IntervalHeap.html#1829" class="Bound">s</a> <a id="1845" href="Relation.Binary.html#3432" class="Function Operator">≤?</a> <a id="1848" href="Algebra.html#1444" class="Function">ε</a>
<a id="1850" href="Control.Comonad.IntervalHeap.html#1692" class="Function">pop-ε</a> <a id="1856" href="Control.Comonad.IntervalHeap.html#1856" class="Bound">xs</a> <a id="1859" class="Symbol">_</a> <a id="1861" class="Symbol">|</a> <a id="1863" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="1869" href="Control.Comonad.IntervalHeap.html#1869" class="Bound">s</a> <a id="1871" href="Control.Comonad.IntervalHeap.html#1871" class="Bound">s≢ε</a> <a id="1875" href="Control.Comonad.IntervalHeap.html#1875" class="Bound">ys</a> <a id="1878" class="Symbol">|</a> <a id="1880" href="Relation.Nullary.Decidable.html#433" class="InductiveConstructor">no</a>  <a id="1884" href="Control.Comonad.IntervalHeap.html#1884" class="Bound">s≰ε</a> <a id="1888" class="Symbol">=</a> <a id="1890" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
<a id="1895" href="Control.Comonad.IntervalHeap.html#1692" class="Function">pop-ε</a> <a id="1901" href="Control.Comonad.IntervalHeap.html#1901" class="Bound">xs</a> <a id="1904" class="Symbol">_</a> <a id="1906" class="Symbol">|</a> <a id="1908" href="Control.Comonad.IntervalHeap.html#691" class="InductiveConstructor">until</a> <a id="1914" href="Control.Comonad.IntervalHeap.html#1914" class="Bound">s</a> <a id="1916" href="Control.Comonad.IntervalHeap.html#1916" class="Bound">s≢ε</a> <a id="1920" href="Control.Comonad.IntervalHeap.html#1920" class="Bound">ys</a> <a id="1923" class="Symbol">|</a> <a id="1925" href="Relation.Nullary.Decidable.html#399" class="InductiveConstructor">yes</a> <a id="1929" href="Control.Comonad.IntervalHeap.html#1929" class="Bound">s≤ε</a> <a id="1933" class="Symbol">=</a> <a id="1935" href="Data.Empty.Base.html#154" class="Function">⊥-elim</a> <a id="1942" class="Symbol">(</a><a id="1943" href="Control.Comonad.IntervalHeap.html#1916" class="Bound">s≢ε</a> <a id="1947" class="Symbol">(</a><a id="1948" href="Algebra.Monus.html#4963" class="Function">antisym</a> <a id="1956" href="Control.Comonad.IntervalHeap.html#1929" class="Bound">s≤ε</a> <a id="1960" class="Symbol">(</a><a id="1961" href="Algebra.Monus.html#1903" class="Function">positive</a> <a id="1970" href="Control.Comonad.IntervalHeap.html#1914" class="Bound">s</a><a id="1971" class="Symbol">)))</a>

<a id="1976" class="Comment">-- slide : Heap A → Heap A</a>
<a id="2003" class="Comment">-- slide xs with xs .tl .next</a>
<a id="2033" class="Comment">-- slide xs | [] = xs</a>
<a id="2055" class="Comment">-- slide xs | [] = []</a>

<a id="2078" class="Comment">-- pop-tl : ∀ (x : A) s₁ (s₁≢ε : s₁ ≢ ε) xs s₂ → pop (x ◃ ⟪ until s₁ s₁≢ε xs ⟫) (s₁ ∙ s₂) ≡ pop xs s₂</a>
<a id="2180" class="Comment">-- pop-tl x s₁ s₁≢ε xs s₂ with s₁ ≤? (s₁ ∙ s₂)</a>
<a id="2227" class="Comment">-- pop-tl x s₁ s₁≢ε xs s₂ | no  s₁≰s₁∙s₂ = ⊥-elim (s₁≰s₁∙s₂ (s₂ , refl))</a>
<a id="2300" class="Comment">-- pop-tl x s₁ s₁≢ε xs s₂ | yes (k , s₁≤s₁∙s₂) =</a>
<a id="2349" class="Comment">--   let p = cancel s₁ s₂ k s₁≤s₁∙s₂</a>
<a id="2386" class="Comment">--   in {!!} ; cong (λ w → pop′ s₂ w xs) (isPropAcc {!!} (wf s₂))</a>

<a id="2453" class="Comment">-- seg-leftInv′ : (x : Heap A) → tabulate (pop x) ≡ x</a>
<a id="2507" class="Comment">-- seg-leftInv′ x = {!!}</a>

<a id="2533" class="Comment">-- mutual</a>
<a id="2543" class="Comment">--   seg-leftInv′ : (xs : Heap A) → stepFrom (pop xs) (pop xs ε .snd) (pop xs ε .snd ≟ ε) ≡ xs .tl .next</a>
<a id="2648" class="Comment">--   seg-leftInv′ (x ◃ xs) with pop (x ◃ xs) ε .snd ≟ ε</a>
<a id="2704" class="Comment">--   seg-leftInv′ (x ◃ xs) | yes s≡ε = {!!}</a>
<a id="2748" class="Comment">--   seg-leftInv′ (x ◃ xs) | no  s≢ε = {!!}</a>

<a id="2793" class="Comment">--   seg-leftInv : (x : Heap A) → tabulate (pop x) ≡ x</a>
<a id="2848" class="Comment">--   seg-leftInv (x ◃ xs) i .hd = pop-ε (x ◃ xs) (wf ε) i</a>
<a id="2906" class="Comment">--   seg-leftInv (x ◃ xs) i .tl .next = seg-leftInv′ (x ◃ xs) i</a>

<a id="2971" class="Comment">-- state-iso : Heap A ⇔ State A</a>
<a id="3003" class="Comment">-- state-iso .fun = pop</a>
<a id="3027" class="Comment">-- state-iso .inv = tabulate</a>
<a id="3056" class="Comment">-- state-iso .rightInv = {!!}</a>
<a id="3086" class="Comment">-- state-iso .leftInv  = {!!}</a>
</pre></body></html>