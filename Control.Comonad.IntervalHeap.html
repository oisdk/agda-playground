<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Comonad.IntervalHeap</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Pragma">--guardedness</a> <a id="66" class="Symbol">#-}</a>

<a id="71" class="Keyword">open</a> <a id="76" class="Keyword">import</a> <a id="83" href="Algebra.html" class="Module">Algebra</a>
<a id="91" class="Keyword">open</a> <a id="96" class="Keyword">import</a> <a id="103" href="Prelude.html" class="Module">Prelude</a>
<a id="111" class="Keyword">open</a> <a id="116" class="Keyword">import</a> <a id="123" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="WellFounded.html" class="Module">WellFounded</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Algebra.Monus.html" class="Module">Algebra.Monus</a>
<a id="189" class="Keyword">open</a> <a id="194" class="Keyword">import</a> <a id="201" href="Data.Maybe.html" class="Module">Data.Maybe</a>

<a id="213" class="Keyword">module</a> <a id="220" href="Control.Comonad.IntervalHeap.html" class="Module">Control.Comonad.IntervalHeap</a> <a id="249" class="Symbol">{</a><a id="250" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a><a id="251" class="Symbol">}</a>
  <a id="255" class="Symbol">(</a><a id="256" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a> <a id="260" class="Symbol">:</a> <a id="262" href="Algebra.Monus.html#166" class="Record">Monus</a> <a id="268" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a><a id="269" class="Symbol">)</a>
  <a id="273" class="Symbol">(</a><a id="274" href="Control.Comonad.IntervalHeap.html#274" class="Bound">wf</a> <a id="277" class="Symbol">:</a> <a id="279" href="WellFounded.html#385" class="Function">WellFounded</a> <a id="291" class="Symbol">(</a><a id="292" href="Relation.Binary.html#1546" class="Function Operator">Monus._&lt;_</a> <a id="302" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a><a id="305" class="Symbol">))</a> <a id="308" class="Keyword">where</a>

<a id="315" class="Keyword">open</a> <a id="320" href="Algebra.Monus.html#166" class="Module">Monus</a> <a id="326" href="Control.Comonad.IntervalHeap.html#256" class="Bound">mon</a> <a id="330" class="Deadcode Keyword">public</a><a id="336" class="Deadcode"> </a><a id="337" class="Deadcode Keyword">renaming</a><a id="345" class="Deadcode"> </a><a id="346" class="Deadcode Symbol">(</a><a id="347" class="Deadcode">totalâ‡’discrete </a><a id="362" class="Deadcode Symbol">to</a><a id="364" class="Deadcode"> _â‰Ÿ_</a><a id="368" class="Deadcode Symbol">)</a>

<a id="371" class="Keyword">record</a> <a id="Heap"></a><a id="378" href="Control.Comonad.IntervalHeap.html#378" class="Record">Heap</a> <a id="383" class="Symbol">{</a><a id="384" href="Control.Comonad.IntervalHeap.html#384" class="Bound">a</a><a id="385" class="Symbol">}</a> <a id="387" class="Symbol">(</a><a id="388" href="Control.Comonad.IntervalHeap.html#388" class="Bound">A</a> <a id="390" class="Symbol">:</a> <a id="392" href="Level.html#192" class="Function">Type</a> <a id="397" href="Control.Comonad.IntervalHeap.html#384" class="Bound">a</a><a id="398" class="Symbol">)</a> <a id="400" class="Symbol">:</a> <a id="402" href="Level.html#192" class="Function">Type</a> <a id="407" class="Symbol">(</a><a id="408" href="Control.Comonad.IntervalHeap.html#250" class="Bound">s</a> <a id="410" href="Agda.Primitive.html#636" class="Primitive Operator">â„“âŠ”</a> <a id="413" href="Control.Comonad.IntervalHeap.html#384" class="Bound">a</a><a id="414" class="Symbol">)</a> <a id="416" class="Keyword">where</a>
  <a id="424" class="Keyword">coinductive</a><a id="435" class="Symbol">;</a> <a id="437" class="Keyword">constructor</a> <a id="_â‰º_"></a><a id="449" href="Control.Comonad.IntervalHeap.html#449" class="CoinductiveConstructor Operator">_â‰º_</a>
  <a id="455" class="Keyword">field</a>
    <a id="Heap.v"></a><a id="465" href="Control.Comonad.IntervalHeap.html#465" class="Field">v</a> <a id="467" class="Symbol">:</a> <a id="469" href="Control.Comonad.IntervalHeap.html#388" class="Bound">A</a>
    <a id="Heap.next"></a><a id="475" href="Control.Comonad.IntervalHeap.html#475" class="Field">next</a> <a id="480" class="Symbol">:</a> <a id="482" href="Data.Maybe.Base.html#91" class="Datatype">Maybe</a> <a id="488" class="Symbol">(</a><a id="489" href="Data.Sigma.Base.html#248" class="Function">âˆƒ[</a> <a id="492" href="Control.Comonad.IntervalHeap.html#492" class="Bound">s</a> <a id="494" href="Data.Sigma.Base.html#248" class="Function">]</a> <a id="496" class="Symbol">((</a><a id="498" href="Control.Comonad.IntervalHeap.html#492" class="Bound">s</a> <a id="500" href="Path.html#506" class="Function Operator">â‰¢</a> <a id="502" href="Algebra.html#1444" class="Function">Îµ</a><a id="503" class="Symbol">)</a> <a id="505" href="Data.Sigma.Base.html#519" class="Function Operator">Ã—</a> <a id="507" href="Control.Comonad.IntervalHeap.html#378" class="Record">Heap</a> <a id="512" href="Control.Comonad.IntervalHeap.html#388" class="Bound">A</a><a id="513" class="Symbol">))</a>
<a id="516" class="Keyword">open</a> <a id="521" href="Control.Comonad.IntervalHeap.html#378" class="Module">Heap</a> <a id="526" class="Keyword">public</a>

<a id="State"></a><a id="534" href="Control.Comonad.IntervalHeap.html#534" class="Function">State</a> <a id="540" class="Symbol">:</a> <a id="542" href="Level.html#192" class="Function">Type</a> <a id="547" href="Level.html#372" class="Generalizable">a</a> <a id="549" class="Symbol">â†’</a> <a id="551" href="Level.html#192" class="Function">Type</a> <a id="556" class="Symbol">_</a>
<a id="558" href="Control.Comonad.IntervalHeap.html#534" class="Function">State</a> <a id="564" href="Control.Comonad.IntervalHeap.html#564" class="Bound">A</a> <a id="566" class="Symbol">=</a> <a id="568" href="Algebra.html#1401" class="Function">ğ‘†</a> <a id="570" class="Symbol">â†’</a> <a id="572" href="Control.Comonad.IntervalHeap.html#564" class="Bound">A</a> <a id="574" href="Data.Sigma.Base.html#519" class="Function Operator">Ã—</a> <a id="576" href="Algebra.html#1401" class="Function">ğ‘†</a>

<a id="579" class="Comment">-- popâ€² : (s : ğ‘†) â†’ Acc _&lt;_ s â†’ Heap A â†’ A Ã— ğ‘†</a>
<a id="626" class="Comment">-- popâ€² sâ‚‚ a xs with xs .next</a>
<a id="656" class="Comment">-- popâ€² sâ‚‚ a xs | nothing = xs .v , Îµ</a>
<a id="694" class="Comment">-- popâ€² sâ‚‚ a xs | just (sâ‚ , sâ‚â‰¢Îµ , ys) with sâ‚ â‰¤? sâ‚‚</a>
<a id="748" class="Comment">-- popâ€² sâ‚‚ a xs | just (sâ‚ , sâ‚â‰¢Îµ , ys) | no sâ‚â‰°sâ‚‚ = xs .v , fst (&lt;â‡’â‰¤ sâ‚â‰°sâ‚‚)</a>
<a id="825" class="Comment">-- popâ€² sâ‚‚ (acc wf) xs | just (sâ‚ , sâ‚â‰¢Îµ , ys) | yes (kâ‚ , sâ‚‚â‰¡sâ‚âˆ™kâ‚) = popâ€² kâ‚ (wf kâ‚ lemma) ys</a>
<a id="921" class="Comment">--   where</a>
<a id="932" class="Comment">--   lemma : kâ‚ &lt; sâ‚‚</a>
<a id="953" class="Comment">--   lemma (kâ‚‚ , kâ‚â‰¡sâ‚‚âˆ™kâ‚‚) = sâ‚â‰¢Îµ (zeroSumFree sâ‚ kâ‚‚ (absorbative _ _ p))</a>
<a id="1027" class="Comment">--     where</a>
<a id="1040" class="Comment">--     p : kâ‚ â‰¡ kâ‚ âˆ™ (sâ‚ âˆ™ kâ‚‚)</a>
<a id="1071" class="Comment">--     p = kâ‚â‰¡sâ‚‚âˆ™kâ‚‚ Í¾ cong (_âˆ™ kâ‚‚) sâ‚‚â‰¡sâ‚âˆ™kâ‚ Í¾ cong (_âˆ™ kâ‚‚) (comm sâ‚ kâ‚) Í¾ assoc kâ‚ sâ‚ kâ‚‚</a>

<a id="1161" class="Comment">-- pop : Heap A â†’ State A</a>
<a id="1187" class="Comment">-- pop xs s = popâ€² s (wf s) xs</a>

<a id="1219" class="Comment">-- mutual</a>
<a id="1229" class="Comment">--   stepFrom : State A â†’ (s : ğ‘†) â†’ Dec (s â‰¡ Îµ) â†’ Maybe (âˆƒ[ s ] ((s â‰¢ Îµ) Ã— Heap A))</a>
<a id="1313" class="Comment">--   stepFrom f s (yes p) = nothing</a>
<a id="1349" class="Comment">--   stepFrom f s (no Â¬p) = just (s , Â¬p , tabulate (f âˆ˜â€² _âˆ™_ s))</a>

<a id="1416" class="Comment">--   tabulate : State A â†’ Heap A</a>
<a id="1449" class="Comment">--   tabulate f = let x , s = f Îµ in Î» where</a>
<a id="1494" class="Comment">--     .v â†’ x</a>
<a id="1508" class="Comment">--     .next â†’ stepFrom f s (s â‰Ÿ Îµ)</a>

<a id="1545" class="Comment">-- -- seg-leftInvâ€² : (x : Heap A) â†’ tabulate (pop x) â‰¡ x</a>
<a id="1602" class="Comment">-- -- seg-leftInvâ€² x = {!!}</a>

<a id="1631" class="Comment">-- -- seg-leftInv : (x : Heap A) â†’ tabulate (pop x) â‰¡ x</a>
<a id="1687" class="Comment">-- -- seg-leftInv x = {!!}</a>

<a id="1715" class="Comment">-- -- state-iso : Heap A â‡” State A</a>
<a id="1750" class="Comment">-- -- state-iso .fun = pop</a>
<a id="1777" class="Comment">-- -- state-iso .inv = tabulate</a>
<a id="1809" class="Comment">-- -- state-iso .rightInv = seg-rightInv</a>
<a id="1850" class="Comment">-- -- state-iso .leftInv  = seg-leftInv</a>
</pre></body></html>