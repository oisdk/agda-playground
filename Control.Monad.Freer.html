<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.Freer</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>

<a id="41" class="Keyword">module</a> <a id="48" href="Control.Monad.Freer.html" class="Module">Control.Monad.Freer</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Prelude.html" class="Module">Prelude</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="Data.List.html" class="Module">Data.List</a> <a id="117" class="Keyword">hiding</a> <a id="124" class="Symbol">(</a><a id="125" href="Data.List.Base.html#1144" class="Function">map</a><a id="128" class="Symbol">)</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.List.Properties.html" class="Module">Data.List.Properties</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.List.Membership.html" class="Module">Data.List.Membership</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Algebra.html" class="Module">Algebra</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="237" class="Keyword">hiding</a> <a id="244" class="Symbol">(</a><a id="245" href="Data.Fin.Base.html#271" class="InductiveConstructor">fs</a><a id="247" class="Symbol">)</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Container.html" class="Module">Container</a>


<a id="Distributes"></a><a id="273" href="Control.Monad.Freer.html#273" class="Function">Distributes</a> <a id="285" class="Symbol">:</a> <a id="287" class="Symbol">(</a><a id="288" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="293" href="Level.html#266" class="Generalizable">a</a> <a id="295" class="Symbol">→</a> <a id="297" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="302" href="Level.html#266" class="Generalizable">a</a><a id="303" class="Symbol">)</a> <a id="305" class="Symbol">→</a> <a id="307" class="Symbol">(</a><a id="308" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="313" href="Level.html#266" class="Generalizable">a</a> <a id="315" class="Symbol">→</a> <a id="317" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="322" href="Level.html#266" class="Generalizable">a</a><a id="323" class="Symbol">)</a> <a id="325" class="Symbol">→</a> <a id="327" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="332" class="Symbol">_</a>
<a id="334" href="Control.Monad.Freer.html#273" class="Function">Distributes</a> <a id="346" href="Control.Monad.Freer.html#346" class="Bound">F</a> <a id="348" href="Control.Monad.Freer.html#348" class="Bound">G</a> <a id="350" class="Symbol">=</a> <a id="352" class="Symbol">∀</a> <a id="354" class="Symbol">{</a><a id="355" href="Control.Monad.Freer.html#355" class="Bound">A</a><a id="356" class="Symbol">}</a> <a id="358" class="Symbol">→</a> <a id="360" href="Control.Monad.Freer.html#346" class="Bound">F</a> <a id="362" class="Symbol">(</a><a id="363" href="Control.Monad.Freer.html#348" class="Bound">G</a> <a id="365" href="Control.Monad.Freer.html#355" class="Bound">A</a><a id="366" class="Symbol">)</a> <a id="368" class="Symbol">→</a> <a id="370" href="Control.Monad.Freer.html#348" class="Bound">G</a> <a id="372" class="Symbol">(</a><a id="373" href="Control.Monad.Freer.html#346" class="Bound">F</a> <a id="375" href="Control.Monad.Freer.html#355" class="Bound">A</a><a id="376" class="Symbol">)</a>

<a id="Freer"></a><a id="379" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="385" class="Symbol">:</a> <a id="387" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="392" href="Container.html#80" class="Function">Container</a> <a id="402" class="Symbol">→</a> <a id="404" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="410" class="Symbol">→</a> <a id="412" href="Agda.Primitive.html#388" class="Primitive">Type₁</a>
<a id="418" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="424" href="Control.Monad.Freer.html#424" class="Bound">fs</a> <a id="427" href="Control.Monad.Freer.html#427" class="Bound">A</a> <a id="429" class="Symbol">=</a> <a id="431" href="Data.List.Base.html#269" class="Function">foldr</a> <a id="437" href="Container.html#146" class="Function Operator">⟦_⟧</a> <a id="441" href="Control.Monad.Freer.html#427" class="Bound">A</a> <a id="443" href="Control.Monad.Freer.html#424" class="Bound">fs</a>

<a id="447" class="Keyword">private</a>
  <a id="457" class="Keyword">variable</a> <a id="466" href="Control.Monad.Freer.html#466" class="Generalizable">f</a> <a id="468" href="Control.Monad.Freer.html#468" class="Generalizable">g</a> <a id="470" class="Symbol">:</a> <a id="472" href="Container.html#80" class="Function">Container</a>
  <a id="484" class="Keyword">variable</a> <a id="493" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="496" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a> <a id="499" class="Symbol">:</a> <a id="501" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="506" href="Container.html#80" class="Function">Container</a>

<a id="bind"></a><a id="517" href="Control.Monad.Freer.html#517" class="Function">bind</a> <a id="522" class="Symbol">:</a> <a id="524" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="530" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="533" href="Level.html#282" class="Generalizable">A</a> <a id="535" class="Symbol">→</a> <a id="537" class="Symbol">(</a><a id="538" href="Level.html#282" class="Generalizable">A</a> <a id="540" class="Symbol">→</a> <a id="542" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="548" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a> <a id="551" href="Level.html#296" class="Generalizable">B</a><a id="552" class="Symbol">)</a> <a id="554" class="Symbol">→</a> <a id="556" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="562" class="Symbol">(</a><a id="563" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="566" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="569" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a><a id="571" class="Symbol">)</a> <a id="573" href="Level.html#296" class="Generalizable">B</a>
<a id="575" href="Control.Monad.Freer.html#517" class="Function">bind</a> <a id="580" class="Symbol">{</a><a id="581" class="Argument">fs</a> <a id="584" class="Symbol">=</a> <a id="586" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="588" class="Symbol">}</a> <a id="590" href="Control.Monad.Freer.html#590" class="Bound">xs</a> <a id="593" href="Control.Monad.Freer.html#593" class="Bound">k</a> <a id="595" class="Symbol">=</a> <a id="597" href="Control.Monad.Freer.html#593" class="Bound">k</a> <a id="599" href="Control.Monad.Freer.html#590" class="Bound">xs</a>
<a id="602" href="Control.Monad.Freer.html#517" class="Function">bind</a> <a id="607" class="Symbol">{</a><a id="608" class="Argument">fs</a> <a id="611" class="Symbol">=</a> <a id="613" href="Control.Monad.Freer.html#613" class="Bound">f</a> <a id="615" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="617" href="Control.Monad.Freer.html#617" class="Bound">fs</a><a id="619" class="Symbol">}</a> <a id="621" href="Control.Monad.Freer.html#621" class="Bound">xs</a> <a id="624" href="Control.Monad.Freer.html#624" class="Bound">k</a> <a id="626" class="Symbol">=</a> <a id="628" href="Container.html#226" class="Function">cmap</a> <a id="633" class="Symbol">(</a><a id="634" href="Function.html#369" class="Function">flip</a> <a id="639" class="Symbol">(</a><a id="640" href="Control.Monad.Freer.html#517" class="Function">bind</a> <a id="645" class="Symbol">{</a><a id="646" class="Argument">fs</a> <a id="649" class="Symbol">=</a> <a id="651" href="Control.Monad.Freer.html#617" class="Bound">fs</a><a id="653" class="Symbol">})</a> <a id="656" href="Control.Monad.Freer.html#624" class="Bound">k</a><a id="657" class="Symbol">)</a> <a id="659" href="Control.Monad.Freer.html#621" class="Bound">xs</a>

<a id="join"></a><a id="663" href="Control.Monad.Freer.html#663" class="Function">join</a> <a id="668" class="Symbol">:</a> <a id="670" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="676" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="679" class="Symbol">(</a><a id="680" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="686" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a> <a id="689" href="Level.html#282" class="Generalizable">A</a><a id="690" class="Symbol">)</a> <a id="692" class="Symbol">→</a> <a id="694" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="700" class="Symbol">(</a><a id="701" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="704" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="707" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a><a id="709" class="Symbol">)</a> <a id="711" href="Level.html#282" class="Generalizable">A</a>
<a id="713" href="Control.Monad.Freer.html#663" class="Function">join</a> <a id="718" class="Symbol">{</a><a id="719" class="Argument">fs</a> <a id="722" class="Symbol">=</a> <a id="724" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="726" class="Symbol">}</a> <a id="728" class="Symbol">=</a> <a id="730" href="Function.html#533" class="Function">id</a>
<a id="733" href="Control.Monad.Freer.html#663" class="Function">join</a> <a id="738" class="Symbol">{</a><a id="739" class="Argument">fs</a> <a id="742" class="Symbol">=</a> <a id="744" href="Control.Monad.Freer.html#744" class="Bound">f</a> <a id="746" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="748" href="Control.Monad.Freer.html#748" class="Bound">fs</a><a id="750" class="Symbol">}</a> <a id="752" class="Symbol">=</a> <a id="754" href="Container.html#226" class="Function">cmap</a> <a id="759" class="Symbol">(</a><a id="760" href="Control.Monad.Freer.html#663" class="Function">join</a> <a id="765" class="Symbol">{</a><a id="766" class="Argument">fs</a> <a id="769" class="Symbol">=</a> <a id="771" href="Control.Monad.Freer.html#748" class="Bound">fs</a><a id="773" class="Symbol">})</a>

<a id="extend"></a><a id="777" href="Control.Monad.Freer.html#777" class="Function">extend</a> <a id="784" class="Symbol">:</a> <a id="786" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="792" class="Symbol">(</a><a id="793" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="796" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="799" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a><a id="801" class="Symbol">)</a> <a id="803" href="Level.html#282" class="Generalizable">A</a> <a id="805" class="Symbol">→</a> <a id="807" class="Symbol">(</a><a id="808" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="814" href="Control.Monad.Freer.html#496" class="Generalizable">gs</a> <a id="817" href="Level.html#282" class="Generalizable">A</a> <a id="819" class="Symbol">→</a> <a id="821" href="Level.html#296" class="Generalizable">B</a><a id="822" class="Symbol">)</a> <a id="824" class="Symbol">→</a> <a id="826" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="832" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="835" href="Level.html#296" class="Generalizable">B</a>
<a id="837" href="Control.Monad.Freer.html#777" class="Function">extend</a> <a id="844" class="Symbol">{</a><a id="845" class="Argument">fs</a> <a id="848" class="Symbol">=</a> <a id="850" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="852" class="Symbol">}</a>     <a id="858" href="Control.Monad.Freer.html#858" class="Bound">x</a>  <a id="861" href="Control.Monad.Freer.html#861" class="Bound">k</a> <a id="863" class="Symbol">=</a> <a id="865" class="Symbol">(</a><a id="866" href="Control.Monad.Freer.html#861" class="Bound">k</a> <a id="868" href="Control.Monad.Freer.html#858" class="Bound">x</a><a id="869" class="Symbol">)</a>
<a id="871" href="Control.Monad.Freer.html#777" class="Function">extend</a> <a id="878" class="Symbol">{</a><a id="879" class="Argument">fs</a> <a id="882" class="Symbol">=</a> <a id="884" href="Control.Monad.Freer.html#884" class="Bound">f</a> <a id="886" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="888" href="Control.Monad.Freer.html#888" class="Bound">fs</a><a id="890" class="Symbol">}</a> <a id="892" href="Control.Monad.Freer.html#892" class="Bound">xs</a> <a id="895" href="Control.Monad.Freer.html#895" class="Bound">k</a> <a id="897" class="Symbol">=</a> <a id="899" href="Container.html#226" class="Function">cmap</a> <a id="904" class="Symbol">(</a><a id="905" href="Function.html#369" class="Function">flip</a> <a id="910" class="Symbol">(</a><a id="911" href="Control.Monad.Freer.html#777" class="Function">extend</a> <a id="918" class="Symbol">{</a><a id="919" class="Argument">fs</a> <a id="922" class="Symbol">=</a> <a id="924" href="Control.Monad.Freer.html#888" class="Bound">fs</a><a id="926" class="Symbol">})</a> <a id="929" href="Control.Monad.Freer.html#895" class="Bound">k</a><a id="930" class="Symbol">)</a> <a id="932" href="Control.Monad.Freer.html#892" class="Bound">xs</a>

<a id="936" class="Keyword">module</a> <a id="943" href="Control.Monad.Freer.html#943" class="Module">_</a> <a id="945" class="Symbol">{</a><a id="946" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="948" class="Symbol">:</a> <a id="950" href="Agda.Primitive.html#388" class="Primitive">Type₁</a> <a id="956" class="Symbol">→</a> <a id="958" href="Agda.Primitive.html#388" class="Primitive">Type₁</a><a id="963" class="Symbol">}(</a><a id="965" href="Control.Monad.Freer.html#965" class="Bound">mon</a> <a id="969" class="Symbol">:</a> <a id="971" href="Algebra.html#6522" class="Record">Monad</a> <a id="977" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a><a id="978" class="Symbol">)</a> <a id="980" class="Keyword">where</a>
  <a id="988" class="Keyword">open</a> <a id="993" class="Keyword">import</a> <a id="1000" href="Data.Fin.Properties.html" class="Module">Data.Fin.Properties</a> <a id="1020" class="Keyword">using</a> <a id="1026" class="Symbol">(</a><a id="1027" href="Data.Fin.Properties.html#2477" class="Function Operator">_&lt;_</a><a id="1030" class="Symbol">)</a>
  <a id="1034" class="Keyword">open</a> <a id="1039" href="Algebra.html#6522" class="Module">Monad</a> <a id="1045" href="Control.Monad.Freer.html#965" class="Bound">mon</a>

  <a id="1052" href="Control.Monad.Freer.html#1052" class="Function">handle</a> <a id="1059" class="Symbol">:</a> <a id="1061" class="Symbol">(</a><a id="1062" href="Control.Monad.Freer.html#1062" class="Bound">i</a> <a id="1064" class="Symbol">:</a> <a id="1066" href="Data.Fin.Base.html#182" class="Function">Fin</a> <a id="1070" class="Symbol">(</a><a id="1071" href="Data.List.Base.html#845" class="Function">length</a> <a id="1078" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a><a id="1080" class="Symbol">))</a> <a id="1083" class="Symbol">→</a>
            <a id="1097" class="Symbol">(</a><a id="1098" href="Container.html#146" class="Function Operator">⟦</a> <a id="1100" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1103" href="Data.List.Indexing.html#150" class="Function Operator">!</a> <a id="1105" href="Control.Monad.Freer.html#1062" class="Bound">i</a> <a id="1107" href="Container.html#146" class="Function Operator">⟧</a> <a id="1109" href="Data.Pi.Base.html#504" class="Function Operator">⇒</a> <a id="1111" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a><a id="1112" class="Symbol">)</a> <a id="1114" class="Symbol">→</a>
            <a id="1128" class="Symbol">(∀</a> <a id="1131" href="Control.Monad.Freer.html#1131" class="Bound">j</a> <a id="1133" class="Symbol">→</a> <a id="1135" href="Control.Monad.Freer.html#1131" class="Bound">j</a> <a id="1137" href="Data.Fin.Properties.html#2477" class="Function Operator">&lt;</a> <a id="1139" href="Control.Monad.Freer.html#1062" class="Bound">i</a> <a id="1141" class="Symbol">→</a> <a id="1143" href="Control.Monad.Freer.html#273" class="Function">Distributes</a> <a id="1155" href="Container.html#146" class="Function Operator">⟦</a> <a id="1157" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1160" href="Data.List.Indexing.html#150" class="Function Operator">!</a> <a id="1162" href="Control.Monad.Freer.html#1131" class="Bound">j</a> <a id="1164" href="Container.html#146" class="Function Operator">⟧</a> <a id="1166" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a><a id="1167" class="Symbol">)</a> <a id="1169" class="Symbol">→</a>
            <a id="1183" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="1189" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1192" href="Level.html#282" class="Generalizable">A</a> <a id="1194" class="Symbol">→</a>
            <a id="1208" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="1210" class="Symbol">(</a><a id="1211" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="1217" class="Symbol">(</a><a id="1218" href="Data.List.Membership.html#624" class="Function">delete</a> <a id="1225" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1228" href="Control.Monad.Freer.html#1062" class="Bound">i</a><a id="1229" class="Symbol">)</a> <a id="1231" href="Level.html#282" class="Generalizable">A</a><a id="1232" class="Symbol">)</a>
  <a id="1236" href="Control.Monad.Freer.html#1052" class="Function">handle</a> <a id="1243" class="Symbol">{</a><a id="1244" class="Argument">fs</a> <a id="1247" class="Symbol">=</a> <a id="1249" href="Control.Monad.Freer.html#1249" class="Bound">f</a> <a id="1251" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1253" href="Control.Monad.Freer.html#1253" class="Bound">fs</a><a id="1255" class="Symbol">}</a> <a id="1257" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="1266" href="Control.Monad.Freer.html#1266" class="Bound">h</a> <a id="1268" href="Control.Monad.Freer.html#1268" class="Bound">d</a> <a id="1270" href="Control.Monad.Freer.html#1270" class="Bound">xs</a> <a id="1273" class="Symbol">=</a> <a id="1275" href="Control.Monad.Freer.html#1266" class="Bound">h</a> <a id="1277" href="Control.Monad.Freer.html#1270" class="Bound">xs</a>
  <a id="1282" href="Control.Monad.Freer.html#1052" class="Function">handle</a> <a id="1289" class="Symbol">{</a><a id="1290" class="Argument">fs</a> <a id="1293" class="Symbol">=</a> <a id="1295" href="Control.Monad.Freer.html#1295" class="Bound">f</a> <a id="1297" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1299" href="Control.Monad.Freer.html#1299" class="Bound">fs</a><a id="1301" class="Symbol">}</a> <a id="1303" class="Symbol">(</a><a id="1304" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1309" href="Control.Monad.Freer.html#1309" class="Bound">i</a><a id="1310" class="Symbol">)</a> <a id="1312" href="Control.Monad.Freer.html#1312" class="Bound">h</a> <a id="1314" href="Control.Monad.Freer.html#1314" class="Bound">d</a> <a id="1316" href="Control.Monad.Freer.html#1316" class="Bound">xs</a> <a id="1319" class="Symbol">=</a> <a id="1321" href="Control.Monad.Freer.html#1314" class="Bound">d</a> <a id="1323" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a> <a id="1331" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a> <a id="1334" class="Symbol">(</a><a id="1335" href="Container.html#226" class="Function">cmap</a> <a id="1340" class="Symbol">(</a><a id="1341" href="Control.Monad.Freer.html#1052" class="Function">handle</a> <a id="1348" class="Symbol">{</a><a id="1349" class="Argument">fs</a> <a id="1352" class="Symbol">=</a> <a id="1354" href="Control.Monad.Freer.html#1299" class="Bound">fs</a><a id="1356" class="Symbol">}</a> <a id="1358" href="Control.Monad.Freer.html#1309" class="Bound">i</a> <a id="1360" href="Control.Monad.Freer.html#1312" class="Bound">h</a> <a id="1362" class="Symbol">(</a><a id="1363" href="Control.Monad.Freer.html#1314" class="Bound">d</a> <a id="1365" href="Function.html#97" class="Function Operator">∘</a> <a id="1367" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1371" class="Symbol">))</a> <a id="1374" href="Control.Monad.Freer.html#1316" class="Bound">xs</a><a id="1376" class="Symbol">)</a>

  <a id="1381" href="Control.Monad.Freer.html#1381" class="Function">handle″</a> <a id="1389" class="Symbol">:</a> <a id="1391" class="Symbol">(∀</a> <a id="1394" href="Control.Monad.Freer.html#1394" class="Bound">j</a> <a id="1396" class="Symbol">→</a> <a id="1398" href="Control.Monad.Freer.html#273" class="Function">Distributes</a> <a id="1410" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="1412" href="Container.html#146" class="Function Operator">⟦</a> <a id="1414" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1417" href="Data.List.Indexing.html#150" class="Function Operator">!</a> <a id="1419" href="Control.Monad.Freer.html#1394" class="Bound">j</a> <a id="1421" href="Container.html#146" class="Function Operator">⟧</a><a id="1422" class="Symbol">)</a> <a id="1424" class="Symbol">→</a>
            <a id="1438" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="1440" class="Symbol">(</a><a id="1441" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="1447" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1450" href="Level.html#282" class="Generalizable">A</a><a id="1451" class="Symbol">)</a> <a id="1453" class="Symbol">→</a>
            <a id="1467" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="1473" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1476" class="Symbol">(</a><a id="1477" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="1479" href="Level.html#282" class="Generalizable">A</a><a id="1480" class="Symbol">)</a>
  <a id="1484" href="Control.Monad.Freer.html#1381" class="Function">handle″</a> <a id="1492" class="Symbol">{</a><a id="1493" class="Argument">fs</a> <a id="1496" class="Symbol">=</a> <a id="1498" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a><a id="1500" class="Symbol">}</a>     <a id="1506" href="Control.Monad.Freer.html#1506" class="Bound">d</a> <a id="1508" href="Control.Monad.Freer.html#1508" class="Bound">xs</a> <a id="1511" class="Symbol">=</a> <a id="1513" href="Control.Monad.Freer.html#1508" class="Bound">xs</a>
  <a id="1518" href="Control.Monad.Freer.html#1381" class="Function">handle″</a> <a id="1526" class="Symbol">{</a><a id="1527" class="Argument">fs</a> <a id="1530" class="Symbol">=</a> <a id="1532" href="Control.Monad.Freer.html#1532" class="Bound">f</a> <a id="1534" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1536" href="Control.Monad.Freer.html#1536" class="Bound">fs</a><a id="1538" class="Symbol">}</a> <a id="1540" href="Control.Monad.Freer.html#1540" class="Bound">d</a> <a id="1542" href="Control.Monad.Freer.html#1542" class="Bound">xs</a> <a id="1545" class="Symbol">=</a> <a id="1547" href="Container.html#226" class="Function">cmap</a> <a id="1552" class="Symbol">(</a><a id="1553" href="Control.Monad.Freer.html#1381" class="Function">handle″</a> <a id="1561" class="Symbol">{</a><a id="1562" class="Argument">fs</a> <a id="1565" class="Symbol">=</a> <a id="1567" href="Control.Monad.Freer.html#1536" class="Bound">fs</a><a id="1569" class="Symbol">}</a> <a id="1571" class="Symbol">(</a><a id="1572" href="Control.Monad.Freer.html#1540" class="Bound">d</a> <a id="1574" href="Function.html#97" class="Function Operator">∘</a> <a id="1576" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1580" class="Symbol">))</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Control.Monad.Freer.html#1540" class="Bound">d</a> <a id="1586" href="Data.Fin.Base.html#250" class="InductiveConstructor">f0</a> <a id="1589" href="Control.Monad.Freer.html#1542" class="Bound">xs</a><a id="1591" class="Symbol">)</a>

  <a id="1596" href="Control.Monad.Freer.html#1596" class="Function">handle′</a> <a id="1604" class="Symbol">:</a> <a id="1606" class="Symbol">(</a><a id="1607" href="Control.Monad.Freer.html#1607" class="Bound">i</a> <a id="1609" class="Symbol">:</a> <a id="1611" href="Data.Fin.Base.html#182" class="Function">Fin</a> <a id="1615" class="Symbol">(</a><a id="1616" href="Data.List.Base.html#845" class="Function">length</a> <a id="1623" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a><a id="1625" class="Symbol">))</a> <a id="1628" class="Symbol">→</a>
            <a id="1642" class="Symbol">(</a><a id="1643" href="Container.html#146" class="Function Operator">⟦</a> <a id="1645" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1648" href="Data.List.Indexing.html#150" class="Function Operator">!</a> <a id="1650" href="Control.Monad.Freer.html#1607" class="Bound">i</a> <a id="1652" href="Container.html#146" class="Function Operator">⟧</a> <a id="1654" href="Data.Pi.Base.html#504" class="Function Operator">⇒</a> <a id="1656" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a><a id="1657" class="Symbol">)</a> <a id="1659" class="Symbol">→</a>
            <a id="1673" class="Symbol">(∀</a> <a id="1676" href="Control.Monad.Freer.html#1676" class="Bound">j</a> <a id="1678" class="Symbol">→</a> <a id="1680" href="Control.Monad.Freer.html#1607" class="Bound">i</a> <a id="1682" href="Data.Fin.Properties.html#2477" class="Function Operator">&lt;</a> <a id="1684" href="Control.Monad.Freer.html#1676" class="Bound">j</a> <a id="1686" class="Symbol">→</a> <a id="1688" href="Control.Monad.Freer.html#273" class="Function">Distributes</a> <a id="1700" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="1702" href="Container.html#146" class="Function Operator">⟦</a> <a id="1704" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1707" href="Data.List.Indexing.html#150" class="Function Operator">!</a> <a id="1709" href="Control.Monad.Freer.html#1676" class="Bound">j</a> <a id="1711" href="Container.html#146" class="Function Operator">⟧</a><a id="1712" class="Symbol">)</a> <a id="1714" class="Symbol">→</a>
            <a id="1728" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="1734" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1737" href="Level.html#282" class="Generalizable">A</a> <a id="1739" class="Symbol">→</a>
            <a id="1753" href="Control.Monad.Freer.html#379" class="Function">Freer</a> <a id="1759" class="Symbol">(</a><a id="1760" href="Data.List.Membership.html#624" class="Function">delete</a> <a id="1767" href="Control.Monad.Freer.html#493" class="Generalizable">fs</a> <a id="1770" href="Control.Monad.Freer.html#1607" class="Bound">i</a><a id="1771" class="Symbol">)</a> <a id="1773" class="Symbol">(</a><a id="1774" href="Control.Monad.Freer.html#946" class="Bound">𝐹</a> <a id="1776" href="Level.html#282" class="Generalizable">A</a><a id="1777" class="Symbol">)</a>
  <a id="1781" href="Control.Monad.Freer.html#1596" class="Function">handle′</a> <a id="1789" class="Symbol">{</a><a id="1790" class="Argument">fs</a> <a id="1793" class="Symbol">=</a> <a id="1795" href="Control.Monad.Freer.html#1795" class="Bound">f</a> <a id="1797" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1799" href="Control.Monad.Freer.html#1799" class="Bound">fs</a><a id="1801" class="Symbol">}</a> <a id="1803" class="Symbol">(</a><a id="1804" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1809" href="Control.Monad.Freer.html#1809" class="Bound">i</a><a id="1810" class="Symbol">)</a> <a id="1812" href="Control.Monad.Freer.html#1812" class="Bound">h</a> <a id="1814" href="Control.Monad.Freer.html#1814" class="Bound">d</a> <a id="1816" href="Control.Monad.Freer.html#1816" class="Bound">xs</a> <a id="1819" class="Symbol">=</a> <a id="1821" href="Container.html#226" class="Function">cmap</a> <a id="1826" class="Symbol">(</a><a id="1827" href="Control.Monad.Freer.html#1596" class="Function">handle′</a> <a id="1835" class="Symbol">{</a><a id="1836" class="Argument">fs</a> <a id="1839" class="Symbol">=</a> <a id="1841" href="Control.Monad.Freer.html#1799" class="Bound">fs</a><a id="1843" class="Symbol">}</a> <a id="1845" href="Control.Monad.Freer.html#1809" class="Bound">i</a> <a id="1847" href="Control.Monad.Freer.html#1812" class="Bound">h</a> <a id="1849" class="Symbol">(</a><a id="1850" href="Control.Monad.Freer.html#1814" class="Bound">d</a> <a id="1852" href="Function.html#97" class="Function Operator">∘</a> <a id="1854" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a><a id="1858" class="Symbol">))</a> <a id="1861" href="Control.Monad.Freer.html#1816" class="Bound">xs</a>
  <a id="1866" href="Control.Monad.Freer.html#1596" class="Function">handle′</a> <a id="1874" class="Symbol">{</a><a id="1875" class="Argument">fs</a> <a id="1878" class="Symbol">=</a> <a id="1880" href="Control.Monad.Freer.html#1880" class="Bound">f</a> <a id="1882" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1884" href="Control.Monad.Freer.html#1884" class="Bound">fs</a><a id="1886" class="Symbol">}</a> <a id="1888" href="Agda.Builtin.Maybe.html#194" class="InductiveConstructor">nothing</a>  <a id="1897" href="Control.Monad.Freer.html#1897" class="Bound">h</a> <a id="1899" href="Control.Monad.Freer.html#1899" class="Bound">d</a> <a id="1901" href="Control.Monad.Freer.html#1901" class="Bound">xs</a> <a id="1904" class="Symbol">=</a> <a id="1906" href="Control.Monad.Freer.html#1381" class="Function">handle″</a> <a id="1914" class="Symbol">{</a><a id="1915" class="Argument">fs</a> <a id="1918" class="Symbol">=</a> <a id="1920" href="Control.Monad.Freer.html#1884" class="Bound">fs</a><a id="1922" class="Symbol">}</a> <a id="1924" class="Symbol">(λ</a> <a id="1927" href="Control.Monad.Freer.html#1927" class="Bound">j</a> <a id="1929" class="Symbol">→</a> <a id="1931" href="Control.Monad.Freer.html#1899" class="Bound">d</a> <a id="1933" class="Symbol">(</a><a id="1934" href="Agda.Builtin.Maybe.html#173" class="InductiveConstructor">just</a> <a id="1939" href="Control.Monad.Freer.html#1927" class="Bound">j</a><a id="1940" class="Symbol">)</a> <a id="1942" href="Agda.Builtin.Unit.html#212" class="InductiveConstructor">tt</a><a id="1944" class="Symbol">)</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Control.Monad.Freer.html#1897" class="Bound">h</a> <a id="1949" href="Control.Monad.Freer.html#1901" class="Bound">xs</a><a id="1951" class="Symbol">)</a>

<a id="1954" class="Comment">-- module _ {ℓ₁} where</a>
<a id="1977" class="Comment">--   gradedMonad : GradedMonad (listMonoid (Container ℓ₂ ℓ₃)) ℓ₁ _</a>
<a id="2044" class="Comment">--   gradedMonad .GradedMonad.𝐹 = flip Freer</a>
<a id="2089" class="Comment">--   gradedMonad .GradedMonad.return = lift</a>
<a id="2133" class="Comment">--   gradedMonad .GradedMonad._&gt;&gt;=_ = bind</a>
<a id="2176" class="Comment">--   gradedMonad .GradedMonad.&gt;&gt;=-idˡ f x = refl</a>
<a id="2225" class="Comment">--   gradedMonad .GradedMonad.&gt;&gt;=-idʳ x = {!!}</a>
<a id="2272" class="Comment">--   gradedMonad .GradedMonad.&gt;&gt;=-assoc = {!!}</a>

<a id="2320" class="Comment">-- --     gradedComonad : GradedComonad (listMonoid (Type ℓ₂ → Type ℓ₃)) ℓ₁ _</a>
<a id="2398" class="Comment">-- --     gradedComonad .GradedComonad.𝐹 = flip Freer</a>
<a id="2452" class="Comment">-- --     gradedComonad .GradedComonad.extract (pure x) = x</a>
<a id="2512" class="Comment">-- --     gradedComonad .GradedComonad._=&gt;&gt;_ = extend</a>
<a id="2566" class="Comment">-- --     gradedComonad .GradedComonad.=&gt;&gt;-idʳ f = refl</a>
<a id="2622" class="Comment">-- --     gradedComonad .GradedComonad.=&gt;&gt;-idˡ f = {!!}</a>
<a id="2678" class="Comment">-- --     gradedComonad .GradedComonad.=&gt;&gt;-assoc = {!!}</a>
</pre></body></html>