<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.Freer</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>

<a id="41" class="Keyword">module</a> <a id="48" href="Control.Monad.Freer.html" class="Module">Control.Monad.Freer</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Prelude.html" class="Module">Prelude</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="Data.List.html" class="Module">Data.List</a> <a id="117" class="Keyword">hiding</a> <a id="124" class="Symbol">(</a><a id="125" href="Data.List.Base.html#1042" class="Function">map</a><a id="128" class="Symbol">)</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.List.Properties.html" class="Module">Data.List.Properties</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.List.Membership.html" class="Module">Data.List.Membership</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Algebra.html" class="Module">Algebra</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="237" class="Keyword">hiding</a> <a id="244" class="Symbol">(</a><a id="245" href="Data.Fin.Base.html#271" class="InductiveConstructor">fs</a><a id="247" class="Symbol">)</a>
<a id="249" class="Keyword">open</a> <a id="254" class="Keyword">import</a> <a id="261" href="Container.html" class="Module">Container</a>

<a id="272" class="Keyword">data</a> <a id="Freer"></a><a id="277" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="283" class="Symbol">{</a><a id="284" href="Control.Monad.Freer.html#284" class="Bound">ℓ₁</a> <a id="287" href="Control.Monad.Freer.html#287" class="Bound">ℓ₂</a> <a id="290" href="Control.Monad.Freer.html#290" class="Bound">ℓ₃</a><a id="292" class="Symbol">}</a> <a id="294" class="Symbol">(</a><a id="295" href="Control.Monad.Freer.html#295" class="Bound">A</a> <a id="297" class="Symbol">:</a> <a id="299" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="304" href="Control.Monad.Freer.html#284" class="Bound">ℓ₁</a><a id="306" class="Symbol">)</a> <a id="308" class="Symbol">:</a> <a id="310" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="315" class="Symbol">(</a><a id="316" href="Container.html#80" class="Function">Container</a> <a id="326" href="Control.Monad.Freer.html#287" class="Bound">ℓ₂</a> <a id="329" href="Control.Monad.Freer.html#290" class="Bound">ℓ₃</a><a id="331" class="Symbol">)</a> <a id="333" class="Symbol">→</a> <a id="335" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="340" class="Symbol">(</a><a id="341" href="Control.Monad.Freer.html#284" class="Bound">ℓ₁</a> <a id="344" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="347" href="Agda.Primitive.html#780" class="Primitive">ℓsuc</a> <a id="352" class="Symbol">(</a><a id="353" href="Control.Monad.Freer.html#287" class="Bound">ℓ₂</a> <a id="356" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="359" href="Control.Monad.Freer.html#290" class="Bound">ℓ₃</a><a id="361" class="Symbol">))</a> <a id="364" class="Keyword">where</a>
  <a id="Freer.pure"></a><a id="372" href="Control.Monad.Freer.html#372" class="InductiveConstructor">pure</a> <a id="377" class="Symbol">:</a> <a id="379" href="Control.Monad.Freer.html#295" class="Bound">A</a> <a id="381" class="Symbol">→</a> <a id="383" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="389" href="Control.Monad.Freer.html#295" class="Bound">A</a> <a id="391" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="Freer.call"></a><a id="396" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="401" class="Symbol">:</a> <a id="403" class="Symbol">∀</a> <a id="405" class="Symbol">{</a><a id="406" href="Control.Monad.Freer.html#406" class="Bound">f</a> <a id="408" href="Control.Monad.Freer.html#408" class="Bound">fs</a><a id="410" class="Symbol">}</a> <a id="412" class="Symbol">→</a> <a id="414" href="Container.html#185" class="Function Operator">⟦</a> <a id="416" href="Control.Monad.Freer.html#406" class="Bound">f</a> <a id="418" href="Container.html#185" class="Function Operator">⟧</a> <a id="420" class="Symbol">(</a><a id="421" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="427" href="Control.Monad.Freer.html#295" class="Bound">A</a> <a id="429" href="Control.Monad.Freer.html#408" class="Bound">fs</a><a id="431" class="Symbol">)</a> <a id="433" class="Symbol">→</a> <a id="435" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="441" href="Control.Monad.Freer.html#295" class="Bound">A</a> <a id="443" class="Symbol">(</a><a id="444" href="Control.Monad.Freer.html#406" class="Bound">f</a> <a id="446" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="448" href="Control.Monad.Freer.html#408" class="Bound">fs</a><a id="450" class="Symbol">)</a>


<a id="454" class="Keyword">module</a> <a id="461" href="Control.Monad.Freer.html#461" class="Module">_</a> <a id="463" class="Symbol">{</a><a id="464" href="Control.Monad.Freer.html#464" class="Bound">ℓ₂</a> <a id="467" href="Control.Monad.Freer.html#467" class="Bound">ℓ₃</a><a id="469" class="Symbol">}</a> <a id="471" class="Keyword">where</a>
  <a id="479" class="Keyword">private</a>
    <a id="491" class="Keyword">variable</a> <a id="500" href="Control.Monad.Freer.html#500" class="Generalizable">f</a> <a id="502" href="Control.Monad.Freer.html#502" class="Generalizable">g</a> <a id="504" class="Symbol">:</a> <a id="506" href="Container.html#80" class="Function">Container</a> <a id="516" href="Control.Monad.Freer.html#464" class="Bound">ℓ₂</a> <a id="519" href="Control.Monad.Freer.html#467" class="Bound">ℓ₃</a>
    <a id="526" class="Keyword">variable</a> <a id="535" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a> <a id="538" href="Control.Monad.Freer.html#538" class="Generalizable">gs</a> <a id="541" class="Symbol">:</a> <a id="543" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="548" class="Symbol">(</a><a id="549" href="Container.html#80" class="Function">Container</a> <a id="559" href="Control.Monad.Freer.html#464" class="Bound">ℓ₂</a> <a id="562" href="Control.Monad.Freer.html#467" class="Bound">ℓ₃</a><a id="564" class="Symbol">)</a>

  <a id="569" href="Control.Monad.Freer.html#569" class="Function">bind</a> <a id="574" class="Symbol">:</a> <a id="576" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="582" href="Level.html#255" class="Generalizable">A</a> <a id="584" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a> <a id="587" class="Symbol">→</a> <a id="589" class="Symbol">(</a><a id="590" href="Level.html#255" class="Generalizable">A</a> <a id="592" class="Symbol">→</a> <a id="594" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="600" href="Level.html#269" class="Generalizable">B</a> <a id="602" href="Control.Monad.Freer.html#538" class="Generalizable">gs</a><a id="604" class="Symbol">)</a> <a id="606" class="Symbol">→</a> <a id="608" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="614" href="Level.html#269" class="Generalizable">B</a> <a id="616" class="Symbol">(</a><a id="617" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a> <a id="620" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="623" href="Control.Monad.Freer.html#538" class="Generalizable">gs</a><a id="625" class="Symbol">)</a>
  <a id="629" href="Control.Monad.Freer.html#569" class="Function">bind</a> <a id="634" class="Symbol">(</a><a id="635" href="Control.Monad.Freer.html#372" class="InductiveConstructor">pure</a> <a id="640" href="Control.Monad.Freer.html#640" class="Bound">x</a><a id="641" class="Symbol">)</a> <a id="643" href="Control.Monad.Freer.html#643" class="Bound">k</a> <a id="645" class="Symbol">=</a> <a id="647" href="Control.Monad.Freer.html#643" class="Bound">k</a> <a id="649" href="Control.Monad.Freer.html#640" class="Bound">x</a>
  <a id="653" href="Control.Monad.Freer.html#569" class="Function">bind</a> <a id="658" class="Symbol">(</a><a id="659" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="664" href="Control.Monad.Freer.html#664" class="Bound">xs</a><a id="666" class="Symbol">)</a> <a id="668" href="Control.Monad.Freer.html#668" class="Bound">k</a> <a id="670" class="Symbol">=</a> <a id="672" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="677" class="Symbol">(</a><a id="678" href="Container.html#283" class="Function">cmap</a> <a id="683" class="Symbol">(</a><a id="684" href="Function.html#369" class="Function">flip</a> <a id="689" href="Control.Monad.Freer.html#569" class="Function">bind</a> <a id="694" href="Control.Monad.Freer.html#668" class="Bound">k</a><a id="695" class="Symbol">)</a> <a id="697" href="Control.Monad.Freer.html#664" class="Bound">xs</a><a id="699" class="Symbol">)</a>

  <a id="704" href="Control.Monad.Freer.html#704" class="Function">extend</a> <a id="711" class="Symbol">:</a> <a id="713" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="719" href="Level.html#255" class="Generalizable">A</a> <a id="721" class="Symbol">(</a><a id="722" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a> <a id="725" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="728" href="Control.Monad.Freer.html#538" class="Generalizable">gs</a><a id="730" class="Symbol">)</a> <a id="732" class="Symbol">→</a> <a id="734" class="Symbol">(</a><a id="735" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="741" href="Level.html#255" class="Generalizable">A</a> <a id="743" href="Control.Monad.Freer.html#538" class="Generalizable">gs</a> <a id="746" class="Symbol">→</a> <a id="748" href="Level.html#269" class="Generalizable">B</a><a id="749" class="Symbol">)</a> <a id="751" class="Symbol">→</a> <a id="753" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="759" href="Level.html#269" class="Generalizable">B</a> <a id="761" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a>
  <a id="766" href="Control.Monad.Freer.html#704" class="Function">extend</a> <a id="773" class="Symbol">{</a><a id="774" class="Argument">fs</a> <a id="777" class="Symbol">=</a> <a id="779" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="781" class="Symbol">}</a>     <a id="787" href="Control.Monad.Freer.html#787" class="Bound">x</a> <a id="789" href="Control.Monad.Freer.html#789" class="Bound">k</a> <a id="791" class="Symbol">=</a> <a id="793" href="Control.Monad.Freer.html#372" class="InductiveConstructor">pure</a> <a id="798" class="Symbol">(</a><a id="799" href="Control.Monad.Freer.html#789" class="Bound">k</a> <a id="801" href="Control.Monad.Freer.html#787" class="Bound">x</a><a id="802" class="Symbol">)</a>
  <a id="806" href="Control.Monad.Freer.html#704" class="Function">extend</a> <a id="813" class="Symbol">{</a><a id="814" class="Argument">fs</a> <a id="817" class="Symbol">=</a> <a id="819" href="Control.Monad.Freer.html#819" class="Bound">f</a> <a id="821" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="823" href="Control.Monad.Freer.html#823" class="Bound">fs</a><a id="825" class="Symbol">}</a> <a id="827" class="Symbol">(</a><a id="828" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="833" href="Control.Monad.Freer.html#833" class="Bound">xs</a><a id="835" class="Symbol">)</a> <a id="837" href="Control.Monad.Freer.html#837" class="Bound">k</a> <a id="839" class="Symbol">=</a> <a id="841" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="846" class="Symbol">(</a><a id="847" href="Container.html#283" class="Function">cmap</a> <a id="852" class="Symbol">(</a><a id="853" href="Function.html#369" class="Function">flip</a> <a id="858" href="Control.Monad.Freer.html#704" class="Function">extend</a> <a id="865" href="Control.Monad.Freer.html#837" class="Bound">k</a><a id="866" class="Symbol">)</a> <a id="868" href="Control.Monad.Freer.html#833" class="Bound">xs</a><a id="870" class="Symbol">)</a>

  <a id="875" class="Keyword">module</a> <a id="882" href="Control.Monad.Freer.html#882" class="Module">_</a> <a id="884" class="Symbol">(</a><a id="885" href="Control.Monad.Freer.html#885" class="Bound">mon</a> <a id="889" class="Symbol">:</a> <a id="891" href="Algebra.html#7084" class="Record">Monad</a> <a id="897" class="UnsolvedMeta Symbol">_</a> <a id="899" class="UnsolvedMeta Symbol">_</a><a id="900" class="Symbol">)</a> <a id="902" class="Keyword">where</a>
    <a id="912" class="Keyword">open</a> <a id="917" href="Algebra.html#7084" class="Module">Monad</a> <a id="923" href="Control.Monad.Freer.html#885" class="Bound">mon</a>

    <a id="932" href="Control.Monad.Freer.html#932" class="Function">handle</a> <a id="939" class="Symbol">:</a> <a id="941" class="Symbol">(</a><a id="942" href="Control.Monad.Freer.html#942" class="Bound">i</a> <a id="944" class="Symbol">:</a> <a id="946" href="Data.Fin.Base.html#182" class="Function">Fin</a> <a id="950" class="Symbol">(</a><a id="951" href="Data.List.Base.html#845" class="Function">length</a> <a id="958" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a><a id="960" class="Symbol">))</a> <a id="963" class="Symbol">→</a> <a id="965" class="Symbol">(</a><a id="966" href="Container.html#185" class="Function Operator">⟦</a> <a id="968" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a> <a id="971" href="Data.List.Indexing.html#150" class="Function Operator">!</a> <a id="973" href="Control.Monad.Freer.html#942" class="Bound">i</a> <a id="975" href="Container.html#185" class="Function Operator">⟧</a> <a id="977" href="Data.Pi.Base.html#504" class="Function Operator">⇒</a> <a id="979" href="Algebra.html#7139" class="Field">𝐹</a><a id="980" class="Symbol">)</a> <a id="982" class="Symbol">→</a> <a id="984" href="Control.Monad.Freer.html#277" class="Datatype">Freer</a> <a id="990" href="Level.html#255" class="UnsolvedMeta Generalizable">A</a> <a id="992" href="Control.Monad.Freer.html#535" class="Generalizable">fs</a> <a id="995" class="Symbol">→</a> <a id="997" href="Algebra.html#7139" class="Field">𝐹</a> <a id="999" class="Symbol">(</a><a id="1000" href="Control.Monad.Freer.html#277" class="UnsolvedConstraint Datatype">Freer</a><a id="1005" class="UnsolvedConstraint"> </a><a id="1006" href="Level.html#255" class="UnsolvedConstraint Generalizable">A</a><a id="1007" class="UnsolvedConstraint"> </a><a id="1008" class="UnsolvedConstraint Symbol">(</a><a id="1009" href="Data.List.Membership.html#650" class="UnsolvedConstraint Function">delete</a><a id="1015" class="UnsolvedConstraint"> </a><a id="1016" href="Control.Monad.Freer.html#535" class="UnsolvedConstraint Generalizable">fs</a><a id="1018" class="UnsolvedConstraint"> </a><a id="1019" href="Control.Monad.Freer.html#942" class="UnsolvedConstraint Bound">i</a><a id="1020" class="UnsolvedConstraint Symbol">)</a><a id="1021" class="Symbol">)</a>
    <a id="1027" href="Control.Monad.Freer.html#932" class="Function">handle</a> <a id="1034" class="Symbol">{</a><a id="1035" class="Argument">fs</a> <a id="1038" class="Symbol">=</a> <a id="1040" href="Control.Monad.Freer.html#1040" class="Bound">f</a> <a id="1042" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1044" href="Control.Monad.Freer.html#1044" class="Bound">fs</a><a id="1046" class="Symbol">}</a> <a id="1048" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a>  <a id="1057" href="Control.Monad.Freer.html#1057" class="Bound">h</a> <a id="1059" class="Symbol">(</a><a id="1060" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="1065" href="Control.Monad.Freer.html#1065" class="Bound">xs</a><a id="1067" class="Symbol">)</a> <a id="1069" class="Symbol">=</a> <a id="1071" href="Control.Monad.Freer.html#1057" class="UnsolvedConstraint Bound">h</a> <a id="1073" href="Control.Monad.Freer.html#1065" class="UnsolvedConstraint Bound">xs</a>
    <a id="1080" href="Control.Monad.Freer.html#932" class="Function">handle</a> <a id="1087" class="Symbol">{</a><a id="1088" class="Argument">fs</a> <a id="1091" class="Symbol">=</a> <a id="1093" href="Control.Monad.Freer.html#1093" class="Bound">f</a> <a id="1095" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1097" href="Control.Monad.Freer.html#1097" class="Bound">fs</a><a id="1099" class="Symbol">}</a> <a id="1101" class="Symbol">(</a><a id="1102" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="1107" href="Control.Monad.Freer.html#1107" class="Bound">i</a><a id="1108" class="Symbol">)</a> <a id="1110" href="Control.Monad.Freer.html#1110" class="Bound">h</a> <a id="1112" class="Symbol">(</a><a id="1113" href="Control.Monad.Freer.html#396" class="InductiveConstructor">call</a> <a id="1118" href="Control.Monad.Freer.html#1118" class="Bound">xs</a><a id="1120" class="Symbol">)</a> <a id="1122" class="Symbol">=</a> <a id="1124" class="Hole">{!!}</a>

<a id="1130" class="Comment">--   module _ {ℓ₁} where</a>
<a id="1155" class="Comment">--     gradedMonad : GradedMonad (listMonoid (Type ℓ₂ → Type ℓ₃)) ℓ₁ _</a>
<a id="1226" class="Comment">--     gradedMonad .GradedMonad.𝐹 = flip Freer</a>
<a id="1273" class="Comment">--     gradedMonad .GradedMonad.pure = pure</a>
<a id="1317" class="Comment">--     gradedMonad .GradedMonad._&gt;&gt;=_ = bind</a>
<a id="1362" class="Comment">--     gradedMonad .GradedMonad.&gt;&gt;=-idˡ f x = refl</a>
<a id="1413" class="Comment">--     gradedMonad .GradedMonad.&gt;&gt;=-idʳ x = {!!}</a>
<a id="1462" class="Comment">--     gradedMonad .GradedMonad.&gt;&gt;=-assoc = {!!}</a>

<a id="1512" class="Comment">--     gradedComonad : GradedComonad (listMonoid (Type ℓ₂ → Type ℓ₃)) ℓ₁ _</a>
<a id="1587" class="Comment">--     gradedComonad .GradedComonad.𝐹 = flip Freer</a>
<a id="1638" class="Comment">--     gradedComonad .GradedComonad.extract (pure x) = x</a>
<a id="1695" class="Comment">--     gradedComonad .GradedComonad._=&gt;&gt;_ = extend</a>
<a id="1746" class="Comment">--     gradedComonad .GradedComonad.=&gt;&gt;-idʳ f = refl</a>
<a id="1799" class="Comment">--     gradedComonad .GradedComonad.=&gt;&gt;-idˡ f = {!!}</a>
<a id="1852" class="Comment">--     gradedComonad .GradedComonad.=&gt;&gt;-assoc = {!!}</a>
</pre></body></html>