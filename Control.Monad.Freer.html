<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.Freer</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--allow-unsolved-metas</a> <a id="36" class="Symbol">#-}</a>

<a id="41" class="Keyword">module</a> <a id="48" href="Control.Monad.Freer.html" class="Module">Control.Monad.Freer</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Prelude.html" class="Module">Prelude</a>
<a id="95" class="Keyword">open</a> <a id="100" class="Keyword">import</a> <a id="107" href="Data.List.html" class="Module">Data.List</a> <a id="117" class="Keyword">hiding</a> <a id="124" class="Symbol">(</a><a id="125" href="Data.List.Base.html#1042" class="Function">map</a><a id="128" class="Symbol">)</a>
<a id="130" class="Keyword">open</a> <a id="135" class="Keyword">import</a> <a id="142" href="Data.List.Properties.html" class="Module">Data.List.Properties</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.List.Membership.html" class="Module">Data.List.Membership</a>
<a id="196" class="Keyword">open</a> <a id="201" class="Keyword">import</a> <a id="208" href="Algebra.html" class="Module">Algebra</a>
<a id="216" class="Keyword">open</a> <a id="221" class="Keyword">import</a> <a id="228" href="Data.Fin.html" class="Module">Data.Fin</a> <a id="237" class="Keyword">hiding</a> <a id="244" class="Symbol">(</a><a id="245" href="Data.Fin.Base.html#271" class="InductiveConstructor">fs</a><a id="247" class="Symbol">)</a>

<a id="250" class="Keyword">data</a> <a id="Freer"></a><a id="255" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="261" class="Symbol">{</a><a id="262" href="Control.Monad.Freer.html#262" class="Bound">ℓ₁</a> <a id="265" href="Control.Monad.Freer.html#265" class="Bound">ℓ₂</a> <a id="268" href="Control.Monad.Freer.html#268" class="Bound">ℓ₃</a><a id="270" class="Symbol">}</a> <a id="272" class="Symbol">(</a><a id="273" href="Control.Monad.Freer.html#273" class="Bound">A</a> <a id="275" class="Symbol">:</a> <a id="277" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="282" href="Control.Monad.Freer.html#262" class="Bound">ℓ₁</a><a id="284" class="Symbol">)</a> <a id="286" class="Symbol">:</a> <a id="288" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="293" class="Symbol">(</a><a id="294" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="299" href="Control.Monad.Freer.html#265" class="Bound">ℓ₂</a> <a id="302" class="Symbol">→</a> <a id="304" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="309" href="Control.Monad.Freer.html#268" class="Bound">ℓ₃</a><a id="311" class="Symbol">)</a> <a id="313" class="Symbol">→</a> <a id="315" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="320" class="Symbol">(</a><a id="321" href="Control.Monad.Freer.html#262" class="Bound">ℓ₁</a> <a id="324" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="327" href="Agda.Primitive.html#780" class="Primitive">ℓsuc</a> <a id="332" class="Symbol">(</a><a id="333" href="Control.Monad.Freer.html#265" class="Bound">ℓ₂</a> <a id="336" href="Agda.Primitive.html#810" class="Primitive Operator">ℓ⊔</a> <a id="339" href="Control.Monad.Freer.html#268" class="Bound">ℓ₃</a><a id="341" class="Symbol">))</a> <a id="344" class="Keyword">where</a>
  <a id="Freer.pure"></a><a id="352" href="Control.Monad.Freer.html#352" class="InductiveConstructor">pure</a> <a id="357" class="Symbol">:</a> <a id="359" href="Control.Monad.Freer.html#273" class="Bound">A</a> <a id="361" class="Symbol">→</a> <a id="363" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="369" href="Control.Monad.Freer.html#273" class="Bound">A</a> <a id="371" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="Freer.call"></a><a id="376" href="Control.Monad.Freer.html#376" class="InductiveConstructor">call</a> <a id="381" class="Symbol">:</a> <a id="383" class="Symbol">∀</a> <a id="385" class="Symbol">{</a><a id="386" href="Control.Monad.Freer.html#386" class="Bound">f</a> <a id="388" href="Control.Monad.Freer.html#388" class="Bound">fs</a> <a id="391" href="Control.Monad.Freer.html#391" class="Bound">x</a><a id="392" class="Symbol">}</a> <a id="394" class="Symbol">→</a> <a id="396" href="Control.Monad.Freer.html#386" class="Bound">f</a> <a id="398" href="Control.Monad.Freer.html#391" class="Bound">x</a> <a id="400" class="Symbol">→</a> <a id="402" class="Symbol">(</a><a id="403" href="Control.Monad.Freer.html#391" class="Bound">x</a> <a id="405" class="Symbol">→</a> <a id="407" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="413" href="Control.Monad.Freer.html#273" class="Bound">A</a> <a id="415" href="Control.Monad.Freer.html#388" class="Bound">fs</a><a id="417" class="Symbol">)</a> <a id="419" class="Symbol">→</a> <a id="421" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="427" href="Control.Monad.Freer.html#273" class="Bound">A</a> <a id="429" class="Symbol">(</a><a id="430" href="Control.Monad.Freer.html#386" class="Bound">f</a> <a id="432" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="434" href="Control.Monad.Freer.html#388" class="Bound">fs</a><a id="436" class="Symbol">)</a>


<a id="440" class="Keyword">module</a> <a id="447" href="Control.Monad.Freer.html#447" class="Module">_</a> <a id="449" class="Symbol">{</a><a id="450" href="Control.Monad.Freer.html#450" class="Bound">ℓ₂</a> <a id="453" href="Control.Monad.Freer.html#453" class="Bound">ℓ₃</a><a id="455" class="Symbol">}</a> <a id="457" class="Keyword">where</a>
  <a id="465" class="Keyword">private</a>
    <a id="477" class="Keyword">variable</a> <a id="486" href="Control.Monad.Freer.html#486" class="Generalizable">f</a> <a id="488" href="Control.Monad.Freer.html#488" class="Generalizable">g</a> <a id="490" class="Symbol">:</a> <a id="492" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="497" href="Control.Monad.Freer.html#450" class="Bound">ℓ₂</a> <a id="500" class="Symbol">→</a> <a id="502" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="507" href="Control.Monad.Freer.html#453" class="Bound">ℓ₃</a>
    <a id="514" class="Keyword">variable</a> <a id="523" href="Control.Monad.Freer.html#523" class="Generalizable">fs</a> <a id="526" href="Control.Monad.Freer.html#526" class="Generalizable">gs</a> <a id="529" class="Symbol">:</a> <a id="531" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="536" class="Symbol">(</a><a id="537" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="542" href="Control.Monad.Freer.html#450" class="Bound">ℓ₂</a> <a id="545" class="Symbol">→</a> <a id="547" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="552" href="Control.Monad.Freer.html#453" class="Bound">ℓ₃</a><a id="554" class="Symbol">)</a>

  <a id="559" href="Control.Monad.Freer.html#559" class="Function">bind</a> <a id="564" class="Symbol">:</a> <a id="566" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="572" href="Level.html#255" class="Generalizable">A</a> <a id="574" href="Control.Monad.Freer.html#523" class="Generalizable">fs</a> <a id="577" class="Symbol">→</a> <a id="579" class="Symbol">(</a><a id="580" href="Level.html#255" class="Generalizable">A</a> <a id="582" class="Symbol">→</a> <a id="584" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="590" href="Level.html#269" class="Generalizable">B</a> <a id="592" href="Control.Monad.Freer.html#526" class="Generalizable">gs</a><a id="594" class="Symbol">)</a> <a id="596" class="Symbol">→</a> <a id="598" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="604" href="Level.html#269" class="Generalizable">B</a> <a id="606" class="Symbol">(</a><a id="607" href="Control.Monad.Freer.html#523" class="Generalizable">fs</a> <a id="610" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="613" href="Control.Monad.Freer.html#526" class="Generalizable">gs</a><a id="615" class="Symbol">)</a>
  <a id="619" href="Control.Monad.Freer.html#559" class="Function">bind</a> <a id="624" class="Symbol">(</a><a id="625" href="Control.Monad.Freer.html#352" class="InductiveConstructor">pure</a> <a id="630" href="Control.Monad.Freer.html#630" class="Bound">x</a><a id="631" class="Symbol">)</a> <a id="633" href="Control.Monad.Freer.html#633" class="Bound">k</a> <a id="635" class="Symbol">=</a> <a id="637" href="Control.Monad.Freer.html#633" class="Bound">k</a> <a id="639" href="Control.Monad.Freer.html#630" class="Bound">x</a>
  <a id="643" href="Control.Monad.Freer.html#559" class="Function">bind</a> <a id="648" class="Symbol">(</a><a id="649" href="Control.Monad.Freer.html#376" class="InductiveConstructor">call</a> <a id="654" href="Control.Monad.Freer.html#654" class="Bound">x</a> <a id="656" href="Control.Monad.Freer.html#656" class="Bound">xs</a><a id="658" class="Symbol">)</a> <a id="660" href="Control.Monad.Freer.html#660" class="Bound">k</a> <a id="662" class="Symbol">=</a> <a id="664" href="Control.Monad.Freer.html#376" class="InductiveConstructor">call</a> <a id="669" href="Control.Monad.Freer.html#654" class="Bound">x</a> <a id="671" class="Symbol">λ</a> <a id="673" href="Control.Monad.Freer.html#673" class="Bound">y</a> <a id="675" class="Symbol">→</a> <a id="677" href="Control.Monad.Freer.html#559" class="Function">bind</a> <a id="682" class="Symbol">(</a><a id="683" href="Control.Monad.Freer.html#656" class="Bound">xs</a> <a id="686" href="Control.Monad.Freer.html#673" class="Bound">y</a><a id="687" class="Symbol">)</a> <a id="689" href="Control.Monad.Freer.html#660" class="Bound">k</a>

  <a id="694" href="Control.Monad.Freer.html#694" class="Function">extend</a> <a id="701" class="Symbol">:</a> <a id="703" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="709" href="Level.html#255" class="Generalizable">A</a> <a id="711" class="Symbol">(</a><a id="712" href="Control.Monad.Freer.html#523" class="Generalizable">fs</a> <a id="715" href="Data.List.Base.html#785" class="Function Operator">++</a> <a id="718" href="Control.Monad.Freer.html#526" class="Generalizable">gs</a><a id="720" class="Symbol">)</a> <a id="722" class="Symbol">→</a> <a id="724" class="Symbol">(</a><a id="725" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="731" href="Level.html#255" class="Generalizable">A</a> <a id="733" href="Control.Monad.Freer.html#526" class="Generalizable">gs</a> <a id="736" class="Symbol">→</a> <a id="738" href="Level.html#269" class="Generalizable">B</a><a id="739" class="Symbol">)</a> <a id="741" class="Symbol">→</a> <a id="743" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a> <a id="749" href="Level.html#269" class="Generalizable">B</a> <a id="751" href="Control.Monad.Freer.html#523" class="Generalizable">fs</a>
  <a id="756" href="Control.Monad.Freer.html#694" class="Function">extend</a> <a id="763" class="Symbol">{</a><a id="764" class="Argument">fs</a> <a id="767" class="Symbol">=</a> <a id="769" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="771" class="Symbol">}</a> <a id="773" href="Control.Monad.Freer.html#773" class="Bound">x</a> <a id="775" href="Control.Monad.Freer.html#775" class="Bound">k</a> <a id="777" class="Symbol">=</a> <a id="779" href="Control.Monad.Freer.html#352" class="InductiveConstructor">pure</a> <a id="784" class="Symbol">(</a><a id="785" href="Control.Monad.Freer.html#775" class="Bound">k</a> <a id="787" href="Control.Monad.Freer.html#773" class="Bound">x</a><a id="788" class="Symbol">)</a>
  <a id="792" href="Control.Monad.Freer.html#694" class="Function">extend</a> <a id="799" class="Symbol">{</a><a id="800" class="Argument">fs</a> <a id="803" class="Symbol">=</a> <a id="805" href="Control.Monad.Freer.html#805" class="Bound">f</a> <a id="807" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="809" href="Control.Monad.Freer.html#809" class="Bound">fs</a><a id="811" class="Symbol">}</a> <a id="813" class="Symbol">(</a><a id="814" href="Control.Monad.Freer.html#376" class="InductiveConstructor">call</a> <a id="819" href="Control.Monad.Freer.html#819" class="Bound">x</a> <a id="821" href="Control.Monad.Freer.html#821" class="Bound">xs</a><a id="823" class="Symbol">)</a> <a id="825" href="Control.Monad.Freer.html#825" class="Bound">k</a> <a id="827" class="Symbol">=</a> <a id="829" href="Control.Monad.Freer.html#376" class="InductiveConstructor">call</a> <a id="834" href="Control.Monad.Freer.html#819" class="Bound">x</a> <a id="836" class="Symbol">λ</a> <a id="838" href="Control.Monad.Freer.html#838" class="Bound">y</a> <a id="840" class="Symbol">→</a> <a id="842" href="Control.Monad.Freer.html#694" class="Function">extend</a> <a id="849" class="Symbol">(</a><a id="850" href="Control.Monad.Freer.html#821" class="Bound">xs</a> <a id="853" href="Control.Monad.Freer.html#838" class="Bound">y</a><a id="854" class="Symbol">)</a> <a id="856" href="Control.Monad.Freer.html#825" class="Bound">k</a>

  <a id="861" class="Comment">-- module _ (mon : Monad _ _) where</a>
  <a id="899" class="Comment">--   open Monad mon</a>

  <a id="922" class="Comment">--   handle : (i : Fin (length fs)) → (fs ! i ⇒ 𝐹) → Freer A fs → 𝐹 (Freer A (delete fs i))</a>
  <a id="1016" class="Comment">--   handle {fs = f ∷ fs} nothing  h (call x k) = h x &gt;&gt;= λ y → return (k y)</a>
  <a id="1095" class="Comment">--   handle {fs = f ∷ fs} (just i) h (call x k) = {!!} &gt;&gt;= λ y → return (call x y)</a>

  <a id="1181" class="Keyword">module</a> <a id="1188" href="Control.Monad.Freer.html#1188" class="Module">_</a> <a id="1190" class="Symbol">{</a><a id="1191" href="Control.Monad.Freer.html#1191" class="Bound">ℓ₁</a><a id="1193" class="Symbol">}</a> <a id="1195" class="Keyword">where</a>
    <a id="1205" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1217" class="Symbol">:</a> <a id="1219" href="Algebra.html#9907" class="Record">GradedMonad</a> <a id="1231" class="Symbol">(</a><a id="1232" href="Data.List.Properties.html#3936" class="Function">listMonoid</a> <a id="1243" class="Symbol">(</a><a id="1244" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1249" href="Control.Monad.Freer.html#450" class="Bound">ℓ₂</a> <a id="1252" class="Symbol">→</a> <a id="1254" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1259" href="Control.Monad.Freer.html#453" class="Bound">ℓ₃</a><a id="1261" class="Symbol">))</a> <a id="1264" href="Control.Monad.Freer.html#1191" class="Bound">ℓ₁</a> <a id="1267" class="Symbol">_</a>
    <a id="1273" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1285" class="Symbol">.</a><a id="1286" href="Algebra.html#10021" class="Field">GradedMonad.𝐹</a> <a id="1300" class="Symbol">=</a> <a id="1302" href="Function.html#369" class="Function">flip</a> <a id="1307" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a>
    <a id="1317" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1329" class="Symbol">.</a><a id="1330" href="Algebra.html#10051" class="Field">GradedMonad.pure</a> <a id="1347" class="Symbol">=</a> <a id="1349" href="Control.Monad.Freer.html#352" class="InductiveConstructor">pure</a>
    <a id="1358" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1370" class="Symbol">.</a><a id="1371" href="Algebra.html#10073" class="Field Operator">GradedMonad._&gt;&gt;=_</a> <a id="1389" class="Symbol">=</a> <a id="1391" href="Control.Monad.Freer.html#559" class="Function">bind</a>
    <a id="1400" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1412" class="Symbol">.</a><a id="1413" href="Algebra.html#10320" class="Field">GradedMonad.&gt;&gt;=-idˡ</a> <a id="1433" href="Control.Monad.Freer.html#1433" class="Bound">f</a> <a id="1435" href="Control.Monad.Freer.html#1435" class="Bound">x</a> <a id="1437" class="Symbol">=</a> <a id="1439" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
    <a id="1448" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1460" class="Symbol">.</a><a id="1461" href="Algebra.html#10412" class="Field">GradedMonad.&gt;&gt;=-idʳ</a> <a id="1481" href="Control.Monad.Freer.html#1481" class="Bound">x</a> <a id="1483" class="Symbol">=</a> <a id="1485" class="Hole">{!!}</a>
    <a id="1494" href="Control.Monad.Freer.html#1205" class="Function">gradedMonad</a> <a id="1506" class="Symbol">.</a><a id="1507" href="Algebra.html#10484" class="Field">GradedMonad.&gt;&gt;=-assoc</a> <a id="1529" class="Symbol">=</a> <a id="1531" class="Hole">{!!}</a>

    <a id="1541" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1555" class="Symbol">:</a> <a id="1557" href="Algebra.html#11269" class="Record">GradedComonad</a> <a id="1571" class="Symbol">(</a><a id="1572" href="Data.List.Properties.html#3936" class="Function">listMonoid</a> <a id="1583" class="Symbol">(</a><a id="1584" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1589" href="Control.Monad.Freer.html#450" class="Bound">ℓ₂</a> <a id="1592" class="Symbol">→</a> <a id="1594" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="1599" href="Control.Monad.Freer.html#453" class="Bound">ℓ₃</a><a id="1601" class="Symbol">))</a> <a id="1604" href="Control.Monad.Freer.html#1191" class="Bound">ℓ₁</a> <a id="1607" class="Symbol">_</a>
    <a id="1613" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1627" class="Symbol">.</a><a id="1628" href="Algebra.html#11385" class="Field">GradedComonad.𝐹</a> <a id="1644" class="Symbol">=</a> <a id="1646" href="Function.html#369" class="Function">flip</a> <a id="1651" href="Control.Monad.Freer.html#255" class="Datatype">Freer</a>
    <a id="1661" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1675" class="Symbol">.</a><a id="1676" href="Algebra.html#11415" class="Field">GradedComonad.extract</a> <a id="1698" class="Symbol">(</a><a id="1699" href="Control.Monad.Freer.html#352" class="InductiveConstructor">pure</a> <a id="1704" href="Control.Monad.Freer.html#1704" class="Bound">x</a><a id="1705" class="Symbol">)</a> <a id="1707" class="Symbol">=</a> <a id="1709" href="Control.Monad.Freer.html#1704" class="Bound">x</a>
    <a id="1715" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1729" class="Symbol">.</a><a id="1730" href="Algebra.html#11439" class="Field Operator">GradedComonad._=&gt;&gt;_</a> <a id="1750" class="Symbol">=</a> <a id="1752" href="Control.Monad.Freer.html#694" class="Function">extend</a>
    <a id="1763" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1777" class="Symbol">.</a><a id="1778" href="Algebra.html#11868" class="Field">GradedComonad.=&gt;&gt;-idʳ</a> <a id="1800" href="Control.Monad.Freer.html#1800" class="Bound">f</a> <a id="1802" class="Symbol">=</a> <a id="1804" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
    <a id="1813" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1827" class="Symbol">.</a><a id="1828" href="Algebra.html#11953" class="Field">GradedComonad.=&gt;&gt;-idˡ</a> <a id="1850" href="Control.Monad.Freer.html#1850" class="Bound">f</a> <a id="1852" class="Symbol">=</a> <a id="1854" class="Hole">{!!}</a>
    <a id="1863" href="Control.Monad.Freer.html#1541" class="Function">gradedComonad</a> <a id="1877" class="Symbol">.</a><a id="1878" href="Algebra.html#12052" class="Field">GradedComonad.=&gt;&gt;-assoc</a> <a id="1902" class="Symbol">=</a> <a id="1904" class="Hole">{!!}</a>
</pre></body></html>