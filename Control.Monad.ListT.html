<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.ListT</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--postfix-projections</a> <a id="45" class="Symbol">#-}</a>

<a id="50" class="Keyword">open</a> <a id="55" class="Keyword">import</a> <a id="62" href="Prelude.html" class="Module">Prelude</a>
<a id="70" class="Keyword">open</a> <a id="75" class="Keyword">import</a> <a id="82" href="Algebra.html" class="Module">Algebra</a>
<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="Container.html" class="Module">Container</a>

<a id="113" class="Keyword">module</a> <a id="120" href="Control.Monad.ListT.html" class="Module">Control.Monad.ListT</a>
  <a id="142" class="Symbol">(</a><a id="143" href="Control.Monad.ListT.html#143" class="Bound">𝔽</a> <a id="145" class="Symbol">:</a> <a id="147" href="Container.html#80" class="Function">Container</a><a id="156" class="Symbol">)</a>
  <a id="160" class="Symbol">(</a><a id="161" href="Control.Monad.ListT.html#161" class="Bound">is-mon</a> <a id="168" class="Symbol">:</a> <a id="170" href="Algebra.html#6522" class="Record">Monad</a>  <a id="177" href="Container.html#146" class="Function Operator">⟦</a> <a id="179" href="Control.Monad.ListT.html#143" class="Bound">𝔽</a> <a id="181" href="Container.html#146" class="Function Operator">⟧</a><a id="182" class="Symbol">)</a>
  <a id="186" class="Keyword">where</a>

<a id="193" class="Keyword">open</a> <a id="198" href="Algebra.html#6522" class="Module">Monad</a> <a id="204" class="Symbol">{</a><a id="205" class="Argument">ℓ₂</a> <a id="208" class="Symbol">=</a> <a id="210" href="Agda.Primitive.html#764" class="Primitive">ℓzero</a><a id="215" class="Symbol">}</a> <a id="217" href="Control.Monad.ListT.html#161" class="Bound">is-mon</a>

<a id="225" class="Keyword">postulate</a>
  <a id="cmap-return"></a><a id="237" href="Control.Monad.ListT.html#237" class="Postulate">cmap-return</a> <a id="249" class="Symbol">:</a> <a id="251" class="Symbol">(</a><a id="252" href="Control.Monad.ListT.html#252" class="Bound">f</a> <a id="254" class="Symbol">:</a> <a id="256" href="Level.html#282" class="Generalizable">A</a> <a id="258" class="Symbol">→</a> <a id="260" href="Level.html#296" class="Generalizable">B</a><a id="261" class="Symbol">)</a> <a id="263" class="Symbol">(</a><a id="264" href="Control.Monad.ListT.html#264" class="Bound">x</a> <a id="266" class="Symbol">:</a> <a id="268" href="Container.html#146" class="Function Operator">⟦</a> <a id="270" href="Control.Monad.ListT.html#143" class="Bound">𝔽</a> <a id="272" href="Container.html#146" class="Function Operator">⟧</a> <a id="274" href="Level.html#282" class="Generalizable">A</a><a id="275" class="Symbol">)</a> <a id="277" class="Symbol">→</a>
                <a id="295" class="Symbol">(</a><a id="296" href="Container.html#226" class="Function">cmap</a> <a id="301" href="Control.Monad.ListT.html#252" class="Bound">f</a> <a id="303" href="Control.Monad.ListT.html#264" class="Bound">x</a> <a id="305" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="307" class="Symbol">(</a><a id="308" href="Control.Monad.ListT.html#264" class="Bound">x</a> <a id="310" href="Algebra.html#6592" class="Field Operator">&gt;&gt;=</a> <a id="314" href="Algebra.html#6628" class="Field">return</a> <a id="321" href="Function.html#97" class="Function Operator">∘</a> <a id="323" href="Control.Monad.ListT.html#252" class="Bound">f</a><a id="324" class="Symbol">))</a>


<a id="329" class="Keyword">infixr</a> <a id="336" class="Number">5</a> <a id="338" href="Control.Monad.ListT.html#454" class="InductiveConstructor Operator">_∷_</a>
<a id="342" class="Keyword">mutual</a>
  <a id="List"></a><a id="351" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="356" class="Symbol">:</a> <a id="358" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="363" class="Symbol">→</a> <a id="365" href="Agda.Primitive.html#326" class="Primitive">Type</a>
  <a id="372" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="377" href="Control.Monad.ListT.html#377" class="Bound">A</a> <a id="379" class="Symbol">=</a> <a id="381" href="Container.html#146" class="Function Operator">⟦</a> <a id="383" href="Control.Monad.ListT.html#143" class="Bound">𝔽</a> <a id="385" href="Container.html#146" class="Function Operator">⟧</a> <a id="387" class="Symbol">(</a><a id="388" href="Control.Monad.ListT.html#404" class="Datatype">Cons</a> <a id="393" href="Control.Monad.ListT.html#377" class="Bound">A</a><a id="394" class="Symbol">)</a>

  <a id="399" class="Keyword">data</a> <a id="Cons"></a><a id="404" href="Control.Monad.ListT.html#404" class="Datatype">Cons</a> <a id="409" class="Symbol">(</a><a id="410" href="Control.Monad.ListT.html#410" class="Bound">A</a> <a id="412" class="Symbol">:</a> <a id="414" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="418" class="Symbol">)</a> <a id="420" class="Symbol">:</a> <a id="422" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="427" class="Keyword">where</a>
    <a id="Cons.[]"></a><a id="437" href="Control.Monad.ListT.html#437" class="InductiveConstructor">[]</a>  <a id="441" class="Symbol">:</a> <a id="443" href="Control.Monad.ListT.html#404" class="Datatype">Cons</a> <a id="448" href="Control.Monad.ListT.html#410" class="Bound">A</a>
    <a id="Cons._∷_"></a><a id="454" href="Control.Monad.ListT.html#454" class="InductiveConstructor Operator">_∷_</a> <a id="458" class="Symbol">:</a> <a id="460" class="Symbol">(</a><a id="461" href="Control.Monad.ListT.html#461" class="Bound">x</a> <a id="463" class="Symbol">:</a> <a id="465" href="Control.Monad.ListT.html#410" class="Bound">A</a><a id="466" class="Symbol">)</a> <a id="468" class="Symbol">→</a> <a id="470" class="Symbol">(</a><a id="471" href="Control.Monad.ListT.html#471" class="Bound">xs</a> <a id="474" class="Symbol">:</a> <a id="476" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="481" href="Control.Monad.ListT.html#410" class="Bound">A</a><a id="482" class="Symbol">)</a> <a id="484" class="Symbol">→</a> <a id="486" href="Control.Monad.ListT.html#404" class="Datatype">Cons</a> <a id="491" href="Control.Monad.ListT.html#410" class="Bound">A</a>

<a id="494" class="Keyword">data</a> <a id="ℭ𝔬𝔫𝔰"></a><a id="499" href="Control.Monad.ListT.html#499" class="Datatype">ℭ𝔬𝔫𝔰</a> <a id="504" class="Symbol">(</a><a id="505" href="Control.Monad.ListT.html#505" class="Bound">A</a> <a id="507" class="Symbol">:</a> <a id="509" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="513" class="Symbol">)</a> <a id="515" class="Symbol">(</a><a id="516" href="Control.Monad.ListT.html#516" class="Bound">P</a> <a id="518" class="Symbol">:</a> <a id="520" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="525" href="Control.Monad.ListT.html#505" class="Bound">A</a> <a id="527" class="Symbol">→</a> <a id="529" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="533" class="Symbol">)</a> <a id="535" class="Symbol">:</a> <a id="537" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="542" class="Keyword">where</a>
  <a id="ℭ𝔬𝔫𝔰.[]"></a><a id="550" href="Control.Monad.ListT.html#550" class="InductiveConstructor">[]</a> <a id="553" class="Symbol">:</a> <a id="555" href="Control.Monad.ListT.html#499" class="Datatype">ℭ𝔬𝔫𝔰</a> <a id="560" href="Control.Monad.ListT.html#505" class="Bound">A</a> <a id="562" href="Control.Monad.ListT.html#516" class="Bound">P</a>
  <a id="ℭ𝔬𝔫𝔰._∷_⟨_⟩"></a><a id="566" href="Control.Monad.ListT.html#566" class="InductiveConstructor Operator">_∷_⟨_⟩</a> <a id="573" class="Symbol">:</a> <a id="575" class="Symbol">(</a><a id="576" href="Control.Monad.ListT.html#576" class="Bound">x</a> <a id="578" class="Symbol">:</a> <a id="580" href="Control.Monad.ListT.html#505" class="Bound">A</a><a id="581" class="Symbol">)</a> <a id="583" class="Symbol">→</a> <a id="585" class="Symbol">(</a><a id="586" href="Control.Monad.ListT.html#586" class="Bound">xs</a> <a id="589" class="Symbol">:</a> <a id="591" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="596" href="Control.Monad.ListT.html#505" class="Bound">A</a><a id="597" class="Symbol">)</a> <a id="599" class="Symbol">→</a> <a id="601" class="Symbol">(</a><a id="602" href="Control.Monad.ListT.html#602" class="Bound">P⟨xs⟩</a> <a id="608" class="Symbol">:</a> <a id="610" href="Control.Monad.ListT.html#516" class="Bound">P</a> <a id="612" href="Control.Monad.ListT.html#586" class="Bound">xs</a><a id="614" class="Symbol">)</a> <a id="616" class="Symbol">→</a> <a id="618" href="Control.Monad.ListT.html#499" class="Datatype">ℭ𝔬𝔫𝔰</a> <a id="623" href="Control.Monad.ListT.html#505" class="Bound">A</a> <a id="625" href="Control.Monad.ListT.html#516" class="Bound">P</a>

<a id="628" class="Keyword">module</a> <a id="635" href="Control.Monad.ListT.html#635" class="Module">_</a> <a id="637" class="Symbol">{</a><a id="638" href="Control.Monad.ListT.html#638" class="Bound">A</a> <a id="640" class="Symbol">:</a> <a id="642" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="646" class="Symbol">}</a> <a id="648" class="Symbol">(</a><a id="649" href="Control.Monad.ListT.html#649" class="Bound">P</a> <a id="651" class="Symbol">:</a> <a id="653" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="658" href="Control.Monad.ListT.html#638" class="Bound">A</a> <a id="660" class="Symbol">→</a> <a id="662" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="666" class="Symbol">)</a> <a id="668" class="Keyword">where</a>
  <a id="676" href="Control.Monad.ListT.html#676" class="Function">wrapc</a> <a id="682" class="Symbol">:</a> <a id="684" href="Control.Monad.ListT.html#499" class="Datatype">ℭ𝔬𝔫𝔰</a> <a id="689" href="Control.Monad.ListT.html#638" class="Bound">A</a> <a id="691" href="Control.Monad.ListT.html#649" class="Bound">P</a> <a id="693" class="Symbol">→</a> <a id="695" href="Control.Monad.ListT.html#404" class="Datatype">Cons</a> <a id="700" href="Control.Monad.ListT.html#638" class="Bound">A</a>
  <a id="704" href="Control.Monad.ListT.html#676" class="Function">wrapc</a> <a id="710" href="Control.Monad.ListT.html#550" class="InductiveConstructor">[]</a> <a id="713" class="Symbol">=</a> <a id="715" href="Control.Monad.ListT.html#437" class="InductiveConstructor">[]</a>
  <a id="720" href="Control.Monad.ListT.html#676" class="Function">wrapc</a> <a id="726" class="Symbol">(</a><a id="727" href="Control.Monad.ListT.html#727" class="Bound">x</a> <a id="729" href="Control.Monad.ListT.html#566" class="InductiveConstructor Operator">∷</a> <a id="731" href="Control.Monad.ListT.html#731" class="Bound">xs</a> <a id="734" href="Control.Monad.ListT.html#566" class="InductiveConstructor Operator">⟨</a> <a id="736" href="Control.Monad.ListT.html#736" class="Bound">P⟨xs⟩</a> <a id="742" href="Control.Monad.ListT.html#566" class="InductiveConstructor Operator">⟩</a><a id="743" class="Symbol">)</a> <a id="745" class="Symbol">=</a> <a id="747" href="Control.Monad.ListT.html#727" class="Bound">x</a> <a id="749" href="Control.Monad.ListT.html#454" class="InductiveConstructor Operator">∷</a> <a id="751" href="Control.Monad.ListT.html#731" class="Bound">xs</a>

  <a id="757" href="Control.Monad.ListT.html#757" class="Function">wrap</a> <a id="762" class="Symbol">:</a> <a id="764" href="Container.html#146" class="Function Operator">⟦</a> <a id="766" href="Control.Monad.ListT.html#143" class="Bound">𝔽</a> <a id="768" href="Container.html#146" class="Function Operator">⟧</a> <a id="770" class="Symbol">(</a><a id="771" href="Control.Monad.ListT.html#499" class="Datatype">ℭ𝔬𝔫𝔰</a> <a id="776" href="Control.Monad.ListT.html#638" class="Bound">A</a> <a id="778" href="Control.Monad.ListT.html#649" class="Bound">P</a><a id="779" class="Symbol">)</a> <a id="781" class="Symbol">→</a> <a id="783" href="Control.Monad.ListT.html#351" class="Function">List</a> <a id="788" href="Control.Monad.ListT.html#638" class="Bound">A</a>
  <a id="792" href="Control.Monad.ListT.html#757" class="Function">wrap</a> <a id="797" class="Symbol">=</a> <a id="799" href="Container.html#226" class="Function">cmap</a> <a id="804" href="Control.Monad.ListT.html#676" class="Function">wrapc</a>
  <a id="812" class="Symbol">{-#</a> <a id="816" class="Keyword">INLINE</a> <a id="823" href="Control.Monad.ListT.html#757" class="Function">wrap</a> <a id="828" class="Symbol">#-}</a>

  <a id="835" class="Comment">-- module _ (ψ : (x : ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A P)) → P (wrap x)) where</a>
  <a id="897" class="Comment">--   elim : (x : List A) → P x</a>
  <a id="930" class="Comment">--   elim (n , k) = {!!}</a>

    <a id="960" class="Comment">-- elimc : Cons A → ℭ𝔬𝔫𝔰 A P</a>

    <a id="994" class="Comment">-- wrapc-elimc : (c : Cons A) → wrapc (elimc c) ≡ c</a>

    <a id="1051" class="Comment">-- wrapc-elimc []       i = []</a>
    <a id="1086" class="Comment">-- wrapc-elimc (x ∷ xs) i = x ∷ xs</a>

    <a id="1126" class="Comment">-- elimc [] = []</a>
    <a id="1147" class="Comment">-- elimc (x ∷ xs) = x ∷ xs ⟨ elim xs ⟩</a>

    <a id="1191" class="Comment">-- elim xs =</a>
    <a id="1208" class="Comment">--   subst</a>
    <a id="1223" class="Comment">--     P</a>
    <a id="1236" class="Comment">--     (cong (xs .fst ,_) (funExt (λ x → wrapc-elimc (xs .snd x))))</a>
    <a id="1308" class="Comment">--     (ψ (cmap elimc xs))</a>

<a id="1336" class="Comment">-- module _  (ϕ : ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A (const B)) → B) where</a>
<a id="1390" class="Comment">--   para : List A → B</a>
<a id="1413" class="Comment">--   parac : Cons A → ℭ𝔬𝔫𝔰 A (const B)</a>


<a id="1454" class="Comment">--   para xs = ϕ (cmap parac xs)</a>

<a id="1488" class="Comment">--   parac [] = []</a>
<a id="1507" class="Comment">--   parac (x ∷ xs) = x ∷ xs ⟨ para xs ⟩</a>

<a id="1549" class="Comment">-- ++-ϕ : List A → ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A (const (List A))) → List A</a>
<a id="1609" class="Comment">-- ++-ϕ ys xs = xs &gt;&gt;= λ { [] → ys ; (x ∷ _ ⟨ xs ⟩) → return (x ∷ xs) }</a>

<a id="1682" class="Comment">-- infixr 5 _++_</a>
<a id="1699" class="Comment">-- _++_ : List A → List A → List A</a>
<a id="1734" class="Comment">-- xs ++ ys = para (++-ϕ ys) xs</a>

<a id="1767" class="Comment">-- cmap-comp : (f : B → C) (g : A → B) (x : ⟦ 𝔽 ⟧ A) → cmap f (cmap g x) ≡ cmap (f ∘ g) x</a>
<a id="1857" class="Comment">-- cmap-comp f g x = refl</a>

<a id="1884" class="Comment">-- cmap-id : (x : ⟦ 𝔽 ⟧ A) → cmap id x ≡ x</a>
<a id="1927" class="Comment">-- cmap-id x = refl</a>

<a id="1948" class="Comment">-- open import Path.Reasoning</a>

<a id="1979" class="Comment">-- ++-id : (xs : List A) → xs ++ return [] ≡ xs</a>
<a id="2027" class="Comment">-- ++-id {A = A} = elim P ψ</a>
<a id="2055" class="Comment">--   where</a>
<a id="2066" class="Comment">--   P : List A → Type</a>
<a id="2089" class="Comment">--   P xs = xs ++ return [] ≡ xs</a>

<a id="2123" class="Comment">--   ϕ : ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A (const (List A))) → List A</a>
<a id="2173" class="Comment">--   ϕ = ++-ϕ (return [])</a>

<a id="2200" class="Comment">--   ϕ′ : ℭ𝔬𝔫𝔰 A (const (List A)) → Cons A</a>
<a id="2243" class="Comment">--   ϕ′ [] = []</a>
<a id="2259" class="Comment">--   ϕ′ (x ∷ xs ⟨ P⟨xs⟩ ⟩) = x ∷ P⟨xs⟩</a>

<a id="2299" class="Comment">--   ϕ≡ : ∀ xs → ϕ xs ≡ (xs &gt;&gt;= return ∘′ ϕ′)</a>
<a id="2345" class="Comment">--   ϕ≡ xs = cong (xs &gt;&gt;=_) (funExt (λ { [] → refl ; (x ∷ xs ⟨ P⟨xs⟩ ⟩) → refl }))</a>

<a id="2429" class="Comment">--   lemma : (xs : ℭ𝔬𝔫𝔰 A P) → ϕ′ (parac ϕ (wrapc P xs)) ≡ wrapc P xs</a>
<a id="2499" class="Comment">--   lemma [] = refl</a>
<a id="2520" class="Comment">--   lemma (x ∷ xs ⟨ P⟨xs⟩ ⟩) = cong (x ∷_) P⟨xs⟩</a>

<a id="2571" class="Comment">--   ψ : (xs : ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A P)) → P (wrap P xs)</a>
<a id="2620" class="Comment">--   ψ xs =</a>
<a id="2632" class="Comment">--     wrap P xs ++ return [] ≡⟨⟩</a>
<a id="2666" class="Comment">--     para ϕ (wrap P xs) ≡⟨⟩</a>
<a id="2696" class="Comment">--     ϕ (cmap (parac ϕ) (wrap P xs)) ≡⟨ ϕ≡ _ ⟩</a>
<a id="2744" class="Comment">--     (cmap (parac ϕ) (wrap P xs) &gt;&gt;= return ∘′ ϕ′) ≡˘⟨ cmap-return ϕ′ _ ⟩</a>
<a id="2820" class="Comment">--     cmap ϕ′ (cmap (parac ϕ) (wrap P xs)) ≡⟨⟩</a>
<a id="2868" class="Comment">--     cmap (ϕ′ ∘ parac ϕ) (wrap P xs) ≡⟨⟩</a>
<a id="2911" class="Comment">--     cmap (ϕ′ ∘ parac ϕ) (cmap (wrapc P) xs) ≡⟨⟩</a>
<a id="2962" class="Comment">--     cmap (ϕ′ ∘ parac ϕ ∘ wrapc P) xs ≡⟨ cong (flip cmap xs) (funExt lemma) ⟩</a>
<a id="3042" class="Comment">--     wrap P xs ∎</a>


<a id="3063" class="Comment">-- -- open import Cubical.Data.Sigma.Properties</a>

<a id="3112" class="Comment">-- -- ++-assoc : (xs ys zs : List A) → (xs ++ ys) ++ zs ≡ xs ++ (ys ++ zs)</a>
<a id="3187" class="Comment">-- -- ++-assoc {A = A} xs ys zs = elim P ψ xs</a>
<a id="3233" class="Comment">-- --   where</a>
<a id="3247" class="Comment">-- --   P : List A → Type</a>
<a id="3273" class="Comment">-- --   P xs′ = (xs′ ++ ys) ++ zs ≡ xs′ ++ (ys ++ zs)</a>
<a id="3327" class="Comment">-- --   {-# INLINE P #-}</a>

<a id="3353" class="Comment">-- --   ψ : (x : ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A P)) → P (wrap P x)</a>
<a id="3403" class="Comment">-- --   ψ xs = ΣPathTransport→PathΣ _ _ ({!refl!} , {!!})</a>

<a id="3462" class="Comment">-- -- _&gt;&gt;=′_ : List A → (A → List B) → List B</a>
<a id="3508" class="Comment">-- -- _&gt;&gt;=′_ {A = A} {B = B} xs k = para ϕ xs</a>
<a id="3554" class="Comment">-- --   where</a>
<a id="3568" class="Comment">-- --   ϕ : ⟦ 𝔽 ⟧ (ℭ𝔬𝔫𝔰 A (List B)) → List B</a>
<a id="3613" class="Comment">-- --   ϕ xs = xs &gt;&gt;= λ { [] → return [] ; (x ∷ xs) → k x ++ xs }</a>
</pre></body></html>