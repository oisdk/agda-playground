<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Codata.Stream</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--guardedness</a> <a id="44" class="Pragma">--postfix-projections</a> <a id="66" class="Symbol">#-}</a>

<a id="71" class="Keyword">module</a> <a id="78" href="Codata.Stream.html" class="Module">Codata.Stream</a> <a id="92" class="Keyword">where</a>

<a id="99" class="Keyword">open</a> <a id="104" class="Keyword">import</a> <a id="111" href="Prelude.html" class="Module">Prelude</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="Data.List.html" class="Module">Data.List</a> <a id="141" class="Keyword">using</a> <a id="147" class="Symbol">(</a><a id="148" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="152" class="Symbol">;</a> <a id="154" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="157" class="Symbol">;</a> <a id="159" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="161" class="Symbol">)</a>
<a id="163" class="Keyword">open</a> <a id="168" class="Keyword">import</a> <a id="175" href="Data.List.Kleene.html" class="Module">Data.List.Kleene</a>
<a id="192" class="Keyword">import</a> <a id="199" href="Data.List.Kleene.Membership.html" class="Module">Data.List.Kleene.Membership</a> <a id="227" class="Symbol">as</a> <a id="230" class="Module">Kleene</a>
<a id="237" class="Keyword">open</a> <a id="242" class="Keyword">import</a> <a id="249" href="Data.Fin.html" class="Module">Data.Fin</a>

<a id="259" class="Keyword">infixr</a> <a id="266" class="Number">5</a> <a id="268" href="Codata.Stream.html#328" class="CoinductiveConstructor Operator">_◃_</a>
<a id="272" class="Keyword">record</a> <a id="Stream"></a><a id="279" href="Codata.Stream.html#279" class="Record">Stream</a> <a id="286" class="Symbol">(</a><a id="287" href="Codata.Stream.html#287" class="Bound">A</a> <a id="289" class="Symbol">:</a> <a id="291" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="296" href="Level.html#266" class="Generalizable">a</a><a id="297" class="Symbol">)</a> <a id="299" class="Symbol">:</a> <a id="301" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="306" href="Codata.Stream.html#296" class="Bound">a</a> <a id="308" class="Keyword">where</a>
  <a id="316" class="Keyword">constructor</a> <a id="_◃_"></a><a id="328" href="Codata.Stream.html#328" class="CoinductiveConstructor Operator">_◃_</a>
  <a id="334" class="Keyword">coinductive</a>
  <a id="348" class="Keyword">field</a>
    <a id="Stream.head"></a><a id="358" href="Codata.Stream.html#358" class="Field">head</a>  <a id="364" class="Symbol">:</a> <a id="366" href="Codata.Stream.html#287" class="Bound">A</a>
    <a id="Stream.tail"></a><a id="372" href="Codata.Stream.html#372" class="Field">tail</a>  <a id="378" class="Symbol">:</a> <a id="380" href="Codata.Stream.html#279" class="Record">Stream</a> <a id="387" href="Codata.Stream.html#287" class="Bound">A</a>
<a id="389" class="Keyword">open</a> <a id="394" href="Codata.Stream.html#279" class="Module">Stream</a> <a id="401" class="Keyword">public</a>

<a id="Stream′"></a><a id="409" href="Codata.Stream.html#409" class="Function">Stream′</a> <a id="417" class="Symbol">:</a> <a id="419" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="424" href="Level.html#266" class="Generalizable">a</a> <a id="426" class="Symbol">→</a> <a id="428" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="433" href="Level.html#266" class="Generalizable">a</a>
<a id="435" href="Codata.Stream.html#409" class="Function">Stream′</a> <a id="443" href="Codata.Stream.html#443" class="Bound">A</a> <a id="445" class="Symbol">=</a> <a id="447" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="449" class="Symbol">→</a> <a id="451" href="Codata.Stream.html#443" class="Bound">A</a>

<a id="_!_"></a><a id="454" href="Codata.Stream.html#454" class="Function Operator">_!_</a> <a id="458" class="Symbol">:</a> <a id="460" href="Codata.Stream.html#279" class="Record">Stream</a> <a id="467" href="Level.html#282" class="Generalizable">A</a> <a id="469" class="Symbol">→</a> <a id="471" href="Codata.Stream.html#409" class="Function">Stream′</a> <a id="479" href="Level.html#282" class="Generalizable">A</a>
<a id="481" href="Codata.Stream.html#481" class="Bound">xs</a> <a id="484" href="Codata.Stream.html#454" class="Function Operator">!</a> <a id="486" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="492" class="Symbol">=</a> <a id="494" href="Codata.Stream.html#481" class="Bound">xs</a> <a id="497" class="Symbol">.</a><a id="498" href="Codata.Stream.html#358" class="Field">head</a>
<a id="503" href="Codata.Stream.html#503" class="Bound">xs</a> <a id="506" href="Codata.Stream.html#454" class="Function Operator">!</a> <a id="508" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="512" href="Codata.Stream.html#512" class="Bound">n</a> <a id="514" class="Symbol">=</a> <a id="516" href="Codata.Stream.html#503" class="Bound">xs</a> <a id="519" class="Symbol">.</a><a id="520" href="Codata.Stream.html#372" class="Field">tail</a> <a id="525" href="Codata.Stream.html#454" class="Function Operator">!</a> <a id="527" href="Codata.Stream.html#512" class="Bound">n</a>

<a id="tabulate"></a><a id="530" href="Codata.Stream.html#530" class="Function">tabulate</a> <a id="539" class="Symbol">:</a> <a id="541" href="Codata.Stream.html#409" class="Function">Stream′</a> <a id="549" href="Level.html#282" class="Generalizable">A</a> <a id="551" class="Symbol">→</a> <a id="553" href="Codata.Stream.html#279" class="Record">Stream</a> <a id="560" href="Level.html#282" class="Generalizable">A</a>
<a id="562" href="Codata.Stream.html#530" class="Function">tabulate</a> <a id="571" href="Codata.Stream.html#571" class="Bound">xs</a> <a id="574" class="Symbol">.</a><a id="575" href="Codata.Stream.html#358" class="Field">head</a> <a id="580" class="Symbol">=</a> <a id="582" href="Codata.Stream.html#571" class="Bound">xs</a> <a id="585" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="590" href="Codata.Stream.html#530" class="Function">tabulate</a> <a id="599" href="Codata.Stream.html#599" class="Bound">xs</a> <a id="602" class="Symbol">.</a><a id="603" href="Codata.Stream.html#372" class="Field">tail</a> <a id="608" class="Symbol">=</a> <a id="610" href="Codata.Stream.html#530" class="Function">tabulate</a> <a id="619" class="Symbol">(</a><a id="620" href="Codata.Stream.html#599" class="Bound">xs</a> <a id="623" href="Function.html#97" class="Function Operator">∘</a> <a id="625" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="628" class="Symbol">)</a>

<a id="linv"></a><a id="631" href="Codata.Stream.html#631" class="Function">linv</a> <a id="636" class="Symbol">:</a> <a id="638" class="Symbol">(</a><a id="639" href="Codata.Stream.html#639" class="Bound">xs</a> <a id="642" class="Symbol">:</a> <a id="644" href="Codata.Stream.html#279" class="Record">Stream</a> <a id="651" href="Level.html#282" class="Generalizable">A</a><a id="652" class="Symbol">)</a> <a id="654" class="Symbol">→</a> <a id="656" href="Codata.Stream.html#530" class="Function">tabulate</a> <a id="665" class="Symbol">(</a><a id="666" href="Codata.Stream.html#639" class="Bound">xs</a> <a id="669" href="Codata.Stream.html#454" class="Function Operator">!_</a><a id="671" class="Symbol">)</a> <a id="673" href="Agda.Builtin.Cubical.Path.html#388" class="Function Operator">≡</a> <a id="675" href="Codata.Stream.html#639" class="Bound">xs</a>
<a id="678" href="Codata.Stream.html#631" class="Function">linv</a> <a id="683" href="Codata.Stream.html#683" class="Bound">xs</a> <a id="686" href="Codata.Stream.html#686" class="Bound">i</a> <a id="688" class="Symbol">.</a><a id="689" href="Codata.Stream.html#358" class="Field">head</a> <a id="694" class="Symbol">=</a> <a id="696" href="Codata.Stream.html#683" class="Bound">xs</a> <a id="699" class="Symbol">.</a><a id="700" href="Codata.Stream.html#358" class="Field">head</a>
<a id="705" href="Codata.Stream.html#631" class="Function">linv</a> <a id="710" href="Codata.Stream.html#710" class="Bound">xs</a> <a id="713" href="Codata.Stream.html#713" class="Bound">i</a> <a id="715" class="Symbol">.</a><a id="716" href="Codata.Stream.html#372" class="Field">tail</a> <a id="721" class="Symbol">=</a> <a id="723" href="Codata.Stream.html#631" class="Function">linv</a> <a id="728" class="Symbol">(</a><a id="729" href="Codata.Stream.html#710" class="Bound">xs</a> <a id="732" class="Symbol">.</a><a id="733" href="Codata.Stream.html#372" class="Field">tail</a><a id="737" class="Symbol">)</a> <a id="739" href="Codata.Stream.html#713" class="Bound">i</a>

<a id="rinv"></a><a id="742" href="Codata.Stream.html#742" class="Function">rinv</a> <a id="747" class="Symbol">:</a> <a id="749" class="Symbol">(</a><a id="750" href="Codata.Stream.html#750" class="Bound">xs</a> <a id="753" class="Symbol">:</a> <a id="755" href="Codata.Stream.html#409" class="Function">Stream′</a> <a id="763" href="Level.html#282" class="Generalizable">A</a><a id="764" class="Symbol">)</a> <a id="766" class="Symbol">→</a> <a id="768" class="Symbol">(</a><a id="769" href="Codata.Stream.html#530" class="Function">tabulate</a> <a id="778" href="Codata.Stream.html#750" class="Bound">xs</a> <a id="781" href="Codata.Stream.html#454" class="Function Operator">!_</a><a id="783" class="Symbol">)</a> <a id="785" href="Agda.Builtin.Cubical.Path.html#388" class="Function Operator">≡</a> <a id="787" href="Codata.Stream.html#750" class="Bound">xs</a>
<a id="790" href="Codata.Stream.html#742" class="Function">rinv</a> <a id="795" href="Codata.Stream.html#795" class="Bound">xs</a> <a id="798" href="Codata.Stream.html#798" class="Bound">i</a> <a id="800" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="808" class="Symbol">=</a> <a id="810" href="Codata.Stream.html#795" class="Bound">xs</a> <a id="813" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="818" href="Codata.Stream.html#742" class="Function">rinv</a> <a id="823" href="Codata.Stream.html#823" class="Bound">xs</a> <a id="826" href="Codata.Stream.html#826" class="Bound">i</a> <a id="828" class="Symbol">(</a><a id="829" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="833" href="Codata.Stream.html#833" class="Bound">n</a><a id="834" class="Symbol">)</a> <a id="836" class="Symbol">=</a> <a id="838" href="Codata.Stream.html#742" class="Function">rinv</a> <a id="843" class="Symbol">(</a><a id="844" href="Codata.Stream.html#823" class="Bound">xs</a> <a id="847" href="Function.html#97" class="Function Operator">∘</a> <a id="849" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a><a id="852" class="Symbol">)</a> <a id="854" href="Codata.Stream.html#826" class="Bound">i</a> <a id="856" href="Codata.Stream.html#833" class="Bound">n</a>

<a id="stream"></a><a id="859" href="Codata.Stream.html#859" class="Function">stream</a> <a id="866" class="Symbol">:</a> <a id="868" href="Codata.Stream.html#279" class="Record">Stream</a> <a id="875" href="Level.html#282" class="Generalizable">A</a> <a id="877" href="Function.Isomorphism.html#338" class="Function Operator">⇔</a> <a id="879" href="Codata.Stream.html#409" class="Function">Stream′</a> <a id="887" href="Level.html#282" class="Generalizable">A</a>
<a id="889" href="Codata.Stream.html#859" class="Function">stream</a> <a id="896" class="Symbol">.</a><a id="897" href="Cubical.Foundations.Isomorphism.html#882" class="Field">fun</a> <a id="901" class="Symbol">=</a> <a id="903" href="Codata.Stream.html#454" class="Function Operator">_!_</a>
<a id="907" href="Codata.Stream.html#859" class="Function">stream</a> <a id="914" class="Symbol">.</a><a id="915" href="Cubical.Foundations.Isomorphism.html#898" class="Field">inv</a> <a id="919" class="Symbol">=</a> <a id="921" href="Codata.Stream.html#530" class="Function">tabulate</a>
<a id="930" href="Codata.Stream.html#859" class="Function">stream</a> <a id="937" class="Symbol">.</a><a id="938" href="Cubical.Foundations.Isomorphism.html#914" class="Field">rightInv</a> <a id="947" class="Symbol">=</a> <a id="949" href="Codata.Stream.html#742" class="Function">rinv</a>
<a id="954" href="Codata.Stream.html#859" class="Function">stream</a> <a id="961" class="Symbol">.</a><a id="962" href="Cubical.Foundations.Isomorphism.html#945" class="Field">leftInv</a> <a id="970" class="Symbol">=</a> <a id="972" href="Codata.Stream.html#631" class="Function">linv</a>



<a id="980" class="Comment">-- infixr 5 _∈_</a>
<a id="996" class="Comment">-- _∈_ : A → Stream A → Type _</a>
<a id="1027" class="Comment">-- x ∈ xs = fiber xs x</a>

<a id="1051" class="Comment">-- toList : ℕ → Stream A → List A</a>
<a id="1085" class="Comment">-- toList zero xs = []</a>
<a id="1108" class="Comment">-- toList (suc n) xs = xs zero ∷ toList n (xs ∘ suc)</a>

<a id="1162" class="Comment">-- mutual</a>
<a id="1172" class="Comment">--   concat⋆ : A ⋆ → Stream (A ⁺) → Stream A</a>
<a id="1217" class="Comment">--   concat⋆ []    xs = concat⁺ (xs zero) (xs ∘ suc)</a>
<a id="1270" class="Comment">--   concat⋆ (∹ x) xs = concat⁺ x xs</a>

<a id="1308" class="Comment">--   concat⁺ : A ⁺ → Stream (A ⁺) → Stream A</a>
<a id="1353" class="Comment">--   concat⁺ x xs zero    = x .head</a>
<a id="1389" class="Comment">--   concat⁺ x xs (suc n) = concat⋆ (x .tail) xs n</a>

<a id="1441" class="Comment">-- concat : Stream (A ⁺) → Stream A</a>
<a id="1477" class="Comment">-- concat xs = concat⁺ (xs zero) (xs ∘ suc)</a>

<a id="1522" class="Comment">-- infixr 5 _∈²_</a>
<a id="1539" class="Comment">-- _∈²_ : A → Stream (A ⁺) → Type _</a>
<a id="1575" class="Comment">-- x ∈² xs = ∃ n x Kleene.∈⁺ xs n</a>

<a id="1610" class="Comment">-- mutual</a>
<a id="1620" class="Comment">--   ◇++⋆ : ∀ (x : A) y ys → x Kleene.∈⋆ y → x ∈ concat⋆ y ys</a>
<a id="1682" class="Comment">--   ◇++⋆ x (∹ y) ys x∈y = ◇++⁺ x y ys x∈y</a>

<a id="1726" class="Comment">--   ◇++⁺ : ∀ (x : A) y ys → x Kleene.∈⁺ y → x ∈ concat⁺ y ys</a>
<a id="1788" class="Comment">--   ◇++⁺ x y ys (f0 , x∈y) = zero , x∈y</a>
<a id="1829" class="Comment">--   ◇++⁺ x y ys (fs n , x∈y) = let m , p = ◇++⋆ x (y .tail) ys (n , x∈y) in suc m , p</a>

<a id="1917" class="Comment">-- mutual</a>
<a id="1927" class="Comment">--   ++◇⋆ : ∀ (x : A) y ys → x ∈ concat ys → x ∈ concat⋆ y ys</a>
<a id="1989" class="Comment">--   ++◇⋆ x [] ys x∈ys = x∈ys</a>
<a id="2019" class="Comment">--   ++◇⋆ x (∹ y) ys x∈ys = ++◇⁺ x y ys x∈ys</a>

<a id="2065" class="Comment">--   ++◇⁺ : ∀ (x : A) y ys → x ∈ concat ys → x ∈ concat⁺ y ys</a>
<a id="2127" class="Comment">--   ++◇⁺ x y ys x∈ys = let n , p = ++◇⋆ x (y .tail) ys x∈ys in suc n , p</a>

<a id="2202" class="Comment">-- concat-∈ : ∀ (x : A) xs → x ∈² xs → x ∈ concat xs</a>
<a id="2255" class="Comment">-- concat-∈ x xs (zero  , x∈xs) = ◇++⁺ x (xs zero) (xs ∘ suc) x∈xs</a>
<a id="2322" class="Comment">-- concat-∈ x xs (suc n , x∈xs) = ++◇⁺ x (xs zero) (xs ∘ suc) (concat-∈ x (xs ∘ suc) (n , x∈xs))</a>
</pre></body></html>