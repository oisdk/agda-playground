<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>TreeFold</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="TreeFold.html" class="Module">TreeFold</a> <a id="51" class="Keyword">where</a>

<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="Prelude.html" class="Module">Prelude</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Data.List.html" class="Module">Data.List</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Algebra.html" class="Module">Algebra</a> <a id="120" class="Keyword">using</a> <a id="126" class="Symbol">(</a><a id="127" href="Algebra.html#129" class="Function">Associative</a><a id="138" class="Symbol">)</a>
<a id="140" class="Keyword">open</a> <a id="145" class="Keyword">import</a> <a id="152" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="173" class="Keyword">using</a> <a id="179" class="Symbol">(</a><a id="180" href="Data.List.Properties.html#1573" class="Function">foldr-fusion</a><a id="192" class="Symbol">)</a>

<a id="195" class="Keyword">infixr</a> <a id="202" class="Number">5</a> <a id="204" href="TreeFold.html#277" class="InductiveConstructor Operator">_^_&amp;_</a>
<a id="210" class="Keyword">record</a> <a id="Spine"></a><a id="217" href="TreeFold.html#217" class="Record">Spine</a> <a id="223" class="Symbol">(</a><a id="224" href="TreeFold.html#224" class="Bound">A</a> <a id="226" class="Symbol">:</a> <a id="228" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="233" href="Level.html#239" class="Generalizable">a</a><a id="234" class="Symbol">)</a> <a id="236" class="Symbol">:</a> <a id="238" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="243" href="TreeFold.html#233" class="Bound">a</a> <a id="245" class="Keyword">where</a>
  <a id="253" class="Keyword">inductive</a>
  <a id="265" class="Keyword">constructor</a> <a id="_^_&amp;_"></a><a id="277" href="TreeFold.html#277" class="InductiveConstructor Operator">_^_&amp;_</a>
  <a id="285" class="Keyword">field</a>
    <a id="Spine.depth"></a><a id="295" href="TreeFold.html#295" class="Field">depth</a> <a id="301" class="Symbol">:</a> <a id="303" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
    <a id="Spine.val"></a><a id="309" href="TreeFold.html#309" class="Field">val</a> <a id="313" class="Symbol">:</a> <a id="315" href="TreeFold.html#224" class="Bound">A</a>
    <a id="Spine.tail"></a><a id="321" href="TreeFold.html#321" class="Field">tail</a> <a id="326" class="Symbol">:</a> <a id="328" href="Data.Maybe.Base.html#91" class="Datatype">Maybe</a> <a id="334" class="Symbol">(</a><a id="335" href="TreeFold.html#217" class="Record">Spine</a> <a id="341" href="TreeFold.html#224" class="Bound">A</a><a id="342" class="Symbol">)</a>

<a id="345" class="Keyword">module</a> <a id="TheFold"></a><a id="352" href="TreeFold.html#352" class="Module">TheFold</a> <a id="360" class="Symbol">(</a><a id="361" href="TreeFold.html#361" class="Bound">f</a> <a id="363" class="Symbol">:</a> <a id="365" href="Level.html#255" class="Generalizable">A</a> <a id="367" class="Symbol">→</a> <a id="369" href="Level.html#255" class="Generalizable">A</a> <a id="371" class="Symbol">→</a> <a id="373" href="Level.html#255" class="Generalizable">A</a><a id="374" class="Symbol">)</a> <a id="376" class="Symbol">(</a><a id="377" href="TreeFold.html#377" class="Bound">z</a> <a id="379" class="Symbol">:</a> <a id="381" href="Level.html#255" class="Generalizable">A</a><a id="382" class="Symbol">)</a> <a id="384" class="Keyword">where</a>
  <a id="392" class="Keyword">infixr</a> <a id="399" class="Number">5</a> <a id="401" href="TreeFold.html#409" class="Function Operator">_^_∹_</a>
  <a id="TheFold._^_∹_"></a><a id="409" href="TreeFold.html#409" class="Function Operator">_^_∹_</a> <a id="415" class="Symbol">:</a> <a id="417" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="419" class="Symbol">→</a> <a id="421" href="TreeFold.html#365" class="Bound">A</a> <a id="423" class="Symbol">→</a> <a id="425" href="TreeFold.html#217" class="Record">Spine</a> <a id="431" href="TreeFold.html#365" class="Bound">A</a> <a id="433" class="Symbol">→</a> <a id="435" href="TreeFold.html#217" class="Record">Spine</a> <a id="441" href="TreeFold.html#365" class="Bound">A</a>
  <a id="445" href="TreeFold.html#445" class="Bound">n</a> <a id="447" href="TreeFold.html#409" class="Function Operator">^</a> <a id="449" href="TreeFold.html#449" class="Bound">x</a> <a id="451" href="TreeFold.html#409" class="Function Operator">∹</a> <a id="453" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="459" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="461" href="TreeFold.html#461" class="Bound">y</a> <a id="463" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="465" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a> <a id="473" class="Symbol">=</a> <a id="475" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="479" href="TreeFold.html#445" class="Bound">n</a> <a id="481" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="483" href="TreeFold.html#361" class="Bound">f</a> <a id="485" href="TreeFold.html#449" class="Bound">x</a> <a id="487" href="TreeFold.html#461" class="Bound">y</a> <a id="489" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="491" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a>
  <a id="501" href="TreeFold.html#501" class="Bound">n</a> <a id="503" href="TreeFold.html#409" class="Function Operator">^</a> <a id="505" href="TreeFold.html#505" class="Bound">x</a> <a id="507" href="TreeFold.html#409" class="Function Operator">∹</a> <a id="509" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="515" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="517" href="TreeFold.html#517" class="Bound">y</a> <a id="519" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="521" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="526" href="TreeFold.html#526" class="Bound">xs</a> <a id="529" class="Symbol">=</a> <a id="531" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="535" href="TreeFold.html#501" class="Bound">n</a> <a id="537" href="TreeFold.html#409" class="Function Operator">^</a> <a id="539" href="TreeFold.html#361" class="Bound">f</a> <a id="541" href="TreeFold.html#505" class="Bound">x</a> <a id="543" href="TreeFold.html#517" class="Bound">y</a> <a id="545" href="TreeFold.html#409" class="Function Operator">∹</a> <a id="547" href="TreeFold.html#526" class="Bound">xs</a>
  <a id="552" href="TreeFold.html#552" class="Bound">n</a> <a id="554" href="TreeFold.html#409" class="Function Operator">^</a> <a id="556" href="TreeFold.html#556" class="Bound">x</a> <a id="558" href="TreeFold.html#409" class="Function Operator">∹</a> <a id="560" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="564" href="TreeFold.html#564" class="Bound">m</a> <a id="566" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="568" href="TreeFold.html#568" class="Bound">y</a> <a id="570" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="572" href="TreeFold.html#572" class="Bound">xs</a>      <a id="580" class="Symbol">=</a> <a id="582" href="TreeFold.html#552" class="Bound">n</a> <a id="584" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="586" href="TreeFold.html#556" class="Bound">x</a> <a id="588" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="590" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="595" class="Symbol">(</a><a id="596" href="TreeFold.html#564" class="Bound">m</a> <a id="598" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="600" href="TreeFold.html#568" class="Bound">y</a> <a id="602" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="604" href="TreeFold.html#572" class="Bound">xs</a><a id="606" class="Symbol">)</a>

  <a id="TheFold.⟦_⟧⇑"></a><a id="611" href="TreeFold.html#611" class="Function Operator">⟦_⟧⇑</a> <a id="616" class="Symbol">:</a> <a id="618" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="623" href="TreeFold.html#365" class="Bound">A</a> <a id="625" class="Symbol">→</a> <a id="627" href="TreeFold.html#217" class="Record">Spine</a> <a id="633" href="TreeFold.html#365" class="Bound">A</a>
  <a id="637" href="TreeFold.html#611" class="Function Operator">⟦_⟧⇑</a> <a id="642" class="Symbol">=</a> <a id="644" href="Data.List.Base.html#191" class="Function">foldr</a> <a id="650" class="Symbol">(</a><a id="651" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="656" href="TreeFold.html#409" class="Function Operator">^_∹_</a><a id="660" class="Symbol">)</a> <a id="662" class="Symbol">(</a><a id="663" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="668" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="670" href="TreeFold.html#377" class="Bound">z</a> <a id="672" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="674" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a><a id="681" class="Symbol">)</a>

  <a id="TheFold.⟦_⟧⇓"></a><a id="686" href="TreeFold.html#686" class="Function Operator">⟦_⟧⇓</a> <a id="691" class="Symbol">:</a> <a id="693" href="TreeFold.html#217" class="Record">Spine</a> <a id="699" href="TreeFold.html#365" class="Bound">A</a> <a id="701" class="Symbol">→</a> <a id="703" href="TreeFold.html#365" class="Bound">A</a>
  <a id="707" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="709" class="Symbol">_</a> <a id="711" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="713" href="TreeFold.html#713" class="Bound">x</a> <a id="715" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="717" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a> <a id="725" href="TreeFold.html#686" class="Function Operator">⟧⇓</a> <a id="728" class="Symbol">=</a> <a id="730" href="TreeFold.html#713" class="Bound">x</a>
  <a id="734" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="736" class="Symbol">_</a> <a id="738" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="740" href="TreeFold.html#740" class="Bound">x</a> <a id="742" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="744" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="749" href="TreeFold.html#749" class="Bound">xs</a> <a id="752" href="TreeFold.html#686" class="Function Operator">⟧⇓</a> <a id="755" class="Symbol">=</a> <a id="757" href="TreeFold.html#361" class="Bound">f</a> <a id="759" href="TreeFold.html#740" class="Bound">x</a> <a id="761" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="763" href="TreeFold.html#749" class="Bound">xs</a> <a id="766" href="TreeFold.html#686" class="Function Operator">⟧⇓</a>

  <a id="TheFold.treeFold"></a><a id="772" href="TreeFold.html#772" class="Function">treeFold</a> <a id="781" class="Symbol">:</a> <a id="783" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="788" href="TreeFold.html#365" class="Bound">A</a> <a id="790" class="Symbol">→</a> <a id="792" href="TreeFold.html#365" class="Bound">A</a>
  <a id="796" href="TreeFold.html#772" class="Function">treeFold</a> <a id="805" class="Symbol">=</a> <a id="807" href="TreeFold.html#686" class="Function Operator">⟦_⟧⇓</a> <a id="812" href="Function.html#97" class="Function Operator">∘</a> <a id="814" href="TreeFold.html#611" class="Function Operator">⟦_⟧⇑</a>

  <a id="822" class="Keyword">module</a> <a id="829" href="TreeFold.html#829" class="Module">_</a> <a id="831" class="Symbol">(</a><a id="832" href="TreeFold.html#832" class="Bound">f-assoc</a> <a id="840" class="Symbol">:</a> <a id="842" href="Algebra.html#129" class="Function">Associative</a> <a id="854" href="TreeFold.html#361" class="Bound">f</a><a id="855" class="Symbol">)</a> <a id="857" class="Keyword">where</a>
    <a id="867" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="873" class="Symbol">:</a> <a id="875" class="Symbol">∀</a> <a id="877" href="TreeFold.html#877" class="Bound">n</a> <a id="879" href="TreeFold.html#879" class="Bound">x</a> <a id="881" href="TreeFold.html#881" class="Bound">xs</a> <a id="884" class="Symbol">→</a> <a id="886" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="888" href="TreeFold.html#877" class="Bound">n</a> <a id="890" href="TreeFold.html#409" class="Function Operator">^</a> <a id="892" href="TreeFold.html#879" class="Bound">x</a> <a id="894" href="TreeFold.html#409" class="Function Operator">∹</a> <a id="896" href="TreeFold.html#881" class="Bound">xs</a> <a id="899" href="TreeFold.html#686" class="Function Operator">⟧⇓</a> <a id="902" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="904" href="TreeFold.html#361" class="Bound">f</a> <a id="906" href="TreeFold.html#879" class="Bound">x</a> <a id="908" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="910" href="TreeFold.html#881" class="Bound">xs</a> <a id="913" href="TreeFold.html#686" class="Function Operator">⟧⇓</a>
    <a id="920" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="926" href="TreeFold.html#926" class="Bound">n</a> <a id="928" href="TreeFold.html#928" class="Bound">x</a> <a id="930" class="Symbol">(</a><a id="931" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="937" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="939" class="Symbol">_</a> <a id="941" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="943" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a><a id="950" class="Symbol">)</a> <a id="952" class="Symbol">=</a> <a id="954" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
    <a id="963" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="969" href="TreeFold.html#969" class="Bound">n</a> <a id="971" href="TreeFold.html#971" class="Bound">x</a> <a id="973" class="Symbol">(</a><a id="974" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="980" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="982" href="TreeFold.html#982" class="Bound">y</a> <a id="984" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="986" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="991" href="TreeFold.html#991" class="Bound">xs</a><a id="993" class="Symbol">)</a> <a id="995" class="Symbol">=</a> <a id="997" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="1003" class="Symbol">(</a><a id="1004" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1008" href="TreeFold.html#969" class="Bound">n</a><a id="1009" class="Symbol">)</a> <a id="1011" class="Symbol">(</a><a id="1012" href="TreeFold.html#361" class="Bound">f</a> <a id="1014" href="TreeFold.html#971" class="Bound">x</a> <a id="1016" href="TreeFold.html#982" class="Bound">y</a><a id="1017" class="Symbol">)</a> <a id="1019" href="TreeFold.html#991" class="Bound">xs</a> <a id="1022" href="Cubical.Foundations.Id.html#737" class="Function Operator">;</a> <a id="1024" href="TreeFold.html#832" class="Bound">f-assoc</a> <a id="1032" href="TreeFold.html#971" class="Bound">x</a> <a id="1034" href="TreeFold.html#982" class="Bound">y</a> <a id="1036" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="1038" href="TreeFold.html#991" class="Bound">xs</a> <a id="1041" href="TreeFold.html#686" class="Function Operator">⟧⇓</a>
    <a id="1048" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="1054" href="TreeFold.html#1054" class="Bound">n</a> <a id="1056" href="TreeFold.html#1056" class="Bound">x</a> <a id="1058" class="Symbol">(</a><a id="1059" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1063" class="Symbol">_</a> <a id="1065" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="1067" class="Symbol">_</a> <a id="1069" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="1071" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a><a id="1078" class="Symbol">)</a> <a id="1080" class="Symbol">=</a> <a id="1082" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
    <a id="1091" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="1097" href="TreeFold.html#1097" class="Bound">n</a> <a id="1099" href="TreeFold.html#1099" class="Bound">x</a> <a id="1101" class="Symbol">(</a><a id="1102" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1106" class="Symbol">_</a> <a id="1108" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="1110" class="Symbol">_</a> <a id="1112" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="1114" href="Data.Maybe.Base.html#148" class="InductiveConstructor">just</a> <a id="1119" class="Symbol">_</a> <a id="1121" class="Symbol">)</a> <a id="1123" class="Symbol">=</a> <a id="1125" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>

    <a id="1135" href="TreeFold.html#1135" class="Function">treeFoldHom</a> <a id="1147" class="Symbol">:</a> <a id="1149" class="Symbol">∀</a> <a id="1151" href="TreeFold.html#1151" class="Bound">xs</a> <a id="1154" class="Symbol">→</a> <a id="1156" href="TreeFold.html#686" class="Function Operator">⟦</a> <a id="1158" href="TreeFold.html#611" class="Function Operator">⟦</a> <a id="1160" href="TreeFold.html#1151" class="Bound">xs</a> <a id="1163" href="TreeFold.html#611" class="Function Operator">⟧⇑</a> <a id="1166" href="TreeFold.html#686" class="Function Operator">⟧⇓</a> <a id="1169" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1171" href="Data.List.Base.html#191" class="Function">foldr</a> <a id="1177" href="TreeFold.html#361" class="Bound">f</a> <a id="1179" href="TreeFold.html#377" class="Bound">z</a> <a id="1181" href="TreeFold.html#1151" class="Bound">xs</a>
    <a id="1188" href="TreeFold.html#1135" class="Function">treeFoldHom</a> <a id="1200" class="Symbol">=</a> <a id="1202" href="Data.List.Properties.html#1573" class="Function">foldr-fusion</a> <a id="1215" href="TreeFold.html#686" class="Function Operator">⟦_⟧⇓</a> <a id="1220" class="Symbol">(</a><a id="1221" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1226" href="TreeFold.html#277" class="InductiveConstructor Operator">^</a> <a id="1228" href="TreeFold.html#377" class="Bound">z</a> <a id="1230" href="TreeFold.html#277" class="InductiveConstructor Operator">&amp;</a> <a id="1232" href="Data.Maybe.Base.html#127" class="InductiveConstructor">nothing</a><a id="1239" class="Symbol">)</a> <a id="1241" class="Symbol">(</a><a id="1242" href="TreeFold.html#867" class="Function">∹-hom</a> <a id="1248" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a><a id="1252" class="Symbol">)</a>
<a id="1254" class="Keyword">open</a> <a id="1259" href="TreeFold.html#352" class="Module">TheFold</a> <a id="1267" class="Keyword">using</a> <a id="1273" class="Symbol">(</a><a id="1274" href="TreeFold.html#772" class="Function">treeFold</a><a id="1282" class="Symbol">;</a> <a id="1284" href="TreeFold.html#1135" class="Function">treeFoldHom</a><a id="1295" class="Symbol">)</a> <a id="1297" class="Keyword">public</a>
</pre></body></html>