<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>TreeFold</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="TreeFold.html" class="Module">TreeFold</a> <a id="51" class="Keyword">where</a>

<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="Prelude.html" class="Module">Prelude</a>
<a id="78" class="Keyword">open</a> <a id="83" class="Keyword">import</a> <a id="90" href="Data.List.html" class="Module">Data.List</a>
<a id="100" class="Keyword">open</a> <a id="105" class="Keyword">import</a> <a id="112" href="Algebra.html" class="Module">Algebra</a> <a id="120" class="Keyword">using</a> <a id="126" class="Symbol">(</a><a id="127" href="Algebra.html#129" class="Function">Associative</a><a id="138" class="Symbol">)</a>
<a id="140" class="Keyword">open</a> <a id="145" class="Keyword">import</a> <a id="152" href="Data.List.Properties.html" class="Module">Data.List.Properties</a> <a id="173" class="Keyword">using</a> <a id="179" class="Symbol">(</a><a id="180" href="Data.List.Properties.html#1603" class="Function">foldr-fusion</a><a id="192" class="Symbol">;</a> <a id="194" href="Data.List.Properties.html#2145" class="Function">foldl-fusion</a><a id="206" class="Symbol">;</a> <a id="208" href="Data.List.Properties.html#3801" class="Function">foldl′-foldl</a><a id="220" class="Symbol">)</a>

<a id="223" class="Keyword">infixr</a> <a id="230" class="Number">5</a> <a id="232" href="TreeFold.html#294" class="InductiveConstructor Operator">_^_&amp;_</a>
<a id="238" class="Keyword">data</a> <a id="Spine"></a><a id="243" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="249" class="Symbol">(</a><a id="250" href="TreeFold.html#250" class="Bound">A</a> <a id="252" class="Symbol">:</a> <a id="254" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="259" href="Level.html#239" class="Generalizable">a</a><a id="260" class="Symbol">)</a> <a id="262" class="Symbol">:</a> <a id="264" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="269" href="TreeFold.html#259" class="Bound">a</a> <a id="271" class="Keyword">where</a>
  <a id="Spine.&amp;0"></a><a id="279" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a> <a id="282" class="Symbol">:</a> <a id="284" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="290" href="TreeFold.html#250" class="Bound">A</a>
  <a id="Spine._^_&amp;_"></a><a id="294" href="TreeFold.html#294" class="InductiveConstructor Operator">_^_&amp;_</a> <a id="300" class="Symbol">:</a> <a id="302" href="TreeFold.html#250" class="Bound">A</a> <a id="304" class="Symbol">→</a> <a id="306" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="308" class="Symbol">→</a> <a id="310" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="316" href="TreeFold.html#250" class="Bound">A</a> <a id="318" class="Symbol">→</a> <a id="320" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="326" href="TreeFold.html#250" class="Bound">A</a>

<a id="329" class="Keyword">private</a> <a id="337" class="Keyword">variable</a> <a id="346" href="TreeFold.html#346" class="Generalizable">n</a> <a id="348" class="Symbol">:</a> <a id="350" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="sing"></a><a id="353" href="TreeFold.html#353" class="Function">sing</a> <a id="358" class="Symbol">:</a> <a id="360" href="Level.html#255" class="Generalizable">A</a> <a id="362" class="Symbol">→</a> <a id="364" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="370" href="Level.html#255" class="Generalizable">A</a>
<a id="372" href="TreeFold.html#353" class="Function">sing</a> <a id="377" class="Symbol">=</a> <a id="379" href="TreeFold.html#294" class="InductiveConstructor Operator">_^</a> <a id="382" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="387" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="389" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a>

<a id="393" class="Keyword">module</a> <a id="Cons"></a><a id="400" href="TreeFold.html#400" class="Module">Cons</a> <a id="405" class="Symbol">(</a><a id="406" href="TreeFold.html#406" class="Bound">f</a> <a id="408" class="Symbol">:</a> <a id="410" href="Level.html#255" class="Generalizable">A</a> <a id="412" class="Symbol">→</a> <a id="414" href="Level.html#255" class="Generalizable">A</a> <a id="416" class="Symbol">→</a> <a id="418" href="Level.html#255" class="Generalizable">A</a><a id="419" class="Symbol">)</a> <a id="421" class="Keyword">where</a>
  <a id="429" class="Keyword">infixr</a> <a id="436" class="Number">5</a> <a id="438" href="TreeFold.html#446" class="Function Operator">_^_∹_</a>
  <a id="Cons._^_∹_"></a><a id="446" href="TreeFold.html#446" class="Function Operator">_^_∹_</a> <a id="452" class="Symbol">:</a> <a id="454" href="TreeFold.html#410" class="Bound">A</a> <a id="456" class="Symbol">→</a> <a id="458" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="460" class="Symbol">→</a> <a id="462" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="468" href="TreeFold.html#410" class="Bound">A</a> <a id="470" class="Symbol">→</a> <a id="472" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="478" href="TreeFold.html#410" class="Bound">A</a>
  <a id="482" href="TreeFold.html#482" class="Bound">x</a> <a id="484" href="TreeFold.html#446" class="Function Operator">^</a> <a id="486" href="TreeFold.html#486" class="Bound">n</a> <a id="488" href="TreeFold.html#446" class="Function Operator">∹</a> <a id="490" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a> <a id="493" class="Symbol">=</a> <a id="495" href="TreeFold.html#482" class="Bound">x</a> <a id="497" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="499" href="TreeFold.html#486" class="Bound">n</a> <a id="501" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="503" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a>
  <a id="508" href="TreeFold.html#508" class="Bound">x</a> <a id="510" href="TreeFold.html#446" class="Function Operator">^</a> <a id="512" href="TreeFold.html#512" class="Bound">n</a> <a id="514" href="TreeFold.html#446" class="Function Operator">∹</a> <a id="516" href="TreeFold.html#516" class="Bound">y</a> <a id="518" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="520" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="526" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="528" href="TreeFold.html#528" class="Bound">xs</a> <a id="531" class="Symbol">=</a> <a id="533" href="TreeFold.html#406" class="Bound">f</a> <a id="535" href="TreeFold.html#508" class="Bound">x</a> <a id="537" href="TreeFold.html#516" class="Bound">y</a> <a id="539" href="TreeFold.html#446" class="Function Operator">^</a> <a id="541" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="545" href="TreeFold.html#512" class="Bound">n</a> <a id="547" href="TreeFold.html#446" class="Function Operator">∹</a> <a id="549" href="TreeFold.html#528" class="Bound">xs</a>
  <a id="554" href="TreeFold.html#554" class="Bound">x</a> <a id="556" href="TreeFold.html#446" class="Function Operator">^</a> <a id="558" href="TreeFold.html#558" class="Bound">n</a> <a id="560" href="TreeFold.html#446" class="Function Operator">∹</a> <a id="562" href="TreeFold.html#562" class="Bound">y</a> <a id="564" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="566" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="570" href="TreeFold.html#570" class="Bound">m</a> <a id="572" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="574" href="TreeFold.html#574" class="Bound">xs</a> <a id="577" class="Symbol">=</a> <a id="579" href="TreeFold.html#554" class="Bound">x</a> <a id="581" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="583" href="TreeFold.html#558" class="Bound">n</a> <a id="585" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="587" href="TreeFold.html#562" class="Bound">y</a> <a id="589" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="591" href="TreeFold.html#570" class="Bound">m</a> <a id="593" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="595" href="TreeFold.html#574" class="Bound">xs</a>

  <a id="Cons._∹_"></a><a id="601" href="TreeFold.html#601" class="Function Operator">_∹_</a> <a id="605" class="Symbol">:</a> <a id="607" href="TreeFold.html#410" class="Bound">A</a> <a id="609" class="Symbol">→</a> <a id="611" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="617" href="TreeFold.html#410" class="Bound">A</a> <a id="619" class="Symbol">→</a> <a id="621" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="627" href="TreeFold.html#410" class="Bound">A</a>
  <a id="631" href="TreeFold.html#601" class="Function Operator">_∹_</a> <a id="635" class="Symbol">=</a> <a id="637" href="TreeFold.html#446" class="Function Operator">_^</a> <a id="640" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="645" href="TreeFold.html#446" class="Function Operator">∹_</a>
  

<a id="652" class="Keyword">module</a> <a id="TreeFoldR"></a><a id="659" href="TreeFold.html#659" class="Module">TreeFoldR</a> <a id="669" class="Symbol">(</a><a id="670" href="TreeFold.html#670" class="Bound">f</a> <a id="672" class="Symbol">:</a> <a id="674" href="Level.html#255" class="Generalizable">A</a> <a id="676" class="Symbol">→</a> <a id="678" href="Level.html#255" class="Generalizable">A</a> <a id="680" class="Symbol">→</a> <a id="682" href="Level.html#255" class="Generalizable">A</a><a id="683" class="Symbol">)</a> <a id="685" class="Symbol">(</a><a id="686" href="TreeFold.html#686" class="Bound">z</a> <a id="688" class="Symbol">:</a> <a id="690" href="Level.html#255" class="Generalizable">A</a><a id="691" class="Symbol">)</a> <a id="693" class="Keyword">where</a>
  <a id="701" class="Keyword">open</a> <a id="706" href="TreeFold.html#400" class="Module">Cons</a> <a id="711" href="TreeFold.html#670" class="Bound">f</a>

  <a id="TreeFoldR.fold"></a><a id="716" href="TreeFold.html#716" class="Function">fold</a> <a id="721" class="Symbol">:</a> <a id="723" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="729" href="TreeFold.html#674" class="Bound">A</a> <a id="731" class="Symbol">→</a> <a id="733" href="TreeFold.html#674" class="Bound">A</a>
  <a id="737" href="TreeFold.html#716" class="Function">fold</a> <a id="742" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a> <a id="745" class="Symbol">=</a> <a id="747" href="TreeFold.html#686" class="Bound">z</a>
  <a id="751" href="TreeFold.html#716" class="Function">fold</a> <a id="756" class="Symbol">(</a><a id="757" href="TreeFold.html#757" class="Bound">x</a> <a id="759" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="761" href="TreeFold.html#761" class="Bound">n</a> <a id="763" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="765" href="TreeFold.html#765" class="Bound">xs</a><a id="767" class="Symbol">)</a> <a id="769" class="Symbol">=</a> <a id="771" href="TreeFold.html#670" class="Bound">f</a> <a id="773" href="TreeFold.html#757" class="Bound">x</a> <a id="775" class="Symbol">(</a><a id="776" href="TreeFold.html#716" class="Function">fold</a> <a id="781" href="TreeFold.html#765" class="Bound">xs</a><a id="783" class="Symbol">)</a>

  <a id="TreeFoldR.∹-hom"></a><a id="788" href="TreeFold.html#788" class="Function">∹-hom</a> <a id="794" class="Symbol">:</a> <a id="796" href="Algebra.html#129" class="Function">Associative</a> <a id="808" href="TreeFold.html#670" class="Bound">f</a> <a id="810" class="Symbol">→</a> <a id="812" class="Symbol">∀</a> <a id="814" href="TreeFold.html#814" class="Bound">x</a> <a id="816" href="TreeFold.html#816" class="Bound">xs</a> <a id="819" class="Symbol">→</a> <a id="821" href="TreeFold.html#716" class="Function">fold</a> <a id="826" class="Symbol">(</a><a id="827" href="TreeFold.html#814" class="Bound">x</a> <a id="829" href="TreeFold.html#446" class="Function Operator">^</a> <a id="831" href="TreeFold.html#346" class="Generalizable">n</a> <a id="833" href="TreeFold.html#446" class="Function Operator">∹</a> <a id="835" href="TreeFold.html#816" class="Bound">xs</a><a id="837" class="Symbol">)</a> <a id="839" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="841" href="TreeFold.html#670" class="Bound">f</a> <a id="843" href="TreeFold.html#814" class="Bound">x</a> <a id="845" class="Symbol">(</a><a id="846" href="TreeFold.html#716" class="Function">fold</a> <a id="851" href="TreeFold.html#816" class="Bound">xs</a><a id="853" class="Symbol">)</a>
  <a id="857" href="TreeFold.html#788" class="Function">∹-hom</a> <a id="863" href="TreeFold.html#863" class="Bound">p</a> <a id="865" href="TreeFold.html#865" class="Bound">x</a> <a id="867" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a> <a id="870" class="Symbol">=</a> <a id="872" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>
  <a id="879" href="TreeFold.html#788" class="Function">∹-hom</a> <a id="885" href="TreeFold.html#885" class="Bound">p</a> <a id="887" href="TreeFold.html#887" class="Bound">x</a> <a id="889" class="Symbol">(</a><a id="890" href="TreeFold.html#890" class="Bound">y</a> <a id="892" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="894" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="900" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="902" href="TreeFold.html#902" class="Bound">xs</a><a id="904" class="Symbol">)</a> <a id="906" class="Symbol">=</a> <a id="908" href="TreeFold.html#788" class="Function">∹-hom</a> <a id="914" href="TreeFold.html#885" class="Bound">p</a> <a id="916" class="Symbol">(</a><a id="917" href="TreeFold.html#670" class="Bound">f</a> <a id="919" href="TreeFold.html#887" class="Bound">x</a> <a id="921" href="TreeFold.html#890" class="Bound">y</a><a id="922" class="Symbol">)</a> <a id="924" href="TreeFold.html#902" class="Bound">xs</a> <a id="927" href="Cubical.Foundations.Id.html#737" class="Function Operator">;</a> <a id="929" href="TreeFold.html#885" class="Bound">p</a> <a id="931" href="TreeFold.html#887" class="Bound">x</a> <a id="933" href="TreeFold.html#890" class="Bound">y</a> <a id="935" class="Symbol">(</a><a id="936" href="TreeFold.html#716" class="Function">fold</a> <a id="941" href="TreeFold.html#902" class="Bound">xs</a><a id="943" class="Symbol">)</a>
  <a id="947" href="TreeFold.html#788" class="Function">∹-hom</a> <a id="953" href="TreeFold.html#953" class="Bound">p</a> <a id="955" href="TreeFold.html#955" class="Bound">x</a> <a id="957" class="Symbol">(</a><a id="958" href="TreeFold.html#958" class="Bound">y</a> <a id="960" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="962" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="966" href="TreeFold.html#966" class="Bound">n</a> <a id="968" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="970" href="TreeFold.html#970" class="Bound">xs</a><a id="972" class="Symbol">)</a> <a id="974" class="Symbol">=</a> <a id="976" href="Cubical.Foundations.Id.html#560" class="Function">refl</a>

  <a id="TreeFoldR.spine"></a><a id="984" href="TreeFold.html#984" class="Function">spine</a> <a id="990" class="Symbol">:</a> <a id="992" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="997" href="TreeFold.html#674" class="Bound">A</a> <a id="999" class="Symbol">→</a> <a id="1001" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="1007" href="TreeFold.html#674" class="Bound">A</a>
  <a id="1011" href="TreeFold.html#984" class="Function">spine</a> <a id="1017" class="Symbol">=</a> <a id="1019" href="Data.List.Base.html#210" class="Function">foldr</a> <a id="1025" href="TreeFold.html#601" class="Function Operator">_∹_</a> <a id="1029" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a>

  <a id="TreeFoldR.treeFold"></a><a id="1035" href="TreeFold.html#1035" class="Function">treeFold</a> <a id="1044" class="Symbol">:</a> <a id="1046" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1051" href="TreeFold.html#674" class="Bound">A</a> <a id="1053" class="Symbol">→</a> <a id="1055" href="TreeFold.html#674" class="Bound">A</a>
  <a id="1059" href="TreeFold.html#1035" class="Function">treeFold</a> <a id="1068" class="Symbol">=</a> <a id="1070" href="TreeFold.html#716" class="Function">fold</a> <a id="1075" href="Function.html#97" class="Function Operator">∘</a> <a id="1077" href="TreeFold.html#984" class="Function">spine</a>
  
  <a id="TreeFoldR.treeFoldHom"></a><a id="1088" href="TreeFold.html#1088" class="Function">treeFoldHom</a> <a id="1100" class="Symbol">:</a> <a id="1102" href="Algebra.html#129" class="Function">Associative</a> <a id="1114" href="TreeFold.html#670" class="Bound">f</a> <a id="1116" class="Symbol">→</a> <a id="1118" class="Symbol">∀</a> <a id="1120" href="TreeFold.html#1120" class="Bound">xs</a> <a id="1123" class="Symbol">→</a> <a id="1125" href="TreeFold.html#1035" class="Function">treeFold</a> <a id="1134" href="TreeFold.html#1120" class="Bound">xs</a> <a id="1137" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="1139" href="Data.List.Base.html#210" class="Function">foldr</a> <a id="1145" href="TreeFold.html#670" class="Bound">f</a> <a id="1147" href="TreeFold.html#686" class="Bound">z</a> <a id="1149" href="TreeFold.html#1120" class="Bound">xs</a>
  <a id="1154" href="TreeFold.html#1088" class="Function">treeFoldHom</a> <a id="1166" href="TreeFold.html#1166" class="Bound">f-assoc</a> <a id="1174" class="Symbol">=</a> <a id="1176" href="Data.List.Properties.html#1603" class="Function">foldr-fusion</a> <a id="1189" href="TreeFold.html#716" class="Function">fold</a> <a id="1194" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a> <a id="1197" class="Symbol">(</a><a id="1198" href="TreeFold.html#788" class="Function">∹-hom</a> <a id="1204" href="TreeFold.html#1166" class="Bound">f-assoc</a><a id="1211" class="Symbol">)</a>

<a id="1214" class="Keyword">open</a> <a id="1219" href="TreeFold.html#659" class="Module">TreeFoldR</a> <a id="1229" class="Keyword">using</a> <a id="1235" class="Symbol">(</a><a id="1236" href="TreeFold.html#1035" class="Function">treeFold</a><a id="1244" class="Symbol">;</a> <a id="1246" href="TreeFold.html#1088" class="Function">treeFoldHom</a><a id="1257" class="Symbol">)</a> <a id="1259" class="Keyword">public</a>

<a id="1267" class="Keyword">open</a> <a id="1272" class="Keyword">import</a> <a id="1279" href="Path.Reasoning.html" class="Module">Path.Reasoning</a>

<a id="1295" class="Keyword">module</a> <a id="TreeFoldL"></a><a id="1302" href="TreeFold.html#1302" class="Module">TreeFoldL</a> <a id="1312" class="Symbol">(</a><a id="1313" href="TreeFold.html#1313" class="Bound">f</a> <a id="1315" class="Symbol">:</a> <a id="1317" href="Level.html#255" class="Generalizable">A</a> <a id="1319" class="Symbol">→</a> <a id="1321" href="Level.html#255" class="Generalizable">A</a> <a id="1323" class="Symbol">→</a> <a id="1325" href="Level.html#255" class="Generalizable">A</a><a id="1326" class="Symbol">)</a> <a id="1328" class="Keyword">where</a>
  <a id="TreeFoldL.fold"></a><a id="1336" href="TreeFold.html#1336" class="Function">fold</a> <a id="1341" class="Symbol">:</a> <a id="1343" href="TreeFold.html#1317" class="Bound">A</a> <a id="1345" class="Symbol">→</a> <a id="1347" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="1353" href="TreeFold.html#1317" class="Bound">A</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="TreeFold.html#1317" class="Bound">A</a>
  <a id="1361" href="TreeFold.html#1336" class="Function">fold</a> <a id="1366" href="TreeFold.html#1366" class="Bound">x</a> <a id="1368" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a> <a id="1371" class="Symbol">=</a> <a id="1373" href="TreeFold.html#1366" class="Bound">x</a>
  <a id="1377" href="TreeFold.html#1336" class="Function">fold</a> <a id="1382" href="TreeFold.html#1382" class="Bound">x</a> <a id="1384" class="Symbol">(</a><a id="1385" href="TreeFold.html#1385" class="Bound">y</a> <a id="1387" href="TreeFold.html#294" class="InductiveConstructor Operator">^</a> <a id="1389" class="Symbol">_</a> <a id="1391" href="TreeFold.html#294" class="InductiveConstructor Operator">&amp;</a> <a id="1393" href="TreeFold.html#1393" class="Bound">xs</a><a id="1395" class="Symbol">)</a> <a id="1397" class="Symbol">=</a> <a id="1399" href="TreeFold.html#1336" class="Function">fold</a> <a id="1404" class="Symbol">(</a><a id="1405" href="TreeFold.html#1313" class="Bound">f</a> <a id="1407" href="TreeFold.html#1385" class="Bound">y</a> <a id="1409" href="TreeFold.html#1382" class="Bound">x</a><a id="1410" class="Symbol">)</a> <a id="1412" href="TreeFold.html#1393" class="Bound">xs</a>

  <a id="1418" class="Keyword">open</a> <a id="1423" href="TreeFold.html#400" class="Module">Cons</a> <a id="1428" class="Symbol">(</a><a id="1429" href="Function.html#369" class="Function">flip</a> <a id="1434" href="TreeFold.html#1313" class="Bound">f</a><a id="1435" class="Symbol">)</a>

  <a id="TreeFoldL.spine"></a><a id="1440" href="TreeFold.html#1440" class="Function">spine</a> <a id="1446" class="Symbol">:</a> <a id="1448" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1453" href="TreeFold.html#1317" class="Bound">A</a> <a id="1455" class="Symbol">→</a> <a id="1457" href="TreeFold.html#243" class="Datatype">Spine</a> <a id="1463" href="TreeFold.html#1317" class="Bound">A</a>
  <a id="1467" href="TreeFold.html#1440" class="Function">spine</a> <a id="1473" class="Symbol">=</a> <a id="1475" href="Data.List.Base.html#305" class="Function">foldl</a> <a id="1481" class="Symbol">(</a><a id="1482" href="Function.html#369" class="Function">flip</a> <a id="1487" href="TreeFold.html#601" class="Function Operator">_∹_</a><a id="1490" class="Symbol">)</a> <a id="1492" href="TreeFold.html#279" class="InductiveConstructor">&amp;0</a>

  <a id="TreeFoldL.treeFoldL"></a><a id="1498" href="TreeFold.html#1498" class="Function">treeFoldL</a> <a id="1508" class="Symbol">:</a> <a id="1510" href="TreeFold.html#1317" class="Bound">A</a> <a id="1512" class="Symbol">→</a> <a id="1514" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1519" href="TreeFold.html#1317" class="Bound">A</a> <a id="1521" class="Symbol">→</a> <a id="1523" href="TreeFold.html#1317" class="Bound">A</a>
  <a id="1527" href="TreeFold.html#1498" class="Function">treeFoldL</a> <a id="1537" href="TreeFold.html#1537" class="Bound">z</a> <a id="1539" class="Symbol">=</a> <a id="1541" href="TreeFold.html#1336" class="Function">fold</a> <a id="1546" href="TreeFold.html#1537" class="Bound">z</a> <a id="1548" href="Function.html#97" class="Function Operator">∘</a> <a id="1550" href="TreeFold.html#1440" class="Function">spine</a>


<a id="1558" class="Comment">--   -- fold-lemma </a>

<a id="1579" class="Comment">-- open TreeFoldL using (treeFoldL)</a>

<a id="1616" class="Comment">-- data Tree : Type where</a>
<a id="1642" class="Comment">--   _*_ : Tree → Tree → Tree</a>
<a id="1672" class="Comment">--   ⟅_⟆ : ℕ → Tree</a>
<a id="1692" class="Comment">--   ⟅⟆ : Tree</a>

<a id="1708" class="Comment">-- ex : Tree</a>
<a id="1721" class="Comment">-- ex = treeFoldL _*_ ⟅⟆ (map ⟅_⟆ (1 ⋯ 10))</a>




<a id="1769" class="Comment">-- module DistribProof (f : A → A → A) (f-assoc : Associative f) where</a>
<a id="1840" class="Comment">--   open TreeFoldR f</a>

<a id="1863" class="Comment">--   distrib-end : ∀ x y xs → ⟦ f x y ⟧⇓ xs ≡ f (⟦ x ⟧⇓ xs) y</a>
<a id="1925" class="Comment">--   distrib-end x y &amp;0 = refl</a>
<a id="1956" class="Comment">--   distrib-end x y (z ^ _ &amp; xs) = cong (f z) (distrib-end x y xs) ; sym (f-assoc z (⟦ x ⟧⇓ xs) y)</a>

<a id="2057" class="Comment">-- open import Path.Reasoning</a>

<a id="2088" class="Comment">-- module TreeFoldL (f : A → A → A) (z : A) where</a>
<a id="2138" class="Comment">--   open TreeFoldR (flip f) z using (_∹_) public</a>

<a id="2189" class="Comment">--   ⟦_⟧⇑ : List A → Spine A</a>
<a id="2218" class="Comment">--   ⟦_⟧⇑ = foldl (flip _∹_) &amp;0</a>

<a id="2251" class="Comment">--   ⟦_,_⟧⇓′ : A → Spine A → A</a>
<a id="2282" class="Comment">--   ⟦ a , &amp;0 ⟧⇓′ = a</a>
<a id="2304" class="Comment">--   ⟦ a , x ^ _ &amp; xs ⟧⇓′ = ⟦ f a x , xs ⟧⇓′</a>

<a id="2350" class="Comment">--   ⟦_⟧⇓ : Spine A → A</a>
<a id="2374" class="Comment">--   ⟦_⟧⇓ = ⟦ z ,_⟧⇓′</a>

<a id="2397" class="Comment">--   treeFoldL : List A → A</a>
<a id="2425" class="Comment">--   treeFoldL = ⟦_⟧⇓ ∘ ⟦_⟧⇑</a>

<a id="2455" class="Comment">--   module Right = TreeFoldR (flip f)</a>

<a id="2495" class="Comment">--   module _ (f-assoc : Associative f) where</a>

<a id="2542" class="Comment">--     flip-assoc : Associative (flip f)</a>
<a id="2583" class="Comment">--     flip-assoc x y z = sym (f-assoc z y x)</a>

<a id="2630" class="Comment">--     ∹-hom : ∀ x xs → ⟦ x ∹ xs ⟧⇓ ≡ f ⟦ xs ⟧⇓ x</a>
<a id="2680" class="Comment">--     ∹-hom x &amp;0 = refl</a>
<a id="2705" class="Comment">--     ∹-hom x (y ^ zero  &amp; xs) = {!!}</a>
<a id="2744" class="Comment">--     ∹-hom x (y ^ suc n &amp; xs) = {!!}</a>

<a id="2784" class="Comment">--     treeFoldLHom : Associative f → ∀ xs → treeFoldL xs ≡ foldl f z xs</a>
<a id="2857" class="Comment">--     treeFoldLHom f-assoc = foldl-fusion ⟦_⟧⇓ &amp;0 {!!} -- (flip (∹-hom (λ x y z → sym (f-assoc z y x))))</a>


<a id="2965" class="Comment">-- open TreeFoldL using (treeFoldL; treeFoldLHom)</a>

<a id="3016" class="Comment">-- module TreeFoldL′ (f : A → A → A) (z : A) where</a>
<a id="3067" class="Comment">--   infixr 5 _^_∹_</a>
<a id="3087" class="Comment">--   _^_∹_ : A → ℕ → Spine A → Spine A</a>
<a id="3126" class="Comment">--   x ^ n ∹ &amp;0 = x ^ n &amp; &amp;0</a>
<a id="3155" class="Comment">--   x ^ n ∹ y ^ zero  &amp; xs = let! xy =! f x y in! xy ^ suc n ∹ xs</a>
<a id="3222" class="Comment">--   x ^ n ∹ y ^ suc m &amp; xs = x ^ n &amp; y ^ m &amp; xs</a>

<a id="3272" class="Comment">--   _∹_ : A → Spine A → Spine A</a>
<a id="3305" class="Comment">--   _∹_ = _^ zero ∹_</a>

<a id="3328" class="Comment">--   ⟦_,_⟧⇓′ : A → Spine A → A</a>
<a id="3359" class="Comment">--   ⟦ a , &amp;0 ⟧⇓′ = a</a>
<a id="3381" class="Comment">--   ⟦ a , x ^ _ &amp; xs ⟧⇓′ = ⟦ f a x , xs ⟧⇓′</a>

<a id="3427" class="Comment">--   ⟦_⟧⇓ : Spine A → A</a>
<a id="3451" class="Comment">--   ⟦_⟧⇓ = ⟦ z ,_⟧⇓′</a>

<a id="3474" class="Comment">--   module Lazy = TreeFoldL f</a>

<a id="3506" class="Comment">--   open import Path.Reasoning</a>

<a id="3539" class="Comment">--   -- llemma : ∀ x y xs → Lazy.⟦ x ⟧⇓ (f xs y) ≡ Lazy.⟦ f x y ⟧⇓ xs</a>
<a id="3609" class="Comment">--   -- llemma x y &amp;0 = refl</a>
<a id="3638" class="Comment">--   -- llemma x y (z ^ _ &amp; xs) = cong (flip f y) (llemma x z xs) ; {!!}</a>

<a id="3712" class="Comment">--   -- conc-lemma : ∀ z xs → ⟦ z , xs ⟧⇓′ ≡ Lazy.⟦ z ⟧⇓ xs</a>
<a id="3772" class="Comment">--   -- conc-lemma z &amp;0 = refl</a>
<a id="3803" class="Comment">--   -- conc-lemma z (x ^ n &amp; xs) = {!!}</a>

<a id="3845" class="Comment">-- -- $!-≡ ⟦_, xs ⟧⇓′ (f z x) ; conc-lemma (f z x) xs ; {!!}</a>

<a id="3907" class="Comment">-- --   _∹_ : A → Spine A → Spine A</a>
<a id="3943" class="Comment">-- --   _∹_ = zero ^_∹_</a>

<a id="3968" class="Comment">-- --   ⟦_⟧⇓ : Spine A → A</a>
<a id="3995" class="Comment">-- --   ⟦ _ ^ x &amp; &amp;0 ⟧⇓ = x</a>
<a id="4023" class="Comment">-- --   ⟦ _ ^ x &amp; just xs ⟧⇓ = let! fxs =! ⟦ xs ⟧⇓ in! f fxs x</a>

<a id="4087" class="Comment">-- --   ⟦_⟧⇑ : List A → Spine A</a>
<a id="4119" class="Comment">-- --   ⟦_⟧⇑ = foldl′ (flip (_∹_)) (sing z)</a>

<a id="4164" class="Comment">-- --   treeFoldL′ : List A → A</a>
<a id="4196" class="Comment">-- --   treeFoldL′ = ⟦_⟧⇓ ∘ ⟦_⟧⇑</a>

<a id="4230" class="Comment">-- --   module Lazy = TreeFoldL f z</a>

<a id="4267" class="Comment">-- --   strict-cons : ∀ n x xs → n ^ x ∹ xs ≡ n Lazy.^ x ∹ xs</a>
<a id="4329" class="Comment">-- --   strict-cons n x (zero  ^ y &amp; &amp;0) = $!-≡ (suc n ^_&amp; &amp;0) (f y x)</a>
<a id="4400" class="Comment">-- --   strict-cons n x (zero  ^ y &amp; just xs) = $!-≡ (suc n ^_∹ xs) (f y x) ; strict-cons (suc n) (f y x) xs</a>
<a id="4509" class="Comment">-- --   strict-cons n x (suc m ^ y &amp; xs)      = refl</a>

<a id="4563" class="Comment">-- --   strict-spine : ∀ xs → ⟦ xs ⟧⇑ ≡ Lazy.⟦ xs ⟧⇑</a>
<a id="4616" class="Comment">-- --   strict-spine xs = foldl′-foldl (flip (_∹_)) (sing z) xs ; cong (λ c → foldl c (sing z) xs) (funExt (λ y → funExt (λ x → strict-cons zero x y)))</a>

<a id="4769" class="Comment">-- --   strict-collapse : ∀ xs → ⟦ xs ⟧⇓ ≡ Lazy.⟦ xs ⟧⇓</a>
<a id="4825" class="Comment">-- --   strict-collapse (_ ^ x &amp; &amp;0) = refl</a>
<a id="4869" class="Comment">-- --   strict-collapse (_ ^ x &amp; just xs) = $!-≡ (flip f x) ⟦ xs ⟧⇓ ; cong (flip f x) (strict-collapse xs)</a>

<a id="4977" class="Comment">-- --   strict-treeFoldL : ∀ xs → treeFoldL′ xs ≡ Lazy.treeFoldL xs</a>
<a id="5045" class="Comment">-- --   strict-treeFoldL xs = cong ⟦_⟧⇓ (strict-spine xs) ; strict-collapse Lazy.⟦ xs ⟧⇑</a>

<a id="5135" class="Comment">-- --   treeFoldL′Hom : Associative f → ∀ xs → treeFoldL′ xs ≡ foldl f z xs</a>
<a id="5211" class="Comment">-- --   treeFoldL′Hom f-assoc xs = strict-treeFoldL xs ; Lazy.treeFoldLHom f-assoc xs</a>

<a id="5298" class="Comment">-- -- open TreeFoldL′ using (treeFoldL′; strict-treeFoldL; treeFoldL′Hom)</a>
</pre></body></html>