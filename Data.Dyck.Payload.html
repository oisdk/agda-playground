<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Dyck.Payload</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Symbol">#-}</a>

<a id="57" class="Comment">-- This module defines a data type for balanced strings of parentheses,</a>
<a id="129" class="Comment">-- which is isomorphic to binary trees.</a>

<a id="170" class="Keyword">module</a> <a id="177" href="Data.Dyck.Payload.html" class="Module">Data.Dyck.Payload</a> <a id="195" class="Keyword">where</a>

<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Prelude.html" class="Module">Prelude</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="243" class="Keyword">using</a> <a id="249" class="Symbol">(</a><a id="250" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="253" class="Symbol">)</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Data.Vec.Iterated.html" class="Module">Data.Vec.Iterated</a> <a id="285" class="Keyword">using</a> <a id="291" class="Symbol">(</a><a id="292" href="Data.Vec.Iterated.html#250" class="Function">Vec</a><a id="295" class="Symbol">;</a> <a id="297" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">_∷_</a><a id="300" class="Symbol">;</a> <a id="302" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="304" class="Symbol">;</a> <a id="306" href="Data.Vec.Iterated.html#997" class="Function">foldlN</a><a id="312" class="Symbol">;</a> <a id="314" href="Data.Vec.Iterated.html#519" class="Field">head</a><a id="318" class="Symbol">)</a>

<a id="321" class="Keyword">private</a>
  <a id="331" class="Keyword">variable</a>
    <a id="344" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="346" class="Symbol">:</a> <a id="348" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="351" class="Comment">--------------------------------------------------------------------------------</a>
<a id="432" class="Comment">-- Binary trees: definition and associated functions</a>
<a id="485" class="Comment">--------------------------------------------------------------------------------</a>

<a id="567" class="Keyword">data</a> <a id="Tree"></a><a id="572" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="577" class="Symbol">(</a><a id="578" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="580" class="Symbol">:</a> <a id="582" href="Level.html#192" class="Function">Type</a> <a id="587" href="Level.html#372" class="Generalizable">a</a><a id="588" class="Symbol">)</a> <a id="590" class="Symbol">:</a> <a id="592" href="Level.html#192" class="Function">Type</a> <a id="597" href="Data.Dyck.Payload.html#587" class="Bound">a</a> <a id="599" class="Keyword">where</a>
  <a id="Tree.[_]"></a><a id="607" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[_]</a> <a id="611" class="Symbol">:</a> <a id="613" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="615" class="Symbol">→</a> <a id="617" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="622" href="Data.Dyck.Payload.html#578" class="Bound">A</a>
  <a id="Tree._*_"></a><a id="626" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">_*_</a> <a id="630" class="Symbol">:</a> <a id="632" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="637" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="639" class="Symbol">→</a> <a id="641" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="646" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="648" class="Symbol">→</a> <a id="650" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="655" href="Data.Dyck.Payload.html#578" class="Bound">A</a>

<a id="658" class="Comment">--------------------------------------------------------------------------------</a>
<a id="739" class="Comment">-- Programs: definition and associated functions</a>
<a id="788" class="Comment">--------------------------------------------------------------------------------</a>

<a id="870" class="Keyword">data</a> <a id="Prog"></a><a id="875" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="880" class="Symbol">{</a><a id="881" href="Data.Dyck.Payload.html#881" class="Bound">a</a><a id="882" class="Symbol">}</a> <a id="884" class="Symbol">(</a><a id="885" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="887" class="Symbol">:</a> <a id="889" href="Level.html#192" class="Function">Type</a> <a id="894" href="Data.Dyck.Payload.html#881" class="Bound">a</a><a id="895" class="Symbol">)</a> <a id="897" class="Symbol">:</a> <a id="899" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="901" class="Symbol">→</a> <a id="903" href="Level.html#192" class="Function">Type</a> <a id="908" href="Data.Dyck.Payload.html#881" class="Bound">a</a> <a id="910" class="Keyword">where</a>
  <a id="Prog.halt"></a><a id="918" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a> <a id="923" class="Symbol">:</a> <a id="925" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="930" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="932" class="Number">1</a>
  <a id="Prog.push"></a><a id="936" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="941" class="Symbol">:</a> <a id="943" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="945" class="Symbol">→</a> <a id="947" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="952" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="954" class="Symbol">(</a><a id="955" class="Number">1</a> <a id="957" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="959" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="960" class="Symbol">)</a> <a id="962" class="Symbol">→</a> <a id="964" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="969" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="971" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a>
  <a id="Prog.pull"></a><a id="975" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a> <a id="980" class="Symbol">:</a> <a id="982" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="987" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="989" class="Symbol">(</a><a id="990" class="Number">1</a> <a id="992" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="994" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="995" class="Symbol">)</a> <a id="997" class="Symbol">→</a> <a id="999" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1004" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="1006" class="Symbol">(</a><a id="1007" class="Number">2</a> <a id="1009" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1011" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1012" class="Symbol">)</a>

<a id="1015" class="Keyword">module</a> <a id="1022" href="Data.Dyck.Payload.html#1022" class="Module">_</a><a id="1023" class="Symbol">{</a><a id="1024" href="Data.Dyck.Payload.html#1024" class="Bound">p</a><a id="1025" class="Symbol">}</a> <a id="1027" class="Symbol">(</a><a id="1028" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1030" class="Symbol">:</a> <a id="1032" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Level.html#192" class="Function">Type</a> <a id="1041" href="Data.Dyck.Payload.html#1024" class="Bound">p</a><a id="1042" class="Symbol">)</a>
            <a id="1056" class="Symbol">(</a><a id="1057" href="Data.Dyck.Payload.html#1057" class="Bound">lb</a> <a id="1060" class="Symbol">:</a> <a id="1062" class="Symbol">∀</a> <a id="1064" class="Symbol">{</a><a id="1065" href="Data.Dyck.Payload.html#1065" class="Bound">n</a><a id="1066" class="Symbol">}</a> <a id="1068" class="Symbol">→</a> <a id="1070" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1072" class="Symbol">(</a><a id="1073" class="Number">2</a> <a id="1075" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1077" href="Data.Dyck.Payload.html#1065" class="Bound">n</a><a id="1078" class="Symbol">)</a> <a id="1080" class="Symbol">→</a> <a id="1082" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1084" class="Symbol">(</a><a id="1085" class="Number">1</a> <a id="1087" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1089" href="Data.Dyck.Payload.html#1065" class="Bound">n</a><a id="1090" class="Symbol">))</a>
            <a id="1105" class="Symbol">(</a><a id="1106" href="Data.Dyck.Payload.html#1106" class="Bound">rb</a> <a id="1109" class="Symbol">:</a> <a id="1111" class="Symbol">∀</a> <a id="1113" class="Symbol">{</a><a id="1114" href="Data.Dyck.Payload.html#1114" class="Bound">n</a><a id="1115" class="Symbol">}</a> <a id="1117" class="Symbol">→</a> <a id="1119" href="Level.html#388" class="Generalizable">A</a> <a id="1121" class="Symbol">→</a> <a id="1123" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1125" href="Data.Dyck.Payload.html#1114" class="Bound">n</a> <a id="1127" class="Symbol">→</a> <a id="1129" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1131" class="Symbol">(</a><a id="1132" class="Number">1</a> <a id="1134" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1136" href="Data.Dyck.Payload.html#1114" class="Bound">n</a><a id="1137" class="Symbol">))</a>
            <a id="1152" class="Keyword">where</a>
  <a id="1160" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1170" class="Symbol">:</a> <a id="1172" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1174" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1176" class="Symbol">→</a> <a id="1178" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1183" href="Data.Dyck.Payload.html#1119" class="Bound">A</a> <a id="1185" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1187" class="Symbol">→</a> <a id="1189" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1191" class="Number">1</a>
  <a id="1195" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1205" href="Data.Dyck.Payload.html#1205" class="Bound">bs</a> <a id="1208" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a> <a id="1213" class="Symbol">=</a> <a id="1215" href="Data.Dyck.Payload.html#1205" class="Bound">bs</a>
  <a id="1220" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1230" href="Data.Dyck.Payload.html#1230" class="Bound">bs</a> <a id="1233" class="Symbol">(</a><a id="1234" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="1239" href="Data.Dyck.Payload.html#1239" class="Bound">x</a> <a id="1241" href="Data.Dyck.Payload.html#1241" class="Bound">xs</a><a id="1243" class="Symbol">)</a> <a id="1245" class="Symbol">=</a> <a id="1247" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1257" class="Symbol">(</a><a id="1258" href="Data.Dyck.Payload.html#1106" class="Bound">rb</a> <a id="1261" href="Data.Dyck.Payload.html#1239" class="Bound">x</a> <a id="1263" href="Data.Dyck.Payload.html#1230" class="Bound">bs</a><a id="1265" class="Symbol">)</a> <a id="1267" href="Data.Dyck.Payload.html#1241" class="Bound">xs</a>
  <a id="1272" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1282" href="Data.Dyck.Payload.html#1282" class="Bound">bs</a> <a id="1285" class="Symbol">(</a><a id="1286" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a>   <a id="1293" href="Data.Dyck.Payload.html#1293" class="Bound">xs</a><a id="1295" class="Symbol">)</a> <a id="1297" class="Symbol">=</a> <a id="1299" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1309" class="Symbol">(</a><a id="1310" href="Data.Dyck.Payload.html#1057" class="Bound">lb</a>   <a id="1315" href="Data.Dyck.Payload.html#1282" class="Bound">bs</a><a id="1317" class="Symbol">)</a> <a id="1319" href="Data.Dyck.Payload.html#1293" class="Bound">xs</a>
<a id="1322" class="Comment">-- In terms of foldr:</a>
<a id="1344" class="Comment">-- foldlProg P lb rb bs xs =</a>
<a id="1373" class="Comment">--     foldrProg</a>
<a id="1390" class="Comment">--       (λ n → P n → P zero)</a>
<a id="1420" class="Comment">--       (λ x k bs → k (rb x bs))</a>
<a id="1454" class="Comment">--       (λ k bs → k (lb bs))</a>
<a id="1484" class="Comment">--       id xs bs</a>

<a id="1503" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1584" class="Comment">-- Conversion from a Prog to a Tree</a>
<a id="1620" class="Comment">--------------------------------------------------------------------------------</a>

<a id="reduce"></a><a id="1702" href="Data.Dyck.Payload.html#1702" class="Function">reduce</a> <a id="1709" class="Symbol">:</a> <a id="1711" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1715" class="Symbol">(</a><a id="1716" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1721" href="Level.html#388" class="Generalizable">A</a><a id="1722" class="Symbol">)</a> <a id="1724" class="Symbol">(</a><a id="1725" class="Number">2</a> <a id="1727" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1729" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1730" class="Symbol">)</a> <a id="1732" class="Symbol">→</a> <a id="1734" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1738" class="Symbol">(</a><a id="1739" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1744" href="Level.html#388" class="Generalizable">A</a><a id="1745" class="Symbol">)</a> <a id="1747" class="Symbol">(</a><a id="1748" class="Number">1</a> <a id="1750" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1752" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1753" class="Symbol">)</a>
<a id="1755" href="Data.Dyck.Payload.html#1702" class="Function">reduce</a> <a id="1762" class="Symbol">(</a><a id="1763" href="Data.Dyck.Payload.html#1763" class="Bound">t₁</a> <a id="1766" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1768" href="Data.Dyck.Payload.html#1768" class="Bound">t₂</a> <a id="1771" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1773" href="Data.Dyck.Payload.html#1773" class="Bound">s</a><a id="1774" class="Symbol">)</a> <a id="1776" class="Symbol">=</a> <a id="1778" class="Symbol">(</a><a id="1779" href="Data.Dyck.Payload.html#1768" class="Bound">t₂</a> <a id="1782" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">*</a> <a id="1784" href="Data.Dyck.Payload.html#1763" class="Bound">t₁</a><a id="1786" class="Symbol">)</a> <a id="1788" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1790" href="Data.Dyck.Payload.html#1773" class="Bound">s</a>

<a id="shift"></a><a id="1793" href="Data.Dyck.Payload.html#1793" class="Function">shift</a> <a id="1799" class="Symbol">:</a> <a id="1801" href="Level.html#388" class="Generalizable">A</a> <a id="1803" class="Symbol">→</a> <a id="1805" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1809" class="Symbol">(</a><a id="1810" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1815" href="Level.html#388" class="Generalizable">A</a><a id="1816" class="Symbol">)</a> <a id="1818" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1820" class="Symbol">→</a> <a id="1822" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1826" class="Symbol">(</a><a id="1827" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1832" href="Level.html#388" class="Generalizable">A</a><a id="1833" class="Symbol">)</a> <a id="1835" class="Symbol">(</a><a id="1836" class="Number">1</a> <a id="1838" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1840" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1841" class="Symbol">)</a>
<a id="1843" href="Data.Dyck.Payload.html#1793" class="Function">shift</a> <a id="1849" href="Data.Dyck.Payload.html#1849" class="Bound">x</a> <a id="1851" href="Data.Dyck.Payload.html#1851" class="Bound">s</a> <a id="1853" class="Symbol">=</a> <a id="1855" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[</a> <a id="1857" href="Data.Dyck.Payload.html#1849" class="Bound">x</a> <a id="1859" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">]</a> <a id="1861" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1863" href="Data.Dyck.Payload.html#1851" class="Bound">s</a>

<a id="prog→tree⊙"></a><a id="1866" href="Data.Dyck.Payload.html#1866" class="Function">prog→tree⊙</a> <a id="1877" class="Symbol">:</a> <a id="1879" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1884" href="Level.html#388" class="Generalizable">A</a> <a id="1886" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1888" class="Symbol">→</a> <a id="1890" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1894" class="Symbol">(</a><a id="1895" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1900" href="Level.html#388" class="Generalizable">A</a><a id="1901" class="Symbol">)</a> <a id="1903" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1905" class="Symbol">→</a> <a id="1907" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1911" class="Symbol">(</a><a id="1912" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1917" href="Level.html#388" class="Generalizable">A</a><a id="1918" class="Symbol">)</a> <a id="1920" class="Number">1</a>
<a id="1922" href="Data.Dyck.Payload.html#1866" class="Function">prog→tree⊙</a> <a id="1933" href="Data.Dyck.Payload.html#1933" class="Bound">p</a> <a id="1935" href="Data.Dyck.Payload.html#1935" class="Bound">s</a> <a id="1937" class="Symbol">=</a> <a id="1939" href="Data.Dyck.Payload.html#1160" class="Function">foldlProg</a> <a id="1949" class="Symbol">(λ</a> <a id="1952" href="Data.Dyck.Payload.html#1952" class="Bound">n</a> <a id="1954" class="Symbol">→</a> <a id="1956" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1960" class="Symbol">(</a><a id="1961" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1966" class="Symbol">_)</a> <a id="1969" href="Data.Dyck.Payload.html#1952" class="Bound">n</a><a id="1970" class="Symbol">)</a> <a id="1972" href="Data.Dyck.Payload.html#1702" class="Function">reduce</a> <a id="1979" href="Data.Dyck.Payload.html#1793" class="Function">shift</a> <a id="1985" href="Data.Dyck.Payload.html#1935" class="Bound">s</a> <a id="1987" href="Data.Dyck.Payload.html#1933" class="Bound">p</a>

<a id="prog→tree"></a><a id="1990" href="Data.Dyck.Payload.html#1990" class="Function">prog→tree</a> <a id="2000" class="Symbol">:</a> <a id="2002" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2007" href="Level.html#388" class="Generalizable">A</a> <a id="2009" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2014" class="Symbol">→</a> <a id="2016" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2021" href="Level.html#388" class="Generalizable">A</a>
<a id="2023" href="Data.Dyck.Payload.html#1990" class="Function">prog→tree</a> <a id="2033" href="Data.Dyck.Payload.html#2033" class="Bound">ds</a> <a id="2036" class="Symbol">=</a> <a id="2038" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="2043" class="Symbol">(</a><a id="2044" href="Data.Dyck.Payload.html#1866" class="Function">prog→tree⊙</a> <a id="2055" href="Data.Dyck.Payload.html#2033" class="Bound">ds</a> <a id="2058" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="2060" class="Symbol">)</a>

<a id="2063" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2144" class="Comment">-- Conversion from a Tree to a Prog</a>
<a id="2180" class="Comment">--------------------------------------------------------------------------------</a>

<a id="tree→prog⊙"></a><a id="2262" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2273" class="Symbol">:</a> <a id="2275" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2280" href="Level.html#388" class="Generalizable">A</a> <a id="2282" class="Symbol">→</a> <a id="2284" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2289" href="Level.html#388" class="Generalizable">A</a> <a id="2291" class="Symbol">(</a><a id="2292" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2296" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="2297" class="Symbol">)</a> <a id="2299" class="Symbol">→</a> <a id="2301" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2306" href="Level.html#388" class="Generalizable">A</a> <a id="2308" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a>
<a id="2310" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2321" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[</a> <a id="2323" href="Data.Dyck.Payload.html#2323" class="Bound">x</a> <a id="2325" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">]</a>     <a id="2331" class="Symbol">=</a> <a id="2333" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="2338" href="Data.Dyck.Payload.html#2323" class="Bound">x</a>
<a id="2340" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2351" class="Symbol">(</a><a id="2352" href="Data.Dyck.Payload.html#2352" class="Bound">xs</a> <a id="2355" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">*</a> <a id="2357" href="Data.Dyck.Payload.html#2357" class="Bound">ys</a><a id="2359" class="Symbol">)</a> <a id="2361" class="Symbol">=</a> <a id="2363" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2374" href="Data.Dyck.Payload.html#2352" class="Bound">xs</a> <a id="2377" href="Function.html#112" class="Function Operator">∘</a> <a id="2379" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2390" href="Data.Dyck.Payload.html#2357" class="Bound">ys</a> <a id="2393" href="Function.html#112" class="Function Operator">∘</a> <a id="2395" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a>

<a id="tree→prog"></a><a id="2401" href="Data.Dyck.Payload.html#2401" class="Function">tree→prog</a> <a id="2411" class="Symbol">:</a> <a id="2413" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2418" href="Level.html#388" class="Generalizable">A</a> <a id="2420" class="Symbol">→</a> <a id="2422" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2427" href="Level.html#388" class="Generalizable">A</a> <a id="2429" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="2434" href="Data.Dyck.Payload.html#2401" class="Function">tree→prog</a> <a id="2444" href="Data.Dyck.Payload.html#2444" class="Bound">tr</a> <a id="2447" class="Symbol">=</a> <a id="2449" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2460" href="Data.Dyck.Payload.html#2444" class="Bound">tr</a> <a id="2463" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a>

<a id="2469" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2550" class="Comment">-- Proof of isomorphism</a>
<a id="2574" class="Comment">--------------------------------------------------------------------------------</a>

<a id="tree→prog→tree⊙"></a><a id="2656" href="Data.Dyck.Payload.html#2656" class="Function">tree→prog→tree⊙</a> <a id="2672" class="Symbol">:</a> <a id="2674" class="Symbol">(</a><a id="2675" href="Data.Dyck.Payload.html#2675" class="Bound">e</a> <a id="2677" class="Symbol">:</a> <a id="2679" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2684" href="Level.html#388" class="Generalizable">A</a><a id="2685" class="Symbol">)</a> <a id="2687" class="Symbol">(</a><a id="2688" href="Data.Dyck.Payload.html#2688" class="Bound">is</a> <a id="2691" class="Symbol">:</a> <a id="2693" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2698" href="Level.html#388" class="Generalizable">A</a> <a id="2700" class="Symbol">(</a><a id="2701" class="Number">1</a> <a id="2703" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2705" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="2706" class="Symbol">))</a> <a id="2709" class="Symbol">(</a><a id="2710" href="Data.Dyck.Payload.html#2710" class="Bound">st</a> <a id="2713" class="Symbol">:</a> <a id="2715" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2719" class="Symbol">(</a><a id="2720" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2725" href="Level.html#388" class="Generalizable">A</a><a id="2726" class="Symbol">)</a> <a id="2728" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="2729" class="Symbol">)</a> <a id="2731" class="Symbol">→</a>
  <a id="2735" href="Data.Dyck.Payload.html#1866" class="Function">prog→tree⊙</a> <a id="2746" class="Symbol">(</a><a id="2747" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="2758" href="Data.Dyck.Payload.html#2675" class="Bound">e</a> <a id="2760" href="Data.Dyck.Payload.html#2688" class="Bound">is</a><a id="2762" class="Symbol">)</a> <a id="2764" href="Data.Dyck.Payload.html#2710" class="Bound">st</a> <a id="2767" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2769" href="Data.Dyck.Payload.html#1866" class="Function">prog→tree⊙</a> <a id="2780" href="Data.Dyck.Payload.html#2688" class="Bound">is</a> <a id="2783" class="Symbol">(</a><a id="2784" href="Data.Dyck.Payload.html#2675" class="Bound">e</a> <a id="2786" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2788" href="Data.Dyck.Payload.html#2710" class="Bound">st</a><a id="2790" class="Symbol">)</a>
<a id="2792" href="Data.Dyck.Payload.html#2656" class="Function">tree→prog→tree⊙</a> <a id="2808" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[</a> <a id="2810" href="Data.Dyck.Payload.html#2810" class="Bound">x</a> <a id="2812" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">]</a>     <a id="2818" href="Data.Dyck.Payload.html#2818" class="Bound">is</a> <a id="2821" href="Data.Dyck.Payload.html#2821" class="Bound">st</a> <a id="2824" class="Symbol">=</a> <a id="2826" href="Cubical.Foundations.Id.html#570" class="Function">refl</a>
<a id="2831" href="Data.Dyck.Payload.html#2656" class="Function">tree→prog→tree⊙</a> <a id="2847" class="Symbol">(</a><a id="2848" href="Data.Dyck.Payload.html#2848" class="Bound">xs</a> <a id="2851" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">*</a> <a id="2853" href="Data.Dyck.Payload.html#2853" class="Bound">ys</a><a id="2855" class="Symbol">)</a> <a id="2857" href="Data.Dyck.Payload.html#2857" class="Bound">is</a> <a id="2860" href="Data.Dyck.Payload.html#2860" class="Bound">st</a> <a id="2863" class="Symbol">=</a> <a id="2865" href="Data.Dyck.Payload.html#2656" class="Function">tree→prog→tree⊙</a> <a id="2881" href="Data.Dyck.Payload.html#2848" class="Bound">xs</a> <a id="2884" class="Symbol">_</a> <a id="2886" href="Data.Dyck.Payload.html#2860" class="Bound">st</a> <a id="2889" href="Cubical.Foundations.Id.html#747" class="Function Operator">;</a>
                                  <a id="2925" href="Data.Dyck.Payload.html#2656" class="Function">tree→prog→tree⊙</a> <a id="2941" href="Data.Dyck.Payload.html#2853" class="Bound">ys</a> <a id="2944" class="Symbol">(</a><a id="2945" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a> <a id="2950" href="Data.Dyck.Payload.html#2857" class="Bound">is</a><a id="2952" class="Symbol">)</a> <a id="2954" class="Symbol">(</a><a id="2955" href="Data.Dyck.Payload.html#2848" class="Bound">xs</a> <a id="2958" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2960" href="Data.Dyck.Payload.html#2860" class="Bound">st</a><a id="2962" class="Symbol">)</a>

<a id="tree→prog→tree"></a><a id="2965" href="Data.Dyck.Payload.html#2965" class="Function">tree→prog→tree</a> <a id="2980" class="Symbol">:</a> <a id="2982" class="Symbol">(</a><a id="2983" href="Data.Dyck.Payload.html#2983" class="Bound">e</a> <a id="2985" class="Symbol">:</a> <a id="2987" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2992" href="Level.html#388" class="Generalizable">A</a><a id="2993" class="Symbol">)</a> <a id="2995" class="Symbol">→</a> <a id="2997" href="Data.Dyck.Payload.html#1990" class="Function">prog→tree</a> <a id="3007" class="Symbol">(</a><a id="3008" href="Data.Dyck.Payload.html#2401" class="Function">tree→prog</a> <a id="3018" href="Data.Dyck.Payload.html#2983" class="Bound">e</a><a id="3019" class="Symbol">)</a> <a id="3021" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3023" href="Data.Dyck.Payload.html#2983" class="Bound">e</a>
<a id="3025" href="Data.Dyck.Payload.html#2965" class="Function">tree→prog→tree</a> <a id="3040" href="Data.Dyck.Payload.html#3040" class="Bound">e</a> <a id="3042" class="Symbol">=</a> <a id="3044" href="Cubical.Foundations.Id.html#782" class="Function">cong</a> <a id="3049" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="3054" class="Symbol">(</a><a id="3055" href="Data.Dyck.Payload.html#2656" class="Function">tree→prog→tree⊙</a> <a id="3071" href="Data.Dyck.Payload.html#3040" class="Bound">e</a> <a id="3073" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a> <a id="3078" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="3080" class="Symbol">)</a>

<a id="prog→tree→prog⊙"></a><a id="3083" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a> <a id="3099" class="Symbol">:</a> <a id="3101" class="Symbol">(</a><a id="3102" href="Data.Dyck.Payload.html#3102" class="Bound">is</a> <a id="3105" class="Symbol">:</a> <a id="3107" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3112" href="Level.html#388" class="Generalizable">A</a> <a id="3114" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="3115" class="Symbol">)</a> <a id="3117" class="Symbol">(</a><a id="3118" href="Data.Dyck.Payload.html#3118" class="Bound">st</a> <a id="3121" class="Symbol">:</a> <a id="3123" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="3127" class="Symbol">(</a><a id="3128" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="3133" href="Level.html#388" class="Generalizable">A</a><a id="3134" class="Symbol">)</a> <a id="3136" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="3137" class="Symbol">)</a> <a id="3139" class="Symbol">→</a>
 <a id="3142" href="Data.Dyck.Payload.html#2401" class="Function">tree→prog</a> <a id="3152" class="Symbol">(</a><a id="3153" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="3158" class="Symbol">(</a><a id="3159" href="Data.Dyck.Payload.html#1866" class="Function">prog→tree⊙</a> <a id="3170" href="Data.Dyck.Payload.html#3102" class="Bound">is</a> <a id="3173" href="Data.Dyck.Payload.html#3118" class="Bound">st</a><a id="3175" class="Symbol">))</a> <a id="3178" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3180" href="Data.Vec.Iterated.html#997" class="Function">foldlN</a> <a id="3187" class="Symbol">(</a><a id="3188" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3193" href="Level.html#388" class="Generalizable">A</a><a id="3194" class="Symbol">)</a> <a id="3196" href="Data.Dyck.Payload.html#2262" class="Function">tree→prog⊙</a> <a id="3207" href="Data.Dyck.Payload.html#3102" class="Bound">is</a> <a id="3210" href="Data.Dyck.Payload.html#3118" class="Bound">st</a>
<a id="3213" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a>  <a id="3230" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a>       <a id="3241" href="Data.Dyck.Payload.html#3241" class="Bound">st</a> <a id="3244" class="Symbol">=</a> <a id="3246" href="Cubical.Foundations.Id.html#570" class="Function">refl</a>
<a id="3251" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a> <a id="3267" class="Symbol">(</a><a id="3268" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="3273" href="Data.Dyck.Payload.html#3273" class="Bound">i</a> <a id="3275" href="Data.Dyck.Payload.html#3275" class="Bound">is</a><a id="3277" class="Symbol">)</a> <a id="3279" href="Data.Dyck.Payload.html#3279" class="Bound">st</a> <a id="3282" class="Symbol">=</a> <a id="3284" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a> <a id="3300" href="Data.Dyck.Payload.html#3275" class="Bound">is</a> <a id="3303" class="Symbol">(</a><a id="3304" href="Data.Dyck.Payload.html#1793" class="Function">shift</a> <a id="3310" href="Data.Dyck.Payload.html#3273" class="Bound">i</a> <a id="3312" href="Data.Dyck.Payload.html#3279" class="Bound">st</a><a id="3314" class="Symbol">)</a>
<a id="3316" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a> <a id="3332" class="Symbol">(</a><a id="3333" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a>   <a id="3340" href="Data.Dyck.Payload.html#3340" class="Bound">is</a><a id="3342" class="Symbol">)</a> <a id="3344" href="Data.Dyck.Payload.html#3344" class="Bound">st</a> <a id="3347" class="Symbol">=</a> <a id="3349" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a> <a id="3365" href="Data.Dyck.Payload.html#3340" class="Bound">is</a> <a id="3368" class="Symbol">(</a><a id="3369" href="Data.Dyck.Payload.html#1702" class="Function">reduce</a>  <a id="3377" href="Data.Dyck.Payload.html#3344" class="Bound">st</a><a id="3379" class="Symbol">)</a>

<a id="prog→tree→prog"></a><a id="3382" href="Data.Dyck.Payload.html#3382" class="Function">prog→tree→prog</a> <a id="3397" class="Symbol">:</a> <a id="3399" class="Symbol">(</a><a id="3400" href="Data.Dyck.Payload.html#3400" class="Bound">is</a> <a id="3403" class="Symbol">:</a> <a id="3405" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3410" href="Level.html#388" class="Generalizable">A</a> <a id="3412" class="Number">0</a><a id="3413" class="Symbol">)</a> <a id="3415" class="Symbol">→</a> <a id="3417" href="Data.Dyck.Payload.html#2401" class="Function">tree→prog</a> <a id="3427" class="Symbol">(</a><a id="3428" href="Data.Dyck.Payload.html#1990" class="Function">prog→tree</a> <a id="3438" href="Data.Dyck.Payload.html#3400" class="Bound">is</a><a id="3440" class="Symbol">)</a> <a id="3442" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3444" href="Data.Dyck.Payload.html#3400" class="Bound">is</a>
<a id="3447" href="Data.Dyck.Payload.html#3382" class="Function">prog→tree→prog</a> <a id="3462" href="Data.Dyck.Payload.html#3462" class="Bound">is</a> <a id="3465" class="Symbol">=</a> <a id="3467" href="Data.Dyck.Payload.html#3083" class="Function">prog→tree→prog⊙</a> <a id="3483" href="Data.Dyck.Payload.html#3462" class="Bound">is</a> <a id="3486" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a>

<a id="prog-iso"></a><a id="3490" href="Data.Dyck.Payload.html#3490" class="Function">prog-iso</a> <a id="3499" class="Symbol">:</a> <a id="3501" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3506" href="Level.html#388" class="Generalizable">A</a> <a id="3508" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3513" href="Function.Isomorphism.html#338" class="Function Operator">⇔</a> <a id="3515" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="3520" href="Level.html#388" class="Generalizable">A</a>
<a id="3522" href="Data.Dyck.Payload.html#3490" class="Function">prog-iso</a> <a id="3531" class="Symbol">.</a><a id="3532" href="Cubical.Foundations.Isomorphism.html#810" class="Field">fun</a> <a id="3536" class="Symbol">=</a> <a id="3538" href="Data.Dyck.Payload.html#1990" class="Function">prog→tree</a>
<a id="3548" href="Data.Dyck.Payload.html#3490" class="Function">prog-iso</a> <a id="3557" class="Symbol">.</a><a id="3558" href="Cubical.Foundations.Isomorphism.html#826" class="Field">inv</a> <a id="3562" class="Symbol">=</a> <a id="3564" href="Data.Dyck.Payload.html#2401" class="Function">tree→prog</a>
<a id="3574" href="Data.Dyck.Payload.html#3490" class="Function">prog-iso</a> <a id="3583" class="Symbol">.</a><a id="3584" href="Cubical.Foundations.Isomorphism.html#842" class="Field">rightInv</a> <a id="3593" class="Symbol">=</a> <a id="3595" href="Data.Dyck.Payload.html#2965" class="Function">tree→prog→tree</a>
<a id="3610" href="Data.Dyck.Payload.html#3490" class="Function">prog-iso</a> <a id="3619" class="Symbol">.</a><a id="3620" href="Cubical.Foundations.Isomorphism.html#873" class="Field">leftInv</a>  <a id="3629" class="Symbol">=</a> <a id="3631" href="Data.Dyck.Payload.html#3382" class="Function">prog→tree→prog</a>
</pre></body></html>