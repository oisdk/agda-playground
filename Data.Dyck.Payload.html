<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Dyck.Payload</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Symbol">#-}</a>

<a id="57" class="Comment">-- This module defines a data type for balanced strings of parentheses,</a>
<a id="129" class="Comment">-- which is isomorphic to binary trees.</a>

<a id="170" class="Keyword">module</a> <a id="177" href="Data.Dyck.Payload.html" class="Module">Data.Dyck.Payload</a> <a id="195" class="Keyword">where</a>

<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Prelude.html" class="Module">Prelude</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Data.List.html" class="Module">Data.List</a> <a id="244" class="Keyword">using</a> <a id="250" class="Symbol">(</a><a id="251" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="255" class="Symbol">)</a>
<a id="257" class="Keyword">open</a> <a id="262" class="Keyword">import</a> <a id="269" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="278" class="Keyword">using</a> <a id="284" class="Symbol">(</a><a id="285" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="288" class="Symbol">)</a>
<a id="290" class="Keyword">open</a> <a id="295" class="Keyword">import</a> <a id="302" href="Path.Reasoning.html" class="Module">Path.Reasoning</a>
<a id="317" class="Keyword">open</a> <a id="322" class="Keyword">import</a> <a id="329" href="Function.Surjective.html" class="Module">Function.Surjective</a>
<a id="349" class="Keyword">open</a> <a id="354" class="Keyword">import</a> <a id="361" href="Function.Injective.html" class="Module">Function.Injective</a>
<a id="380" class="Keyword">open</a> <a id="385" class="Keyword">import</a> <a id="392" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="412" class="Keyword">using</a> <a id="418" class="Symbol">(</a><a id="419" href="Cubical.Data.Nat.Properties.html#453" class="Function">snotz</a><a id="424" class="Symbol">;</a> <a id="426" href="Cubical.Data.Nat.Properties.html#394" class="Function">znots</a><a id="431" class="Symbol">;</a> <a id="433" href="Data.Nat.Properties.html#272" class="Function">pred</a><a id="437" class="Symbol">)</a>
<a id="439" class="Keyword">open</a> <a id="444" class="Keyword">import</a> <a id="451" href="Data.Vec.Iterated.html" class="Module">Data.Vec.Iterated</a>

<a id="470" class="Keyword">private</a>
  <a id="480" class="Keyword">variable</a>
    <a id="493" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="495" href="Data.Dyck.Payload.html#495" class="Generalizable">m</a> <a id="497" href="Data.Dyck.Payload.html#497" class="Generalizable">k</a> <a id="499" class="Symbol">:</a> <a id="501" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="504" class="Comment">--------------------------------------------------------------------------------</a>
<a id="585" class="Comment">-- Binary trees: definition and associated functions.</a>
<a id="639" class="Comment">--------------------------------------------------------------------------------</a>

<a id="721" class="Comment">-- A basic binary tree type.</a>
<a id="750" class="Keyword">data</a> <a id="Tree"></a><a id="755" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="760" class="Symbol">(</a><a id="761" href="Data.Dyck.Payload.html#761" class="Bound">A</a> <a id="763" class="Symbol">:</a> <a id="765" href="Level.html#192" class="Function">Type</a> <a id="770" href="Level.html#372" class="Generalizable">a</a><a id="771" class="Symbol">)</a> <a id="773" class="Symbol">:</a> <a id="775" href="Level.html#192" class="Function">Type</a> <a id="780" href="Data.Dyck.Payload.html#770" class="Bound">a</a> <a id="782" class="Keyword">where</a>
  <a id="Tree.[_]"></a><a id="790" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[_]</a> <a id="794" class="Symbol">:</a> <a id="796" href="Data.Dyck.Payload.html#761" class="Bound">A</a> <a id="798" class="Symbol">→</a> <a id="800" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="805" href="Data.Dyck.Payload.html#761" class="Bound">A</a>
  <a id="Tree._*_"></a><a id="809" href="Data.Dyck.Payload.html#809" class="InductiveConstructor Operator">_*_</a> <a id="813" class="Symbol">:</a> <a id="815" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="820" href="Data.Dyck.Payload.html#761" class="Bound">A</a> <a id="822" class="Symbol">→</a> <a id="824" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="829" href="Data.Dyck.Payload.html#761" class="Bound">A</a> <a id="831" class="Symbol">→</a> <a id="833" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="838" href="Data.Dyck.Payload.html#761" class="Bound">A</a>

<a id="841" class="Comment">-- Counts the number of branches in the tree</a>
<a id="size⊙"></a><a id="886" href="Data.Dyck.Payload.html#886" class="Function">size⊙</a> <a id="892" class="Symbol">:</a> <a id="894" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="899" href="Level.html#388" class="Generalizable">A</a> <a id="901" class="Symbol">→</a> <a id="903" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="905" class="Symbol">→</a> <a id="907" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="909" href="Data.Dyck.Payload.html#886" class="Function">size⊙</a> <a id="915" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="917" class="Symbol">_</a> <a id="919" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a>     <a id="925" class="Symbol">=</a> <a id="927" href="Function.html#489" class="Function">id</a>
<a id="930" href="Data.Dyck.Payload.html#886" class="Function">size⊙</a> <a id="936" class="Symbol">(</a><a id="937" href="Data.Dyck.Payload.html#937" class="Bound">xs</a> <a id="940" href="Data.Dyck.Payload.html#809" class="InductiveConstructor Operator">*</a> <a id="942" href="Data.Dyck.Payload.html#942" class="Bound">ys</a><a id="944" class="Symbol">)</a> <a id="946" class="Symbol">=</a> <a id="948" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="952" href="Function.html#112" class="Function Operator">∘</a> <a id="954" href="Data.Dyck.Payload.html#886" class="Function">size⊙</a> <a id="960" href="Data.Dyck.Payload.html#937" class="Bound">xs</a> <a id="963" href="Function.html#112" class="Function Operator">∘</a> <a id="965" href="Data.Dyck.Payload.html#886" class="Function">size⊙</a> <a id="971" href="Data.Dyck.Payload.html#942" class="Bound">ys</a>

<a id="size"></a><a id="975" href="Data.Dyck.Payload.html#975" class="Function">size</a> <a id="980" class="Symbol">:</a> <a id="982" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="987" href="Level.html#388" class="Generalizable">A</a> <a id="989" class="Symbol">→</a> <a id="991" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="993" href="Data.Dyck.Payload.html#975" class="Function">size</a> <a id="998" href="Data.Dyck.Payload.html#998" class="Bound">t</a> <a id="1000" class="Symbol">=</a> <a id="1002" href="Data.Dyck.Payload.html#886" class="Function">size⊙</a> <a id="1008" href="Data.Dyck.Payload.html#998" class="Bound">t</a> <a id="1010" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>

<a id="1016" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1097" class="Comment">-- Conversion between binary trees and Progs. (rightwards)</a>
<a id="1156" class="Comment">--------------------------------------------------------------------------------</a>

<a id="1238" class="Keyword">module</a> <a id="Right"></a><a id="1245" href="Data.Dyck.Payload.html#1245" class="Module">Right</a> <a id="1251" class="Keyword">where</a>
  <a id="1259" class="Keyword">data</a> <a id="Right.Prog"></a><a id="1264" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1269" class="Symbol">{</a><a id="1270" href="Data.Dyck.Payload.html#1270" class="Bound">a</a><a id="1271" class="Symbol">}</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1276" class="Symbol">:</a> <a id="1278" href="Level.html#192" class="Function">Type</a> <a id="1283" href="Data.Dyck.Payload.html#1270" class="Bound">a</a><a id="1284" class="Symbol">)</a> <a id="1286" class="Symbol">:</a> <a id="1288" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1290" class="Symbol">→</a> <a id="1292" href="Level.html#192" class="Function">Type</a> <a id="1297" href="Data.Dyck.Payload.html#1270" class="Bound">a</a> <a id="1299" class="Keyword">where</a>
    <a id="Right.Prog.halt"></a><a id="1309" href="Data.Dyck.Payload.html#1309" class="InductiveConstructor">halt</a> <a id="1314" class="Symbol">:</a> <a id="1316" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1321" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1323" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
    <a id="Right.Prog.push"></a><a id="1332" href="Data.Dyck.Payload.html#1332" class="InductiveConstructor">push</a> <a id="1337" class="Symbol">:</a> <a id="1339" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1344" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1346" class="Symbol">(</a><a id="1347" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1351" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="1352" class="Symbol">)</a> <a id="1354" class="Symbol">→</a> <a id="1356" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1361" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1363" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a>
    <a id="Right.Prog.pull"></a><a id="1369" href="Data.Dyck.Payload.html#1369" class="InductiveConstructor">pull</a> <a id="1374" class="Symbol">:</a> <a id="1376" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1378" class="Symbol">→</a> <a id="1380" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1385" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1387" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="1389" class="Symbol">→</a> <a id="1391" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1396" href="Data.Dyck.Payload.html#1274" class="Bound">A</a> <a id="1398" class="Symbol">(</a><a id="1399" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1403" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="1404" class="Symbol">)</a>

  <a id="Right.foldrProg"></a><a id="1409" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="1419" class="Symbol">:</a> <a id="1421" class="Symbol">(</a><a id="1422" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1424" class="Symbol">:</a> <a id="1426" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1428" class="Symbol">→</a> <a id="1430" href="Level.html#192" class="Function">Type</a> <a id="1435" href="Level.html#374" class="Generalizable">b</a><a id="1436" class="Symbol">)</a> <a id="1438" class="Symbol">→</a> <a id="1440" class="Symbol">(∀</a> <a id="1443" class="Symbol">{</a><a id="1444" href="Data.Dyck.Payload.html#1444" class="Bound">n</a><a id="1445" class="Symbol">}</a> <a id="1447" class="Symbol">→</a> <a id="1449" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1456" href="Data.Dyck.Payload.html#1444" class="Bound">n</a><a id="1457" class="Symbol">)</a> <a id="1459" class="Symbol">→</a> <a id="1461" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1463" href="Data.Dyck.Payload.html#1444" class="Bound">n</a><a id="1464" class="Symbol">)</a> <a id="1466" class="Symbol">→</a> <a id="1468" class="Symbol">(∀</a> <a id="1471" class="Symbol">{</a><a id="1472" href="Data.Dyck.Payload.html#1472" class="Bound">n</a><a id="1473" class="Symbol">}</a> <a id="1475" class="Symbol">→</a> <a id="1477" href="Level.html#388" class="Generalizable">A</a> <a id="1479" class="Symbol">→</a> <a id="1481" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1483" href="Data.Dyck.Payload.html#1472" class="Bound">n</a> <a id="1485" class="Symbol">→</a> <a id="1487" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1489" class="Symbol">(</a><a id="1490" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1494" href="Data.Dyck.Payload.html#1472" class="Bound">n</a><a id="1495" class="Symbol">))</a> <a id="1498" class="Symbol">→</a> <a id="1500" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1502" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1507" class="Symbol">→</a> <a id="1509" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1514" href="Level.html#388" class="Generalizable">A</a> <a id="1516" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="1518" class="Symbol">→</a> <a id="1520" href="Data.Dyck.Payload.html#1422" class="Bound">P</a> <a id="1522" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a>
  <a id="1526" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="1536" href="Data.Dyck.Payload.html#1536" class="Bound">P</a> <a id="1538" href="Data.Dyck.Payload.html#1538" class="Bound">l</a> <a id="1540" href="Data.Dyck.Payload.html#1540" class="Bound">r</a> <a id="1542" href="Data.Dyck.Payload.html#1542" class="Bound">h</a> <a id="1544" href="Data.Dyck.Payload.html#1309" class="InductiveConstructor">halt</a>        <a id="1556" class="Symbol">=</a> <a id="1558" href="Data.Dyck.Payload.html#1542" class="Bound">h</a>
  <a id="1562" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="1572" href="Data.Dyck.Payload.html#1572" class="Bound">P</a> <a id="1574" href="Data.Dyck.Payload.html#1574" class="Bound">l</a> <a id="1576" href="Data.Dyck.Payload.html#1576" class="Bound">r</a> <a id="1578" href="Data.Dyck.Payload.html#1578" class="Bound">h</a> <a id="1580" class="Symbol">(</a><a id="1581" href="Data.Dyck.Payload.html#1332" class="InductiveConstructor">push</a>   <a id="1588" href="Data.Dyck.Payload.html#1588" class="Bound">ds</a><a id="1590" class="Symbol">)</a> <a id="1592" class="Symbol">=</a> <a id="1594" href="Data.Dyck.Payload.html#1574" class="Bound">l</a> <a id="1596" class="Symbol">(</a><a id="1597" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="1607" href="Data.Dyck.Payload.html#1572" class="Bound">P</a> <a id="1609" href="Data.Dyck.Payload.html#1574" class="Bound">l</a> <a id="1611" href="Data.Dyck.Payload.html#1576" class="Bound">r</a> <a id="1613" href="Data.Dyck.Payload.html#1578" class="Bound">h</a> <a id="1615" href="Data.Dyck.Payload.html#1588" class="Bound">ds</a><a id="1617" class="Symbol">)</a>
  <a id="1621" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="1631" href="Data.Dyck.Payload.html#1631" class="Bound">P</a> <a id="1633" href="Data.Dyck.Payload.html#1633" class="Bound">l</a> <a id="1635" href="Data.Dyck.Payload.html#1635" class="Bound">r</a> <a id="1637" href="Data.Dyck.Payload.html#1637" class="Bound">h</a> <a id="1639" class="Symbol">(</a><a id="1640" href="Data.Dyck.Payload.html#1369" class="InductiveConstructor">pull</a> <a id="1645" href="Data.Dyck.Payload.html#1645" class="Bound">x</a> <a id="1647" href="Data.Dyck.Payload.html#1647" class="Bound">ds</a><a id="1649" class="Symbol">)</a> <a id="1651" class="Symbol">=</a> <a id="1653" href="Data.Dyck.Payload.html#1635" class="Bound">r</a> <a id="1655" href="Data.Dyck.Payload.html#1645" class="Bound">x</a> <a id="1657" class="Symbol">(</a><a id="1658" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="1668" href="Data.Dyck.Payload.html#1631" class="Bound">P</a> <a id="1670" href="Data.Dyck.Payload.html#1633" class="Bound">l</a> <a id="1672" href="Data.Dyck.Payload.html#1635" class="Bound">r</a> <a id="1674" href="Data.Dyck.Payload.html#1637" class="Bound">h</a> <a id="1676" href="Data.Dyck.Payload.html#1647" class="Bound">ds</a><a id="1678" class="Symbol">)</a>

  <a id="Right.tree→prog⊙"></a><a id="1683" href="Data.Dyck.Payload.html#1683" class="Function">tree→prog⊙</a> <a id="1694" class="Symbol">:</a> <a id="1696" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="1701" href="Level.html#388" class="Generalizable">A</a> <a id="1703" class="Symbol">→</a> <a id="1705" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1710" href="Level.html#388" class="Generalizable">A</a> <a id="1712" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="1714" class="Symbol">→</a> <a id="1716" href="Level.html#388" class="Generalizable">A</a> <a id="1718" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="1720" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1725" href="Level.html#388" class="Generalizable">A</a> <a id="1727" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a>
  <a id="1731" href="Data.Dyck.Payload.html#1683" class="Function">tree→prog⊙</a> <a id="1742" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="1744" href="Data.Dyck.Payload.html#1744" class="Bound">x</a> <a id="1746" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a>     <a id="1752" class="Symbol">=</a> <a id="1754" href="Data.Dyck.Payload.html#1744" class="Bound">x</a> <a id="1756" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a>
  <a id="1761" href="Data.Dyck.Payload.html#1683" class="Function">tree→prog⊙</a> <a id="1772" class="Symbol">(</a><a id="1773" href="Data.Dyck.Payload.html#1773" class="Bound">xs</a> <a id="1776" href="Data.Dyck.Payload.html#809" class="InductiveConstructor Operator">*</a> <a id="1778" href="Data.Dyck.Payload.html#1778" class="Bound">ys</a><a id="1780" class="Symbol">)</a> <a id="1782" class="Symbol">=</a> <a id="1784" href="Data.Sigma.Base.html#1283" class="Function">map₂</a> <a id="1789" href="Data.Dyck.Payload.html#1332" class="InductiveConstructor">push</a> <a id="1794" href="Function.html#112" class="Function Operator">∘</a> <a id="1796" href="Data.Dyck.Payload.html#1683" class="Function">tree→prog⊙</a> <a id="1807" href="Data.Dyck.Payload.html#1773" class="Bound">xs</a> <a id="1810" href="Function.html#112" class="Function Operator">∘</a> <a id="1812" href="Data.Sigma.Base.html#769" class="Function">uncurry</a> <a id="1820" href="Data.Dyck.Payload.html#1369" class="InductiveConstructor">pull</a> <a id="1825" href="Function.html#112" class="Function Operator">∘</a> <a id="1827" href="Data.Dyck.Payload.html#1683" class="Function">tree→prog⊙</a> <a id="1838" href="Data.Dyck.Payload.html#1778" class="Bound">ys</a>

  <a id="1844" class="Comment">-- Tree to Prog</a>
  <a id="Right.tree→prog"></a><a id="1862" href="Data.Dyck.Payload.html#1862" class="Function">tree→prog</a> <a id="1872" class="Symbol">:</a> <a id="1874" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="1879" href="Level.html#388" class="Generalizable">A</a> <a id="1881" class="Symbol">→</a> <a id="1883" href="Level.html#388" class="Generalizable">A</a> <a id="1885" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="1887" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="1892" href="Level.html#388" class="Generalizable">A</a> <a id="1894" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
  <a id="1901" href="Data.Dyck.Payload.html#1862" class="Function">tree→prog</a> <a id="1911" href="Data.Dyck.Payload.html#1911" class="Bound">t</a> <a id="1913" class="Symbol">=</a> <a id="1915" href="Data.Dyck.Payload.html#1683" class="Function">tree→prog⊙</a> <a id="1926" href="Data.Dyck.Payload.html#1911" class="Bound">t</a> <a id="1928" href="Data.Dyck.Payload.html#1309" class="InductiveConstructor">halt</a>

  <a id="Right.reduce"></a><a id="1936" href="Data.Dyck.Payload.html#1936" class="Function">reduce</a> <a id="1943" class="Symbol">:</a> <a id="1945" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1949" class="Symbol">(</a><a id="1950" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="1955" href="Level.html#388" class="Generalizable">A</a><a id="1956" class="Symbol">)</a> <a id="1958" class="Symbol">(</a><a id="1959" class="Number">2</a> <a id="1961" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1963" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="1964" class="Symbol">)</a> <a id="1966" class="Symbol">→</a> <a id="1968" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1972" class="Symbol">(</a><a id="1973" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="1978" href="Level.html#388" class="Generalizable">A</a><a id="1979" class="Symbol">)</a> <a id="1981" class="Symbol">(</a><a id="1982" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1986" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="1987" class="Symbol">)</a>
  <a id="1991" href="Data.Dyck.Payload.html#1936" class="Function">reduce</a> <a id="1998" class="Symbol">(</a><a id="1999" href="Data.Dyck.Payload.html#1999" class="Bound">x</a> <a id="2001" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2003" href="Data.Dyck.Payload.html#2003" class="Bound">y</a> <a id="2005" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2007" href="Data.Dyck.Payload.html#2007" class="Bound">xs</a><a id="2009" class="Symbol">)</a> <a id="2011" class="Symbol">=</a> <a id="2013" class="Symbol">(</a><a id="2014" href="Data.Dyck.Payload.html#1999" class="Bound">x</a> <a id="2016" href="Data.Dyck.Payload.html#809" class="InductiveConstructor Operator">*</a> <a id="2018" href="Data.Dyck.Payload.html#2003" class="Bound">y</a><a id="2019" class="Symbol">)</a> <a id="2021" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2023" href="Data.Dyck.Payload.html#2007" class="Bound">xs</a>

  <a id="Right.shift"></a><a id="2029" href="Data.Dyck.Payload.html#2029" class="Function">shift</a> <a id="2035" class="Symbol">:</a> <a id="2037" href="Level.html#388" class="Generalizable">A</a> <a id="2039" class="Symbol">→</a> <a id="2041" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2045" class="Symbol">(</a><a id="2046" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="2051" href="Level.html#388" class="Generalizable">A</a><a id="2052" class="Symbol">)</a> <a id="2054" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="2056" class="Symbol">→</a> <a id="2058" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2062" class="Symbol">(</a><a id="2063" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="2068" href="Level.html#388" class="Generalizable">A</a><a id="2069" class="Symbol">)</a> <a id="2071" class="Symbol">(</a><a id="2072" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2076" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="2077" class="Symbol">)</a>
  <a id="2081" href="Data.Dyck.Payload.html#2029" class="Function">shift</a> <a id="2087" href="Data.Dyck.Payload.html#2087" class="Bound">x</a> <a id="2089" class="Symbol">=</a> <a id="2091" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="2093" href="Data.Dyck.Payload.html#2087" class="Bound">x</a> <a id="2095" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a> <a id="2097" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷_</a>

  <a id="Right.prog→tree⊙"></a><a id="2103" href="Data.Dyck.Payload.html#2103" class="Function">prog→tree⊙</a> <a id="2114" class="Symbol">:</a> <a id="2116" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2120" class="Symbol">(</a><a id="2121" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="2126" href="Level.html#388" class="Generalizable">A</a><a id="2127" class="Symbol">)</a> <a id="2129" class="Symbol">(</a><a id="2130" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2134" href="Data.Dyck.Payload.html#497" class="Generalizable">k</a><a id="2135" class="Symbol">)</a> <a id="2137" class="Symbol">→</a> <a id="2139" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="2144" href="Level.html#388" class="Generalizable">A</a> <a id="2146" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="2148" class="Symbol">→</a> <a id="2150" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2154" class="Symbol">(</a><a id="2155" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="2160" href="Level.html#388" class="Generalizable">A</a><a id="2161" class="Symbol">)</a> <a id="2163" class="Symbol">(</a><a id="2164" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2168" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="2170" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2172" href="Data.Dyck.Payload.html#497" class="Generalizable">k</a><a id="2173" class="Symbol">)</a>
  <a id="2177" href="Data.Dyck.Payload.html#2103" class="Function">prog→tree⊙</a> <a id="2188" class="Symbol">=</a> <a id="2190" href="Data.Dyck.Payload.html#1409" class="Function">foldrProg</a> <a id="2200" class="Symbol">(λ</a> <a id="2203" href="Data.Dyck.Payload.html#2203" class="Bound">n</a> <a id="2205" class="Symbol">→</a> <a id="2207" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2211" class="Symbol">(</a><a id="2212" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="2217" class="Symbol">_)</a> <a id="2220" class="Symbol">(</a><a id="2221" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2225" href="Data.Dyck.Payload.html#2203" class="Bound">n</a> <a id="2227" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2229" class="Symbol">_))</a> <a id="2233" href="Data.Dyck.Payload.html#1936" class="Function">reduce</a> <a id="2240" href="Data.Dyck.Payload.html#2029" class="Function">shift</a>

  <a id="2249" class="Comment">-- Prog to tree</a>
  <a id="Right.prog→tree"></a><a id="2267" href="Data.Dyck.Payload.html#2267" class="Function">prog→tree</a> <a id="2277" class="Symbol">:</a> <a id="2279" href="Level.html#388" class="Generalizable">A</a> <a id="2281" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="2283" href="Data.Dyck.Payload.html#1264" class="Datatype">Prog</a> <a id="2288" href="Level.html#388" class="Generalizable">A</a> <a id="2290" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2295" class="Symbol">→</a> <a id="2297" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="2302" href="Level.html#388" class="Generalizable">A</a>
  <a id="2306" href="Data.Dyck.Payload.html#2267" class="Function">prog→tree</a> <a id="2316" class="Symbol">(</a><a id="2317" href="Data.Dyck.Payload.html#2317" class="Bound">x</a> <a id="2319" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2321" href="Data.Dyck.Payload.html#2321" class="Bound">xs</a><a id="2323" class="Symbol">)</a> <a id="2325" class="Symbol">=</a> <a id="2327" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="2332" class="Symbol">(</a><a id="2333" href="Data.Dyck.Payload.html#2103" class="Function">prog→tree⊙</a> <a id="2344" class="Symbol">(</a><a id="2345" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="2347" href="Data.Dyck.Payload.html#2317" class="Bound">x</a> <a id="2349" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a> <a id="2351" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2353" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="2355" class="Symbol">)</a> <a id="2357" href="Data.Dyck.Payload.html#2321" class="Bound">xs</a><a id="2359" class="Symbol">)</a>

<a id="2362" class="Comment">--   prog→tree→prog-pop : ∀ (xs : Vec Tree (suc k)) (d : Prog n) t → prog→tree⊙ xs (tree→prog⊙ t (⟩ d)) ≡ t ∷ prog→tree⊙ xs d</a>
<a id="2488" class="Comment">--   prog→tree→prog-pop xs d leaf = refl</a>
<a id="2529" class="Comment">--   prog→tree→prog-pop xs d (ls * rs) =</a>
<a id="2570" class="Comment">--     prog→tree⊙ xs (⟨ tree→prog⊙ ls (⟩ tree→prog⊙ rs (⟩ d)))        ≡⟨⟩</a>
<a id="2644" class="Comment">--     reduce (prog→tree⊙ xs (tree→prog⊙ ls (⟩ tree→prog⊙ rs (⟩ d)))) ≡⟨ cong reduce (prog→tree→prog-pop xs (tree→prog⊙ rs (⟩ d)) ls) ⟩</a>
<a id="2780" class="Comment">--     reduce (ls ∷ prog→tree⊙ xs (tree→prog⊙ rs (⟩ d)))              ≡⟨ cong reduce (cong (ls ∷_) (prog→tree→prog-pop xs d rs)) ⟩</a>
<a id="2911" class="Comment">--     reduce (ls ∷ rs ∷ prog→tree⊙ xs d)                             ≡⟨⟩</a>
<a id="2985" class="Comment">--     (ls * rs) ∷ prog→tree⊙ xs d ∎</a>

<a id="3023" class="Comment">--   prog→tree→prog-push : ∀ t (xs : Vec Tree n) → prog→tree⊙ (leaf ∷ xs) (tree→prog t) ≡ t ∷ xs</a>
<a id="3120" class="Comment">--   prog→tree→prog-push leaf      xs = refl</a>
<a id="3165" class="Comment">--   prog→tree→prog-push (ls * rs) xs =</a>
<a id="3205" class="Comment">--     prog→tree⊙ (leaf ∷ xs) (tree→prog (ls * rs))                     ≡⟨⟩</a>
<a id="3281" class="Comment">--     reduce (prog→tree⊙ (leaf ∷ xs) (tree→prog⊙ ls (⟩ tree→prog rs))) ≡⟨ cong reduce (prog→tree→prog-pop (leaf ∷ xs) (tree→prog rs) ls ) ⟩</a>
<a id="3422" class="Comment">--     reduce (ls ∷ prog→tree⊙ (leaf ∷ xs) (tree→prog rs))              ≡⟨ cong reduce (cong (ls ∷_) (prog→tree→prog-push rs xs)) ⟩</a>
<a id="3554" class="Comment">--     (ls * rs) ∷ xs ∎</a>

<a id="3579" class="Comment">--   prog→tree→prog : ∀ t → prog→tree (tree→prog t) ≡ t</a>
<a id="3635" class="Comment">--   prog→tree→prog t = cong head (prog→tree→prog-push t [])</a>

<a id="3697" class="Comment">--   unreduce : Vec Tree (suc n) → Vec Tree (2 + n)</a>
<a id="3749" class="Comment">--   unreduce (leaf ∷ xs) = leaf ∷ leaf ∷ xs</a>
<a id="3794" class="Comment">--   unreduce ((x₁ * x₂) ∷ xs) = x₁ ∷ x₂ ∷ xs</a>

<a id="3841" class="Comment">--   reduce-inj : {xs ys : Vec Tree (2 + n)} → reduce xs ≡ reduce ys → xs ≡ ys</a>
<a id="3920" class="Comment">--   reduce-inj xs≡ys = cong unreduce xs≡ys</a>

<a id="3965" class="Comment">--   sizes⊙ : Vec Tree n → ℕ → ℕ</a>
<a id="3998" class="Comment">--   sizes⊙ xs n = foldr′ size⊙ n xs</a>

<a id="4036" class="Comment">--   lefts⊙ : Prog n → ℕ → ℕ</a>
<a id="4065" class="Comment">--   lefts⊙ halt n = n</a>
<a id="4088" class="Comment">--   lefts⊙ (⟨ d) n = suc (lefts⊙ d n)</a>
<a id="4127" class="Comment">--   lefts⊙ (⟩ d) n = lefts⊙ d n</a>

<a id="4161" class="Comment">--   sizes : Vec Tree n → ℕ</a>
<a id="4189" class="Comment">--   sizes xs = sizes⊙ xs 0</a>

<a id="4218" class="Comment">--   reduce≢shift : {xs : Vec Tree (2 + n)} → {ys : Vec Tree n} → reduce xs ≢ shift ys</a>
<a id="4305" class="Comment">--   reduce≢shift = snotz ∘ cong (size ∘ head)</a>

<a id="4353" class="Comment">--   sizes-lefts : (vs : Vec Tree (suc k)) → (xs : Prog n) → sizes⊙ (prog→tree⊙ vs xs) m ≡ lefts⊙ xs (sizes⊙ vs m)</a>
<a id="4468" class="Comment">--   sizes-lefts vs halt   = refl</a>
<a id="4502" class="Comment">--   sizes-lefts vs (⟨ xs) = cong suc (sizes-lefts vs xs)</a>
<a id="4560" class="Comment">--   sizes-lefts vs (⟩ xs) = sizes-lefts vs xs</a>

<a id="4608" class="Comment">--   suc-distrib-lefts : ∀ n (x : Prog m) → suc (lefts⊙ x n) ≡ lefts⊙ x (suc n)</a>
<a id="4688" class="Comment">--   suc-distrib-lefts n halt = refl</a>
<a id="4725" class="Comment">--   suc-distrib-lefts n (⟨ x) = cong suc (suc-distrib-lefts n x)</a>
<a id="4791" class="Comment">--   suc-distrib-lefts n (⟩ x) = suc-distrib-lefts n x</a>

<a id="4847" class="Comment">--   lefts-monot : ∀ n (x : Prog m) → n ≢ suc (lefts⊙ x n)</a>
<a id="4906" class="Comment">--   lefts-monot zero x p = znots p</a>
<a id="4942" class="Comment">--   lefts-monot (suc n) x p = lefts-monot n x (cong pred p ; sym (suc-distrib-lefts n x))</a>

<a id="5034" class="Comment">--   prog→tree⊙-inj : (vs : Vec Tree (suc k)) → (xs ys : Prog n) → prog→tree⊙ vs xs ≡ prog→tree⊙ vs ys → xs ≡ ys</a>
<a id="5147" class="Comment">--   prog→tree⊙-inj vs halt halt xs≡ys = refl</a>
<a id="5193" class="Comment">--   prog→tree⊙-inj vs (⟨ xs) (⟨ ys) xs≡ys = cong ⟨_ (prog→tree⊙-inj vs xs ys (reduce-inj xs≡ys))</a>
<a id="5291" class="Comment">--   prog→tree⊙-inj vs (⟩ xs) (⟩ ys) xs≡ys = cong pull (prog→tree⊙-inj vs xs ys (cong tail xs≡ys))</a>
<a id="5390" class="Comment">--   prog→tree⊙-inj vs halt (⟨ ys) xs≡ys = ⊥-elim (lefts-monot (sizes vs) ys (cong sizes xs≡ys ; sizes-lefts vs (⟨ ys)))</a>
<a id="5511" class="Comment">--   prog→tree⊙-inj vs (⟨ xs) halt xs≡ys = ⊥-elim (lefts-monot (sizes vs) xs (cong sizes (sym xs≡ys) ; sizes-lefts vs (⟨ xs)))</a>
<a id="5638" class="Comment">--   prog→tree⊙-inj vs (⟨ xs) (⟩ ys) xs≡ys = ⊥-elim (reduce≢shift xs≡ys)</a>
<a id="5711" class="Comment">--   prog→tree⊙-inj vs (⟩ xs) (⟨ ys) xs≡ys = ⊥-elim (reduce≢shift (sym xs≡ys))</a>

<a id="5791" class="Comment">--   prog→tree-inj : (xs ys : Prog 0) → prog→tree xs ≡ prog→tree ys → xs ≡ ys</a>
<a id="5869" class="Comment">--   prog→tree-inj xs ys xs≡ys = prog→tree⊙-inj (leaf ∷ []) xs ys (cong (_∷ []) xs≡ys)</a>

<a id="5957" class="Comment">--   prog⇔tree : Prog 0 ⇔ Tree</a>
<a id="5988" class="Comment">--   prog⇔tree = surj×inj⇒iso prog→tree (λ y → tree→prog y , prog→tree→prog y) prog→tree-inj</a>

<a id="6082" class="Keyword">module</a> <a id="Left"></a><a id="6089" href="Data.Dyck.Payload.html#6089" class="Module">Left</a> <a id="6094" class="Keyword">where</a>

  <a id="6103" class="Keyword">data</a> <a id="Left.Prog"></a><a id="6108" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6113" class="Symbol">{</a><a id="6114" href="Data.Dyck.Payload.html#6114" class="Bound">a</a><a id="6115" class="Symbol">}</a> <a id="6117" class="Symbol">(</a><a id="6118" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6120" class="Symbol">:</a> <a id="6122" href="Level.html#192" class="Function">Type</a> <a id="6127" href="Data.Dyck.Payload.html#6114" class="Bound">a</a><a id="6128" class="Symbol">)</a> <a id="6130" class="Symbol">:</a> <a id="6132" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="6134" class="Symbol">→</a> <a id="6136" href="Level.html#192" class="Function">Type</a> <a id="6141" href="Data.Dyck.Payload.html#6114" class="Bound">a</a> <a id="6143" class="Keyword">where</a>
    <a id="Left.Prog.halt"></a><a id="6153" href="Data.Dyck.Payload.html#6153" class="InductiveConstructor">halt</a> <a id="6158" class="Symbol">:</a> <a id="6160" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6165" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6167" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
    <a id="Left.Prog.push"></a><a id="6176" href="Data.Dyck.Payload.html#6176" class="InductiveConstructor">push</a> <a id="6181" class="Symbol">:</a> <a id="6183" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6185" class="Symbol">→</a> <a id="6187" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6192" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6194" class="Symbol">(</a><a id="6195" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6199" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6200" class="Symbol">)</a> <a id="6202" class="Symbol">→</a> <a id="6204" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6209" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6211" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a>
    <a id="Left.Prog.pull"></a><a id="6217" href="Data.Dyck.Payload.html#6217" class="InductiveConstructor">pull</a> <a id="6222" class="Symbol">:</a> <a id="6224" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6229" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6231" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="6233" class="Symbol">→</a> <a id="6235" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6240" href="Data.Dyck.Payload.html#6118" class="Bound">A</a> <a id="6242" class="Symbol">(</a><a id="6243" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6247" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6248" class="Symbol">)</a>

  <a id="Left.foldlProg"></a><a id="6253" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="6263" class="Symbol">:</a> <a id="6265" class="Symbol">∀</a> <a id="6267" class="Symbol">{</a><a id="6268" href="Data.Dyck.Payload.html#6268" class="Bound">p</a><a id="6269" class="Symbol">}</a> <a id="6271" class="Symbol">(</a><a id="6272" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6274" class="Symbol">:</a> <a id="6276" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="6278" class="Symbol">→</a> <a id="6280" href="Level.html#192" class="Function">Type</a> <a id="6285" href="Data.Dyck.Payload.html#6268" class="Bound">p</a><a id="6286" class="Symbol">)</a>
              <a id="6302" class="Symbol">(</a><a id="6303" href="Data.Dyck.Payload.html#6303" class="Bound">lbrack</a> <a id="6310" class="Symbol">:</a> <a id="6312" class="Symbol">∀</a> <a id="6314" class="Symbol">{</a><a id="6315" href="Data.Dyck.Payload.html#6315" class="Bound">n</a><a id="6316" class="Symbol">}</a> <a id="6318" class="Symbol">→</a> <a id="6320" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6322" class="Symbol">(</a><a id="6323" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6327" href="Data.Dyck.Payload.html#6315" class="Bound">n</a><a id="6328" class="Symbol">)</a> <a id="6330" class="Symbol">→</a> <a id="6332" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6334" href="Data.Dyck.Payload.html#6315" class="Bound">n</a><a id="6335" class="Symbol">)</a>
              <a id="6351" class="Symbol">(</a><a id="6352" href="Data.Dyck.Payload.html#6352" class="Bound">rbrack</a> <a id="6359" class="Symbol">:</a> <a id="6361" class="Symbol">∀</a> <a id="6363" class="Symbol">{</a><a id="6364" href="Data.Dyck.Payload.html#6364" class="Bound">n</a><a id="6365" class="Symbol">}</a> <a id="6367" class="Symbol">→</a> <a id="6369" href="Level.html#388" class="Generalizable">A</a> <a id="6371" class="Symbol">→</a> <a id="6373" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6375" href="Data.Dyck.Payload.html#6364" class="Bound">n</a> <a id="6377" class="Symbol">→</a> <a id="6379" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6381" class="Symbol">(</a><a id="6382" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="6386" href="Data.Dyck.Payload.html#6364" class="Bound">n</a><a id="6387" class="Symbol">))</a>
              <a id="6404" class="Symbol">(</a><a id="6405" href="Data.Dyck.Payload.html#6405" class="Bound">base</a> <a id="6410" class="Symbol">:</a> <a id="6412" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6414" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6415" class="Symbol">)</a> <a id="6417" class="Symbol">→</a>
              <a id="6433" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6438" href="Level.html#388" class="Generalizable">A</a> <a id="6440" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="6442" class="Symbol">→</a> <a id="6444" href="Data.Dyck.Payload.html#6272" class="Bound">P</a> <a id="6446" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
  <a id="6453" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="6463" href="Data.Dyck.Payload.html#6463" class="Bound">P</a> <a id="6465" href="Data.Dyck.Payload.html#6465" class="Bound">lb</a> <a id="6468" href="Data.Dyck.Payload.html#6468" class="Bound">rb</a> <a id="6471" href="Data.Dyck.Payload.html#6471" class="Bound">bs</a> <a id="6474" href="Data.Dyck.Payload.html#6153" class="InductiveConstructor">halt</a> <a id="6479" class="Symbol">=</a> <a id="6481" href="Data.Dyck.Payload.html#6471" class="Bound">bs</a>
  <a id="6486" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="6496" href="Data.Dyck.Payload.html#6496" class="Bound">P</a> <a id="6498" href="Data.Dyck.Payload.html#6498" class="Bound">lb</a> <a id="6501" href="Data.Dyck.Payload.html#6501" class="Bound">rb</a> <a id="6504" href="Data.Dyck.Payload.html#6504" class="Bound">bs</a> <a id="6507" class="Symbol">(</a><a id="6508" href="Data.Dyck.Payload.html#6176" class="InductiveConstructor">push</a> <a id="6513" href="Data.Dyck.Payload.html#6513" class="Bound">x</a> <a id="6515" href="Data.Dyck.Payload.html#6515" class="Bound">xs</a><a id="6517" class="Symbol">)</a> <a id="6519" class="Symbol">=</a> <a id="6521" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="6531" href="Data.Dyck.Payload.html#6496" class="Bound">P</a> <a id="6533" href="Data.Dyck.Payload.html#6498" class="Bound">lb</a> <a id="6536" href="Data.Dyck.Payload.html#6501" class="Bound">rb</a> <a id="6539" class="Symbol">(</a><a id="6540" href="Data.Dyck.Payload.html#6501" class="Bound">rb</a> <a id="6543" href="Data.Dyck.Payload.html#6513" class="Bound">x</a> <a id="6545" href="Data.Dyck.Payload.html#6504" class="Bound">bs</a><a id="6547" class="Symbol">)</a> <a id="6549" href="Data.Dyck.Payload.html#6515" class="Bound">xs</a>
  <a id="6554" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="6564" href="Data.Dyck.Payload.html#6564" class="Bound">P</a> <a id="6566" href="Data.Dyck.Payload.html#6566" class="Bound">lb</a> <a id="6569" href="Data.Dyck.Payload.html#6569" class="Bound">rb</a> <a id="6572" href="Data.Dyck.Payload.html#6572" class="Bound">bs</a> <a id="6575" class="Symbol">(</a><a id="6576" href="Data.Dyck.Payload.html#6217" class="InductiveConstructor">pull</a>   <a id="6583" href="Data.Dyck.Payload.html#6583" class="Bound">xs</a><a id="6585" class="Symbol">)</a> <a id="6587" class="Symbol">=</a> <a id="6589" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="6599" href="Data.Dyck.Payload.html#6564" class="Bound">P</a> <a id="6601" href="Data.Dyck.Payload.html#6566" class="Bound">lb</a> <a id="6604" href="Data.Dyck.Payload.html#6569" class="Bound">rb</a> <a id="6607" class="Symbol">(</a><a id="6608" href="Data.Dyck.Payload.html#6566" class="Bound">lb</a> <a id="6611" href="Data.Dyck.Payload.html#6572" class="Bound">bs</a><a id="6613" class="Symbol">)</a> <a id="6615" href="Data.Dyck.Payload.html#6583" class="Bound">xs</a>
  <a id="6620" class="Comment">-- In terms of foldr:</a>
  <a id="6644" class="Comment">-- foldlProg P lb rb bs xs = foldrProg (λ n → P n → P zero) (λ x k bs → k (rb x bs)) (λ k bs → k (lb bs)) id xs bs</a>

  <a id="Left.reduce"></a><a id="6762" href="Data.Dyck.Payload.html#6762" class="Function">reduce</a> <a id="6769" class="Symbol">:</a> <a id="6771" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="6775" class="Symbol">(</a><a id="6776" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="6781" href="Level.html#388" class="Generalizable">A</a><a id="6782" class="Symbol">)</a> <a id="6784" class="Symbol">(</a><a id="6785" class="Number">2</a> <a id="6787" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6789" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6790" class="Symbol">)</a> <a id="6792" class="Symbol">→</a> <a id="6794" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="6798" class="Symbol">(</a><a id="6799" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="6804" href="Level.html#388" class="Generalizable">A</a><a id="6805" class="Symbol">)</a> <a id="6807" class="Symbol">(</a><a id="6808" class="Number">1</a> <a id="6810" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6812" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6813" class="Symbol">)</a>
  <a id="6817" href="Data.Dyck.Payload.html#6762" class="Function">reduce</a> <a id="6824" class="Symbol">(</a><a id="6825" href="Data.Dyck.Payload.html#6825" class="Bound">t₁</a> <a id="6828" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="6830" href="Data.Dyck.Payload.html#6830" class="Bound">t₂</a> <a id="6833" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="6835" href="Data.Dyck.Payload.html#6835" class="Bound">s</a><a id="6836" class="Symbol">)</a> <a id="6838" class="Symbol">=</a> <a id="6840" class="Symbol">(</a><a id="6841" href="Data.Dyck.Payload.html#6830" class="Bound">t₂</a> <a id="6844" href="Data.Dyck.Payload.html#809" class="InductiveConstructor Operator">*</a> <a id="6846" href="Data.Dyck.Payload.html#6825" class="Bound">t₁</a><a id="6848" class="Symbol">)</a> <a id="6850" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="6852" href="Data.Dyck.Payload.html#6835" class="Bound">s</a>

  <a id="Left.shift"></a><a id="6857" href="Data.Dyck.Payload.html#6857" class="Function">shift</a> <a id="6863" class="Symbol">:</a> <a id="6865" href="Level.html#388" class="Generalizable">A</a> <a id="6867" class="Symbol">→</a> <a id="6869" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="6873" class="Symbol">(</a><a id="6874" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="6879" href="Level.html#388" class="Generalizable">A</a><a id="6880" class="Symbol">)</a> <a id="6882" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="6884" class="Symbol">→</a> <a id="6886" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="6890" class="Symbol">(</a><a id="6891" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="6896" href="Level.html#388" class="Generalizable">A</a><a id="6897" class="Symbol">)</a> <a id="6899" class="Symbol">(</a><a id="6900" class="Number">1</a> <a id="6902" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6904" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6905" class="Symbol">)</a>
  <a id="6909" href="Data.Dyck.Payload.html#6857" class="Function">shift</a> <a id="6915" href="Data.Dyck.Payload.html#6915" class="Bound">x</a> <a id="6917" href="Data.Dyck.Payload.html#6917" class="Bound">s</a> <a id="6919" class="Symbol">=</a> <a id="6921" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="6923" href="Data.Dyck.Payload.html#6915" class="Bound">x</a> <a id="6925" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a> <a id="6927" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="6929" href="Data.Dyck.Payload.html#6917" class="Bound">s</a>

  <a id="Left.prog→tree⊙"></a><a id="6934" href="Data.Dyck.Payload.html#6934" class="Function">prog→tree⊙</a> <a id="6945" class="Symbol">:</a> <a id="6947" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="6952" href="Level.html#388" class="Generalizable">A</a> <a id="6954" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="6956" class="Symbol">→</a> <a id="6958" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="6962" class="Symbol">(</a><a id="6963" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="6968" href="Level.html#388" class="Generalizable">A</a><a id="6969" class="Symbol">)</a> <a id="6971" class="Symbol">(</a><a id="6972" class="Number">1</a> <a id="6974" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="6976" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a><a id="6977" class="Symbol">)</a> <a id="6979" class="Symbol">→</a> <a id="6981" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="6985" class="Symbol">(</a><a id="6986" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="6991" href="Level.html#388" class="Generalizable">A</a><a id="6992" class="Symbol">)</a> <a id="6994" class="Number">1</a>
  <a id="6998" href="Data.Dyck.Payload.html#6934" class="Function">prog→tree⊙</a> <a id="7009" href="Data.Dyck.Payload.html#7009" class="Bound">p</a> <a id="7011" href="Data.Dyck.Payload.html#7011" class="Bound">s</a> <a id="7013" class="Symbol">=</a> <a id="7015" href="Data.Dyck.Payload.html#6253" class="Function">foldlProg</a> <a id="7025" class="Symbol">(λ</a> <a id="7028" href="Data.Dyck.Payload.html#7028" class="Bound">n</a> <a id="7030" class="Symbol">→</a> <a id="7032" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="7036" class="Symbol">(</a><a id="7037" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="7042" class="Symbol">_)</a> <a id="7045" class="Symbol">(</a><a id="7046" class="Number">1</a> <a id="7048" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="7050" href="Data.Dyck.Payload.html#7028" class="Bound">n</a><a id="7051" class="Symbol">))</a> <a id="7054" href="Data.Dyck.Payload.html#6762" class="Function">reduce</a> <a id="7061" href="Data.Dyck.Payload.html#6857" class="Function">shift</a> <a id="7067" href="Data.Dyck.Payload.html#7011" class="Bound">s</a> <a id="7069" href="Data.Dyck.Payload.html#7009" class="Bound">p</a>

  <a id="7074" class="Comment">-- prog→tree⊙ halt                   s  = s</a>
  <a id="7120" class="Comment">-- prog→tree⊙ (push x ds)            s  = prog→tree⊙ ds ([ x ] ∷ s)</a>
  <a id="7190" class="Comment">-- prog→tree⊙ (pull   ds) (t₁ ∷ t₂ ∷ s) = prog→tree⊙ ds ((t₂ * t₁) ∷ s)</a>

  <a id="Left.prog→tree"></a><a id="7265" href="Data.Dyck.Payload.html#7265" class="Function">prog→tree</a> <a id="7275" class="Symbol">:</a> <a id="7277" href="Level.html#388" class="Generalizable">A</a> <a id="7279" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="7281" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="7286" href="Level.html#388" class="Generalizable">A</a> <a id="7288" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="7293" class="Symbol">→</a> <a id="7295" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="7300" href="Level.html#388" class="Generalizable">A</a>
  <a id="7304" href="Data.Dyck.Payload.html#7265" class="Function">prog→tree</a> <a id="7314" class="Symbol">(</a><a id="7315" href="Data.Dyck.Payload.html#7315" class="Bound">x</a> <a id="7317" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="7319" href="Data.Dyck.Payload.html#7319" class="Bound">ds</a><a id="7321" class="Symbol">)</a> <a id="7323" class="Symbol">=</a> <a id="7325" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="7330" class="Symbol">(</a><a id="7331" href="Data.Dyck.Payload.html#6934" class="Function">prog→tree⊙</a> <a id="7342" href="Data.Dyck.Payload.html#7319" class="Bound">ds</a> <a id="7345" class="Symbol">(</a><a id="7346" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="7348" href="Data.Dyck.Payload.html#7315" class="Bound">x</a> <a id="7350" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a> <a id="7352" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="7354" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="7356" class="Symbol">))</a>

  <a id="Left.tree→prog⊙"></a><a id="7362" href="Data.Dyck.Payload.html#7362" class="Function">tree→prog⊙</a> <a id="7373" class="Symbol">:</a> <a id="7375" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="7380" href="Level.html#388" class="Generalizable">A</a> <a id="7382" class="Symbol">→</a> <a id="7384" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="7389" href="Level.html#388" class="Generalizable">A</a> <a id="7391" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a> <a id="7393" class="Symbol">→</a> <a id="7395" href="Level.html#388" class="Generalizable">A</a> <a id="7397" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="7399" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="7404" href="Level.html#388" class="Generalizable">A</a> <a id="7406" href="Data.Dyck.Payload.html#493" class="Generalizable">n</a>
  <a id="7410" href="Data.Dyck.Payload.html#7362" class="Function">tree→prog⊙</a> <a id="7421" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">[</a> <a id="7423" href="Data.Dyck.Payload.html#7423" class="Bound">x</a> <a id="7425" href="Data.Dyck.Payload.html#790" class="InductiveConstructor Operator">]</a>     <a id="7431" class="Symbol">=</a> <a id="7433" href="Data.Dyck.Payload.html#7423" class="Bound">x</a> <a id="7435" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,_</a>
  <a id="7440" href="Data.Dyck.Payload.html#7362" class="Function">tree→prog⊙</a> <a id="7451" class="Symbol">(</a><a id="7452" href="Data.Dyck.Payload.html#7452" class="Bound">xs</a> <a id="7455" href="Data.Dyck.Payload.html#809" class="InductiveConstructor Operator">*</a> <a id="7457" href="Data.Dyck.Payload.html#7457" class="Bound">ys</a><a id="7459" class="Symbol">)</a> <a id="7461" class="Symbol">=</a> <a id="7463" href="Data.Dyck.Payload.html#7362" class="Function">tree→prog⊙</a> <a id="7474" href="Data.Dyck.Payload.html#7452" class="Bound">xs</a> <a id="7477" href="Function.html#112" class="Function Operator">∘</a> <a id="7479" href="Data.Sigma.Base.html#769" class="Function">uncurry</a> <a id="7487" href="Data.Dyck.Payload.html#6176" class="InductiveConstructor">push</a> <a id="7492" href="Function.html#112" class="Function Operator">∘</a> <a id="7494" href="Data.Dyck.Payload.html#7362" class="Function">tree→prog⊙</a> <a id="7505" href="Data.Dyck.Payload.html#7457" class="Bound">ys</a> <a id="7508" href="Function.html#112" class="Function Operator">∘</a> <a id="7510" href="Data.Dyck.Payload.html#6217" class="InductiveConstructor">pull</a>

  <a id="Left.tree→prog"></a><a id="7518" href="Data.Dyck.Payload.html#7518" class="Function">tree→prog</a> <a id="7528" class="Symbol">:</a> <a id="7530" href="Data.Dyck.Payload.html#755" class="Datatype">Tree</a> <a id="7535" href="Level.html#388" class="Generalizable">A</a> <a id="7537" class="Symbol">→</a> <a id="7539" href="Level.html#388" class="Generalizable">A</a> <a id="7541" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="7543" href="Data.Dyck.Payload.html#6108" class="Datatype">Prog</a> <a id="7548" href="Level.html#388" class="Generalizable">A</a> <a id="7550" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
  <a id="7557" href="Data.Dyck.Payload.html#7518" class="Function">tree→prog</a> <a id="7567" href="Data.Dyck.Payload.html#7567" class="Bound">tr</a> <a id="7570" class="Symbol">=</a> <a id="7572" href="Data.Dyck.Payload.html#7362" class="Function">tree→prog⊙</a> <a id="7583" href="Data.Dyck.Payload.html#7567" class="Bound">tr</a> <a id="7586" href="Data.Dyck.Payload.html#6153" class="InductiveConstructor">halt</a>
</pre></body></html>