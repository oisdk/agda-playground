<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Dyck.Payload</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Symbol">#-}</a>

<a id="57" class="Comment">-- This module defines a data type for balanced strings of parentheses,</a>
<a id="129" class="Comment">-- which is isomorphic to binary trees.</a>

<a id="170" class="Keyword">module</a> <a id="177" href="Data.Dyck.Payload.html" class="Module">Data.Dyck.Payload</a> <a id="195" class="Keyword">where</a>

<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Prelude.html" class="Module">Prelude</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="243" class="Keyword">using</a> <a id="249" class="Symbol">(</a><a id="250" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="253" class="Symbol">)</a>
<a id="255" class="Keyword">open</a> <a id="260" class="Keyword">import</a> <a id="267" href="Data.Vec.Iterated.html" class="Module">Data.Vec.Iterated</a> <a id="285" class="Keyword">using</a> <a id="291" class="Symbol">(</a><a id="292" href="Data.Vec.Iterated.html#250" class="Function">Vec</a><a id="295" class="Symbol">;</a> <a id="297" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">_∷_</a><a id="300" class="Symbol">;</a> <a id="302" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="304" class="Symbol">;</a> <a id="306" href="Data.Vec.Iterated.html#997" class="Function">foldlN</a><a id="312" class="Symbol">;</a> <a id="314" href="Data.Vec.Iterated.html#519" class="Field">head</a><a id="318" class="Symbol">)</a>

<a id="321" class="Keyword">private</a>
  <a id="331" class="Keyword">variable</a>
    <a id="344" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="346" class="Symbol">:</a> <a id="348" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="351" class="Comment">--------------------------------------------------------------------------------</a>
<a id="432" class="Comment">-- Binary trees: definition and associated functions</a>
<a id="485" class="Comment">--------------------------------------------------------------------------------</a>

<a id="567" class="Keyword">data</a> <a id="Tree"></a><a id="572" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="577" class="Symbol">(</a><a id="578" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="580" class="Symbol">:</a> <a id="582" href="Level.html#192" class="Function">Type</a> <a id="587" href="Level.html#372" class="Generalizable">a</a><a id="588" class="Symbol">)</a> <a id="590" class="Symbol">:</a> <a id="592" href="Level.html#192" class="Function">Type</a> <a id="597" href="Data.Dyck.Payload.html#587" class="Bound">a</a> <a id="599" class="Keyword">where</a>
  <a id="Tree.[_]"></a><a id="607" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[_]</a> <a id="611" class="Symbol">:</a> <a id="613" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="615" class="Symbol">→</a> <a id="617" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="622" href="Data.Dyck.Payload.html#578" class="Bound">A</a>
  <a id="Tree._*_"></a><a id="626" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">_*_</a> <a id="630" class="Symbol">:</a> <a id="632" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="637" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="639" class="Symbol">→</a> <a id="641" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="646" href="Data.Dyck.Payload.html#578" class="Bound">A</a> <a id="648" class="Symbol">→</a> <a id="650" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="655" href="Data.Dyck.Payload.html#578" class="Bound">A</a>

<a id="658" class="Comment">--------------------------------------------------------------------------------</a>
<a id="739" class="Comment">-- Programs: definition and associated functions</a>
<a id="788" class="Comment">--------------------------------------------------------------------------------</a>

<a id="870" class="Keyword">data</a> <a id="Prog"></a><a id="875" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="880" class="Symbol">{</a><a id="881" href="Data.Dyck.Payload.html#881" class="Bound">a</a><a id="882" class="Symbol">}</a> <a id="884" class="Symbol">(</a><a id="885" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="887" class="Symbol">:</a> <a id="889" href="Level.html#192" class="Function">Type</a> <a id="894" href="Data.Dyck.Payload.html#881" class="Bound">a</a><a id="895" class="Symbol">)</a> <a id="897" class="Symbol">:</a> <a id="899" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="901" class="Symbol">→</a> <a id="903" href="Level.html#192" class="Function">Type</a> <a id="908" href="Data.Dyck.Payload.html#881" class="Bound">a</a> <a id="910" class="Keyword">where</a>
  <a id="Prog.halt"></a><a id="918" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a> <a id="923" class="Symbol">:</a> <a id="925" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="930" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="932" class="Number">1</a>
  <a id="Prog.push"></a><a id="936" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="941" class="Symbol">:</a> <a id="943" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="945" class="Symbol">→</a> <a id="947" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="952" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="954" class="Symbol">(</a><a id="955" class="Number">1</a> <a id="957" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="959" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="960" class="Symbol">)</a> <a id="962" class="Symbol">→</a> <a id="964" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="969" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="971" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a>
  <a id="Prog.pull"></a><a id="975" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a> <a id="980" class="Symbol">:</a> <a id="982" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="987" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="989" class="Symbol">(</a><a id="990" class="Number">1</a> <a id="992" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="994" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="995" class="Symbol">)</a> <a id="997" class="Symbol">→</a> <a id="999" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1004" href="Data.Dyck.Payload.html#885" class="Bound">A</a> <a id="1006" class="Symbol">(</a><a id="1007" class="Number">2</a> <a id="1009" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1011" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1012" class="Symbol">)</a>

<a id="1015" class="Keyword">module</a> <a id="1022" href="Data.Dyck.Payload.html#1022" class="Module">_</a><a id="1023" class="Symbol">{</a><a id="1024" href="Data.Dyck.Payload.html#1024" class="Bound">p</a><a id="1025" class="Symbol">}</a> <a id="1027" class="Symbol">(</a><a id="1028" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1030" class="Symbol">:</a> <a id="1032" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="Level.html#192" class="Function">Type</a> <a id="1041" href="Data.Dyck.Payload.html#1024" class="Bound">p</a><a id="1042" class="Symbol">)</a>
            <a id="1056" class="Symbol">(</a><a id="1057" href="Data.Dyck.Payload.html#1057" class="Bound">lb</a> <a id="1060" class="Symbol">:</a> <a id="1062" class="Symbol">∀</a> <a id="1064" class="Symbol">{</a><a id="1065" href="Data.Dyck.Payload.html#1065" class="Bound">n</a><a id="1066" class="Symbol">}</a> <a id="1068" class="Symbol">→</a> <a id="1070" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1072" class="Symbol">(</a><a id="1073" class="Number">2</a> <a id="1075" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1077" href="Data.Dyck.Payload.html#1065" class="Bound">n</a><a id="1078" class="Symbol">)</a> <a id="1080" class="Symbol">→</a> <a id="1082" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1084" class="Symbol">(</a><a id="1085" class="Number">1</a> <a id="1087" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1089" href="Data.Dyck.Payload.html#1065" class="Bound">n</a><a id="1090" class="Symbol">))</a>
            <a id="1105" class="Symbol">(</a><a id="1106" href="Data.Dyck.Payload.html#1106" class="Bound">rb</a> <a id="1109" class="Symbol">:</a> <a id="1111" class="Symbol">∀</a> <a id="1113" class="Symbol">{</a><a id="1114" href="Data.Dyck.Payload.html#1114" class="Bound">n</a><a id="1115" class="Symbol">}</a> <a id="1117" class="Symbol">→</a> <a id="1119" href="Level.html#388" class="Generalizable">A</a> <a id="1121" class="Symbol">→</a> <a id="1123" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1125" href="Data.Dyck.Payload.html#1114" class="Bound">n</a> <a id="1127" class="Symbol">→</a> <a id="1129" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1131" class="Symbol">(</a><a id="1132" class="Number">1</a> <a id="1134" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1136" href="Data.Dyck.Payload.html#1114" class="Bound">n</a><a id="1137" class="Symbol">))</a>
            <a id="1152" class="Keyword">where</a>
  <a id="1160" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1165" class="Symbol">:</a> <a id="1167" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1169" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1171" class="Symbol">→</a> <a id="1173" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1178" href="Data.Dyck.Payload.html#1119" class="Bound">A</a> <a id="1180" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1182" class="Symbol">→</a> <a id="1184" href="Data.Dyck.Payload.html#1028" class="Bound">P</a> <a id="1186" class="Number">1</a>
  <a id="1190" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1195" href="Data.Dyck.Payload.html#1195" class="Bound">bs</a> <a id="1198" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a>        <a id="1210" class="Symbol">=</a> <a id="1212" href="Data.Dyck.Payload.html#1195" class="Bound">bs</a>
  <a id="1217" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1222" href="Data.Dyck.Payload.html#1222" class="Bound">bs</a> <a id="1225" class="Symbol">(</a><a id="1226" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="1231" href="Data.Dyck.Payload.html#1231" class="Bound">x</a> <a id="1233" href="Data.Dyck.Payload.html#1233" class="Bound">xs</a><a id="1235" class="Symbol">)</a> <a id="1237" class="Symbol">=</a> <a id="1239" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1244" class="Symbol">(</a><a id="1245" href="Data.Dyck.Payload.html#1106" class="Bound">rb</a> <a id="1248" href="Data.Dyck.Payload.html#1231" class="Bound">x</a> <a id="1250" href="Data.Dyck.Payload.html#1222" class="Bound">bs</a><a id="1252" class="Symbol">)</a> <a id="1254" href="Data.Dyck.Payload.html#1233" class="Bound">xs</a>
  <a id="1259" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1264" href="Data.Dyck.Payload.html#1264" class="Bound">bs</a> <a id="1267" class="Symbol">(</a><a id="1268" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a>   <a id="1275" href="Data.Dyck.Payload.html#1275" class="Bound">xs</a><a id="1277" class="Symbol">)</a> <a id="1279" class="Symbol">=</a> <a id="1281" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1286" class="Symbol">(</a><a id="1287" href="Data.Dyck.Payload.html#1057" class="Bound">lb</a>   <a id="1292" href="Data.Dyck.Payload.html#1264" class="Bound">bs</a><a id="1294" class="Symbol">)</a> <a id="1296" href="Data.Dyck.Payload.html#1275" class="Bound">xs</a>
<a id="1299" class="Comment">-- In terms of foldr:</a>
<a id="1321" class="Comment">-- runl P lb rb bs xs =</a>
<a id="1345" class="Comment">--     foldrProg</a>
<a id="1362" class="Comment">--       (λ n → P n → P zero)</a>
<a id="1392" class="Comment">--       (λ x k bs → k (rb x bs))</a>
<a id="1426" class="Comment">--       (λ k bs → k (lb bs))</a>
<a id="1456" class="Comment">--       id xs bs</a>

<a id="1475" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1556" class="Comment">-- Conversion from a Prog to a Tree</a>
<a id="1592" class="Comment">--------------------------------------------------------------------------------</a>

<a id="reduce"></a><a id="1674" href="Data.Dyck.Payload.html#1674" class="Function">reduce</a> <a id="1681" class="Symbol">:</a> <a id="1683" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1687" class="Symbol">(</a><a id="1688" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1693" href="Level.html#388" class="Generalizable">A</a><a id="1694" class="Symbol">)</a> <a id="1696" class="Symbol">(</a><a id="1697" class="Number">2</a> <a id="1699" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1701" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1702" class="Symbol">)</a> <a id="1704" class="Symbol">→</a> <a id="1706" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1710" class="Symbol">(</a><a id="1711" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1716" href="Level.html#388" class="Generalizable">A</a><a id="1717" class="Symbol">)</a> <a id="1719" class="Symbol">(</a><a id="1720" class="Number">1</a> <a id="1722" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1724" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1725" class="Symbol">)</a>
<a id="1727" href="Data.Dyck.Payload.html#1674" class="Function">reduce</a> <a id="1734" class="Symbol">(</a><a id="1735" href="Data.Dyck.Payload.html#1735" class="Bound">t₁</a> <a id="1738" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1740" href="Data.Dyck.Payload.html#1740" class="Bound">t₂</a> <a id="1743" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1745" href="Data.Dyck.Payload.html#1745" class="Bound">s</a><a id="1746" class="Symbol">)</a> <a id="1748" class="Symbol">=</a> <a id="1750" class="Symbol">(</a><a id="1751" href="Data.Dyck.Payload.html#1740" class="Bound">t₂</a> <a id="1754" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">*</a> <a id="1756" href="Data.Dyck.Payload.html#1735" class="Bound">t₁</a><a id="1758" class="Symbol">)</a> <a id="1760" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1762" href="Data.Dyck.Payload.html#1745" class="Bound">s</a>

<a id="shift"></a><a id="1765" href="Data.Dyck.Payload.html#1765" class="Function">shift</a> <a id="1771" class="Symbol">:</a> <a id="1773" href="Level.html#388" class="Generalizable">A</a> <a id="1775" class="Symbol">→</a> <a id="1777" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1781" class="Symbol">(</a><a id="1782" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1787" href="Level.html#388" class="Generalizable">A</a><a id="1788" class="Symbol">)</a> <a id="1790" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1792" class="Symbol">→</a> <a id="1794" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1798" class="Symbol">(</a><a id="1799" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1804" href="Level.html#388" class="Generalizable">A</a><a id="1805" class="Symbol">)</a> <a id="1807" class="Symbol">(</a><a id="1808" class="Number">1</a> <a id="1810" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1812" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="1813" class="Symbol">)</a>
<a id="1815" href="Data.Dyck.Payload.html#1765" class="Function">shift</a> <a id="1821" href="Data.Dyck.Payload.html#1821" class="Bound">x</a> <a id="1823" href="Data.Dyck.Payload.html#1823" class="Bound">s</a> <a id="1825" class="Symbol">=</a> <a id="1827" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[</a> <a id="1829" href="Data.Dyck.Payload.html#1821" class="Bound">x</a> <a id="1831" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">]</a> <a id="1833" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1835" href="Data.Dyck.Payload.html#1823" class="Bound">s</a>

<a id="prog→tree⊙"></a><a id="1838" href="Data.Dyck.Payload.html#1838" class="Function">prog→tree⊙</a> <a id="1849" class="Symbol">:</a> <a id="1851" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1856" href="Level.html#388" class="Generalizable">A</a> <a id="1858" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1860" class="Symbol">→</a> <a id="1862" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1866" class="Symbol">(</a><a id="1867" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1872" href="Level.html#388" class="Generalizable">A</a><a id="1873" class="Symbol">)</a> <a id="1875" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a> <a id="1877" class="Symbol">→</a> <a id="1879" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1883" class="Symbol">(</a><a id="1884" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1889" href="Level.html#388" class="Generalizable">A</a><a id="1890" class="Symbol">)</a> <a id="1892" class="Number">1</a>
<a id="1894" href="Data.Dyck.Payload.html#1838" class="Function">prog→tree⊙</a> <a id="1905" href="Data.Dyck.Payload.html#1905" class="Bound">p</a> <a id="1907" href="Data.Dyck.Payload.html#1907" class="Bound">s</a> <a id="1909" class="Symbol">=</a> <a id="1911" href="Data.Dyck.Payload.html#1160" class="Function">runl</a> <a id="1916" class="Symbol">(λ</a> <a id="1919" href="Data.Dyck.Payload.html#1919" class="Bound">n</a> <a id="1921" class="Symbol">→</a> <a id="1923" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1927" class="Symbol">(</a><a id="1928" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1933" class="Symbol">_)</a> <a id="1936" href="Data.Dyck.Payload.html#1919" class="Bound">n</a><a id="1937" class="Symbol">)</a> <a id="1939" href="Data.Dyck.Payload.html#1674" class="Function">reduce</a> <a id="1946" href="Data.Dyck.Payload.html#1765" class="Function">shift</a> <a id="1952" href="Data.Dyck.Payload.html#1907" class="Bound">s</a> <a id="1954" href="Data.Dyck.Payload.html#1905" class="Bound">p</a>

<a id="prog→tree"></a><a id="1957" href="Data.Dyck.Payload.html#1957" class="Function">prog→tree</a> <a id="1967" class="Symbol">:</a> <a id="1969" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="1974" href="Level.html#388" class="Generalizable">A</a> <a id="1976" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="1981" class="Symbol">→</a> <a id="1983" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="1988" href="Level.html#388" class="Generalizable">A</a>
<a id="1990" href="Data.Dyck.Payload.html#1957" class="Function">prog→tree</a> <a id="2000" href="Data.Dyck.Payload.html#2000" class="Bound">ds</a> <a id="2003" class="Symbol">=</a> <a id="2005" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="2010" class="Symbol">(</a><a id="2011" href="Data.Dyck.Payload.html#1838" class="Function">prog→tree⊙</a> <a id="2022" href="Data.Dyck.Payload.html#2000" class="Bound">ds</a> <a id="2025" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="2027" class="Symbol">)</a>

<a id="2030" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2111" class="Comment">-- Conversion from a Tree to a Prog</a>
<a id="2147" class="Comment">--------------------------------------------------------------------------------</a>

<a id="tree→prog⊙"></a><a id="2229" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2240" class="Symbol">:</a> <a id="2242" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2247" href="Level.html#388" class="Generalizable">A</a> <a id="2249" class="Symbol">→</a> <a id="2251" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2256" href="Level.html#388" class="Generalizable">A</a> <a id="2258" class="Symbol">(</a><a id="2259" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2263" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="2264" class="Symbol">)</a> <a id="2266" class="Symbol">→</a> <a id="2268" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2273" href="Level.html#388" class="Generalizable">A</a> <a id="2275" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a>
<a id="2277" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2288" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[</a> <a id="2290" href="Data.Dyck.Payload.html#2290" class="Bound">x</a> <a id="2292" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">]</a>     <a id="2298" class="Symbol">=</a> <a id="2300" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="2305" href="Data.Dyck.Payload.html#2290" class="Bound">x</a>
<a id="2307" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2318" class="Symbol">(</a><a id="2319" href="Data.Dyck.Payload.html#2319" class="Bound">xs</a> <a id="2322" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">*</a> <a id="2324" href="Data.Dyck.Payload.html#2324" class="Bound">ys</a><a id="2326" class="Symbol">)</a> <a id="2328" class="Symbol">=</a> <a id="2330" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2341" href="Data.Dyck.Payload.html#2319" class="Bound">xs</a> <a id="2344" href="Function.html#112" class="Function Operator">∘</a> <a id="2346" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2357" href="Data.Dyck.Payload.html#2324" class="Bound">ys</a> <a id="2360" href="Function.html#112" class="Function Operator">∘</a> <a id="2362" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a>

<a id="tree→prog"></a><a id="2368" href="Data.Dyck.Payload.html#2368" class="Function">tree→prog</a> <a id="2378" class="Symbol">:</a> <a id="2380" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2385" href="Level.html#388" class="Generalizable">A</a> <a id="2387" class="Symbol">→</a> <a id="2389" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2394" href="Level.html#388" class="Generalizable">A</a> <a id="2396" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="2401" href="Data.Dyck.Payload.html#2368" class="Function">tree→prog</a> <a id="2411" href="Data.Dyck.Payload.html#2411" class="Bound">tr</a> <a id="2414" class="Symbol">=</a> <a id="2416" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2427" href="Data.Dyck.Payload.html#2411" class="Bound">tr</a> <a id="2430" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a>

<a id="2436" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2517" class="Comment">-- Proof of isomorphism</a>
<a id="2541" class="Comment">--------------------------------------------------------------------------------</a>

<a id="tree→prog→tree⊙"></a><a id="2623" href="Data.Dyck.Payload.html#2623" class="Function">tree→prog→tree⊙</a> <a id="2639" class="Symbol">:</a> <a id="2641" class="Symbol">(</a><a id="2642" href="Data.Dyck.Payload.html#2642" class="Bound">e</a> <a id="2644" class="Symbol">:</a> <a id="2646" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2651" href="Level.html#388" class="Generalizable">A</a><a id="2652" class="Symbol">)</a> <a id="2654" class="Symbol">(</a><a id="2655" href="Data.Dyck.Payload.html#2655" class="Bound">is</a> <a id="2658" class="Symbol">:</a> <a id="2660" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="2665" href="Level.html#388" class="Generalizable">A</a> <a id="2667" class="Symbol">(</a><a id="2668" class="Number">1</a> <a id="2670" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2672" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="2673" class="Symbol">))</a> <a id="2676" class="Symbol">(</a><a id="2677" href="Data.Dyck.Payload.html#2677" class="Bound">st</a> <a id="2680" class="Symbol">:</a> <a id="2682" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2686" class="Symbol">(</a><a id="2687" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2692" href="Level.html#388" class="Generalizable">A</a><a id="2693" class="Symbol">)</a> <a id="2695" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="2696" class="Symbol">)</a> <a id="2698" class="Symbol">→</a>
  <a id="2702" href="Data.Dyck.Payload.html#1838" class="Function">prog→tree⊙</a> <a id="2713" class="Symbol">(</a><a id="2714" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="2725" href="Data.Dyck.Payload.html#2642" class="Bound">e</a> <a id="2727" href="Data.Dyck.Payload.html#2655" class="Bound">is</a><a id="2729" class="Symbol">)</a> <a id="2731" href="Data.Dyck.Payload.html#2677" class="Bound">st</a> <a id="2734" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2736" href="Data.Dyck.Payload.html#1838" class="Function">prog→tree⊙</a> <a id="2747" href="Data.Dyck.Payload.html#2655" class="Bound">is</a> <a id="2750" class="Symbol">(</a><a id="2751" href="Data.Dyck.Payload.html#2642" class="Bound">e</a> <a id="2753" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2755" href="Data.Dyck.Payload.html#2677" class="Bound">st</a><a id="2757" class="Symbol">)</a>
<a id="2759" href="Data.Dyck.Payload.html#2623" class="Function">tree→prog→tree⊙</a> <a id="2775" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">[</a> <a id="2777" href="Data.Dyck.Payload.html#2777" class="Bound">x</a> <a id="2779" href="Data.Dyck.Payload.html#607" class="InductiveConstructor Operator">]</a>     <a id="2785" href="Data.Dyck.Payload.html#2785" class="Bound">is</a> <a id="2788" href="Data.Dyck.Payload.html#2788" class="Bound">st</a> <a id="2791" class="Symbol">=</a> <a id="2793" href="Cubical.Foundations.Id.html#570" class="Function">refl</a>
<a id="2798" href="Data.Dyck.Payload.html#2623" class="Function">tree→prog→tree⊙</a> <a id="2814" class="Symbol">(</a><a id="2815" href="Data.Dyck.Payload.html#2815" class="Bound">xs</a> <a id="2818" href="Data.Dyck.Payload.html#626" class="InductiveConstructor Operator">*</a> <a id="2820" href="Data.Dyck.Payload.html#2820" class="Bound">ys</a><a id="2822" class="Symbol">)</a> <a id="2824" href="Data.Dyck.Payload.html#2824" class="Bound">is</a> <a id="2827" href="Data.Dyck.Payload.html#2827" class="Bound">st</a> <a id="2830" class="Symbol">=</a> <a id="2832" href="Data.Dyck.Payload.html#2623" class="Function">tree→prog→tree⊙</a> <a id="2848" href="Data.Dyck.Payload.html#2815" class="Bound">xs</a> <a id="2851" class="Symbol">_</a> <a id="2853" href="Data.Dyck.Payload.html#2827" class="Bound">st</a> <a id="2856" href="Cubical.Foundations.Id.html#747" class="Function Operator">;</a>
                                  <a id="2892" href="Data.Dyck.Payload.html#2623" class="Function">tree→prog→tree⊙</a> <a id="2908" href="Data.Dyck.Payload.html#2820" class="Bound">ys</a> <a id="2911" class="Symbol">(</a><a id="2912" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a> <a id="2917" href="Data.Dyck.Payload.html#2824" class="Bound">is</a><a id="2919" class="Symbol">)</a> <a id="2921" class="Symbol">(</a><a id="2922" href="Data.Dyck.Payload.html#2815" class="Bound">xs</a> <a id="2925" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2927" href="Data.Dyck.Payload.html#2827" class="Bound">st</a><a id="2929" class="Symbol">)</a>

<a id="tree→prog→tree"></a><a id="2932" href="Data.Dyck.Payload.html#2932" class="Function">tree→prog→tree</a> <a id="2947" class="Symbol">:</a> <a id="2949" class="Symbol">(</a><a id="2950" href="Data.Dyck.Payload.html#2950" class="Bound">e</a> <a id="2952" class="Symbol">:</a> <a id="2954" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="2959" href="Level.html#388" class="Generalizable">A</a><a id="2960" class="Symbol">)</a> <a id="2962" class="Symbol">→</a> <a id="2964" href="Data.Dyck.Payload.html#1957" class="Function">prog→tree</a> <a id="2974" class="Symbol">(</a><a id="2975" href="Data.Dyck.Payload.html#2368" class="Function">tree→prog</a> <a id="2985" href="Data.Dyck.Payload.html#2950" class="Bound">e</a><a id="2986" class="Symbol">)</a> <a id="2988" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2990" href="Data.Dyck.Payload.html#2950" class="Bound">e</a>
<a id="2992" href="Data.Dyck.Payload.html#2932" class="Function">tree→prog→tree</a> <a id="3007" href="Data.Dyck.Payload.html#3007" class="Bound">e</a> <a id="3009" class="Symbol">=</a> <a id="3011" href="Cubical.Foundations.Id.html#782" class="Function">cong</a> <a id="3016" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="3021" class="Symbol">(</a><a id="3022" href="Data.Dyck.Payload.html#2623" class="Function">tree→prog→tree⊙</a> <a id="3038" href="Data.Dyck.Payload.html#3007" class="Bound">e</a> <a id="3040" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a> <a id="3045" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="3047" class="Symbol">)</a>

<a id="prog→tree→prog⊙"></a><a id="3050" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a> <a id="3066" class="Symbol">:</a> <a id="3068" class="Symbol">(</a><a id="3069" href="Data.Dyck.Payload.html#3069" class="Bound">is</a> <a id="3072" class="Symbol">:</a> <a id="3074" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3079" href="Level.html#388" class="Generalizable">A</a> <a id="3081" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="3082" class="Symbol">)</a> <a id="3084" class="Symbol">(</a><a id="3085" href="Data.Dyck.Payload.html#3085" class="Bound">st</a> <a id="3088" class="Symbol">:</a> <a id="3090" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="3094" class="Symbol">(</a><a id="3095" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="3100" href="Level.html#388" class="Generalizable">A</a><a id="3101" class="Symbol">)</a> <a id="3103" href="Data.Dyck.Payload.html#344" class="Generalizable">n</a><a id="3104" class="Symbol">)</a> <a id="3106" class="Symbol">→</a>
 <a id="3109" href="Data.Dyck.Payload.html#2368" class="Function">tree→prog</a> <a id="3119" class="Symbol">(</a><a id="3120" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="3125" class="Symbol">(</a><a id="3126" href="Data.Dyck.Payload.html#1838" class="Function">prog→tree⊙</a> <a id="3137" href="Data.Dyck.Payload.html#3069" class="Bound">is</a> <a id="3140" href="Data.Dyck.Payload.html#3085" class="Bound">st</a><a id="3142" class="Symbol">))</a> <a id="3145" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3147" href="Data.Vec.Iterated.html#997" class="Function">foldlN</a> <a id="3154" class="Symbol">(</a><a id="3155" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3160" href="Level.html#388" class="Generalizable">A</a><a id="3161" class="Symbol">)</a> <a id="3163" href="Data.Dyck.Payload.html#2229" class="Function">tree→prog⊙</a> <a id="3174" href="Data.Dyck.Payload.html#3069" class="Bound">is</a> <a id="3177" href="Data.Dyck.Payload.html#3085" class="Bound">st</a>
<a id="3180" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a>  <a id="3197" href="Data.Dyck.Payload.html#918" class="InductiveConstructor">halt</a>       <a id="3208" href="Data.Dyck.Payload.html#3208" class="Bound">st</a> <a id="3211" class="Symbol">=</a> <a id="3213" href="Cubical.Foundations.Id.html#570" class="Function">refl</a>
<a id="3218" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a> <a id="3234" class="Symbol">(</a><a id="3235" href="Data.Dyck.Payload.html#936" class="InductiveConstructor">push</a> <a id="3240" href="Data.Dyck.Payload.html#3240" class="Bound">i</a> <a id="3242" href="Data.Dyck.Payload.html#3242" class="Bound">is</a><a id="3244" class="Symbol">)</a> <a id="3246" href="Data.Dyck.Payload.html#3246" class="Bound">st</a> <a id="3249" class="Symbol">=</a> <a id="3251" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a> <a id="3267" href="Data.Dyck.Payload.html#3242" class="Bound">is</a> <a id="3270" class="Symbol">(</a><a id="3271" href="Data.Dyck.Payload.html#1765" class="Function">shift</a> <a id="3277" href="Data.Dyck.Payload.html#3240" class="Bound">i</a> <a id="3279" href="Data.Dyck.Payload.html#3246" class="Bound">st</a><a id="3281" class="Symbol">)</a>
<a id="3283" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a> <a id="3299" class="Symbol">(</a><a id="3300" href="Data.Dyck.Payload.html#975" class="InductiveConstructor">pull</a>   <a id="3307" href="Data.Dyck.Payload.html#3307" class="Bound">is</a><a id="3309" class="Symbol">)</a> <a id="3311" href="Data.Dyck.Payload.html#3311" class="Bound">st</a> <a id="3314" class="Symbol">=</a> <a id="3316" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a> <a id="3332" href="Data.Dyck.Payload.html#3307" class="Bound">is</a> <a id="3335" class="Symbol">(</a><a id="3336" href="Data.Dyck.Payload.html#1674" class="Function">reduce</a>  <a id="3344" href="Data.Dyck.Payload.html#3311" class="Bound">st</a><a id="3346" class="Symbol">)</a>

<a id="prog→tree→prog"></a><a id="3349" href="Data.Dyck.Payload.html#3349" class="Function">prog→tree→prog</a> <a id="3364" class="Symbol">:</a> <a id="3366" class="Symbol">(</a><a id="3367" href="Data.Dyck.Payload.html#3367" class="Bound">is</a> <a id="3370" class="Symbol">:</a> <a id="3372" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3377" href="Level.html#388" class="Generalizable">A</a> <a id="3379" class="Number">0</a><a id="3380" class="Symbol">)</a> <a id="3382" class="Symbol">→</a> <a id="3384" href="Data.Dyck.Payload.html#2368" class="Function">tree→prog</a> <a id="3394" class="Symbol">(</a><a id="3395" href="Data.Dyck.Payload.html#1957" class="Function">prog→tree</a> <a id="3405" href="Data.Dyck.Payload.html#3367" class="Bound">is</a><a id="3407" class="Symbol">)</a> <a id="3409" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3411" href="Data.Dyck.Payload.html#3367" class="Bound">is</a>
<a id="3414" href="Data.Dyck.Payload.html#3349" class="Function">prog→tree→prog</a> <a id="3429" href="Data.Dyck.Payload.html#3429" class="Bound">is</a> <a id="3432" class="Symbol">=</a> <a id="3434" href="Data.Dyck.Payload.html#3050" class="Function">prog→tree→prog⊙</a> <a id="3450" href="Data.Dyck.Payload.html#3429" class="Bound">is</a> <a id="3453" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a>

<a id="prog-iso"></a><a id="3457" href="Data.Dyck.Payload.html#3457" class="Function">prog-iso</a> <a id="3466" class="Symbol">:</a> <a id="3468" href="Data.Dyck.Payload.html#875" class="Datatype">Prog</a> <a id="3473" href="Level.html#388" class="Generalizable">A</a> <a id="3475" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3480" href="Function.Isomorphism.html#338" class="Function Operator">⇔</a> <a id="3482" href="Data.Dyck.Payload.html#572" class="Datatype">Tree</a> <a id="3487" href="Level.html#388" class="Generalizable">A</a>
<a id="3489" href="Data.Dyck.Payload.html#3457" class="Function">prog-iso</a> <a id="3498" class="Symbol">.</a><a id="3499" href="Cubical.Foundations.Isomorphism.html#810" class="Field">fun</a> <a id="3503" class="Symbol">=</a> <a id="3505" href="Data.Dyck.Payload.html#1957" class="Function">prog→tree</a>
<a id="3515" href="Data.Dyck.Payload.html#3457" class="Function">prog-iso</a> <a id="3524" class="Symbol">.</a><a id="3525" href="Cubical.Foundations.Isomorphism.html#826" class="Field">inv</a> <a id="3529" class="Symbol">=</a> <a id="3531" href="Data.Dyck.Payload.html#2368" class="Function">tree→prog</a>
<a id="3541" href="Data.Dyck.Payload.html#3457" class="Function">prog-iso</a> <a id="3550" class="Symbol">.</a><a id="3551" href="Cubical.Foundations.Isomorphism.html#842" class="Field">rightInv</a> <a id="3560" class="Symbol">=</a> <a id="3562" href="Data.Dyck.Payload.html#2932" class="Function">tree→prog→tree</a>
<a id="3577" href="Data.Dyck.Payload.html#3457" class="Function">prog-iso</a> <a id="3586" class="Symbol">.</a><a id="3587" href="Cubical.Foundations.Isomorphism.html#873" class="Field">leftInv</a>  <a id="3596" class="Symbol">=</a> <a id="3598" href="Data.Dyck.Payload.html#3349" class="Function">prog→tree→prog</a>
</pre></body></html>