<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Dyck.Payload</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Symbol">#-}</a>

<a id="57" class="Comment">-- This module defines a data type for balanced strings of parentheses,</a>
<a id="129" class="Comment">-- which is isomorphic to binary trees.</a>

<a id="170" class="Keyword">module</a> <a id="177" href="Data.Dyck.Payload.html" class="Module">Data.Dyck.Payload</a> <a id="195" class="Keyword">where</a>

<a id="202" class="Keyword">open</a> <a id="207" class="Keyword">import</a> <a id="214" href="Prelude.html" class="Module">Prelude</a>
<a id="222" class="Keyword">open</a> <a id="227" class="Keyword">import</a> <a id="234" href="Data.List.html" class="Module">Data.List</a> <a id="244" class="Keyword">using</a> <a id="250" class="Symbol">(</a><a id="251" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="255" class="Symbol">;</a> <a id="257" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_∷_</a><a id="260" class="Symbol">;</a> <a id="262" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="264" class="Symbol">;</a> <a id="266" href="Data.List.Base.html#677" class="Function Operator">_++_</a><a id="270" class="Symbol">;</a> <a id="272" href="Data.List.Base.html#737" class="Function">length</a><a id="278" class="Symbol">)</a>
<a id="280" class="Keyword">open</a> <a id="285" class="Keyword">import</a> <a id="292" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="301" class="Keyword">using</a> <a id="307" class="Symbol">(</a><a id="308" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">_+_</a><a id="311" class="Symbol">)</a>
<a id="313" class="Keyword">open</a> <a id="318" class="Keyword">import</a> <a id="325" href="Path.Reasoning.html" class="Module">Path.Reasoning</a>
<a id="340" class="Keyword">open</a> <a id="345" class="Keyword">import</a> <a id="352" href="Function.Surjective.html" class="Module">Function.Surjective</a>
<a id="372" class="Keyword">open</a> <a id="377" class="Keyword">import</a> <a id="384" href="Function.Injective.html" class="Module">Function.Injective</a>
<a id="403" class="Keyword">open</a> <a id="408" class="Keyword">import</a> <a id="415" href="Function.Injective.Properties.html" class="Module">Function.Injective.Properties</a> <a id="445" class="Keyword">using</a> <a id="451" class="Symbol">(</a><a id="452" href="Function.Injective.Properties.html#458" class="Function">inject-contrapositive</a><a id="473" class="Symbol">)</a>
<a id="475" class="Keyword">open</a> <a id="480" class="Keyword">import</a> <a id="487" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="507" class="Keyword">using</a> <a id="513" class="Symbol">(</a><a id="514" href="Cubical.Data.Nat.Properties.html#453" class="Function">snotz</a><a id="519" class="Symbol">;</a> <a id="521" href="Cubical.Data.Nat.Properties.html#394" class="Function">znots</a><a id="526" class="Symbol">;</a> <a id="528" href="Data.Nat.Properties.html#272" class="Function">pred</a><a id="532" class="Symbol">)</a>
<a id="534" class="Keyword">open</a> <a id="539" class="Keyword">import</a> <a id="546" href="Data.Vec.Iterated.html" class="Module">Data.Vec.Iterated</a>

<a id="565" class="Keyword">private</a>
  <a id="575" class="Keyword">variable</a>
    <a id="588" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a> <a id="590" href="Data.Dyck.Payload.html#590" class="Generalizable">m</a> <a id="592" href="Data.Dyck.Payload.html#592" class="Generalizable">k</a> <a id="594" class="Symbol">:</a> <a id="596" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="599" class="Comment">--------------------------------------------------------------------------------</a>
<a id="680" class="Comment">-- Binary trees: definition and associated functions</a>
<a id="733" class="Comment">--------------------------------------------------------------------------------</a>

<a id="815" class="Keyword">data</a> <a id="Tree"></a><a id="820" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="825" class="Symbol">(</a><a id="826" href="Data.Dyck.Payload.html#826" class="Bound">A</a> <a id="828" class="Symbol">:</a> <a id="830" href="Level.html#192" class="Function">Type</a> <a id="835" href="Level.html#372" class="Generalizable">a</a><a id="836" class="Symbol">)</a> <a id="838" class="Symbol">:</a> <a id="840" href="Level.html#192" class="Function">Type</a> <a id="845" href="Data.Dyck.Payload.html#835" class="Bound">a</a> <a id="847" class="Keyword">where</a>
  <a id="Tree.[_]"></a><a id="855" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">[_]</a> <a id="859" class="Symbol">:</a> <a id="861" href="Data.Dyck.Payload.html#826" class="Bound">A</a> <a id="863" class="Symbol">→</a> <a id="865" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="870" href="Data.Dyck.Payload.html#826" class="Bound">A</a>
  <a id="Tree._*_"></a><a id="874" href="Data.Dyck.Payload.html#874" class="InductiveConstructor Operator">_*_</a> <a id="878" class="Symbol">:</a> <a id="880" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="885" href="Data.Dyck.Payload.html#826" class="Bound">A</a> <a id="887" class="Symbol">→</a> <a id="889" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="894" href="Data.Dyck.Payload.html#826" class="Bound">A</a> <a id="896" class="Symbol">→</a> <a id="898" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="903" href="Data.Dyck.Payload.html#826" class="Bound">A</a>

<a id="906" class="Comment">--------------------------------------------------------------------------------</a>
<a id="987" class="Comment">-- Programs: definition and associated functions</a>
<a id="1036" class="Comment">--------------------------------------------------------------------------------</a>

<a id="1118" class="Keyword">data</a> <a id="Prog"></a><a id="1123" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1128" class="Symbol">{</a><a id="1129" href="Data.Dyck.Payload.html#1129" class="Bound">a</a><a id="1130" class="Symbol">}</a> <a id="1132" class="Symbol">(</a><a id="1133" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1135" class="Symbol">:</a> <a id="1137" href="Level.html#192" class="Function">Type</a> <a id="1142" href="Data.Dyck.Payload.html#1129" class="Bound">a</a><a id="1143" class="Symbol">)</a> <a id="1145" class="Symbol">:</a> <a id="1147" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1149" class="Symbol">→</a> <a id="1151" href="Level.html#192" class="Function">Type</a> <a id="1156" href="Data.Dyck.Payload.html#1129" class="Bound">a</a> <a id="1158" class="Keyword">where</a>
  <a id="Prog.halt"></a><a id="1166" href="Data.Dyck.Payload.html#1166" class="InductiveConstructor">halt</a> <a id="1171" class="Symbol">:</a> <a id="1173" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1178" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1180" class="Number">1</a>
  <a id="Prog.push"></a><a id="1184" href="Data.Dyck.Payload.html#1184" class="InductiveConstructor">push</a> <a id="1189" class="Symbol">:</a> <a id="1191" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1193" class="Symbol">→</a> <a id="1195" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1200" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1202" class="Symbol">(</a><a id="1203" class="Number">1</a> <a id="1205" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1207" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="1208" class="Symbol">)</a> <a id="1210" class="Symbol">→</a> <a id="1212" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1217" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1219" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a>
  <a id="Prog.pull"></a><a id="1223" href="Data.Dyck.Payload.html#1223" class="InductiveConstructor">pull</a> <a id="1228" class="Symbol">:</a> <a id="1230" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1235" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1237" class="Symbol">(</a><a id="1238" class="Number">1</a> <a id="1240" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1242" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="1243" class="Symbol">)</a> <a id="1245" class="Symbol">→</a> <a id="1247" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1252" href="Data.Dyck.Payload.html#1133" class="Bound">A</a> <a id="1254" class="Symbol">(</a><a id="1255" class="Number">2</a> <a id="1257" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1259" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="1260" class="Symbol">)</a>

<a id="1263" class="Keyword">module</a> <a id="1270" href="Data.Dyck.Payload.html#1270" class="Module">_</a><a id="1271" class="Symbol">{</a><a id="1272" href="Data.Dyck.Payload.html#1272" class="Bound">p</a><a id="1273" class="Symbol">}</a> <a id="1275" class="Symbol">(</a><a id="1276" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1278" class="Symbol">:</a> <a id="1280" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1282" class="Symbol">→</a> <a id="1284" href="Level.html#192" class="Function">Type</a> <a id="1289" href="Data.Dyck.Payload.html#1272" class="Bound">p</a><a id="1290" class="Symbol">)</a>
            <a id="1304" class="Symbol">(</a><a id="1305" href="Data.Dyck.Payload.html#1305" class="Bound">lb</a> <a id="1308" class="Symbol">:</a> <a id="1310" class="Symbol">∀</a> <a id="1312" class="Symbol">{</a><a id="1313" href="Data.Dyck.Payload.html#1313" class="Bound">n</a><a id="1314" class="Symbol">}</a> <a id="1316" class="Symbol">→</a> <a id="1318" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1320" class="Symbol">(</a><a id="1321" class="Number">2</a> <a id="1323" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1325" href="Data.Dyck.Payload.html#1313" class="Bound">n</a><a id="1326" class="Symbol">)</a> <a id="1328" class="Symbol">→</a> <a id="1330" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1332" class="Symbol">(</a><a id="1333" class="Number">1</a> <a id="1335" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1337" href="Data.Dyck.Payload.html#1313" class="Bound">n</a><a id="1338" class="Symbol">))</a>
            <a id="1353" class="Symbol">(</a><a id="1354" href="Data.Dyck.Payload.html#1354" class="Bound">rb</a> <a id="1357" class="Symbol">:</a> <a id="1359" class="Symbol">∀</a> <a id="1361" class="Symbol">{</a><a id="1362" href="Data.Dyck.Payload.html#1362" class="Bound">n</a><a id="1363" class="Symbol">}</a> <a id="1365" class="Symbol">→</a> <a id="1367" href="Level.html#388" class="Generalizable">A</a> <a id="1369" class="Symbol">→</a> <a id="1371" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1373" href="Data.Dyck.Payload.html#1362" class="Bound">n</a> <a id="1375" class="Symbol">→</a> <a id="1377" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1379" class="Symbol">(</a><a id="1380" class="Number">1</a> <a id="1382" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1384" href="Data.Dyck.Payload.html#1362" class="Bound">n</a><a id="1385" class="Symbol">))</a>
            <a id="1400" class="Keyword">where</a>
  <a id="1408" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="1418" class="Symbol">:</a> <a id="1420" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1422" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a> <a id="1424" class="Symbol">→</a> <a id="1426" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="1431" href="Data.Dyck.Payload.html#1367" class="Bound">A</a> <a id="1433" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a> <a id="1435" class="Symbol">→</a> <a id="1437" href="Data.Dyck.Payload.html#1276" class="Bound">P</a> <a id="1439" class="Number">1</a>
  <a id="1443" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="1453" href="Data.Dyck.Payload.html#1453" class="Bound">bs</a> <a id="1456" href="Data.Dyck.Payload.html#1166" class="InductiveConstructor">halt</a> <a id="1461" class="Symbol">=</a> <a id="1463" href="Data.Dyck.Payload.html#1453" class="Bound">bs</a>
  <a id="1468" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="1478" href="Data.Dyck.Payload.html#1478" class="Bound">bs</a> <a id="1481" class="Symbol">(</a><a id="1482" href="Data.Dyck.Payload.html#1184" class="InductiveConstructor">push</a> <a id="1487" href="Data.Dyck.Payload.html#1487" class="Bound">x</a> <a id="1489" href="Data.Dyck.Payload.html#1489" class="Bound">xs</a><a id="1491" class="Symbol">)</a> <a id="1493" class="Symbol">=</a> <a id="1495" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="1505" class="Symbol">(</a><a id="1506" href="Data.Dyck.Payload.html#1354" class="Bound">rb</a> <a id="1509" href="Data.Dyck.Payload.html#1487" class="Bound">x</a> <a id="1511" href="Data.Dyck.Payload.html#1478" class="Bound">bs</a><a id="1513" class="Symbol">)</a> <a id="1515" href="Data.Dyck.Payload.html#1489" class="Bound">xs</a>
  <a id="1520" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="1530" href="Data.Dyck.Payload.html#1530" class="Bound">bs</a> <a id="1533" class="Symbol">(</a><a id="1534" href="Data.Dyck.Payload.html#1223" class="InductiveConstructor">pull</a>   <a id="1541" href="Data.Dyck.Payload.html#1541" class="Bound">xs</a><a id="1543" class="Symbol">)</a> <a id="1545" class="Symbol">=</a> <a id="1547" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="1557" class="Symbol">(</a><a id="1558" href="Data.Dyck.Payload.html#1305" class="Bound">lb</a>   <a id="1563" href="Data.Dyck.Payload.html#1530" class="Bound">bs</a><a id="1565" class="Symbol">)</a> <a id="1567" href="Data.Dyck.Payload.html#1541" class="Bound">xs</a>
<a id="1570" class="Comment">-- In terms of foldr:</a>
<a id="1592" class="Comment">-- foldlProg P lb rb bs xs = foldrProg (λ n → P n → P zero) (λ x k bs → k (rb x bs)) (λ k bs → k (lb bs)) id xs bs</a>

<a id="1708" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1789" class="Comment">-- Conversion from a Prog to a Tree</a>
<a id="1825" class="Comment">--------------------------------------------------------------------------------</a>

<a id="reduce"></a><a id="1907" href="Data.Dyck.Payload.html#1907" class="Function">reduce</a> <a id="1914" class="Symbol">:</a> <a id="1916" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1920" class="Symbol">(</a><a id="1921" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="1926" href="Level.html#388" class="Generalizable">A</a><a id="1927" class="Symbol">)</a> <a id="1929" class="Symbol">(</a><a id="1930" class="Number">2</a> <a id="1932" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1934" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="1935" class="Symbol">)</a> <a id="1937" class="Symbol">→</a> <a id="1939" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="1943" class="Symbol">(</a><a id="1944" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="1949" href="Level.html#388" class="Generalizable">A</a><a id="1950" class="Symbol">)</a> <a id="1952" class="Symbol">(</a><a id="1953" class="Number">1</a> <a id="1955" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="1957" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="1958" class="Symbol">)</a>
<a id="1960" href="Data.Dyck.Payload.html#1907" class="Function">reduce</a> <a id="1967" class="Symbol">(</a><a id="1968" href="Data.Dyck.Payload.html#1968" class="Bound">t₁</a> <a id="1971" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1973" href="Data.Dyck.Payload.html#1973" class="Bound">t₂</a> <a id="1976" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1978" href="Data.Dyck.Payload.html#1978" class="Bound">s</a><a id="1979" class="Symbol">)</a> <a id="1981" class="Symbol">=</a> <a id="1983" class="Symbol">(</a><a id="1984" href="Data.Dyck.Payload.html#1973" class="Bound">t₂</a> <a id="1987" href="Data.Dyck.Payload.html#874" class="InductiveConstructor Operator">*</a> <a id="1989" href="Data.Dyck.Payload.html#1968" class="Bound">t₁</a><a id="1991" class="Symbol">)</a> <a id="1993" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="1995" href="Data.Dyck.Payload.html#1978" class="Bound">s</a>

<a id="shift"></a><a id="1998" href="Data.Dyck.Payload.html#1998" class="Function">shift</a> <a id="2004" class="Symbol">:</a> <a id="2006" href="Level.html#388" class="Generalizable">A</a> <a id="2008" class="Symbol">→</a> <a id="2010" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2014" class="Symbol">(</a><a id="2015" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2020" href="Level.html#388" class="Generalizable">A</a><a id="2021" class="Symbol">)</a> <a id="2023" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a> <a id="2025" class="Symbol">→</a> <a id="2027" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2031" class="Symbol">(</a><a id="2032" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2037" href="Level.html#388" class="Generalizable">A</a><a id="2038" class="Symbol">)</a> <a id="2040" class="Symbol">(</a><a id="2041" class="Number">1</a> <a id="2043" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2045" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="2046" class="Symbol">)</a>
<a id="2048" href="Data.Dyck.Payload.html#1998" class="Function">shift</a> <a id="2054" href="Data.Dyck.Payload.html#2054" class="Bound">x</a> <a id="2056" href="Data.Dyck.Payload.html#2056" class="Bound">s</a> <a id="2058" class="Symbol">=</a> <a id="2060" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">[</a> <a id="2062" href="Data.Dyck.Payload.html#2054" class="Bound">x</a> <a id="2064" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">]</a> <a id="2066" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2068" href="Data.Dyck.Payload.html#2056" class="Bound">s</a>

<a id="prog→tree⊙"></a><a id="2071" href="Data.Dyck.Payload.html#2071" class="Function">prog→tree⊙</a> <a id="2082" class="Symbol">:</a> <a id="2084" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="2089" href="Level.html#388" class="Generalizable">A</a> <a id="2091" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a> <a id="2093" class="Symbol">→</a> <a id="2095" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2099" class="Symbol">(</a><a id="2100" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2105" href="Level.html#388" class="Generalizable">A</a><a id="2106" class="Symbol">)</a> <a id="2108" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a> <a id="2110" class="Symbol">→</a> <a id="2112" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2116" class="Symbol">(</a><a id="2117" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2122" href="Level.html#388" class="Generalizable">A</a><a id="2123" class="Symbol">)</a> <a id="2125" class="Number">1</a>
<a id="2127" href="Data.Dyck.Payload.html#2071" class="Function">prog→tree⊙</a> <a id="2138" href="Data.Dyck.Payload.html#2138" class="Bound">p</a> <a id="2140" href="Data.Dyck.Payload.html#2140" class="Bound">s</a> <a id="2142" class="Symbol">=</a> <a id="2144" href="Data.Dyck.Payload.html#1408" class="Function">foldlProg</a> <a id="2154" class="Symbol">(λ</a> <a id="2157" href="Data.Dyck.Payload.html#2157" class="Bound">n</a> <a id="2159" class="Symbol">→</a> <a id="2161" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2165" class="Symbol">(</a><a id="2166" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2171" class="Symbol">_)</a> <a id="2174" href="Data.Dyck.Payload.html#2157" class="Bound">n</a><a id="2175" class="Symbol">)</a> <a id="2177" href="Data.Dyck.Payload.html#1907" class="Function">reduce</a> <a id="2184" href="Data.Dyck.Payload.html#1998" class="Function">shift</a> <a id="2190" href="Data.Dyck.Payload.html#2140" class="Bound">s</a> <a id="2192" href="Data.Dyck.Payload.html#2138" class="Bound">p</a>

<a id="prog→tree"></a><a id="2195" href="Data.Dyck.Payload.html#2195" class="Function">prog→tree</a> <a id="2205" class="Symbol">:</a> <a id="2207" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="2212" href="Level.html#388" class="Generalizable">A</a> <a id="2214" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2219" class="Symbol">→</a> <a id="2221" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2226" href="Level.html#388" class="Generalizable">A</a>
<a id="2228" href="Data.Dyck.Payload.html#2195" class="Function">prog→tree</a> <a id="2238" href="Data.Dyck.Payload.html#2238" class="Bound">ds</a> <a id="2241" class="Symbol">=</a> <a id="2243" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="2248" class="Symbol">(</a><a id="2249" href="Data.Dyck.Payload.html#2071" class="Function">prog→tree⊙</a> <a id="2260" href="Data.Dyck.Payload.html#2238" class="Bound">ds</a> <a id="2263" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="2265" class="Symbol">)</a>

<a id="2268" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2349" class="Comment">-- Conversion from a Tree to a Prog</a>
<a id="2385" class="Comment">--------------------------------------------------------------------------------</a>

<a id="tree→prog⊙"></a><a id="2467" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2478" class="Symbol">:</a> <a id="2480" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2485" href="Level.html#388" class="Generalizable">A</a> <a id="2487" class="Symbol">→</a> <a id="2489" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="2494" href="Level.html#388" class="Generalizable">A</a> <a id="2496" class="Symbol">(</a><a id="2497" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2501" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="2502" class="Symbol">)</a> <a id="2504" class="Symbol">→</a> <a id="2506" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="2511" href="Level.html#388" class="Generalizable">A</a> <a id="2513" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a>
<a id="2515" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2526" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">[</a> <a id="2528" href="Data.Dyck.Payload.html#2528" class="Bound">x</a> <a id="2530" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">]</a>     <a id="2536" class="Symbol">=</a> <a id="2538" href="Data.Dyck.Payload.html#1184" class="InductiveConstructor">push</a> <a id="2543" href="Data.Dyck.Payload.html#2528" class="Bound">x</a>
<a id="2545" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2556" class="Symbol">(</a><a id="2557" href="Data.Dyck.Payload.html#2557" class="Bound">xs</a> <a id="2560" href="Data.Dyck.Payload.html#874" class="InductiveConstructor Operator">*</a> <a id="2562" href="Data.Dyck.Payload.html#2562" class="Bound">ys</a><a id="2564" class="Symbol">)</a> <a id="2566" class="Symbol">=</a> <a id="2568" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2579" href="Data.Dyck.Payload.html#2557" class="Bound">xs</a> <a id="2582" href="Function.html#112" class="Function Operator">∘</a> <a id="2584" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2595" href="Data.Dyck.Payload.html#2562" class="Bound">ys</a> <a id="2598" href="Function.html#112" class="Function Operator">∘</a> <a id="2600" href="Data.Dyck.Payload.html#1223" class="InductiveConstructor">pull</a>

<a id="tree→prog"></a><a id="2606" href="Data.Dyck.Payload.html#2606" class="Function">tree→prog</a> <a id="2616" class="Symbol">:</a> <a id="2618" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2623" href="Level.html#388" class="Generalizable">A</a> <a id="2625" class="Symbol">→</a> <a id="2627" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="2632" href="Level.html#388" class="Generalizable">A</a> <a id="2634" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>
<a id="2639" href="Data.Dyck.Payload.html#2606" class="Function">tree→prog</a> <a id="2649" href="Data.Dyck.Payload.html#2649" class="Bound">tr</a> <a id="2652" class="Symbol">=</a> <a id="2654" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2665" href="Data.Dyck.Payload.html#2649" class="Bound">tr</a> <a id="2668" href="Data.Dyck.Payload.html#1166" class="InductiveConstructor">halt</a>

<a id="2674" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2755" class="Comment">-- Proof of isomorphism</a>
<a id="2779" class="Comment">--------------------------------------------------------------------------------</a>

<a id="tree→prog→tree⊙"></a><a id="2861" href="Data.Dyck.Payload.html#2861" class="Function">tree→prog→tree⊙</a> <a id="2877" class="Symbol">:</a> <a id="2879" class="Symbol">(</a><a id="2880" href="Data.Dyck.Payload.html#2880" class="Bound">e</a> <a id="2882" class="Symbol">:</a> <a id="2884" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2889" href="Level.html#388" class="Generalizable">A</a><a id="2890" class="Symbol">)</a> <a id="2892" class="Symbol">(</a><a id="2893" href="Data.Dyck.Payload.html#2893" class="Bound">is</a> <a id="2896" class="Symbol">:</a> <a id="2898" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="2903" href="Level.html#388" class="Generalizable">A</a> <a id="2905" class="Symbol">(</a><a id="2906" class="Number">1</a> <a id="2908" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">+</a> <a id="2910" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="2911" class="Symbol">))</a> <a id="2914" class="Symbol">(</a><a id="2915" href="Data.Dyck.Payload.html#2915" class="Bound">st</a> <a id="2918" class="Symbol">:</a> <a id="2920" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="2924" class="Symbol">(</a><a id="2925" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="2930" href="Level.html#388" class="Generalizable">A</a><a id="2931" class="Symbol">)</a> <a id="2933" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="2934" class="Symbol">)</a> <a id="2936" class="Symbol">→</a> <a id="2938" href="Data.Dyck.Payload.html#2071" class="Function">prog→tree⊙</a> <a id="2949" class="Symbol">(</a><a id="2950" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="2961" href="Data.Dyck.Payload.html#2880" class="Bound">e</a> <a id="2963" href="Data.Dyck.Payload.html#2893" class="Bound">is</a><a id="2965" class="Symbol">)</a> <a id="2967" href="Data.Dyck.Payload.html#2915" class="Bound">st</a> <a id="2970" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="2972" href="Data.Dyck.Payload.html#2071" class="Function">prog→tree⊙</a> <a id="2983" href="Data.Dyck.Payload.html#2893" class="Bound">is</a> <a id="2986" class="Symbol">(</a><a id="2987" href="Data.Dyck.Payload.html#2880" class="Bound">e</a> <a id="2989" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="2991" href="Data.Dyck.Payload.html#2915" class="Bound">st</a><a id="2993" class="Symbol">)</a>
<a id="2995" href="Data.Dyck.Payload.html#2861" class="Function">tree→prog→tree⊙</a> <a id="3011" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">[</a> <a id="3013" href="Data.Dyck.Payload.html#3013" class="Bound">x</a> <a id="3015" href="Data.Dyck.Payload.html#855" class="InductiveConstructor Operator">]</a>     <a id="3021" href="Data.Dyck.Payload.html#3021" class="Bound">is</a> <a id="3024" href="Data.Dyck.Payload.html#3024" class="Bound">st</a> <a id="3027" class="Symbol">=</a> <a id="3029" href="Cubical.Foundations.Id.html#570" class="Function">refl</a>
<a id="3034" href="Data.Dyck.Payload.html#2861" class="Function">tree→prog→tree⊙</a> <a id="3050" class="Symbol">(</a><a id="3051" href="Data.Dyck.Payload.html#3051" class="Bound">xs</a> <a id="3054" href="Data.Dyck.Payload.html#874" class="InductiveConstructor Operator">*</a> <a id="3056" href="Data.Dyck.Payload.html#3056" class="Bound">ys</a><a id="3058" class="Symbol">)</a> <a id="3060" href="Data.Dyck.Payload.html#3060" class="Bound">is</a> <a id="3063" href="Data.Dyck.Payload.html#3063" class="Bound">st</a> <a id="3066" class="Symbol">=</a> <a id="3068" href="Data.Dyck.Payload.html#2861" class="Function">tree→prog→tree⊙</a> <a id="3084" href="Data.Dyck.Payload.html#3051" class="Bound">xs</a> <a id="3087" class="Symbol">_</a> <a id="3089" href="Data.Dyck.Payload.html#3063" class="Bound">st</a> <a id="3092" href="Cubical.Foundations.Id.html#747" class="Function Operator">;</a> <a id="3094" href="Data.Dyck.Payload.html#2861" class="Function">tree→prog→tree⊙</a> <a id="3110" href="Data.Dyck.Payload.html#3056" class="Bound">ys</a> <a id="3113" class="Symbol">(</a><a id="3114" href="Data.Dyck.Payload.html#1223" class="InductiveConstructor">pull</a> <a id="3119" href="Data.Dyck.Payload.html#3060" class="Bound">is</a><a id="3121" class="Symbol">)</a> <a id="3123" class="Symbol">(</a><a id="3124" href="Data.Dyck.Payload.html#3051" class="Bound">xs</a> <a id="3127" href="Data.Vec.Iterated.html#499" class="InductiveConstructor Operator">∷</a> <a id="3129" href="Data.Dyck.Payload.html#3063" class="Bound">st</a><a id="3131" class="Symbol">)</a>

<a id="tree→prog→tree"></a><a id="3134" href="Data.Dyck.Payload.html#3134" class="Function">tree→prog→tree</a> <a id="3149" class="Symbol">:</a> <a id="3151" class="Symbol">(</a><a id="3152" href="Data.Dyck.Payload.html#3152" class="Bound">t</a> <a id="3154" class="Symbol">:</a> <a id="3156" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="3161" href="Level.html#388" class="Generalizable">A</a><a id="3162" class="Symbol">)</a> <a id="3164" class="Symbol">→</a> <a id="3166" href="Data.Dyck.Payload.html#2195" class="Function">prog→tree</a> <a id="3176" class="Symbol">(</a><a id="3177" href="Data.Dyck.Payload.html#2606" class="Function">tree→prog</a> <a id="3187" href="Data.Dyck.Payload.html#3152" class="Bound">t</a><a id="3188" class="Symbol">)</a> <a id="3190" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3192" href="Data.Dyck.Payload.html#3152" class="Bound">t</a>
<a id="3194" href="Data.Dyck.Payload.html#3134" class="Function">tree→prog→tree</a> <a id="3209" href="Data.Dyck.Payload.html#3209" class="Bound">t</a> <a id="3211" class="Symbol">=</a> <a id="3213" href="Cubical.Foundations.Id.html#782" class="Function">cong</a> <a id="3218" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="3223" class="Symbol">(</a><a id="3224" href="Data.Dyck.Payload.html#2861" class="Function">tree→prog→tree⊙</a> <a id="3240" href="Data.Dyck.Payload.html#3209" class="Bound">t</a> <a id="3242" href="Data.Dyck.Payload.html#1166" class="InductiveConstructor">halt</a> <a id="3247" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a><a id="3249" class="Symbol">)</a>

<a id="prog→tree→prog⊙"></a><a id="3252" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3268" class="Symbol">:</a> <a id="3270" class="Symbol">(</a><a id="3271" href="Data.Dyck.Payload.html#3271" class="Bound">vs</a> <a id="3274" class="Symbol">:</a> <a id="3276" href="Data.Vec.Iterated.html#250" class="Function">Vec</a> <a id="3280" class="Symbol">(</a><a id="3281" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="3286" href="Level.html#388" class="Generalizable">A</a><a id="3287" class="Symbol">)</a> <a id="3289" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="3290" class="Symbol">)</a> <a id="3292" class="Symbol">(</a><a id="3293" href="Data.Dyck.Payload.html#3293" class="Bound">xs</a> <a id="3296" class="Symbol">:</a> <a id="3298" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="3303" href="Level.html#388" class="Generalizable">A</a> <a id="3305" href="Data.Dyck.Payload.html#588" class="Generalizable">n</a><a id="3306" class="Symbol">)</a> <a id="3308" class="Symbol">→</a> <a id="3310" href="Data.Dyck.Payload.html#2606" class="Function">tree→prog</a> <a id="3320" class="Symbol">(</a><a id="3321" href="Data.Vec.Iterated.html#519" class="Field">head</a> <a id="3326" class="Symbol">(</a><a id="3327" href="Data.Dyck.Payload.html#2071" class="Function">prog→tree⊙</a> <a id="3338" href="Data.Dyck.Payload.html#3293" class="Bound">xs</a> <a id="3341" href="Data.Dyck.Payload.html#3271" class="Bound">vs</a><a id="3343" class="Symbol">))</a> <a id="3346" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3348" href="Data.Vec.Iterated.html#997" class="Function">foldlN</a> <a id="3355" class="Symbol">(</a><a id="3356" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="3361" href="Level.html#388" class="Generalizable">A</a><a id="3362" class="Symbol">)</a> <a id="3364" href="Data.Dyck.Payload.html#2467" class="Function">tree→prog⊙</a> <a id="3375" href="Data.Dyck.Payload.html#3293" class="Bound">xs</a> <a id="3378" href="Data.Dyck.Payload.html#3271" class="Bound">vs</a>
<a id="3381" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3397" href="Data.Dyck.Payload.html#3397" class="Bound">vs</a>  <a id="3401" href="Data.Dyck.Payload.html#1166" class="InductiveConstructor">halt</a>       <a id="3412" class="Symbol">=</a> <a id="3414" href="Cubical.Foundations.Id.html#570" class="Function">refl</a>
<a id="3419" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3435" href="Data.Dyck.Payload.html#3435" class="Bound">vs</a> <a id="3438" class="Symbol">(</a><a id="3439" href="Data.Dyck.Payload.html#1184" class="InductiveConstructor">push</a> <a id="3444" href="Data.Dyck.Payload.html#3444" class="Bound">x</a> <a id="3446" href="Data.Dyck.Payload.html#3446" class="Bound">xs</a><a id="3448" class="Symbol">)</a> <a id="3450" class="Symbol">=</a> <a id="3452" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3468" class="Symbol">(</a><a id="3469" href="Data.Dyck.Payload.html#1998" class="Function">shift</a> <a id="3475" href="Data.Dyck.Payload.html#3444" class="Bound">x</a> <a id="3477" href="Data.Dyck.Payload.html#3435" class="Bound">vs</a><a id="3479" class="Symbol">)</a> <a id="3481" href="Data.Dyck.Payload.html#3446" class="Bound">xs</a>
<a id="3484" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3500" href="Data.Dyck.Payload.html#3500" class="Bound">vs</a> <a id="3503" class="Symbol">(</a><a id="3504" href="Data.Dyck.Payload.html#1223" class="InductiveConstructor">pull</a>   <a id="3511" href="Data.Dyck.Payload.html#3511" class="Bound">xs</a><a id="3513" class="Symbol">)</a> <a id="3515" class="Symbol">=</a> <a id="3517" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3533" class="Symbol">(</a><a id="3534" href="Data.Dyck.Payload.html#1907" class="Function">reduce</a>  <a id="3542" href="Data.Dyck.Payload.html#3500" class="Bound">vs</a><a id="3544" class="Symbol">)</a> <a id="3546" href="Data.Dyck.Payload.html#3511" class="Bound">xs</a>

<a id="prog→tree→prog"></a><a id="3550" href="Data.Dyck.Payload.html#3550" class="Function">prog→tree→prog</a> <a id="3565" class="Symbol">:</a> <a id="3567" class="Symbol">(</a><a id="3568" href="Data.Dyck.Payload.html#3568" class="Bound">xs</a> <a id="3571" class="Symbol">:</a> <a id="3573" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="3578" href="Level.html#388" class="Generalizable">A</a> <a id="3580" class="Number">0</a><a id="3581" class="Symbol">)</a> <a id="3583" class="Symbol">→</a> <a id="3585" href="Data.Dyck.Payload.html#2606" class="Function">tree→prog</a> <a id="3595" class="Symbol">(</a><a id="3596" href="Data.Dyck.Payload.html#2195" class="Function">prog→tree</a> <a id="3606" href="Data.Dyck.Payload.html#3568" class="Bound">xs</a><a id="3608" class="Symbol">)</a> <a id="3610" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="3612" href="Data.Dyck.Payload.html#3568" class="Bound">xs</a>
<a id="3615" href="Data.Dyck.Payload.html#3550" class="Function">prog→tree→prog</a> <a id="3630" class="Symbol">=</a> <a id="3632" href="Data.Dyck.Payload.html#3252" class="Function">prog→tree→prog⊙</a> <a id="3648" href="Data.Vec.Iterated.html#379" class="InductiveConstructor">[]</a>

<a id="prog-iso"></a><a id="3652" href="Data.Dyck.Payload.html#3652" class="Function">prog-iso</a> <a id="3661" class="Symbol">:</a> <a id="3663" href="Data.Dyck.Payload.html#1123" class="Datatype">Prog</a> <a id="3668" href="Level.html#388" class="Generalizable">A</a> <a id="3670" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="3675" href="Function.Isomorphism.html#338" class="Function Operator">⇔</a> <a id="3677" href="Data.Dyck.Payload.html#820" class="Datatype">Tree</a> <a id="3682" href="Level.html#388" class="Generalizable">A</a>
<a id="3684" href="Data.Dyck.Payload.html#3652" class="Function">prog-iso</a> <a id="3693" class="Symbol">.</a><a id="3694" href="Cubical.Foundations.Isomorphism.html#810" class="Field">fun</a> <a id="3698" class="Symbol">=</a> <a id="3700" href="Data.Dyck.Payload.html#2195" class="Function">prog→tree</a>
<a id="3710" href="Data.Dyck.Payload.html#3652" class="Function">prog-iso</a> <a id="3719" class="Symbol">.</a><a id="3720" href="Cubical.Foundations.Isomorphism.html#826" class="Field">inv</a> <a id="3724" class="Symbol">=</a> <a id="3726" href="Data.Dyck.Payload.html#2606" class="Function">tree→prog</a>
<a id="3736" href="Data.Dyck.Payload.html#3652" class="Function">prog-iso</a> <a id="3745" class="Symbol">.</a><a id="3746" href="Cubical.Foundations.Isomorphism.html#842" class="Field">rightInv</a> <a id="3755" class="Symbol">=</a> <a id="3757" href="Data.Dyck.Payload.html#3134" class="Function">tree→prog→tree</a>
<a id="3772" href="Data.Dyck.Payload.html#3652" class="Function">prog-iso</a> <a id="3781" class="Symbol">.</a><a id="3782" href="Cubical.Foundations.Isomorphism.html#873" class="Field">leftInv</a>  <a id="3791" class="Symbol">=</a> <a id="3793" href="Data.Dyck.Payload.html#3550" class="Function">prog→tree→prog</a>
</pre></body></html>