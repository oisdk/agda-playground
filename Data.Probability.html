<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Probability</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="Data.Probability.html" class="Module">Data.Probability</a> <a id="59" class="Keyword">where</a>

<a id="66" class="Keyword">open</a> <a id="71" class="Keyword">import</a> <a id="78" href="Prelude.html" class="Module">Prelude</a>
<a id="86" class="Keyword">import</a> <a id="93" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="102" class="Symbol">as</a> <a id="105" class="Module">ℕ</a>
<a id="107" class="Keyword">import</a> <a id="114" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="134" class="Symbol">as</a> <a id="137" class="Module">ℕ</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Bits.html" class="Module">Data.Bits</a> <a id="161" class="Keyword">renaming</a> <a id="170" class="Symbol">(</a><a id="171" href="Data.Bits.html#102" class="Datatype">Bits</a> <a id="176" class="Symbol">to</a> <a id="179" class="Datatype">ℚ⁺</a><a id="181" class="Symbol">;</a> <a id="183" href="Data.Bits.html#122" class="InductiveConstructor">[]</a> <a id="186" class="Symbol">to</a> <a id="189" class="InductiveConstructor">1ℚ</a><a id="191" class="Symbol">;</a> <a id="193" href="Data.Bits.html#134" class="InductiveConstructor Operator">0∷_</a> <a id="197" class="Symbol">to</a> <a id="200" class="InductiveConstructor Operator">lℚ</a><a id="202" class="Symbol">;</a> <a id="204" href="Data.Bits.html#154" class="InductiveConstructor Operator">1∷_</a> <a id="208" class="Symbol">to</a> <a id="211" class="InductiveConstructor Operator">rℚ</a><a id="213" class="Symbol">)</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Data.Bits.Equatable.html" class="Module">Data.Bits.Equatable</a>

<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Data.Bits.Fold.html" class="Module">Data.Bits.Fold</a>

<a id="euclidian"></a><a id="276" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="286" class="Symbol">:</a> <a id="288" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="290" class="Symbol">→</a> <a id="292" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="294" class="Symbol">→</a> <a id="296" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="298" class="Symbol">→</a> <a id="300" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="303" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="313" href="Data.Probability.html#313" class="Bound">n</a> <a id="315" href="Data.Probability.html#315" class="Bound">m</a> <a id="317" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>    <a id="325" class="Symbol">=</a> <a id="327" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
<a id="330" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="340" href="Data.Probability.html#340" class="Bound">n</a> <a id="342" href="Data.Probability.html#342" class="Bound">m</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="349" href="Data.Probability.html#349" class="Bound">s</a><a id="350" class="Symbol">)</a> <a id="352" class="Symbol">=</a>
  <a id="356" href="Data.Bool.Base.html#596" class="Function Operator">if</a> <a id="359" href="Data.Probability.html#340" class="Bound">n</a> <a id="361" href="Data.Nat.Properties.html#778" class="Primitive Operator">ℕ.Eqℕ.≡ᴮ</a> <a id="370" href="Data.Probability.html#342" class="Bound">m</a>
  <a id="374" href="Data.Bool.Base.html#596" class="Function Operator">then</a> <a id="379" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
  <a id="384" href="Data.Bool.Base.html#596" class="Function Operator">else</a> <a id="389" href="Data.Bool.Base.html#596" class="Function Operator">if</a> <a id="392" href="Data.Probability.html#340" class="Bound">n</a> <a id="394" href="Data.Nat.Properties.html#150" class="Primitive Operator">ℕ.&lt;ᴮ</a> <a id="399" href="Data.Probability.html#342" class="Bound">m</a>
  <a id="403" href="Data.Bool.Base.html#596" class="Function Operator">then</a> <a id="408" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="411" class="Symbol">(</a><a id="412" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="422" href="Data.Probability.html#340" class="Bound">n</a> <a id="424" class="Symbol">(</a><a id="425" href="Data.Probability.html#342" class="Bound">m</a> <a id="427" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="431" class="Symbol">(</a><a id="432" class="Number">1</a> <a id="434" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">ℕ.+</a> <a id="438" href="Data.Probability.html#340" class="Bound">n</a><a id="439" class="Symbol">))</a> <a id="442" href="Data.Probability.html#349" class="Bound">s</a><a id="443" class="Symbol">)</a>
  <a id="447" href="Data.Bool.Base.html#596" class="Function Operator">else</a> <a id="452" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="455" class="Symbol">(</a><a id="456" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="466" class="Symbol">(</a><a id="467" href="Data.Probability.html#340" class="Bound">n</a> <a id="469" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="473" class="Symbol">(</a><a id="474" class="Number">1</a> <a id="476" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">ℕ.+</a> <a id="480" href="Data.Probability.html#342" class="Bound">m</a><a id="481" class="Symbol">))</a> <a id="484" href="Data.Probability.html#342" class="Bound">m</a> <a id="486" href="Data.Probability.html#349" class="Bound">s</a><a id="487" class="Symbol">)</a>

<a id="normalise-suc"></a><a id="490" href="Data.Probability.html#490" class="Function">normalise-suc</a> <a id="504" class="Symbol">:</a> <a id="506" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="508" class="Symbol">→</a> <a id="510" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="512" class="Symbol">→</a> <a id="514" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="517" href="Data.Probability.html#490" class="Function">normalise-suc</a> <a id="531" href="Data.Probability.html#531" class="Bound">n</a> <a id="533" href="Data.Probability.html#533" class="Bound">m</a> <a id="535" class="Symbol">=</a> <a id="537" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="547" href="Data.Probability.html#531" class="Bound">n</a> <a id="549" href="Data.Probability.html#533" class="Bound">m</a> <a id="551" class="Symbol">(</a><a id="552" href="Data.Probability.html#531" class="Bound">n</a> <a id="554" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">ℕ.+</a> <a id="558" href="Data.Probability.html#533" class="Bound">m</a><a id="559" class="Symbol">)</a>

<a id="562" class="Keyword">data</a> <a id="ℙ"></a><a id="567" href="Data.Probability.html#567" class="Datatype">ℙ</a> <a id="569" class="Symbol">:</a> <a id="571" href="Agda.Primitive.html#388" class="Primitive">Type</a> <a id="576" class="Keyword">where</a>
  <a id="ℙ.ℙ⁰"></a><a id="584" href="Data.Probability.html#584" class="InductiveConstructor">ℙ⁰</a> <a id="587" class="Symbol">:</a> <a id="589" href="Data.Probability.html#567" class="Datatype">ℙ</a>
  <a id="ℙ.ℙ¹"></a><a id="593" href="Data.Probability.html#593" class="InductiveConstructor">ℙ¹</a> <a id="596" class="Symbol">:</a> <a id="598" href="Data.Probability.html#567" class="Datatype">ℙ</a>
  <a id="ℙ.ℙ∙"></a><a id="602" href="Data.Probability.html#602" class="InductiveConstructor">ℙ∙</a> <a id="605" class="Symbol">:</a> <a id="607" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="610" class="Symbol">→</a> <a id="612" href="Data.Probability.html#567" class="Datatype">ℙ</a>

<a id="unEu"></a><a id="615" href="Data.Probability.html#615" class="Function">unEu</a> <a id="620" class="Symbol">:</a> <a id="622" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="625" class="Symbol">→</a> <a id="627" href="Data.Probability.html#567" class="Datatype">ℙ</a>
<a id="629" href="Data.Probability.html#615" class="Function">unEu</a> <a id="634" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a> <a id="637" class="Symbol">=</a> <a id="639" href="Data.Probability.html#593" class="InductiveConstructor">ℙ¹</a>
<a id="642" href="Data.Probability.html#615" class="Function">unEu</a> <a id="647" class="Symbol">(</a><a id="648" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="651" href="Data.Probability.html#651" class="Bound">x</a><a id="652" class="Symbol">)</a> <a id="654" class="Symbol">=</a> <a id="656" href="Data.Probability.html#602" class="InductiveConstructor">ℙ∙</a> <a id="659" href="Data.Probability.html#651" class="Bound">x</a>
<a id="661" href="Data.Probability.html#615" class="Function">unEu</a> <a id="666" class="Symbol">(</a><a id="667" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="670" href="Data.Probability.html#670" class="Bound">x</a><a id="671" class="Symbol">)</a> <a id="673" class="Symbol">=</a> <a id="675" href="Data.Probability.html#593" class="InductiveConstructor">ℙ¹</a> <a id="678" class="Comment">-- won&#39;t happen</a>

<a id="_/suc_"></a><a id="695" href="Data.Probability.html#695" class="Function Operator">_/suc_</a> <a id="702" class="Symbol">:</a> <a id="704" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="706" class="Symbol">→</a> <a id="708" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="710" class="Symbol">→</a> <a id="712" href="Data.Probability.html#567" class="Datatype">ℙ</a>
<a id="714" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>  <a id="720" href="Data.Probability.html#695" class="Function Operator">/suc</a> <a id="725" href="Data.Probability.html#725" class="Bound">d</a> <a id="727" class="Symbol">=</a> <a id="729" href="Data.Probability.html#584" class="InductiveConstructor">ℙ⁰</a>
<a id="732" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="736" href="Data.Probability.html#736" class="Bound">n</a> <a id="738" href="Data.Probability.html#695" class="Function Operator">/suc</a> <a id="743" href="Data.Probability.html#743" class="Bound">d</a> <a id="745" class="Symbol">=</a> <a id="747" href="Data.Probability.html#615" class="Function">unEu</a> <a id="752" class="Symbol">(</a><a id="753" href="Data.Probability.html#490" class="Function">normalise-suc</a> <a id="767" href="Data.Probability.html#736" class="Bound">n</a> <a id="769" href="Data.Probability.html#743" class="Bound">d</a><a id="770" class="Symbol">)</a>

<a id="_/_"></a><a id="773" href="Data.Probability.html#773" class="Function Operator">_/_</a> <a id="777" class="Symbol">:</a> <a id="779" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="781" class="Symbol">→</a> <a id="783" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="785" class="Symbol">→</a> <a id="787" href="Data.Probability.html#567" class="Datatype">ℙ</a>
<a id="789" href="Data.Probability.html#789" class="Bound">n</a> <a id="791" href="Data.Probability.html#773" class="Function Operator">/</a> <a id="793" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a> <a id="798" class="Symbol">=</a> <a id="800" href="Data.Probability.html#584" class="InductiveConstructor">ℙ⁰</a>
<a id="803" href="Data.Probability.html#803" class="Bound">n</a> <a id="805" href="Data.Probability.html#773" class="Function Operator">/</a> <a id="807" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="811" href="Data.Probability.html#811" class="Bound">d</a> <a id="813" class="Symbol">=</a> <a id="815" href="Data.Probability.html#803" class="Bound">n</a> <a id="817" href="Data.Probability.html#695" class="Function Operator">/suc</a> <a id="822" href="Data.Probability.html#811" class="Bound">d</a>


<a id="zer"></a><a id="826" href="Data.Probability.html#826" class="Function">zer</a> <a id="830" class="Symbol">:</a> <a id="832" class="Symbol">(</a><a id="833" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="835" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="837" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="838" class="Symbol">)</a> <a id="840" class="Symbol">→</a> <a id="842" class="Symbol">(</a><a id="843" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="845" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="847" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="848" class="Symbol">)</a>
<a id="850" href="Data.Probability.html#826" class="Function">zer</a> <a id="854" class="Symbol">(</a><a id="855" href="Data.Probability.html#855" class="Bound">p</a> <a id="857" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="859" href="Data.Probability.html#859" class="Bound">q</a><a id="860" class="Symbol">)</a> <a id="862" class="Symbol">=</a> <a id="864" href="Data.Probability.html#855" class="Bound">p</a> <a id="866" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="868" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="872" href="Data.Probability.html#855" class="Bound">p</a> <a id="874" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">ℕ.+</a> <a id="878" href="Data.Probability.html#859" class="Bound">q</a>

<a id="one"></a><a id="881" href="Data.Probability.html#881" class="Function">one</a> <a id="885" class="Symbol">:</a> <a id="887" class="Symbol">(</a><a id="888" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="890" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="892" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="893" class="Symbol">)</a> <a id="895" class="Symbol">→</a> <a id="897" class="Symbol">(</a><a id="898" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="900" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="902" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="903" class="Symbol">)</a>
<a id="905" href="Data.Probability.html#881" class="Function">one</a> <a id="909" class="Symbol">(</a><a id="910" href="Data.Probability.html#910" class="Bound">p</a> <a id="912" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="914" href="Data.Probability.html#914" class="Bound">q</a><a id="915" class="Symbol">)</a> <a id="917" class="Symbol">=</a> <a id="919" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="923" href="Data.Probability.html#910" class="Bound">p</a> <a id="925" href="Agda.Builtin.Nat.html#336" class="Primitive Operator">ℕ.+</a> <a id="929" href="Data.Probability.html#914" class="Bound">q</a> <a id="931" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="933" href="Data.Probability.html#914" class="Bound">q</a>

<a id="norm"></a><a id="936" href="Data.Probability.html#936" class="Function">norm</a> <a id="941" class="Symbol">:</a> <a id="943" class="Symbol">(</a><a id="944" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="946" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="948" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="949" class="Symbol">)</a> <a id="951" class="Symbol">→</a> <a id="953" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="955" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="957" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a>
<a id="959" href="Data.Probability.html#936" class="Function">norm</a> <a id="964" class="Symbol">(</a><a id="965" href="Data.Probability.html#965" class="Bound">x</a> <a id="967" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="969" href="Data.Probability.html#969" class="Bound">y</a><a id="970" class="Symbol">)</a> <a id="972" class="Symbol">=</a> <a id="974" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="978" href="Data.Probability.html#965" class="Bound">x</a> <a id="980" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="982" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="986" href="Data.Probability.html#969" class="Bound">y</a>

<a id="prob"></a><a id="989" href="Data.Probability.html#989" class="Function">prob</a> <a id="994" class="Symbol">:</a> <a id="996" href="Data.Probability.html#567" class="Datatype">ℙ</a> <a id="998" class="Symbol">→</a> <a id="1000" class="Symbol">(</a><a id="1001" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1003" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="1005" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a><a id="1006" class="Symbol">)</a>
<a id="1008" href="Data.Probability.html#989" class="Function">prob</a> <a id="1013" href="Data.Probability.html#584" class="InductiveConstructor">ℙ⁰</a> <a id="1016" class="Symbol">=</a> <a id="1018" class="Number">0</a> <a id="1020" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1022" class="Number">1</a>
<a id="1024" href="Data.Probability.html#989" class="Function">prob</a> <a id="1029" href="Data.Probability.html#593" class="InductiveConstructor">ℙ¹</a> <a id="1032" class="Symbol">=</a> <a id="1034" class="Number">1</a> <a id="1036" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1038" class="Number">1</a>
<a id="1040" href="Data.Probability.html#989" class="Function">prob</a> <a id="1045" class="Symbol">(</a><a id="1046" href="Data.Probability.html#602" class="InductiveConstructor">ℙ∙</a> <a id="1049" href="Data.Probability.html#1049" class="Bound">x</a><a id="1050" class="Symbol">)</a> <a id="1052" class="Symbol">=</a> <a id="1054" href="Data.Probability.html#936" class="Function">norm</a> <a id="1059" class="Symbol">(</a><a id="1060" href="Data.Probability.html#826" class="Function">zer</a> <a id="1064" class="Symbol">(</a><a id="1065" href="Data.Bits.Fold.html#199" class="Function">foldr-bits</a> <a id="1076" href="Data.Probability.html#826" class="Function">zer</a> <a id="1080" href="Data.Probability.html#881" class="Function">one</a> <a id="1084" class="Symbol">(</a><a id="1085" class="Number">0</a> <a id="1087" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1089" class="Number">0</a><a id="1090" class="Symbol">)</a> <a id="1092" href="Data.Probability.html#1049" class="Bound">x</a><a id="1093" class="Symbol">))</a>

<a id="mul″"></a><a id="1097" href="Data.Probability.html#1097" class="Function">mul″</a> <a id="1102" class="Symbol">:</a> <a id="1104" href="Data.Probability.html#567" class="Datatype">ℙ</a> <a id="1106" class="Symbol">→</a> <a id="1108" href="Data.Probability.html#567" class="Datatype">ℙ</a> <a id="1110" class="Symbol">→</a> <a id="1112" href="Data.Probability.html#567" class="Datatype">ℙ</a>
<a id="1114" href="Data.Probability.html#1097" class="Function">mul″</a> <a id="1119" href="Data.Probability.html#1119" class="Bound">x</a> <a id="1121" href="Data.Probability.html#1121" class="Bound">y</a> <a id="1123" class="Symbol">=</a>
  <a id="1127" class="Keyword">let</a> <a id="1131" href="Data.Probability.html#1131" class="Bound">xn</a> <a id="1134" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1136" href="Data.Probability.html#1136" class="Bound">xd</a> <a id="1139" class="Symbol">=</a> <a id="1141" href="Data.Probability.html#989" class="Function">prob</a> <a id="1146" href="Data.Probability.html#1119" class="Bound">x</a>
      <a id="1154" href="Data.Probability.html#1154" class="Bound">yn</a> <a id="1157" href="Agda.Builtin.Sigma.html#235" class="InductiveConstructor Operator">,</a> <a id="1159" href="Data.Probability.html#1159" class="Bound">yd</a> <a id="1162" class="Symbol">=</a> <a id="1164" href="Data.Probability.html#989" class="Function">prob</a> <a id="1169" href="Data.Probability.html#1121" class="Bound">y</a>
  <a id="1173" class="Keyword">in</a> <a id="1176" class="Symbol">(</a><a id="1177" href="Data.Probability.html#1131" class="Bound">xn</a> <a id="1180" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">ℕ.*</a> <a id="1184" href="Data.Probability.html#1154" class="Bound">yn</a><a id="1186" class="Symbol">)</a> <a id="1188" href="Data.Probability.html#773" class="Function Operator">/</a> <a id="1190" class="Symbol">(</a><a id="1191" href="Data.Probability.html#1136" class="Bound">xd</a> <a id="1194" href="Agda.Builtin.Nat.html#539" class="Primitive Operator">ℕ.*</a> <a id="1198" href="Data.Probability.html#1159" class="Bound">yd</a><a id="1200" class="Symbol">)</a>

<a id="1203" class="Comment">-- e = prob (5 /suc 22)</a>

<a id="nextFrac"></a><a id="1228" href="Data.Probability.html#1228" class="Function">nextFrac</a> <a id="1237" class="Symbol">:</a> <a id="1239" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="1242" class="Symbol">→</a> <a id="1244" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="1247" href="Data.Probability.html#1228" class="Function">nextFrac</a> <a id="1256" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a> <a id="1259" class="Symbol">=</a> <a id="1261" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1264" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
<a id="1267" href="Data.Probability.html#1228" class="Function">nextFrac</a> <a id="1276" class="Symbol">(</a><a id="1277" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1280" href="Data.Probability.html#1280" class="Bound">x</a><a id="1281" class="Symbol">)</a> <a id="1283" class="Symbol">=</a> <a id="1285" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="1288" href="Data.Probability.html#1280" class="Bound">x</a>
<a id="1290" href="Data.Probability.html#1228" class="Function">nextFrac</a> <a id="1299" class="Symbol">(</a><a id="1300" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="1303" href="Data.Probability.html#1303" class="Bound">x</a><a id="1304" class="Symbol">)</a> <a id="1306" class="Symbol">=</a> <a id="1308" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1311" class="Symbol">(</a><a id="1312" href="Data.Probability.html#1228" class="Function">nextFrac</a> <a id="1321" href="Data.Probability.html#1303" class="Bound">x</a><a id="1322" class="Symbol">)</a>

<a id="1325" class="Keyword">open</a> <a id="1330" class="Keyword">import</a> <a id="1337" href="Data.List.html" class="Module">Data.List</a>

<a id="fracs"></a><a id="1348" href="Data.Probability.html#1348" class="Function">fracs</a> <a id="1354" class="Symbol">:</a> <a id="1356" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1358" class="Symbol">→</a> <a id="1360" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1365" href="Data.Probability.html#567" class="Datatype">ℙ</a>
<a id="1367" href="Data.Probability.html#1348" class="Function">fracs</a> <a id="1373" href="Data.Probability.html#1373" class="Bound">n</a> <a id="1375" class="Symbol">=</a> <a id="1377" href="Data.Probability.html#584" class="InductiveConstructor">ℙ⁰</a> <a id="1380" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1382" href="Data.Probability.html#593" class="InductiveConstructor">ℙ¹</a> <a id="1385" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1387" href="Data.Probability.html#1405" class="Function">go</a> <a id="1390" href="Data.Probability.html#1373" class="Bound">n</a> <a id="1392" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
  <a id="1397" class="Keyword">where</a>
  <a id="1405" href="Data.Probability.html#1405" class="Function">go</a> <a id="1408" class="Symbol">:</a> <a id="1410" href="Agda.Builtin.Nat.html#203" class="Datatype">ℕ</a> <a id="1412" class="Symbol">→</a> <a id="1414" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="1417" class="Symbol">→</a> <a id="1419" href="Agda.Builtin.List.html#147" class="Datatype">List</a> <a id="1424" href="Data.Probability.html#567" class="Datatype">ℙ</a>
  <a id="1428" href="Data.Probability.html#1405" class="Function">go</a> <a id="1431" href="Agda.Builtin.Nat.html#221" class="InductiveConstructor">zero</a>    <a id="1439" href="Data.Probability.html#1439" class="Bound">x</a> <a id="1441" class="Symbol">=</a> <a id="1443" href="Agda.Builtin.List.html#184" class="InductiveConstructor">[]</a>
  <a id="1448" href="Data.Probability.html#1405" class="Function">go</a> <a id="1451" class="Symbol">(</a><a id="1452" href="Agda.Builtin.Nat.html#234" class="InductiveConstructor">suc</a> <a id="1456" href="Data.Probability.html#1456" class="Bound">n</a><a id="1457" class="Symbol">)</a> <a id="1459" href="Data.Probability.html#1459" class="Bound">x</a> <a id="1461" class="Symbol">=</a> <a id="1463" href="Data.Probability.html#602" class="InductiveConstructor">ℙ∙</a> <a id="1466" href="Data.Probability.html#1459" class="Bound">x</a> <a id="1468" href="Agda.Builtin.List.html#199" class="InductiveConstructor Operator">∷</a> <a id="1470" href="Data.Probability.html#1405" class="Function">go</a> <a id="1473" href="Data.Probability.html#1456" class="Bound">n</a> <a id="1475" class="Symbol">(</a><a id="1476" href="Data.Probability.html#1228" class="Function">nextFrac</a> <a id="1485" href="Data.Probability.html#1459" class="Bound">x</a><a id="1486" class="Symbol">)</a>

<a id="1489" class="Keyword">open</a> <a id="1494" class="Keyword">import</a> <a id="1501" href="Data.List.Sugar.html" class="Module">Data.List.Sugar</a> <a id="1517" class="Keyword">using</a> <a id="1523" class="Symbol">(</a><a id="1524" href="Data.List.Sugar.html#443" class="Function">liftA2</a><a id="1530" class="Symbol">)</a>

<a id="1533" class="Comment">-- mul′ : ℚ⁺ → ℚ⁺ → ℚ⁺</a>
<a id="1556" class="Comment">-- mul′ 1ℚ 1ℚ = lℚ (lℚ 1ℚ)</a>
<a id="1583" class="Comment">-- mul′ 1ℚ (lℚ ys) = {!!}</a>
<a id="1609" class="Comment">-- mul′ 1ℚ (rℚ ys) = {!!}</a>
<a id="1635" class="Comment">-- mul′ (lℚ xs) 1ℚ = {!!}</a>
<a id="1661" class="Comment">-- mul′ (lℚ xs) (lℚ ys) = {!!}</a>
<a id="1692" class="Comment">-- mul′ (lℚ xs) (rℚ ys) = {!!}</a>
<a id="1723" class="Comment">-- mul′ (rℚ xs) 1ℚ = {!!}</a>
<a id="1749" class="Comment">-- mul′ (rℚ xs) (lℚ ys) = {!!}</a>
<a id="1780" class="Comment">-- mul′ (rℚ xs) (rℚ ys) = {!!}</a>

<a id="1812" class="Comment">-- mul : ℙ → ℙ → ℙ</a>
<a id="1831" class="Comment">-- mul ℙ⁰ ys = ℙ⁰</a>
<a id="1849" class="Comment">-- mul ℙ¹ ys = ys</a>
<a id="1867" class="Comment">-- mul (ℙ∙ x) ℙ⁰ = ℙ⁰</a>
<a id="1889" class="Comment">-- mul xs ℙ¹ = xs</a>
<a id="1907" class="Comment">-- mul (ℙ∙ x) (ℙ∙ y) = ℙ∙ (mul′ x y)</a>


<a id="1946" class="Comment">-- testMul : ℕ → Type</a>
<a id="1968" class="Comment">-- testMul n = liftA2 mul xs xs ≡ liftA2 mul″ xs xs</a>
<a id="2020" class="Comment">--   where</a>
<a id="2031" class="Comment">--     xs : List ℙ</a>
<a id="2050" class="Comment">--     xs = fracs n</a>

<a id="2071" class="Comment">-- _ : testMul 5</a>
<a id="2088" class="Comment">-- _ = refl</a>
</pre></body></html>