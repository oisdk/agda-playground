<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Probability</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="Data.Probability.html" class="Module">Data.Probability</a> <a id="59" class="Keyword">where</a>

<a id="66" class="Keyword">open</a> <a id="71" class="Keyword">import</a> <a id="78" href="Prelude.html" class="Module">Prelude</a>
<a id="86" class="Keyword">import</a> <a id="93" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="102" class="Symbol">as</a> <a id="105" class="Module">ℕ</a>
<a id="107" class="Keyword">import</a> <a id="114" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="134" class="Symbol">as</a> <a id="137" class="Module">ℕ</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Bits.html" class="Module">Data.Bits</a> <a id="161" class="Keyword">renaming</a> <a id="170" class="Symbol">(</a><a id="171" href="Data.Bits.html#102" class="Datatype">Bits</a> <a id="176" class="Symbol">to</a> <a id="Bits"></a><a id="179" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a><a id="181" class="Symbol">;</a> <a id="183" href="Data.Bits.html#123" class="InductiveConstructor">[]</a> <a id="186" class="Symbol">to</a> <a id="Bits.[]"></a><a id="189" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a><a id="191" class="Symbol">;</a> <a id="193" href="Data.Bits.html#135" class="InductiveConstructor Operator">0∷_</a> <a id="197" class="Symbol">to</a> <a id="Bits.0∷_"></a><a id="200" href="Data.Probability.html#200" class="InductiveConstructor Operator">lℚ</a><a id="202" class="Symbol">;</a> <a id="204" href="Data.Bits.html#155" class="InductiveConstructor Operator">1∷_</a> <a id="208" class="Symbol">to</a> <a id="Bits.1∷_"></a><a id="211" href="Data.Probability.html#211" class="InductiveConstructor Operator">rℚ</a><a id="213" class="Symbol">)</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Data.Bits.Equatable.html" class="Module">Data.Bits.Equatable</a>

<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Data.Bits.Fold.html" class="Module">Data.Bits.Fold</a>

<a id="euclidian"></a><a id="276" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="286" class="Symbol">:</a> <a id="288" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="290" class="Symbol">→</a> <a id="292" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="294" class="Symbol">→</a> <a id="296" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="298" class="Symbol">→</a> <a id="300" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="303" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="313" href="Data.Probability.html#313" class="Bound">n</a> <a id="315" href="Data.Probability.html#315" class="Bound">m</a> <a id="317" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="325" class="Symbol">=</a> <a id="327" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
<a id="330" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="340" href="Data.Probability.html#340" class="Bound">n</a> <a id="342" href="Data.Probability.html#342" class="Bound">m</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="349" href="Data.Probability.html#349" class="Bound">s</a><a id="350" class="Symbol">)</a> <a id="352" class="Symbol">=</a>
  <a id="356" href="Data.Bool.Base.html#516" class="Function Operator">if</a> <a id="359" href="Data.Probability.html#340" class="Bound">n</a> <a id="361" href="Data.Nat.Properties.html#164" class="Primitive Operator">ℕ.≡ᴮ</a> <a id="366" href="Data.Probability.html#342" class="Bound">m</a>
  <a id="370" href="Data.Bool.Base.html#516" class="Function Operator">then</a> <a id="375" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
  <a id="380" href="Data.Bool.Base.html#516" class="Function Operator">else</a> <a id="385" href="Data.Bool.Base.html#516" class="Function Operator">if</a> <a id="388" href="Data.Probability.html#340" class="Bound">n</a> <a id="390" href="Data.Nat.Properties.html#150" class="Primitive Operator">ℕ.&lt;ᴮ</a> <a id="395" href="Data.Probability.html#342" class="Bound">m</a>
  <a id="399" href="Data.Bool.Base.html#516" class="Function Operator">then</a> <a id="404" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="407" class="Symbol">(</a><a id="408" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="418" href="Data.Probability.html#340" class="Bound">n</a> <a id="420" class="Symbol">(</a><a id="421" href="Data.Probability.html#342" class="Bound">m</a> <a id="423" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="427" class="Symbol">(</a><a id="428" class="Number">1</a> <a id="430" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="434" href="Data.Probability.html#340" class="Bound">n</a><a id="435" class="Symbol">))</a> <a id="438" href="Data.Probability.html#349" class="Bound">s</a><a id="439" class="Symbol">)</a>
  <a id="443" href="Data.Bool.Base.html#516" class="Function Operator">else</a> <a id="448" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="451" class="Symbol">(</a><a id="452" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="462" class="Symbol">(</a><a id="463" href="Data.Probability.html#340" class="Bound">n</a> <a id="465" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="469" class="Symbol">(</a><a id="470" class="Number">1</a> <a id="472" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="476" href="Data.Probability.html#342" class="Bound">m</a><a id="477" class="Symbol">))</a> <a id="480" href="Data.Probability.html#342" class="Bound">m</a> <a id="482" href="Data.Probability.html#349" class="Bound">s</a><a id="483" class="Symbol">)</a>

<a id="normalise-suc"></a><a id="486" href="Data.Probability.html#486" class="Function">normalise-suc</a> <a id="500" class="Symbol">:</a> <a id="502" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="504" class="Symbol">→</a> <a id="506" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="508" class="Symbol">→</a> <a id="510" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="513" href="Data.Probability.html#486" class="Function">normalise-suc</a> <a id="527" href="Data.Probability.html#527" class="Bound">n</a> <a id="529" href="Data.Probability.html#529" class="Bound">m</a> <a id="531" class="Symbol">=</a> <a id="533" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="543" href="Data.Probability.html#527" class="Bound">n</a> <a id="545" href="Data.Probability.html#529" class="Bound">m</a> <a id="547" class="Symbol">(</a><a id="548" href="Data.Probability.html#527" class="Bound">n</a> <a id="550" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="554" href="Data.Probability.html#529" class="Bound">m</a><a id="555" class="Symbol">)</a>

<a id="558" class="Keyword">data</a> <a id="ℙ"></a><a id="563" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="565" class="Symbol">:</a> <a id="567" href="Level.html#242" class="Function">Type₀</a> <a id="573" class="Keyword">where</a>
  <a id="ℙ.ℙ⁰"></a><a id="581" href="Data.Probability.html#581" class="InductiveConstructor">ℙ⁰</a> <a id="584" class="Symbol">:</a> <a id="586" href="Data.Probability.html#563" class="Datatype">ℙ</a>
  <a id="ℙ.ℙ¹"></a><a id="590" href="Data.Probability.html#590" class="InductiveConstructor">ℙ¹</a> <a id="593" class="Symbol">:</a> <a id="595" href="Data.Probability.html#563" class="Datatype">ℙ</a>
  <a id="ℙ.ℙ∙"></a><a id="599" href="Data.Probability.html#599" class="InductiveConstructor">ℙ∙</a> <a id="602" class="Symbol">:</a> <a id="604" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="607" class="Symbol">→</a> <a id="609" href="Data.Probability.html#563" class="Datatype">ℙ</a>

<a id="unEu"></a><a id="612" href="Data.Probability.html#612" class="Function">unEu</a> <a id="617" class="Symbol">:</a> <a id="619" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="622" class="Symbol">→</a> <a id="624" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="626" href="Data.Probability.html#612" class="Function">unEu</a> <a id="631" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a> <a id="634" class="Symbol">=</a> <a id="636" href="Data.Probability.html#590" class="InductiveConstructor">ℙ¹</a>
<a id="639" href="Data.Probability.html#612" class="Function">unEu</a> <a id="644" class="Symbol">(</a><a id="645" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="648" href="Data.Probability.html#648" class="Bound">x</a><a id="649" class="Symbol">)</a> <a id="651" class="Symbol">=</a> <a id="653" href="Data.Probability.html#599" class="InductiveConstructor">ℙ∙</a> <a id="656" href="Data.Probability.html#648" class="Bound">x</a>
<a id="658" href="Data.Probability.html#612" class="Function">unEu</a> <a id="663" class="Symbol">(</a><a id="664" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="667" href="Data.Probability.html#667" class="Bound">x</a><a id="668" class="Symbol">)</a> <a id="670" class="Symbol">=</a> <a id="672" href="Data.Probability.html#590" class="InductiveConstructor">ℙ¹</a> <a id="675" class="Comment">-- won&#39;t happen</a>

<a id="_/suc_"></a><a id="692" href="Data.Probability.html#692" class="Function Operator">_/suc_</a> <a id="699" class="Symbol">:</a> <a id="701" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="703" class="Symbol">→</a> <a id="705" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="707" class="Symbol">→</a> <a id="709" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="711" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="717" href="Data.Probability.html#692" class="Function Operator">/suc</a> <a id="722" href="Data.Probability.html#722" class="Bound">d</a> <a id="724" class="Symbol">=</a> <a id="726" href="Data.Probability.html#581" class="InductiveConstructor">ℙ⁰</a>
<a id="729" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="733" href="Data.Probability.html#733" class="Bound">n</a> <a id="735" href="Data.Probability.html#692" class="Function Operator">/suc</a> <a id="740" href="Data.Probability.html#740" class="Bound">d</a> <a id="742" class="Symbol">=</a> <a id="744" href="Data.Probability.html#612" class="Function">unEu</a> <a id="749" class="Symbol">(</a><a id="750" href="Data.Probability.html#486" class="Function">normalise-suc</a> <a id="764" href="Data.Probability.html#733" class="Bound">n</a> <a id="766" href="Data.Probability.html#740" class="Bound">d</a><a id="767" class="Symbol">)</a>

<a id="_/_"></a><a id="770" href="Data.Probability.html#770" class="Function Operator">_/_</a> <a id="774" class="Symbol">:</a> <a id="776" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="778" class="Symbol">→</a> <a id="780" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="782" class="Symbol">→</a> <a id="784" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="786" href="Data.Probability.html#786" class="Bound">n</a> <a id="788" href="Data.Probability.html#770" class="Function Operator">/</a> <a id="790" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="795" class="Symbol">=</a> <a id="797" href="Data.Probability.html#581" class="InductiveConstructor">ℙ⁰</a>
<a id="800" href="Data.Probability.html#800" class="Bound">n</a> <a id="802" href="Data.Probability.html#770" class="Function Operator">/</a> <a id="804" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="808" href="Data.Probability.html#808" class="Bound">d</a> <a id="810" class="Symbol">=</a> <a id="812" href="Data.Probability.html#800" class="Bound">n</a> <a id="814" href="Data.Probability.html#692" class="Function Operator">/suc</a> <a id="819" href="Data.Probability.html#808" class="Bound">d</a>


<a id="zer"></a><a id="823" href="Data.Probability.html#823" class="Function">zer</a> <a id="827" class="Symbol">:</a> <a id="829" class="Symbol">(</a><a id="830" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="832" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="834" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="835" class="Symbol">)</a> <a id="837" class="Symbol">→</a> <a id="839" class="Symbol">(</a><a id="840" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="842" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="844" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="845" class="Symbol">)</a>
<a id="847" href="Data.Probability.html#823" class="Function">zer</a> <a id="851" class="Symbol">(</a><a id="852" href="Data.Probability.html#852" class="Bound">p</a> <a id="854" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="856" href="Data.Probability.html#856" class="Bound">q</a><a id="857" class="Symbol">)</a> <a id="859" class="Symbol">=</a> <a id="861" href="Data.Probability.html#852" class="Bound">p</a> <a id="863" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="865" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="869" href="Data.Probability.html#852" class="Bound">p</a> <a id="871" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="875" href="Data.Probability.html#856" class="Bound">q</a>

<a id="one"></a><a id="878" href="Data.Probability.html#878" class="Function">one</a> <a id="882" class="Symbol">:</a> <a id="884" class="Symbol">(</a><a id="885" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="887" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="889" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="890" class="Symbol">)</a> <a id="892" class="Symbol">→</a> <a id="894" class="Symbol">(</a><a id="895" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="897" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="899" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="900" class="Symbol">)</a>
<a id="902" href="Data.Probability.html#878" class="Function">one</a> <a id="906" class="Symbol">(</a><a id="907" href="Data.Probability.html#907" class="Bound">p</a> <a id="909" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="911" href="Data.Probability.html#911" class="Bound">q</a><a id="912" class="Symbol">)</a> <a id="914" class="Symbol">=</a> <a id="916" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="920" href="Data.Probability.html#907" class="Bound">p</a> <a id="922" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="926" href="Data.Probability.html#911" class="Bound">q</a> <a id="928" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="930" href="Data.Probability.html#911" class="Bound">q</a>

<a id="norm"></a><a id="933" href="Data.Probability.html#933" class="Function">norm</a> <a id="938" class="Symbol">:</a> <a id="940" class="Symbol">(</a><a id="941" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="943" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="945" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="946" class="Symbol">)</a> <a id="948" class="Symbol">→</a> <a id="950" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="952" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="954" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="956" href="Data.Probability.html#933" class="Function">norm</a> <a id="961" class="Symbol">(</a><a id="962" href="Data.Probability.html#962" class="Bound">x</a> <a id="964" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="966" href="Data.Probability.html#966" class="Bound">y</a><a id="967" class="Symbol">)</a> <a id="969" class="Symbol">=</a> <a id="971" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="975" href="Data.Probability.html#962" class="Bound">x</a> <a id="977" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="979" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="983" href="Data.Probability.html#966" class="Bound">y</a>

<a id="prob"></a><a id="986" href="Data.Probability.html#986" class="Function">prob</a> <a id="991" class="Symbol">:</a> <a id="993" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="995" class="Symbol">→</a> <a id="997" class="Symbol">(</a><a id="998" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1000" href="Data.Sigma.Base.html#534" class="Function Operator">×</a> <a id="1002" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1003" class="Symbol">)</a>
<a id="1005" href="Data.Probability.html#986" class="Function">prob</a> <a id="1010" href="Data.Probability.html#581" class="InductiveConstructor">ℙ⁰</a> <a id="1013" class="Symbol">=</a> <a id="1015" class="Number">0</a> <a id="1017" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1019" class="Number">1</a>
<a id="1021" href="Data.Probability.html#986" class="Function">prob</a> <a id="1026" href="Data.Probability.html#590" class="InductiveConstructor">ℙ¹</a> <a id="1029" class="Symbol">=</a> <a id="1031" class="Number">1</a> <a id="1033" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1035" class="Number">1</a>
<a id="1037" href="Data.Probability.html#986" class="Function">prob</a> <a id="1042" class="Symbol">(</a><a id="1043" href="Data.Probability.html#599" class="InductiveConstructor">ℙ∙</a> <a id="1046" href="Data.Probability.html#1046" class="Bound">x</a><a id="1047" class="Symbol">)</a> <a id="1049" class="Symbol">=</a> <a id="1051" href="Data.Probability.html#933" class="Function">norm</a> <a id="1056" class="Symbol">(</a><a id="1057" href="Data.Probability.html#823" class="Function">zer</a> <a id="1061" class="Symbol">(</a><a id="1062" href="Data.Bits.Fold.html#199" class="Function">foldr-bits</a> <a id="1073" href="Data.Probability.html#823" class="Function">zer</a> <a id="1077" href="Data.Probability.html#878" class="Function">one</a> <a id="1081" class="Symbol">(</a><a id="1082" class="Number">0</a> <a id="1084" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1086" class="Number">0</a><a id="1087" class="Symbol">)</a> <a id="1089" href="Data.Probability.html#1046" class="Bound">x</a><a id="1090" class="Symbol">))</a>

<a id="mul″"></a><a id="1094" href="Data.Probability.html#1094" class="Function">mul″</a> <a id="1099" class="Symbol">:</a> <a id="1101" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="1103" class="Symbol">→</a> <a id="1105" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="1107" class="Symbol">→</a> <a id="1109" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="1111" href="Data.Probability.html#1094" class="Function">mul″</a> <a id="1116" href="Data.Probability.html#1116" class="Bound">x</a> <a id="1118" href="Data.Probability.html#1118" class="Bound">y</a> <a id="1120" class="Symbol">=</a>
  <a id="1124" class="Keyword">let</a> <a id="1128" href="Data.Probability.html#1128" class="Bound">xn</a> <a id="1131" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1133" href="Data.Probability.html#1133" class="Bound">xd</a> <a id="1136" class="Symbol">=</a> <a id="1138" href="Data.Probability.html#986" class="Function">prob</a> <a id="1143" href="Data.Probability.html#1116" class="Bound">x</a>
      <a id="1151" href="Data.Probability.html#1151" class="Bound">yn</a> <a id="1154" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1156" href="Data.Probability.html#1156" class="Bound">yd</a> <a id="1159" class="Symbol">=</a> <a id="1161" href="Data.Probability.html#986" class="Function">prob</a> <a id="1166" href="Data.Probability.html#1118" class="Bound">y</a>
  <a id="1170" class="Keyword">in</a> <a id="1173" class="Symbol">(</a><a id="1174" href="Data.Probability.html#1128" class="Bound">xn</a> <a id="1177" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">ℕ.*</a> <a id="1181" href="Data.Probability.html#1151" class="Bound">yn</a><a id="1183" class="Symbol">)</a> <a id="1185" href="Data.Probability.html#770" class="Function Operator">/</a> <a id="1187" class="Symbol">(</a><a id="1188" href="Data.Probability.html#1133" class="Bound">xd</a> <a id="1191" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">ℕ.*</a> <a id="1195" href="Data.Probability.html#1156" class="Bound">yd</a><a id="1197" class="Symbol">)</a>

<a id="1200" class="Comment">-- e = prob (5 /suc 22)</a>

<a id="nextFrac"></a><a id="1225" href="Data.Probability.html#1225" class="Function">nextFrac</a> <a id="1234" class="Symbol">:</a> <a id="1236" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="1239" class="Symbol">→</a> <a id="1241" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="1244" href="Data.Probability.html#1225" class="Function">nextFrac</a> <a id="1253" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a> <a id="1256" class="Symbol">=</a> <a id="1258" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1261" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
<a id="1264" href="Data.Probability.html#1225" class="Function">nextFrac</a> <a id="1273" class="Symbol">(</a><a id="1274" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1277" href="Data.Probability.html#1277" class="Bound">x</a><a id="1278" class="Symbol">)</a> <a id="1280" class="Symbol">=</a> <a id="1282" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="1285" href="Data.Probability.html#1277" class="Bound">x</a>
<a id="1287" href="Data.Probability.html#1225" class="Function">nextFrac</a> <a id="1296" class="Symbol">(</a><a id="1297" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="1300" href="Data.Probability.html#1300" class="Bound">x</a><a id="1301" class="Symbol">)</a> <a id="1303" class="Symbol">=</a> <a id="1305" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1308" class="Symbol">(</a><a id="1309" href="Data.Probability.html#1225" class="Function">nextFrac</a> <a id="1318" href="Data.Probability.html#1300" class="Bound">x</a><a id="1319" class="Symbol">)</a>

<a id="1322" class="Keyword">open</a> <a id="1327" class="Keyword">import</a> <a id="1334" href="Data.List.html" class="Module">Data.List</a>

<a id="fracs"></a><a id="1345" href="Data.Probability.html#1345" class="Function">fracs</a> <a id="1351" class="Symbol">:</a> <a id="1353" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1355" class="Symbol">→</a> <a id="1357" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1362" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="1364" href="Data.Probability.html#1345" class="Function">fracs</a> <a id="1370" href="Data.Probability.html#1370" class="Bound">n</a> <a id="1372" class="Symbol">=</a> <a id="1374" href="Data.Probability.html#581" class="InductiveConstructor">ℙ⁰</a> <a id="1377" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1379" href="Data.Probability.html#590" class="InductiveConstructor">ℙ¹</a> <a id="1382" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1384" href="Data.Probability.html#1402" class="Function">go</a> <a id="1387" href="Data.Probability.html#1370" class="Bound">n</a> <a id="1389" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
  <a id="1394" class="Keyword">where</a>
  <a id="1402" href="Data.Probability.html#1402" class="Function">go</a> <a id="1405" class="Symbol">:</a> <a id="1407" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="1414" class="Symbol">→</a> <a id="1416" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1421" href="Data.Probability.html#563" class="Datatype">ℙ</a>
  <a id="1425" href="Data.Probability.html#1402" class="Function">go</a> <a id="1428" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1436" href="Data.Probability.html#1436" class="Bound">x</a> <a id="1438" class="Symbol">=</a> <a id="1440" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="1445" href="Data.Probability.html#1402" class="Function">go</a> <a id="1448" class="Symbol">(</a><a id="1449" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1453" href="Data.Probability.html#1453" class="Bound">n</a><a id="1454" class="Symbol">)</a> <a id="1456" href="Data.Probability.html#1456" class="Bound">x</a> <a id="1458" class="Symbol">=</a> <a id="1460" href="Data.Probability.html#599" class="InductiveConstructor">ℙ∙</a> <a id="1463" href="Data.Probability.html#1456" class="Bound">x</a> <a id="1465" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1467" href="Data.Probability.html#1402" class="Function">go</a> <a id="1470" href="Data.Probability.html#1453" class="Bound">n</a> <a id="1472" class="Symbol">(</a><a id="1473" href="Data.Probability.html#1225" class="Function">nextFrac</a> <a id="1482" href="Data.Probability.html#1456" class="Bound">x</a><a id="1483" class="Symbol">)</a>

<a id="1486" class="Keyword">open</a> <a id="1491" class="Keyword">import</a> <a id="1498" href="Data.List.Sugar.html" class="Module">Data.List.Sugar</a> <a id="1514" class="Keyword">using</a> <a id="1520" class="Symbol">(</a><a id="1521" href="Data.List.Sugar.html#443" class="Function">liftA2</a><a id="1527" class="Symbol">)</a>

<a id="1530" class="Comment">-- mul′ : ℚ⁺ → ℚ⁺ → ℚ⁺</a>
<a id="1553" class="Comment">-- mul′ 1ℚ 1ℚ = lℚ (lℚ 1ℚ)</a>
<a id="1580" class="Comment">-- mul′ 1ℚ (lℚ ys) = {!!}</a>
<a id="1606" class="Comment">-- mul′ 1ℚ (rℚ ys) = {!!}</a>
<a id="1632" class="Comment">-- mul′ (lℚ xs) 1ℚ = {!!}</a>
<a id="1658" class="Comment">-- mul′ (lℚ xs) (lℚ ys) = {!!}</a>
<a id="1689" class="Comment">-- mul′ (lℚ xs) (rℚ ys) = {!!}</a>
<a id="1720" class="Comment">-- mul′ (rℚ xs) 1ℚ = {!!}</a>
<a id="1746" class="Comment">-- mul′ (rℚ xs) (lℚ ys) = {!!}</a>
<a id="1777" class="Comment">-- mul′ (rℚ xs) (rℚ ys) = {!!}</a>

<a id="1809" class="Comment">-- mul : ℙ → ℙ → ℙ</a>
<a id="1828" class="Comment">-- mul ℙ⁰ ys = ℙ⁰</a>
<a id="1846" class="Comment">-- mul ℙ¹ ys = ys</a>
<a id="1864" class="Comment">-- mul (ℙ∙ x) ℙ⁰ = ℙ⁰</a>
<a id="1886" class="Comment">-- mul xs ℙ¹ = xs</a>
<a id="1904" class="Comment">-- mul (ℙ∙ x) (ℙ∙ y) = ℙ∙ (mul′ x y)</a>


<a id="1943" class="Comment">-- testMul : ℕ → Type₀</a>
<a id="1966" class="Comment">-- testMul n = liftA2 mul xs xs ≡ liftA2 mul″ xs xs</a>
<a id="2018" class="Comment">--   where</a>
<a id="2029" class="Comment">--     xs : List ℙ</a>
<a id="2048" class="Comment">--     xs = fracs n</a>

<a id="2069" class="Comment">-- _ : testMul 5</a>
<a id="2086" class="Comment">-- _ = refl</a>
</pre></body></html>