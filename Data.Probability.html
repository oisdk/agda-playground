<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Probability</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="Data.Probability.html" class="Module">Data.Probability</a> <a id="59" class="Keyword">where</a>

<a id="66" class="Keyword">open</a> <a id="71" class="Keyword">import</a> <a id="78" href="Prelude.html" class="Module">Prelude</a>
<a id="86" class="Keyword">import</a> <a id="93" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="102" class="Symbol">as</a> <a id="105" class="Module">ℕ</a>
<a id="107" class="Keyword">import</a> <a id="114" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="134" class="Symbol">as</a> <a id="137" class="Module">ℕ</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Data.Bits.html" class="Module">Data.Bits</a> <a id="161" class="Keyword">renaming</a> <a id="170" class="Symbol">(</a><a id="171" href="Data.Bits.html#102" class="Datatype">Bits</a> <a id="176" class="Symbol">to</a> <a id="179" class="Datatype">ℚ⁺</a><a id="181" class="Symbol">;</a> <a id="183" href="Data.Bits.html#122" class="InductiveConstructor">[]</a> <a id="186" class="Symbol">to</a> <a id="189" class="InductiveConstructor">1ℚ</a><a id="191" class="Symbol">;</a> <a id="193" href="Data.Bits.html#134" class="InductiveConstructor Operator">0∷_</a> <a id="197" class="Symbol">to</a> <a id="200" class="InductiveConstructor Operator">lℚ</a><a id="202" class="Symbol">;</a> <a id="204" href="Data.Bits.html#154" class="InductiveConstructor Operator">1∷_</a> <a id="208" class="Symbol">to</a> <a id="211" class="InductiveConstructor Operator">rℚ</a><a id="213" class="Symbol">)</a>
<a id="215" class="Keyword">open</a> <a id="220" class="Keyword">import</a> <a id="227" href="Data.Bits.Equatable.html" class="Module">Data.Bits.Equatable</a>

<a id="248" class="Keyword">open</a> <a id="253" class="Keyword">import</a> <a id="260" href="Data.Bits.Fold.html" class="Module">Data.Bits.Fold</a>

<a id="euclidian"></a><a id="276" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="286" class="Symbol">:</a> <a id="288" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="290" class="Symbol">→</a> <a id="292" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="294" class="Symbol">→</a> <a id="296" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="298" class="Symbol">→</a> <a id="300" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="303" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="313" href="Data.Probability.html#313" class="Bound">n</a> <a id="315" href="Data.Probability.html#315" class="Bound">m</a> <a id="317" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="325" class="Symbol">=</a> <a id="327" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
<a id="330" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="340" href="Data.Probability.html#340" class="Bound">n</a> <a id="342" href="Data.Probability.html#342" class="Bound">m</a> <a id="344" class="Symbol">(</a><a id="345" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="349" href="Data.Probability.html#349" class="Bound">s</a><a id="350" class="Symbol">)</a> <a id="352" class="Symbol">=</a>
  <a id="356" href="Data.Bool.Base.html#596" class="Function Operator">if</a> <a id="359" href="Data.Probability.html#340" class="Bound">n</a> <a id="361" href="Data.Nat.Properties.html#164" class="Primitive Operator">ℕ.≡ᴮ</a> <a id="366" href="Data.Probability.html#342" class="Bound">m</a>
  <a id="370" href="Data.Bool.Base.html#596" class="Function Operator">then</a> <a id="375" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
  <a id="380" href="Data.Bool.Base.html#596" class="Function Operator">else</a> <a id="385" href="Data.Bool.Base.html#596" class="Function Operator">if</a> <a id="388" href="Data.Probability.html#340" class="Bound">n</a> <a id="390" href="Data.Nat.Properties.html#150" class="Primitive Operator">ℕ.&lt;ᴮ</a> <a id="395" href="Data.Probability.html#342" class="Bound">m</a>
  <a id="399" href="Data.Bool.Base.html#596" class="Function Operator">then</a> <a id="404" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="407" class="Symbol">(</a><a id="408" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="418" href="Data.Probability.html#340" class="Bound">n</a> <a id="420" class="Symbol">(</a><a id="421" href="Data.Probability.html#342" class="Bound">m</a> <a id="423" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="427" class="Symbol">(</a><a id="428" class="Number">1</a> <a id="430" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="434" href="Data.Probability.html#340" class="Bound">n</a><a id="435" class="Symbol">))</a> <a id="438" href="Data.Probability.html#349" class="Bound">s</a><a id="439" class="Symbol">)</a>
  <a id="443" href="Data.Bool.Base.html#596" class="Function Operator">else</a> <a id="448" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="451" class="Symbol">(</a><a id="452" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="462" class="Symbol">(</a><a id="463" href="Data.Probability.html#340" class="Bound">n</a> <a id="465" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="469" class="Symbol">(</a><a id="470" class="Number">1</a> <a id="472" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="476" href="Data.Probability.html#342" class="Bound">m</a><a id="477" class="Symbol">))</a> <a id="480" href="Data.Probability.html#342" class="Bound">m</a> <a id="482" href="Data.Probability.html#349" class="Bound">s</a><a id="483" class="Symbol">)</a>

<a id="normalise-suc"></a><a id="486" href="Data.Probability.html#486" class="Function">normalise-suc</a> <a id="500" class="Symbol">:</a> <a id="502" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="504" class="Symbol">→</a> <a id="506" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="508" class="Symbol">→</a> <a id="510" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="513" href="Data.Probability.html#486" class="Function">normalise-suc</a> <a id="527" href="Data.Probability.html#527" class="Bound">n</a> <a id="529" href="Data.Probability.html#529" class="Bound">m</a> <a id="531" class="Symbol">=</a> <a id="533" href="Data.Probability.html#276" class="Function">euclidian</a> <a id="543" href="Data.Probability.html#527" class="Bound">n</a> <a id="545" href="Data.Probability.html#529" class="Bound">m</a> <a id="547" class="Symbol">(</a><a id="548" href="Data.Probability.html#527" class="Bound">n</a> <a id="550" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="554" href="Data.Probability.html#529" class="Bound">m</a><a id="555" class="Symbol">)</a>

<a id="558" class="Keyword">data</a> <a id="ℙ"></a><a id="563" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="565" class="Symbol">:</a> <a id="567" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="572" class="Keyword">where</a>
  <a id="ℙ.ℙ⁰"></a><a id="580" href="Data.Probability.html#580" class="InductiveConstructor">ℙ⁰</a> <a id="583" class="Symbol">:</a> <a id="585" href="Data.Probability.html#563" class="Datatype">ℙ</a>
  <a id="ℙ.ℙ¹"></a><a id="589" href="Data.Probability.html#589" class="InductiveConstructor">ℙ¹</a> <a id="592" class="Symbol">:</a> <a id="594" href="Data.Probability.html#563" class="Datatype">ℙ</a>
  <a id="ℙ.ℙ∙"></a><a id="598" href="Data.Probability.html#598" class="InductiveConstructor">ℙ∙</a> <a id="601" class="Symbol">:</a> <a id="603" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="606" class="Symbol">→</a> <a id="608" href="Data.Probability.html#563" class="Datatype">ℙ</a>

<a id="unEu"></a><a id="611" href="Data.Probability.html#611" class="Function">unEu</a> <a id="616" class="Symbol">:</a> <a id="618" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="621" class="Symbol">→</a> <a id="623" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="625" href="Data.Probability.html#611" class="Function">unEu</a> <a id="630" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a> <a id="633" class="Symbol">=</a> <a id="635" href="Data.Probability.html#589" class="InductiveConstructor">ℙ¹</a>
<a id="638" href="Data.Probability.html#611" class="Function">unEu</a> <a id="643" class="Symbol">(</a><a id="644" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="647" href="Data.Probability.html#647" class="Bound">x</a><a id="648" class="Symbol">)</a> <a id="650" class="Symbol">=</a> <a id="652" href="Data.Probability.html#598" class="InductiveConstructor">ℙ∙</a> <a id="655" href="Data.Probability.html#647" class="Bound">x</a>
<a id="657" href="Data.Probability.html#611" class="Function">unEu</a> <a id="662" class="Symbol">(</a><a id="663" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="666" href="Data.Probability.html#666" class="Bound">x</a><a id="667" class="Symbol">)</a> <a id="669" class="Symbol">=</a> <a id="671" href="Data.Probability.html#589" class="InductiveConstructor">ℙ¹</a> <a id="674" class="Comment">-- won&#39;t happen</a>

<a id="_/suc_"></a><a id="691" href="Data.Probability.html#691" class="Function Operator">_/suc_</a> <a id="698" class="Symbol">:</a> <a id="700" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="702" class="Symbol">→</a> <a id="704" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="706" class="Symbol">→</a> <a id="708" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="710" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>  <a id="716" href="Data.Probability.html#691" class="Function Operator">/suc</a> <a id="721" href="Data.Probability.html#721" class="Bound">d</a> <a id="723" class="Symbol">=</a> <a id="725" href="Data.Probability.html#580" class="InductiveConstructor">ℙ⁰</a>
<a id="728" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="732" href="Data.Probability.html#732" class="Bound">n</a> <a id="734" href="Data.Probability.html#691" class="Function Operator">/suc</a> <a id="739" href="Data.Probability.html#739" class="Bound">d</a> <a id="741" class="Symbol">=</a> <a id="743" href="Data.Probability.html#611" class="Function">unEu</a> <a id="748" class="Symbol">(</a><a id="749" href="Data.Probability.html#486" class="Function">normalise-suc</a> <a id="763" href="Data.Probability.html#732" class="Bound">n</a> <a id="765" href="Data.Probability.html#739" class="Bound">d</a><a id="766" class="Symbol">)</a>

<a id="_/_"></a><a id="769" href="Data.Probability.html#769" class="Function Operator">_/_</a> <a id="773" class="Symbol">:</a> <a id="775" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="777" class="Symbol">→</a> <a id="779" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="781" class="Symbol">→</a> <a id="783" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="785" href="Data.Probability.html#785" class="Bound">n</a> <a id="787" href="Data.Probability.html#769" class="Function Operator">/</a> <a id="789" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="794" class="Symbol">=</a> <a id="796" href="Data.Probability.html#580" class="InductiveConstructor">ℙ⁰</a>
<a id="799" href="Data.Probability.html#799" class="Bound">n</a> <a id="801" href="Data.Probability.html#769" class="Function Operator">/</a> <a id="803" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="807" href="Data.Probability.html#807" class="Bound">d</a> <a id="809" class="Symbol">=</a> <a id="811" href="Data.Probability.html#799" class="Bound">n</a> <a id="813" href="Data.Probability.html#691" class="Function Operator">/suc</a> <a id="818" href="Data.Probability.html#807" class="Bound">d</a>


<a id="zer"></a><a id="822" href="Data.Probability.html#822" class="Function">zer</a> <a id="826" class="Symbol">:</a> <a id="828" class="Symbol">(</a><a id="829" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="831" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="833" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="834" class="Symbol">)</a> <a id="836" class="Symbol">→</a> <a id="838" class="Symbol">(</a><a id="839" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="841" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="843" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="844" class="Symbol">)</a>
<a id="846" href="Data.Probability.html#822" class="Function">zer</a> <a id="850" class="Symbol">(</a><a id="851" href="Data.Probability.html#851" class="Bound">p</a> <a id="853" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="855" href="Data.Probability.html#855" class="Bound">q</a><a id="856" class="Symbol">)</a> <a id="858" class="Symbol">=</a> <a id="860" href="Data.Probability.html#851" class="Bound">p</a> <a id="862" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="864" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="868" href="Data.Probability.html#851" class="Bound">p</a> <a id="870" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="874" href="Data.Probability.html#855" class="Bound">q</a>

<a id="one"></a><a id="877" href="Data.Probability.html#877" class="Function">one</a> <a id="881" class="Symbol">:</a> <a id="883" class="Symbol">(</a><a id="884" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="886" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="888" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="889" class="Symbol">)</a> <a id="891" class="Symbol">→</a> <a id="893" class="Symbol">(</a><a id="894" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="896" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="898" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="899" class="Symbol">)</a>
<a id="901" href="Data.Probability.html#877" class="Function">one</a> <a id="905" class="Symbol">(</a><a id="906" href="Data.Probability.html#906" class="Bound">p</a> <a id="908" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="910" href="Data.Probability.html#910" class="Bound">q</a><a id="911" class="Symbol">)</a> <a id="913" class="Symbol">=</a> <a id="915" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="919" href="Data.Probability.html#906" class="Bound">p</a> <a id="921" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="925" href="Data.Probability.html#910" class="Bound">q</a> <a id="927" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="929" href="Data.Probability.html#910" class="Bound">q</a>

<a id="norm"></a><a id="932" href="Data.Probability.html#932" class="Function">norm</a> <a id="937" class="Symbol">:</a> <a id="939" class="Symbol">(</a><a id="940" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="942" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="944" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="945" class="Symbol">)</a> <a id="947" class="Symbol">→</a> <a id="949" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="951" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="953" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="955" href="Data.Probability.html#932" class="Function">norm</a> <a id="960" class="Symbol">(</a><a id="961" href="Data.Probability.html#961" class="Bound">x</a> <a id="963" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="965" href="Data.Probability.html#965" class="Bound">y</a><a id="966" class="Symbol">)</a> <a id="968" class="Symbol">=</a> <a id="970" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="974" href="Data.Probability.html#961" class="Bound">x</a> <a id="976" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="978" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="982" href="Data.Probability.html#965" class="Bound">y</a>

<a id="prob"></a><a id="985" href="Data.Probability.html#985" class="Function">prob</a> <a id="990" class="Symbol">:</a> <a id="992" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="994" class="Symbol">→</a> <a id="996" class="Symbol">(</a><a id="997" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="999" href="Data.Sigma.Base.html#523" class="Function Operator">×</a> <a id="1001" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1002" class="Symbol">)</a>
<a id="1004" href="Data.Probability.html#985" class="Function">prob</a> <a id="1009" href="Data.Probability.html#580" class="InductiveConstructor">ℙ⁰</a> <a id="1012" class="Symbol">=</a> <a id="1014" class="Number">0</a> <a id="1016" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1018" class="Number">1</a>
<a id="1020" href="Data.Probability.html#985" class="Function">prob</a> <a id="1025" href="Data.Probability.html#589" class="InductiveConstructor">ℙ¹</a> <a id="1028" class="Symbol">=</a> <a id="1030" class="Number">1</a> <a id="1032" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1034" class="Number">1</a>
<a id="1036" href="Data.Probability.html#985" class="Function">prob</a> <a id="1041" class="Symbol">(</a><a id="1042" href="Data.Probability.html#598" class="InductiveConstructor">ℙ∙</a> <a id="1045" href="Data.Probability.html#1045" class="Bound">x</a><a id="1046" class="Symbol">)</a> <a id="1048" class="Symbol">=</a> <a id="1050" href="Data.Probability.html#932" class="Function">norm</a> <a id="1055" class="Symbol">(</a><a id="1056" href="Data.Probability.html#822" class="Function">zer</a> <a id="1060" class="Symbol">(</a><a id="1061" href="Data.Bits.Fold.html#199" class="Function">foldr-bits</a> <a id="1072" href="Data.Probability.html#822" class="Function">zer</a> <a id="1076" href="Data.Probability.html#877" class="Function">one</a> <a id="1080" class="Symbol">(</a><a id="1081" class="Number">0</a> <a id="1083" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1085" class="Number">0</a><a id="1086" class="Symbol">)</a> <a id="1088" href="Data.Probability.html#1045" class="Bound">x</a><a id="1089" class="Symbol">))</a>

<a id="mul″"></a><a id="1093" href="Data.Probability.html#1093" class="Function">mul″</a> <a id="1098" class="Symbol">:</a> <a id="1100" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="1102" class="Symbol">→</a> <a id="1104" href="Data.Probability.html#563" class="Datatype">ℙ</a> <a id="1106" class="Symbol">→</a> <a id="1108" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="1110" href="Data.Probability.html#1093" class="Function">mul″</a> <a id="1115" href="Data.Probability.html#1115" class="Bound">x</a> <a id="1117" href="Data.Probability.html#1117" class="Bound">y</a> <a id="1119" class="Symbol">=</a>
  <a id="1123" class="Keyword">let</a> <a id="1127" href="Data.Probability.html#1127" class="Bound">xn</a> <a id="1130" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1132" href="Data.Probability.html#1132" class="Bound">xd</a> <a id="1135" class="Symbol">=</a> <a id="1137" href="Data.Probability.html#985" class="Function">prob</a> <a id="1142" href="Data.Probability.html#1115" class="Bound">x</a>
      <a id="1150" href="Data.Probability.html#1150" class="Bound">yn</a> <a id="1153" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1155" href="Data.Probability.html#1155" class="Bound">yd</a> <a id="1158" class="Symbol">=</a> <a id="1160" href="Data.Probability.html#985" class="Function">prob</a> <a id="1165" href="Data.Probability.html#1117" class="Bound">y</a>
  <a id="1169" class="Keyword">in</a> <a id="1172" class="Symbol">(</a><a id="1173" href="Data.Probability.html#1127" class="Bound">xn</a> <a id="1176" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">ℕ.*</a> <a id="1180" href="Data.Probability.html#1150" class="Bound">yn</a><a id="1182" class="Symbol">)</a> <a id="1184" href="Data.Probability.html#769" class="Function Operator">/</a> <a id="1186" class="Symbol">(</a><a id="1187" href="Data.Probability.html#1132" class="Bound">xd</a> <a id="1190" href="Agda.Builtin.Nat.html#528" class="Primitive Operator">ℕ.*</a> <a id="1194" href="Data.Probability.html#1155" class="Bound">yd</a><a id="1196" class="Symbol">)</a>

<a id="1199" class="Comment">-- e = prob (5 /suc 22)</a>

<a id="nextFrac"></a><a id="1224" href="Data.Probability.html#1224" class="Function">nextFrac</a> <a id="1233" class="Symbol">:</a> <a id="1235" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="1238" class="Symbol">→</a> <a id="1240" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a>
<a id="1243" href="Data.Probability.html#1224" class="Function">nextFrac</a> <a id="1252" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a> <a id="1255" class="Symbol">=</a> <a id="1257" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1260" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
<a id="1263" href="Data.Probability.html#1224" class="Function">nextFrac</a> <a id="1272" class="Symbol">(</a><a id="1273" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1276" href="Data.Probability.html#1276" class="Bound">x</a><a id="1277" class="Symbol">)</a> <a id="1279" class="Symbol">=</a> <a id="1281" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="1284" href="Data.Probability.html#1276" class="Bound">x</a>
<a id="1286" href="Data.Probability.html#1224" class="Function">nextFrac</a> <a id="1295" class="Symbol">(</a><a id="1296" href="Data.Probability.html#211" class="InductiveConstructor">rℚ</a> <a id="1299" href="Data.Probability.html#1299" class="Bound">x</a><a id="1300" class="Symbol">)</a> <a id="1302" class="Symbol">=</a> <a id="1304" href="Data.Probability.html#200" class="InductiveConstructor">lℚ</a> <a id="1307" class="Symbol">(</a><a id="1308" href="Data.Probability.html#1224" class="Function">nextFrac</a> <a id="1317" href="Data.Probability.html#1299" class="Bound">x</a><a id="1318" class="Symbol">)</a>

<a id="1321" class="Keyword">open</a> <a id="1326" class="Keyword">import</a> <a id="1333" href="Data.List.html" class="Module">Data.List</a>

<a id="fracs"></a><a id="1344" href="Data.Probability.html#1344" class="Function">fracs</a> <a id="1350" class="Symbol">:</a> <a id="1352" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1354" class="Symbol">→</a> <a id="1356" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1361" href="Data.Probability.html#563" class="Datatype">ℙ</a>
<a id="1363" href="Data.Probability.html#1344" class="Function">fracs</a> <a id="1369" href="Data.Probability.html#1369" class="Bound">n</a> <a id="1371" class="Symbol">=</a> <a id="1373" href="Data.Probability.html#580" class="InductiveConstructor">ℙ⁰</a> <a id="1376" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1378" href="Data.Probability.html#589" class="InductiveConstructor">ℙ¹</a> <a id="1381" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1383" href="Data.Probability.html#1401" class="Function">go</a> <a id="1386" href="Data.Probability.html#1369" class="Bound">n</a> <a id="1388" href="Data.Probability.html#189" class="InductiveConstructor">1ℚ</a>
  <a id="1393" class="Keyword">where</a>
  <a id="1401" href="Data.Probability.html#1401" class="Function">go</a> <a id="1404" class="Symbol">:</a> <a id="1406" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1408" class="Symbol">→</a> <a id="1410" href="Data.Probability.html#179" class="Datatype">ℚ⁺</a> <a id="1413" class="Symbol">→</a> <a id="1415" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="1420" href="Data.Probability.html#563" class="Datatype">ℙ</a>
  <a id="1424" href="Data.Probability.html#1401" class="Function">go</a> <a id="1427" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1435" href="Data.Probability.html#1435" class="Bound">x</a> <a id="1437" class="Symbol">=</a> <a id="1439" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
  <a id="1444" href="Data.Probability.html#1401" class="Function">go</a> <a id="1447" class="Symbol">(</a><a id="1448" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1452" href="Data.Probability.html#1452" class="Bound">n</a><a id="1453" class="Symbol">)</a> <a id="1455" href="Data.Probability.html#1455" class="Bound">x</a> <a id="1457" class="Symbol">=</a> <a id="1459" href="Data.Probability.html#598" class="InductiveConstructor">ℙ∙</a> <a id="1462" href="Data.Probability.html#1455" class="Bound">x</a> <a id="1464" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">∷</a> <a id="1466" href="Data.Probability.html#1401" class="Function">go</a> <a id="1469" href="Data.Probability.html#1452" class="Bound">n</a> <a id="1471" class="Symbol">(</a><a id="1472" href="Data.Probability.html#1224" class="Function">nextFrac</a> <a id="1481" href="Data.Probability.html#1455" class="Bound">x</a><a id="1482" class="Symbol">)</a>

<a id="1485" class="Keyword">open</a> <a id="1490" class="Keyword">import</a> <a id="1497" href="Data.List.Sugar.html" class="Module">Data.List.Sugar</a> <a id="1513" class="Keyword">using</a> <a id="1519" class="Symbol">(</a><a id="1520" href="Data.List.Sugar.html#443" class="Function">liftA2</a><a id="1526" class="Symbol">)</a>

<a id="1529" class="Comment">-- mul′ : ℚ⁺ → ℚ⁺ → ℚ⁺</a>
<a id="1552" class="Comment">-- mul′ 1ℚ 1ℚ = lℚ (lℚ 1ℚ)</a>
<a id="1579" class="Comment">-- mul′ 1ℚ (lℚ ys) = {!!}</a>
<a id="1605" class="Comment">-- mul′ 1ℚ (rℚ ys) = {!!}</a>
<a id="1631" class="Comment">-- mul′ (lℚ xs) 1ℚ = {!!}</a>
<a id="1657" class="Comment">-- mul′ (lℚ xs) (lℚ ys) = {!!}</a>
<a id="1688" class="Comment">-- mul′ (lℚ xs) (rℚ ys) = {!!}</a>
<a id="1719" class="Comment">-- mul′ (rℚ xs) 1ℚ = {!!}</a>
<a id="1745" class="Comment">-- mul′ (rℚ xs) (lℚ ys) = {!!}</a>
<a id="1776" class="Comment">-- mul′ (rℚ xs) (rℚ ys) = {!!}</a>

<a id="1808" class="Comment">-- mul : ℙ → ℙ → ℙ</a>
<a id="1827" class="Comment">-- mul ℙ⁰ ys = ℙ⁰</a>
<a id="1845" class="Comment">-- mul ℙ¹ ys = ys</a>
<a id="1863" class="Comment">-- mul (ℙ∙ x) ℙ⁰ = ℙ⁰</a>
<a id="1885" class="Comment">-- mul xs ℙ¹ = xs</a>
<a id="1903" class="Comment">-- mul (ℙ∙ x) (ℙ∙ y) = ℙ∙ (mul′ x y)</a>


<a id="1942" class="Comment">-- testMul : ℕ → Type</a>
<a id="1964" class="Comment">-- testMul n = liftA2 mul xs xs ≡ liftA2 mul″ xs xs</a>
<a id="2016" class="Comment">--   where</a>
<a id="2027" class="Comment">--     xs : List ℙ</a>
<a id="2046" class="Comment">--     xs = fracs n</a>

<a id="2067" class="Comment">-- _ : testMul 5</a>
<a id="2084" class="Comment">-- _ = refl</a>
</pre></body></html>