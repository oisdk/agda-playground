<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.HeapT</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--no-positivity-check</a> <a id="45" class="Pragma">--no-termination-check</a> <a id="68" class="Symbol">#-}</a>

<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Prelude.html" class="Module">Prelude</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Algebra.html" class="Module">Algebra</a>
<a id="113" class="Keyword">open</a> <a id="118" class="Keyword">import</a> <a id="125" href="Algebra.Monus.html" class="Module">Algebra.Monus</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="168" class="Keyword">module</a> <a id="175" href="Control.Monad.HeapT.html" class="Module">Control.Monad.HeapT</a>
  <a id="197" class="Symbol">{</a><a id="198" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a><a id="199" class="Symbol">}</a>
  <a id="203" class="Symbol">(</a><a id="204" href="Control.Monad.HeapT.html#204" class="Bound">gmon</a> <a id="209" class="Symbol">:</a> <a id="211" href="Algebra.html#7889" class="Record">GradedMonad</a> <a id="223" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a> <a id="225" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a> <a id="227" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a><a id="228" class="Symbol">)</a>
  <a id="232" class="Symbol">(</a><a id="233" href="Control.Monad.HeapT.html#233" class="Bound">comm</a> <a id="238" class="Symbol">:</a> <a id="240" href="Algebra.html#205" class="Function">Commutative</a> <a id="252" class="Symbol">(</a><a id="253" href="Algebra.html#1421" class="Function Operator">GradedMonad._∙_</a> <a id="269" href="Control.Monad.HeapT.html#204" class="Bound">gmon</a><a id="273" class="Symbol">))</a>
  <a id="278" class="Symbol">(</a><a id="279" href="Control.Monad.HeapT.html#279" class="Bound">tot</a> <a id="283" class="Symbol">:</a> <a id="285" href="Relation.Binary.html#963" class="Function">Total</a> <a id="291" class="Symbol">(λ</a> <a id="294" href="Control.Monad.HeapT.html#294" class="Bound">x</a> <a id="296" href="Control.Monad.HeapT.html#296" class="Bound">y</a> <a id="298" class="Symbol">→</a> <a id="300" href="Data.Sigma.Base.html#248" class="Function">∃[</a> <a id="303" href="Control.Monad.HeapT.html#303" class="Bound">z</a> <a id="305" href="Data.Sigma.Base.html#248" class="Function">]</a> <a id="307" class="Symbol">(</a><a id="308" href="Control.Monad.HeapT.html#296" class="Bound">y</a> <a id="310" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="312" class="Symbol">(</a><a id="313" href="Algebra.html#1421" class="Function Operator">GradedMonad._∙_</a> <a id="329" href="Control.Monad.HeapT.html#204" class="Bound">gmon</a> <a id="334" href="Control.Monad.HeapT.html#294" class="Bound">x</a> <a id="336" href="Control.Monad.HeapT.html#303" class="Bound">z</a><a id="337" class="Symbol">))))</a>
  <a id="344" class="Symbol">(</a><a id="345" href="Control.Monad.HeapT.html#345" class="Bound">atsm</a> <a id="350" class="Symbol">:</a> <a id="352" href="Relation.Binary.html#681" class="Function">Antisymmetric</a> <a id="366" class="Symbol">(λ</a> <a id="369" href="Control.Monad.HeapT.html#369" class="Bound">x</a> <a id="371" href="Control.Monad.HeapT.html#371" class="Bound">y</a> <a id="373" class="Symbol">→</a> <a id="375" href="Data.Sigma.Base.html#248" class="Function">∃[</a> <a id="378" href="Control.Monad.HeapT.html#378" class="Bound">z</a> <a id="380" href="Data.Sigma.Base.html#248" class="Function">]</a> <a id="382" class="Symbol">(</a><a id="383" href="Control.Monad.HeapT.html#371" class="Bound">y</a> <a id="385" href="Agda.Builtin.Cubical.Path.html#381" class="Function Operator">≡</a> <a id="387" class="Symbol">(</a><a id="388" href="Algebra.html#1421" class="Function Operator">GradedMonad._∙_</a> <a id="404" href="Control.Monad.HeapT.html#204" class="Bound">gmon</a> <a id="409" href="Control.Monad.HeapT.html#369" class="Bound">x</a> <a id="411" href="Control.Monad.HeapT.html#378" class="Bound">z</a><a id="412" class="Symbol">))))</a>
  <a id="419" class="Keyword">where</a>

<a id="426" class="Keyword">open</a> <a id="431" href="Algebra.html#7889" class="Module">GradedMonad</a> <a id="443" href="Control.Monad.HeapT.html#204" class="Bound">gmon</a>


<a id="monus"></a><a id="450" href="Control.Monad.HeapT.html#450" class="Function">monus</a> <a id="456" class="Symbol">:</a> <a id="458" href="Algebra.Monus.html#166" class="Record">Monus</a> <a id="464" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a>
<a id="466" href="Algebra.html#2843" class="Field">CommutativeMonoid.monoid</a> <a id="491" class="Symbol">(</a><a id="492" href="Algebra.Monus.html#208" class="Field">Monus.commutativeMonoid</a> <a id="516" href="Control.Monad.HeapT.html#450" class="Function">monus</a><a id="521" class="Symbol">)</a> <a id="523" class="Symbol">=</a> <a id="525" href="Algebra.html#7959" class="Function">monoid</a>
<a id="532" href="Algebra.html#2901" class="Field">CommutativeMonoid.comm</a> <a id="555" class="Symbol">(</a><a id="556" href="Algebra.Monus.html#208" class="Field">Monus.commutativeMonoid</a> <a id="580" href="Control.Monad.HeapT.html#450" class="Function">monus</a><a id="585" class="Symbol">)</a> <a id="587" class="Symbol">=</a> <a id="589" href="Control.Monad.HeapT.html#233" class="Bound">comm</a>
<a id="594" href="Algebra.Monus.html#376" class="Field Operator">Monus._≤|≥_</a> <a id="606" href="Control.Monad.HeapT.html#450" class="Function">monus</a> <a id="612" class="Symbol">=</a> <a id="614" href="Control.Monad.HeapT.html#279" class="Bound">tot</a>
<a id="618" href="Algebra.Monus.html#398" class="Field">Monus.antisym</a> <a id="632" href="Control.Monad.HeapT.html#450" class="Function">monus</a> <a id="638" class="Symbol">=</a> <a id="640" href="Control.Monad.HeapT.html#345" class="Bound">atsm</a>

<a id="646" class="Keyword">open</a> <a id="651" href="Algebra.Monus.html#166" class="Module">Monus</a> <a id="657" href="Control.Monad.HeapT.html#450" class="Function">monus</a> <a id="663" class="Keyword">hiding</a> <a id="670" class="Symbol">(</a>monoid<a id="677" class="Symbol">;</a> 𝑆<a id="680" class="Symbol">;</a> _∙_<a id="685" class="Symbol">;</a> assoc<a id="692" class="Symbol">;</a> comm<a id="698" class="Symbol">;</a> ε<a id="701" class="Symbol">)</a>

<a id="704" class="Keyword">private</a>
  <a id="714" class="Keyword">variable</a>
    <a id="727" href="Control.Monad.HeapT.html#727" class="Generalizable">x</a> <a id="729" href="Control.Monad.HeapT.html#729" class="Generalizable">y</a> <a id="731" href="Control.Monad.HeapT.html#731" class="Generalizable">z</a> <a id="733" class="Symbol">:</a> <a id="735" href="Algebra.html#1401" class="Function">𝑆</a>

<a id="738" class="Keyword">mutual</a>
  <a id="Heaped"></a><a id="747" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="754" class="Symbol">:</a> <a id="756" href="Algebra.html#1401" class="Function">𝑆</a> <a id="758" class="Symbol">→</a> <a id="760" href="Level.html#192" class="Function">Type</a> <a id="765" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a> <a id="767" class="Symbol">→</a> <a id="769" href="Level.html#192" class="Function">Type</a> <a id="774" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a>
  <a id="778" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="785" href="Control.Monad.HeapT.html#785" class="Bound">x</a> <a id="787" href="Control.Monad.HeapT.html#787" class="Bound">A</a> <a id="789" class="Symbol">=</a> <a id="791" href="Algebra.html#8018" class="Function">𝐹</a> <a id="793" href="Control.Monad.HeapT.html#785" class="Bound">x</a> <a id="795" class="Symbol">(</a><a id="796" href="Control.Monad.HeapT.html#814" class="Datatype">Root</a> <a id="801" href="Control.Monad.HeapT.html#785" class="Bound">x</a> <a id="803" href="Control.Monad.HeapT.html#787" class="Bound">A</a><a id="804" class="Symbol">)</a>

  <a id="809" class="Keyword">data</a> <a id="Root"></a><a id="814" href="Control.Monad.HeapT.html#814" class="Datatype">Root</a> <a id="819" class="Symbol">(</a><a id="820" href="Control.Monad.HeapT.html#820" class="Bound">x</a> <a id="822" class="Symbol">:</a> <a id="824" href="Algebra.html#1401" class="Function">𝑆</a><a id="825" class="Symbol">)</a> <a id="827" class="Symbol">(</a><a id="828" href="Control.Monad.HeapT.html#828" class="Bound">A</a> <a id="830" class="Symbol">:</a> <a id="832" href="Level.html#192" class="Function">Type</a> <a id="837" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a><a id="838" class="Symbol">)</a> <a id="840" class="Symbol">:</a> <a id="842" href="Level.html#192" class="Function">Type</a> <a id="847" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a> <a id="849" class="Keyword">where</a>
    <a id="Root.[]"></a><a id="859" href="Control.Monad.HeapT.html#859" class="InductiveConstructor">[]</a> <a id="862" class="Symbol">:</a> <a id="864" href="Control.Monad.HeapT.html#814" class="Datatype">Root</a> <a id="869" href="Control.Monad.HeapT.html#820" class="Bound">x</a> <a id="871" href="Control.Monad.HeapT.html#828" class="Bound">A</a>
    <a id="Root._∷_"></a><a id="877" href="Control.Monad.HeapT.html#877" class="InductiveConstructor Operator">_∷_</a> <a id="881" class="Symbol">:</a> <a id="883" href="Control.Monad.HeapT.html#926" class="Datatype">Branch</a> <a id="890" href="Control.Monad.HeapT.html#820" class="Bound">x</a> <a id="892" href="Control.Monad.HeapT.html#828" class="Bound">A</a> <a id="894" class="Symbol">→</a> <a id="896" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="903" href="Control.Monad.HeapT.html#820" class="Bound">x</a> <a id="905" href="Control.Monad.HeapT.html#828" class="Bound">A</a> <a id="907" class="Symbol">→</a> <a id="909" href="Control.Monad.HeapT.html#814" class="Datatype">Root</a> <a id="914" href="Control.Monad.HeapT.html#820" class="Bound">x</a> <a id="916" href="Control.Monad.HeapT.html#828" class="Bound">A</a>

  <a id="921" class="Keyword">data</a> <a id="Branch"></a><a id="926" href="Control.Monad.HeapT.html#926" class="Datatype">Branch</a> <a id="933" class="Symbol">(</a><a id="934" href="Control.Monad.HeapT.html#934" class="Bound">x</a> <a id="936" class="Symbol">:</a> <a id="938" href="Algebra.html#1401" class="Function">𝑆</a><a id="939" class="Symbol">)</a> <a id="941" class="Symbol">(</a><a id="942" href="Control.Monad.HeapT.html#942" class="Bound">A</a> <a id="944" class="Symbol">:</a> <a id="946" href="Level.html#192" class="Function">Type</a> <a id="951" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a><a id="952" class="Symbol">)</a> <a id="954" class="Symbol">:</a> <a id="956" href="Level.html#192" class="Function">Type</a> <a id="961" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a> <a id="963" class="Keyword">where</a>
    <a id="Branch.leaf"></a><a id="973" href="Control.Monad.HeapT.html#973" class="InductiveConstructor">leaf</a> <a id="978" class="Symbol">:</a> <a id="980" href="Control.Monad.HeapT.html#942" class="Bound">A</a> <a id="982" class="Symbol">→</a> <a id="984" href="Control.Monad.HeapT.html#926" class="Datatype">Branch</a> <a id="991" href="Control.Monad.HeapT.html#934" class="Bound">x</a> <a id="993" href="Control.Monad.HeapT.html#942" class="Bound">A</a>
    <a id="Branch.node"></a><a id="999" href="Control.Monad.HeapT.html#999" class="InductiveConstructor">node</a> <a id="1004" class="Symbol">:</a> <a id="1006" class="Symbol">(</a><a id="1007" href="Control.Monad.HeapT.html#1007" class="Bound">y</a> <a id="1009" class="Symbol">:</a> <a id="1011" href="Algebra.html#1401" class="Function">𝑆</a><a id="1012" class="Symbol">)</a> <a id="1014" class="Symbol">(</a><a id="1015" href="Control.Monad.HeapT.html#1015" class="Bound">ys</a> <a id="1018" class="Symbol">:</a> <a id="1020" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="1027" class="Symbol">(</a><a id="1028" href="Control.Monad.HeapT.html#934" class="Bound">x</a> <a id="1030" href="Algebra.html#1421" class="Function Operator">∙</a> <a id="1032" href="Control.Monad.HeapT.html#1007" class="Bound">y</a><a id="1033" class="Symbol">)</a> <a id="1035" href="Control.Monad.HeapT.html#942" class="Bound">A</a><a id="1036" class="Symbol">)</a> <a id="1038" class="Symbol">→</a> <a id="1040" href="Control.Monad.HeapT.html#926" class="Datatype">Branch</a> <a id="1047" href="Control.Monad.HeapT.html#934" class="Bound">x</a> <a id="1049" href="Control.Monad.HeapT.html#942" class="Bound">A</a>

<a id="Heap"></a><a id="1052" href="Control.Monad.HeapT.html#1052" class="Function">Heap</a> <a id="1057" class="Symbol">:</a> <a id="1059" href="Level.html#192" class="Function">Type</a> <a id="1064" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a> <a id="1066" class="Symbol">→</a> <a id="1068" href="Level.html#192" class="Function">Type</a> <a id="1073" href="Control.Monad.HeapT.html#198" class="Bound">ℓ</a>
<a id="1075" href="Control.Monad.HeapT.html#1052" class="Function">Heap</a> <a id="1080" class="Symbol">=</a> <a id="1082" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="1089" href="Algebra.html#1444" class="Function">ε</a>

<a id="hmap"></a><a id="1092" href="Control.Monad.HeapT.html#1092" class="Function">hmap</a> <a id="1097" class="Symbol">:</a> <a id="1099" class="Symbol">(</a><a id="1100" href="Level.html#388" class="Generalizable">A</a> <a id="1102" class="Symbol">→</a> <a id="1104" href="Level.html#402" class="Generalizable">B</a><a id="1105" class="Symbol">)</a> <a id="1107" class="Symbol">→</a> <a id="1109" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="1116" href="Control.Monad.HeapT.html#727" class="Generalizable">x</a> <a id="1118" href="Level.html#388" class="Generalizable">A</a> <a id="1120" class="Symbol">→</a> <a id="1122" href="Control.Monad.HeapT.html#747" class="Function">Heaped</a> <a id="1129" href="Control.Monad.HeapT.html#727" class="Generalizable">x</a> <a id="1131" href="Level.html#402" class="Generalizable">B</a>
<a id="bmap"></a><a id="1133" href="Control.Monad.HeapT.html#1133" class="Function">bmap</a> <a id="1138" class="Symbol">:</a> <a id="1140" class="Symbol">(</a><a id="1141" href="Level.html#388" class="Generalizable">A</a> <a id="1143" class="Symbol">→</a> <a id="1145" href="Level.html#402" class="Generalizable">B</a><a id="1146" class="Symbol">)</a> <a id="1148" class="Symbol">→</a> <a id="1150" href="Control.Monad.HeapT.html#926" class="Datatype">Branch</a> <a id="1157" href="Control.Monad.HeapT.html#727" class="Generalizable">x</a> <a id="1159" href="Level.html#388" class="Generalizable">A</a> <a id="1161" class="Symbol">→</a> <a id="1163" href="Control.Monad.HeapT.html#926" class="Datatype">Branch</a> <a id="1170" href="Control.Monad.HeapT.html#727" class="Generalizable">x</a> <a id="1172" href="Level.html#402" class="Generalizable">B</a>

<a id="1175" href="Control.Monad.HeapT.html#1092" class="Function">hmap</a> <a id="1180" href="Control.Monad.HeapT.html#1180" class="Bound">f</a> <a id="1182" class="Symbol">=</a> <a id="1184" href="Algebra.html#8648" class="Function">map</a> <a id="1188" class="Symbol">λ</a> <a id="1190" class="Symbol">{</a> <a id="1192" href="Control.Monad.HeapT.html#859" class="InductiveConstructor">[]</a> <a id="1195" class="Symbol">→</a> <a id="1197" href="Control.Monad.HeapT.html#859" class="InductiveConstructor">[]</a> <a id="1200" class="Symbol">;</a> <a id="1202" class="Symbol">(</a><a id="1203" href="Control.Monad.HeapT.html#1203" class="Bound">x</a> <a id="1205" href="Control.Monad.HeapT.html#877" class="InductiveConstructor Operator">∷</a> <a id="1207" href="Control.Monad.HeapT.html#1207" class="Bound">xs</a><a id="1209" class="Symbol">)</a> <a id="1211" class="Symbol">→</a> <a id="1213" href="Control.Monad.HeapT.html#1133" class="Function">bmap</a> <a id="1218" href="Control.Monad.HeapT.html#1180" class="Bound">f</a> <a id="1220" href="Control.Monad.HeapT.html#1203" class="Bound">x</a> <a id="1222" href="Control.Monad.HeapT.html#877" class="InductiveConstructor Operator">∷</a> <a id="1224" href="Control.Monad.HeapT.html#1092" class="Function">hmap</a> <a id="1229" href="Control.Monad.HeapT.html#1180" class="Bound">f</a> <a id="1231" href="Control.Monad.HeapT.html#1207" class="Bound">xs</a><a id="1233" class="Symbol">}</a>
<a id="1235" href="Control.Monad.HeapT.html#1133" class="Function">bmap</a> <a id="1240" href="Control.Monad.HeapT.html#1240" class="Bound">f</a> <a id="1242" class="Symbol">(</a><a id="1243" href="Control.Monad.HeapT.html#973" class="InductiveConstructor">leaf</a> <a id="1248" href="Control.Monad.HeapT.html#1248" class="Bound">x</a><a id="1249" class="Symbol">)</a> <a id="1251" class="Symbol">=</a> <a id="1253" href="Control.Monad.HeapT.html#973" class="InductiveConstructor">leaf</a> <a id="1258" class="Symbol">(</a><a id="1259" href="Control.Monad.HeapT.html#1240" class="Bound">f</a> <a id="1261" href="Control.Monad.HeapT.html#1248" class="Bound">x</a><a id="1262" class="Symbol">)</a>
<a id="1264" href="Control.Monad.HeapT.html#1133" class="Function">bmap</a> <a id="1269" href="Control.Monad.HeapT.html#1269" class="Bound">f</a> <a id="1271" class="Symbol">(</a><a id="1272" href="Control.Monad.HeapT.html#999" class="InductiveConstructor">node</a> <a id="1277" href="Control.Monad.HeapT.html#1277" class="Bound">y</a> <a id="1279" href="Control.Monad.HeapT.html#1279" class="Bound">ys</a><a id="1281" class="Symbol">)</a> <a id="1283" class="Symbol">=</a> <a id="1285" href="Control.Monad.HeapT.html#999" class="InductiveConstructor">node</a> <a id="1290" href="Control.Monad.HeapT.html#1277" class="Bound">y</a> <a id="1292" class="Symbol">(</a><a id="1293" href="Control.Monad.HeapT.html#1092" class="Function">hmap</a> <a id="1298" href="Control.Monad.HeapT.html#1269" class="Bound">f</a> <a id="1300" href="Control.Monad.HeapT.html#1279" class="Bound">ys</a><a id="1302" class="Symbol">)</a>

<a id="1305" class="Comment">-- -- _++_ : Heaped ε A → Heaped ε A → Heaped ε A</a>
<a id="1355" class="Comment">-- -- xs ++ ys = xs &gt;&gt;=[ {!!} ] (λ { [] → ys ; (x ∷ xs) → pure (x ∷ (xs ++ ys)) })</a>


<a id="1440" class="Comment">-- hbind : (A → Heap B) → Heaped x A → Heaped x B</a>
<a id="1490" class="Comment">-- bbind : (A → Heap B) → Branch x A → Heap B</a>

<a id="1537" class="Comment">-- hbind f xs′ = xs′ &gt;&gt;=[ ∙ε _ ]</a>
<a id="1570" class="Comment">--   (λ { [] → pure []</a>
<a id="1593" class="Comment">--      ; (x ∷ xs) →</a>
<a id="1614" class="Comment">--        let y = bbind f x</a>
<a id="1642" class="Comment">--            ys = hbind f xs</a>
<a id="1672" class="Comment">--        in {! !}})</a>

<a id="1694" class="Comment">-- bbind f (leaf x) = f x</a>
<a id="1720" class="Comment">-- bbind f (node y ys) = pure (node y {!!} ∷ pure [])</a>

<a id="1775" class="Comment">-- -- mutual</a>
<a id="1788" class="Comment">-- --   bind : ∀ {x} → Heaped x A → (A → Heaped ε B) → Heaped x B</a>
<a id="1854" class="Comment">-- --   bind xs f = subst (flip 𝐹 _) (∙ε _) (xs &gt;&gt;= go f)</a>

<a id="1913" class="Comment">-- --   go : (A → Heaped ε B) → Root x A → 𝐹 ε (Root x B)</a>
<a id="1971" class="Comment">-- --   go f [] = pure []</a>
<a id="1997" class="Comment">-- --   go f (leaf x    ∷ xs) =</a>
<a id="2029" class="Comment">-- --     let p = f x</a>
<a id="2051" class="Comment">-- --         q = bind xs f</a>
<a id="2079" class="Comment">-- --     in {!!}</a>
<a id="2097" class="Comment">-- --   go f (node y ys ∷ xs) = {!!}</a>

<a id="2135" class="Comment">-- --   -- go′ : (A → Heaped ε B) → Branch x A → Heaped x B → Root x B</a>
<a id="2206" class="Comment">-- --   -- go′ f (leaf x) xs = {!!}</a>
<a id="2242" class="Comment">-- --   -- go′ f (node y ys) zs = {!!}</a>
</pre></body></html>