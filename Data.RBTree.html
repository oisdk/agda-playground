<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.RBTree</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Pragma">--postfix-projections</a> <a id="52" class="Symbol">#-}</a>

<a id="57" class="Keyword">open</a> <a id="62" class="Keyword">import</a> <a id="69" href="Prelude.html" class="Module">Prelude</a>
<a id="77" class="Keyword">open</a> <a id="82" class="Keyword">import</a> <a id="89" href="Relation.Binary.html" class="Module">Relation.Binary</a>

<a id="106" class="Keyword">module</a> <a id="113" href="Data.RBTree.html" class="Module">Data.RBTree</a> <a id="125" class="Symbol">{</a><a id="126" href="Data.RBTree.html#126" class="Bound">e</a><a id="127" class="Symbol">}</a> <a id="129" class="Symbol">{</a><a id="130" href="Data.RBTree.html#130" class="Bound">E</a> <a id="132" class="Symbol">:</a> <a id="134" href="Level.html#192" class="Function">Type</a> <a id="139" href="Data.RBTree.html#126" class="Bound">e</a><a id="140" class="Symbol">}</a> <a id="142" class="Symbol">{</a><a id="143" href="Data.RBTree.html#143" class="Bound">r₁</a> <a id="146" href="Data.RBTree.html#146" class="Bound">r₂</a><a id="148" class="Symbol">}</a> <a id="150" class="Symbol">(</a><a id="151" href="Data.RBTree.html#151" class="Bound">totalOrder</a> <a id="162" class="Symbol">:</a> <a id="164" href="Relation.Binary.html#2507" class="Record">TotalOrder</a> <a id="175" href="Data.RBTree.html#130" class="Bound">E</a> <a id="177" href="Data.RBTree.html#143" class="Bound">r₁</a> <a id="180" href="Data.RBTree.html#146" class="Bound">r₂</a><a id="182" class="Symbol">)</a> <a id="184" class="Keyword">where</a>

<a id="191" class="Keyword">open</a> <a id="196" class="Keyword">import</a> <a id="203" href="Relation.Binary.Construct.Bounded.html" class="Module">Relation.Binary.Construct.Bounded</a> <a id="237" href="Data.RBTree.html#151" class="Bound">totalOrder</a>

<a id="249" class="Keyword">open</a> <a id="254" href="Relation.Binary.html#2507" class="Module">TotalOrder</a> <a id="265" href="Data.RBTree.html#151" class="Bound">totalOrder</a> <a id="276" class="Keyword">using</a> <a id="282" class="Symbol">(</a>_≤?_<a id="287" class="Symbol">)</a>

<a id="290" class="Keyword">data</a> <a id="Colour"></a><a id="295" href="Data.RBTree.html#295" class="Datatype">Colour</a> <a id="302" class="Symbol">:</a> <a id="304" href="Level.html#242" class="Function">Type₀</a> <a id="310" class="Keyword">where</a>
  <a id="Colour.red"></a><a id="318" href="Data.RBTree.html#318" class="InductiveConstructor">red</a> <a id="Colour.black"></a><a id="322" href="Data.RBTree.html#322" class="InductiveConstructor">black</a> <a id="328" class="Symbol">:</a> <a id="330" href="Data.RBTree.html#295" class="Datatype">Colour</a>

<a id="add-black"></a><a id="338" href="Data.RBTree.html#338" class="Function">add-black</a> <a id="348" class="Symbol">:</a> <a id="350" href="Data.RBTree.html#295" class="Datatype">Colour</a> <a id="357" class="Symbol">→</a> <a id="359" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="361" class="Symbol">→</a> <a id="363" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>
<a id="365" href="Data.RBTree.html#338" class="Function">add-black</a> <a id="375" href="Data.RBTree.html#318" class="InductiveConstructor">red</a> <a id="379" class="Symbol">=</a> <a id="381" class="Symbol">λ</a> <a id="383" href="Data.RBTree.html#383" class="Bound">n</a> <a id="385" class="Symbol">→</a> <a id="387" href="Data.RBTree.html#383" class="Bound">n</a>
<a id="389" href="Data.RBTree.html#338" class="Function">add-black</a> <a id="399" href="Data.RBTree.html#322" class="InductiveConstructor">black</a> <a id="405" class="Symbol">=</a> <a id="407" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a>

<a id="412" class="Keyword">private</a>
  <a id="422" class="Keyword">variable</a>
    <a id="435" href="Data.RBTree.html#435" class="Generalizable">n</a> <a id="437" class="Symbol">:</a> <a id="439" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a>

<a id="442" class="Keyword">data</a> <a id="Tree"></a><a id="447" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="452" class="Symbol">(</a><a id="453" href="Data.RBTree.html#453" class="Bound">lb</a> <a id="456" href="Data.RBTree.html#456" class="Bound">ub</a> <a id="459" class="Symbol">:</a> <a id="461" href="Relation.Binary.Construct.Bounded.html#363" class="Datatype">[∙]</a><a id="464" class="Symbol">)</a> <a id="466" class="Symbol">:</a> <a id="468" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="470" class="Symbol">→</a> <a id="472" href="Level.html#192" class="Function">Type</a> <a id="477" class="Symbol">(</a><a id="478" href="Data.RBTree.html#126" class="Bound">e</a> <a id="480" href="Agda.Primitive.html#636" class="Primitive Operator">ℓ⊔</a> <a id="483" href="Data.RBTree.html#146" class="Bound">r₂</a><a id="485" class="Symbol">)</a> <a id="487" class="Keyword">where</a>
  <a id="Tree.leaf"></a><a id="495" href="Data.RBTree.html#495" class="InductiveConstructor">leaf</a> <a id="500" class="Symbol">:</a> <a id="502" href="Data.RBTree.html#453" class="Bound">lb</a> <a id="505" href="Relation.Binary.Construct.Bounded.html#415" class="Function Operator">[≤]</a> <a id="509" href="Data.RBTree.html#456" class="Bound">ub</a> <a id="512" class="Symbol">→</a> <a id="514" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="519" href="Data.RBTree.html#453" class="Bound">lb</a> <a id="522" href="Data.RBTree.html#456" class="Bound">ub</a> <a id="525" href="Data.RBTree.html#435" class="Generalizable">n</a>
  <a id="Tree.node"></a><a id="529" href="Data.RBTree.html#529" class="InductiveConstructor">node</a> <a id="534" class="Symbol">:</a> <a id="536" class="Symbol">(</a><a id="537" href="Data.RBTree.html#537" class="Bound">x</a> <a id="539" class="Symbol">:</a> <a id="541" href="Data.RBTree.html#130" class="Bound">E</a><a id="542" class="Symbol">)</a> <a id="544" class="Symbol">→</a> <a id="546" class="Symbol">(</a><a id="547" href="Data.RBTree.html#547" class="Bound">c</a> <a id="549" class="Symbol">:</a> <a id="551" href="Data.RBTree.html#295" class="Datatype">Colour</a><a id="557" class="Symbol">)</a> <a id="559" class="Symbol">→</a> <a id="561" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="566" href="Data.RBTree.html#453" class="Bound">lb</a> <a id="569" href="Relation.Binary.Construct.Bounded.html#400" class="InductiveConstructor Operator">[</a> <a id="571" href="Data.RBTree.html#537" class="Bound">x</a> <a id="573" href="Relation.Binary.Construct.Bounded.html#400" class="InductiveConstructor Operator">]</a> <a id="575" href="Data.RBTree.html#435" class="Generalizable">n</a> <a id="577" class="Symbol">→</a> <a id="579" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="584" href="Relation.Binary.Construct.Bounded.html#400" class="InductiveConstructor Operator">[</a> <a id="586" href="Data.RBTree.html#537" class="Bound">x</a> <a id="588" href="Relation.Binary.Construct.Bounded.html#400" class="InductiveConstructor Operator">]</a> <a id="590" href="Data.RBTree.html#456" class="Bound">ub</a> <a id="593" href="Data.RBTree.html#435" class="Generalizable">n</a> <a id="595" class="Symbol">→</a> <a id="597" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="602" href="Data.RBTree.html#453" class="Bound">lb</a> <a id="605" href="Data.RBTree.html#456" class="Bound">ub</a> <a id="608" class="Symbol">(</a><a id="609" href="Data.RBTree.html#338" class="Function">add-black</a> <a id="619" href="Data.RBTree.html#547" class="Bound">c</a> <a id="621" href="Data.RBTree.html#435" class="Generalizable">n</a><a id="622" class="Symbol">)</a>

<a id="625" class="Keyword">private</a>
  <a id="635" class="Keyword">variable</a>
    <a id="648" href="Data.RBTree.html#648" class="Generalizable">lb</a> <a id="651" href="Data.RBTree.html#651" class="Generalizable">ub</a> <a id="654" class="Symbol">:</a> <a id="656" href="Relation.Binary.Construct.Bounded.html#363" class="Datatype">[∙]</a>

<a id="IsBlack"></a><a id="661" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="669" class="Symbol">:</a> <a id="671" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="676" href="Data.RBTree.html#648" class="Generalizable">lb</a> <a id="679" href="Data.RBTree.html#651" class="Generalizable">ub</a> <a id="682" href="Data.RBTree.html#435" class="Generalizable">n</a> <a id="684" class="Symbol">→</a> <a id="686" href="Level.html#242" class="Function">Type₀</a>
<a id="692" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="700" class="Symbol">(</a><a id="701" href="Data.RBTree.html#495" class="InductiveConstructor">leaf</a> <a id="706" href="Data.RBTree.html#706" class="Bound">x</a><a id="707" class="Symbol">)</a> <a id="709" class="Symbol">=</a> <a id="711" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="713" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="721" class="Symbol">(</a><a id="722" href="Data.RBTree.html#529" class="InductiveConstructor">node</a> <a id="727" href="Data.RBTree.html#727" class="Bound">x</a> <a id="729" href="Data.RBTree.html#318" class="InductiveConstructor">red</a> <a id="733" href="Data.RBTree.html#733" class="Bound">tr</a> <a id="736" href="Data.RBTree.html#736" class="Bound">tr₁</a><a id="739" class="Symbol">)</a> <a id="741" class="Symbol">=</a> <a id="743" href="Data.Empty.Base.html#91" class="Datatype">⊥</a>
<a id="745" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="753" class="Symbol">(</a><a id="754" href="Data.RBTree.html#529" class="InductiveConstructor">node</a> <a id="759" href="Data.RBTree.html#759" class="Bound">x</a> <a id="761" href="Data.RBTree.html#322" class="InductiveConstructor">black</a> <a id="767" href="Data.RBTree.html#767" class="Bound">tr</a> <a id="770" href="Data.RBTree.html#770" class="Bound">tr₁</a><a id="773" class="Symbol">)</a> <a id="775" class="Symbol">=</a> <a id="777" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>

<a id="Valid-rec"></a><a id="780" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="790" class="Symbol">:</a> <a id="792" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="797" href="Data.RBTree.html#648" class="Generalizable">lb</a> <a id="800" href="Data.RBTree.html#651" class="Generalizable">ub</a> <a id="803" href="Data.RBTree.html#435" class="Generalizable">n</a> <a id="805" class="Symbol">→</a> <a id="807" href="Level.html#242" class="Function">Type₀</a>
<a id="813" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="823" class="Symbol">(</a><a id="824" href="Data.RBTree.html#495" class="InductiveConstructor">leaf</a> <a id="829" href="Data.RBTree.html#829" class="Bound">x</a><a id="830" class="Symbol">)</a> <a id="832" class="Symbol">=</a> <a id="834" href="Agda.Builtin.Unit.html#164" class="Record">⊤</a>
<a id="836" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="846" class="Symbol">(</a><a id="847" href="Data.RBTree.html#529" class="InductiveConstructor">node</a> <a id="852" href="Data.RBTree.html#852" class="Bound">x</a> <a id="854" href="Data.RBTree.html#318" class="InductiveConstructor">red</a>   <a id="860" href="Data.RBTree.html#860" class="Bound">xs</a> <a id="863" href="Data.RBTree.html#863" class="Bound">ys</a><a id="865" class="Symbol">)</a> <a id="867" class="Symbol">=</a> <a id="869" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="877" href="Data.RBTree.html#860" class="Bound">xs</a> <a id="880" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="882" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="890" href="Data.RBTree.html#863" class="Bound">ys</a> <a id="893" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="895" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="905" href="Data.RBTree.html#860" class="Bound">xs</a> <a id="908" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="910" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="920" href="Data.RBTree.html#863" class="Bound">ys</a>
<a id="923" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="933" class="Symbol">(</a><a id="934" href="Data.RBTree.html#529" class="InductiveConstructor">node</a> <a id="939" href="Data.RBTree.html#939" class="Bound">x</a> <a id="941" href="Data.RBTree.html#322" class="InductiveConstructor">black</a> <a id="947" href="Data.RBTree.html#947" class="Bound">xs</a> <a id="950" href="Data.RBTree.html#950" class="Bound">ys</a><a id="952" class="Symbol">)</a> <a id="954" class="Symbol">=</a> <a id="956" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="966" href="Data.RBTree.html#947" class="Bound">xs</a> <a id="969" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="971" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="981" href="Data.RBTree.html#950" class="Bound">ys</a>


<a id="Valid"></a><a id="986" href="Data.RBTree.html#986" class="Function">Valid</a> <a id="992" class="Symbol">:</a> <a id="994" href="Data.RBTree.html#447" class="Datatype">Tree</a> <a id="999" href="Data.RBTree.html#648" class="Generalizable">lb</a> <a id="1002" href="Data.RBTree.html#651" class="Generalizable">ub</a> <a id="1005" href="Data.RBTree.html#435" class="Generalizable">n</a> <a id="1007" class="Symbol">→</a> <a id="1009" href="Level.html#242" class="Function">Type₀</a>
<a id="1015" href="Data.RBTree.html#986" class="Function">Valid</a> <a id="1021" href="Data.RBTree.html#1021" class="Bound">tr</a> <a id="1024" class="Symbol">=</a> <a id="1026" href="Data.RBTree.html#661" class="Function">IsBlack</a> <a id="1034" href="Data.RBTree.html#1021" class="Bound">tr</a> <a id="1037" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="1039" href="Data.RBTree.html#780" class="Function">Valid-rec</a> <a id="1049" href="Data.RBTree.html#1021" class="Bound">tr</a>

<a id="1053" class="Comment">-- insertWithin : (x : E) →</a>
<a id="1081" class="Comment">--                (lb [≤] [ x ]) →</a>
<a id="1116" class="Comment">--                ([ x ] [≤] ub) →</a>
<a id="1151" class="Comment">--                (tr : Tree lb ub n) →</a>
<a id="1191" class="Comment">--                Valid-rec tr →</a>
<a id="1224" class="Comment">--                ∃[ c ] Σ (Tree lb ub (add-black c n)) Valid-rec</a>
<a id="1290" class="Comment">-- insertWithin x lb≤x x≤ub (leaf _) val = red , node x red (leaf lb≤x) (leaf x≤ub) , tt , tt , tt , tt</a>
<a id="1394" class="Comment">-- insertWithin x lb≤x x≤ub (node y c ls rs) val with x ≤? y</a>
<a id="1455" class="Comment">-- insertWithin x lb≤x x≤ub (node y red   ls rs) val | inl x≤y with insertWithin x lb≤x x≤y ls (fst (snd (snd val)))</a>
<a id="1572" class="Comment">-- insertWithin x lb≤x x≤ub (node y red   ls rs) val | inl x≤y | red    , ls′ , val′ = black , node y black ls′ rs , val′ , snd (snd (snd val))</a>
<a id="1716" class="Comment">-- insertWithin x lb≤x x≤ub (node y red   ls rs) val | inl x≤y | black  , ls′ , val′ = {!{!!} , node y {!!} ls′ rs , {!!}!}</a>
<a id="1840" class="Comment">-- insertWithin x lb≤x x≤ub (node y black ls rs) val | inl x≤y with insertWithin x lb≤x x≤y ls (fst val)</a>
<a id="1945" class="Comment">-- insertWithin x lb≤x x≤ub (node y black ls rs) val | inl x≤y | res = {!!}</a>
<a id="2021" class="Comment">-- insertWithin x lb≤x x≤ub (node y c ls rs) val | inr y≤x = {!!}</a>

<a id="2088" class="Comment">-- -- insertWithin x lb≤x x≤ub (node y ls rs) with x ≤? y</a>
<a id="2146" class="Comment">-- -- insertWithin x lb≤x x≤ub (node y ls rs) | inl x≤y = node y (insertWithin x lb≤x x≤y ls) rs</a>
<a id="2243" class="Comment">-- -- insertWithin x lb≤x x≤ub (node y ls rs) | inr y≤x = node y ls (insertWithin x y≤x x≤ub rs)</a>
</pre></body></html>