<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.HeapT.NonTransformer</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--no-positivity-check</a> <a id="45" class="Pragma">--no-termination-check</a> <a id="68" class="Symbol">#-}</a>

<a id="73" class="Keyword">open</a> <a id="78" class="Keyword">import</a> <a id="85" href="Prelude.html" class="Module">Prelude</a>
<a id="93" class="Keyword">open</a> <a id="98" class="Keyword">import</a> <a id="105" href="Algebra.html" class="Module">Algebra</a>
<a id="113" class="Keyword">open</a> <a id="118" class="Keyword">import</a> <a id="125" href="Algebra.Monus.html" class="Module">Algebra.Monus</a>
<a id="139" class="Keyword">open</a> <a id="144" class="Keyword">import</a> <a id="151" href="Relation.Binary.html" class="Module">Relation.Binary</a>
<a id="167" class="Keyword">open</a> <a id="172" class="Keyword">import</a> <a id="179" href="Data.Maybe.html" class="Module">Data.Maybe</a>
<a id="190" class="Keyword">open</a> <a id="195" class="Keyword">import</a> <a id="202" href="Data.List.html" class="Module">Data.List</a> <a id="212" class="Keyword">using</a> <a id="218" class="Symbol">(</a><a id="219" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="223" class="Symbol">;</a> <a id="225" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_âˆ·_</a><a id="228" class="Symbol">;</a> <a id="230" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="232" class="Symbol">;</a> <a id="234" href="Data.List.Base.html#269" class="Function">foldr</a><a id="239" class="Symbol">)</a>

<a id="242" class="Keyword">module</a> <a id="249" href="Control.Monad.HeapT.NonTransformer.html" class="Module">Control.Monad.HeapT.NonTransformer</a>
  <a id="286" class="Symbol">{</a><a id="287" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a><a id="288" class="Symbol">}</a>
  <a id="292" class="Symbol">(</a><a id="293" href="Control.Monad.HeapT.NonTransformer.html#293" class="Bound">monoid</a> <a id="300" class="Symbol">:</a> <a id="302" href="Algebra.html#1343" class="Record">Monoid</a> <a id="309" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a><a id="310" class="Symbol">)</a>
  <a id="314" class="Keyword">where</a>

<a id="321" class="Keyword">open</a> <a id="326" href="Algebra.html#1343" class="Module">Monoid</a> <a id="333" href="Control.Monad.HeapT.NonTransformer.html#293" class="Bound">monoid</a>

<a id="341" class="Keyword">private</a>
  <a id="351" class="Keyword">variable</a>
    <a id="364" href="Control.Monad.HeapT.NonTransformer.html#364" class="Generalizable">w</a> <a id="366" class="Symbol">:</a> <a id="368" href="Algebra.html#1401" class="Field">ğ‘†</a>

<a id="371" class="Keyword">infixr</a> <a id="378" class="Number">5</a> <a id="380" href="Control.Monad.HeapT.NonTransformer.html#686" class="InductiveConstructor Operator">_âˆ·_</a>
<a id="384" class="Keyword">infixr</a> <a id="391" class="Number">6</a> <a id="393" href="Control.Monad.HeapT.NonTransformer.html#479" class="CoinductiveConstructor Operator">_â‹Š_</a>

<a id="398" class="Keyword">mutual</a>
  <a id="407" class="Keyword">record</a> <a id="Root"></a><a id="414" href="Control.Monad.HeapT.NonTransformer.html#414" class="Record">Root</a> <a id="419" class="Symbol">(</a><a id="420" href="Control.Monad.HeapT.NonTransformer.html#420" class="Bound">A</a> <a id="422" class="Symbol">:</a> <a id="424" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="429" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a><a id="430" class="Symbol">)</a> <a id="432" class="Symbol">:</a> <a id="434" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="439" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a> <a id="441" class="Keyword">where</a>
    <a id="451" class="Keyword">coinductive</a>
    <a id="467" class="Keyword">constructor</a> <a id="_â‹Š_"></a><a id="479" href="Control.Monad.HeapT.NonTransformer.html#479" class="CoinductiveConstructor Operator">_â‹Š_</a>
    <a id="487" class="Keyword">field</a>
      <a id="Root.weight"></a><a id="499" href="Control.Monad.HeapT.NonTransformer.html#499" class="Field">weight</a> <a id="506" class="Symbol">:</a> <a id="508" href="Algebra.html#1401" class="Field">ğ‘†</a>
      <a id="Root.step"></a><a id="516" href="Control.Monad.HeapT.NonTransformer.html#516" class="Field">step</a> <a id="521" class="Symbol">:</a> <a id="523" href="Control.Monad.HeapT.NonTransformer.html#628" class="Datatype">Branch</a> <a id="530" href="Control.Monad.HeapT.NonTransformer.html#420" class="Bound">A</a>

  <a id="535" class="Keyword">data</a> <a id="Node"></a><a id="540" href="Control.Monad.HeapT.NonTransformer.html#540" class="Datatype">Node</a> <a id="545" class="Symbol">(</a><a id="546" href="Control.Monad.HeapT.NonTransformer.html#546" class="Bound">A</a> <a id="548" class="Symbol">:</a> <a id="550" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="555" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a><a id="556" class="Symbol">)</a> <a id="558" class="Symbol">:</a> <a id="560" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="565" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a> <a id="567" class="Keyword">where</a>
    <a id="Node.âŒŠ_âŒ‹"></a><a id="577" href="Control.Monad.HeapT.NonTransformer.html#577" class="InductiveConstructor Operator">âŒŠ_âŒ‹</a> <a id="581" class="Symbol">:</a> <a id="583" href="Control.Monad.HeapT.NonTransformer.html#546" class="Bound">A</a> <a id="585" class="Symbol">â†’</a> <a id="587" href="Control.Monad.HeapT.NonTransformer.html#540" class="Datatype">Node</a> <a id="592" href="Control.Monad.HeapT.NonTransformer.html#546" class="Bound">A</a>
    <a id="Node.âŒˆ_âŒ‰"></a><a id="598" href="Control.Monad.HeapT.NonTransformer.html#598" class="InductiveConstructor Operator">âŒˆ_âŒ‰</a> <a id="602" class="Symbol">:</a> <a id="604" href="Control.Monad.HeapT.NonTransformer.html#414" class="Record">Root</a> <a id="609" href="Control.Monad.HeapT.NonTransformer.html#546" class="Bound">A</a> <a id="611" class="Symbol">â†’</a> <a id="613" href="Control.Monad.HeapT.NonTransformer.html#540" class="Datatype">Node</a> <a id="618" href="Control.Monad.HeapT.NonTransformer.html#546" class="Bound">A</a>

  <a id="623" class="Keyword">data</a> <a id="Branch"></a><a id="628" href="Control.Monad.HeapT.NonTransformer.html#628" class="Datatype">Branch</a> <a id="635" class="Symbol">(</a><a id="636" href="Control.Monad.HeapT.NonTransformer.html#636" class="Bound">A</a> <a id="638" class="Symbol">:</a> <a id="640" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="645" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a><a id="646" class="Symbol">)</a> <a id="648" class="Symbol">:</a> <a id="650" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="655" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a> <a id="657" class="Keyword">where</a>
    <a id="Branch.[]"></a><a id="667" href="Control.Monad.HeapT.NonTransformer.html#667" class="InductiveConstructor">[]</a>  <a id="671" class="Symbol">:</a> <a id="673" href="Control.Monad.HeapT.NonTransformer.html#628" class="Datatype">Branch</a> <a id="680" href="Control.Monad.HeapT.NonTransformer.html#636" class="Bound">A</a>
    <a id="Branch._âˆ·_"></a><a id="686" href="Control.Monad.HeapT.NonTransformer.html#686" class="InductiveConstructor Operator">_âˆ·_</a> <a id="690" class="Symbol">:</a> <a id="692" href="Control.Monad.HeapT.NonTransformer.html#540" class="Datatype">Node</a> <a id="697" href="Control.Monad.HeapT.NonTransformer.html#636" class="Bound">A</a> <a id="699" class="Symbol">â†’</a> <a id="701" href="Control.Monad.HeapT.NonTransformer.html#628" class="Datatype">Branch</a> <a id="708" href="Control.Monad.HeapT.NonTransformer.html#636" class="Bound">A</a> <a id="710" class="Symbol">â†’</a> <a id="712" href="Control.Monad.HeapT.NonTransformer.html#628" class="Datatype">Branch</a> <a id="719" href="Control.Monad.HeapT.NonTransformer.html#636" class="Bound">A</a>
<a id="721" class="Keyword">open</a> <a id="726" href="Control.Monad.HeapT.NonTransformer.html#414" class="Module">Root</a> <a id="731" class="Keyword">public</a>

<a id="Heap"></a><a id="739" href="Control.Monad.HeapT.NonTransformer.html#739" class="Function">Heap</a> <a id="744" class="Symbol">:</a> <a id="746" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="751" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a> <a id="753" class="Symbol">â†’</a> <a id="755" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="760" href="Control.Monad.HeapT.NonTransformer.html#287" class="Bound">â„“</a>
<a id="762" href="Control.Monad.HeapT.NonTransformer.html#739" class="Function">Heap</a> <a id="767" href="Control.Monad.HeapT.NonTransformer.html#767" class="Bound">A</a> <a id="769" class="Symbol">=</a> <a id="771" href="Control.Monad.HeapT.NonTransformer.html#628" class="Datatype">Branch</a> <a id="778" href="Control.Monad.HeapT.NonTransformer.html#767" class="Bound">A</a>

<a id="781" class="Comment">-- infixr 5 _++_</a>
<a id="798" class="Comment">-- _++_ : ğ¹ w (Branch A) â†’ ğ¹ Îµ (Branch A) â†’ ğ¹ w (Branch A)</a>
<a id="857" class="Comment">-- xs ++ ys =</a>
  <a id="873" class="Comment">-- xs &gt;&gt;=Îµ Î»  {  []       â†’ ys</a>
  <a id="906" class="Comment">--            ;  (x âˆ· xs) â†’ pure (x âˆ· xs ++ ys) }</a>

<a id="957" class="Comment">-- infixr 1 _&gt;&gt;=á´º_ _&gt;&gt;=á´´_</a>
<a id="983" class="Comment">-- mutual</a>
<a id="993" class="Comment">--   _&gt;&gt;=á´º_ : Node A â†’ (A â†’ Heap B) â†’ Heap B</a>
<a id="1038" class="Comment">--   âŒŠ x âŒ‹  &gt;&gt;=á´º f = f x</a>
<a id="1063" class="Comment">--   âŒˆ x âŒ‰  &gt;&gt;=á´º f = pure (âŒˆ weight x â‹Š (step x &gt;&gt;=á´´ f) âŒ‰ âˆ· pure [])</a>

<a id="1133" class="Comment">--   _&gt;&gt;=á´´_ : ğ¹ w (Branch A) â†’ (A â†’ Heap B) â†’ ğ¹ w (Branch B)</a>
<a id="1194" class="Comment">--   xs &gt;&gt;=á´´ f =</a>
<a id="1211" class="Comment">--     xs &gt;&gt;=Îµ Î»  {  []        â†’ pure []</a>
<a id="1252" class="Comment">--                ;  (x âˆ· xs)  â†’ (x &gt;&gt;=á´º f) ++ (xs &gt;&gt;=á´´ f) }</a>

<a id="1314" class="Comment">-- pureá´´ : A â†’ Heap A</a>
<a id="1336" class="Comment">-- pureá´´ x = pure (âŒŠ x âŒ‹ âˆ· pure [])</a>

<a id="1373" class="Comment">-- liftá´´ : ğ¹ w A â†’ Heap A</a>
<a id="1399" class="Comment">-- liftá´´ xs = pure (âŒˆ _ â‹Š map (Î» x â†’ âŒŠ x âŒ‹ âˆ· pure []) xs âŒ‰ âˆ· pure [])</a>

<a id="1470" class="Comment">-- flatten : ğ¹ w (Branch A) â†’ ğ¹ w (List A Ã— List (Root A))</a>
<a id="1529" class="Comment">-- flatten xs =</a>
<a id="1545" class="Comment">--   xs &gt;&gt;=Îµ Î»  {  []            â†’ pure ([] , [])</a>
<a id="1595" class="Comment">--              ;  (âŒŠ x âŒ‹ âˆ· xs)  â†’ map (mapâ‚ (x âˆ·_)) (flatten xs)</a>
<a id="1661" class="Comment">--              ;  (âŒˆ x âŒ‰ âˆ· xs)  â†’ map (mapâ‚‚ (x âˆ·_)) (flatten xs) }</a>

<a id="1730" class="Comment">-- module PopMin</a>
<a id="1747" class="Comment">--   (_â‰¤|â‰¥_ : Total (Î» x y â†’ âˆƒ z Ã— (y â‰¡ x âˆ™ z)))</a>
<a id="1796" class="Comment">--   (decomp : âˆ€ {A B wâ‚ wâ‚‚ wâ‚ƒ} â†’ ğ¹ (wâ‚ âˆ™ wâ‚‚) A â†’ ğ¹ (wâ‚ âˆ™ wâ‚ƒ) B â†’ ğ¹ wâ‚ (ğ¹ wâ‚‚ A Ã— ğ¹ wâ‚ƒ B)) where</a>

<a id="1893" class="Comment">--   _âˆª_ : Root A â†’ Root A â†’ Root A</a>
<a id="1929" class="Comment">--   xs âˆª ys with weight xs â‰¤|â‰¥ weight ys</a>
<a id="1971" class="Comment">--   ... | inl (k , wÊ¸â‰¡wË£âˆ™k) = weight xs â‹Š map (Î» { (xs , ys) â†’ âŒˆ k â‹Š ys âŒ‰ âˆ· xs }) (decomp (subst (flip ğ¹ _) (sym (âˆ™Îµ _)) (step xs)) (subst (flip ğ¹ _) wÊ¸â‰¡wË£âˆ™k (step ys)))</a>
<a id="2142" class="Comment">--   ... | inr (k , wË£â‰¡wÊ¸âˆ™k) = weight ys â‹Š map (Î» { (ys , xs) â†’ âŒˆ k â‹Š xs âŒ‰ âˆ· ys }) (decomp (subst (flip ğ¹ _) (sym (âˆ™Îµ _)) (step ys)) (subst (flip ğ¹ _) wË£â‰¡wÊ¸âˆ™k (step xs)))</a>

<a id="2314" class="Comment">--   â‹ƒâº : Root A â†’ List (Root A) â†’ Root A</a>
<a id="2356" class="Comment">--   â‹ƒâº xâ‚ []             = xâ‚</a>
<a id="2387" class="Comment">--   â‹ƒâº xâ‚ (xâ‚‚ âˆ· [])      = xâ‚ âˆª xâ‚‚</a>
<a id="2423" class="Comment">--   â‹ƒâº xâ‚ (xâ‚‚ âˆ· xâ‚ƒ âˆ· xs) = (xâ‚ âˆª xâ‚‚) âˆª â‹ƒâº xâ‚ƒ xs</a>

<a id="2473" class="Comment">--   â‹ƒ : List (Root A) â†’ Maybe (Root A)</a>
<a id="2513" class="Comment">--   â‹ƒ []       = nothing</a>
<a id="2539" class="Comment">--   â‹ƒ (x âˆ· xs) = just (â‹ƒâº x xs)</a>

<a id="2573" class="Comment">--   popMin : ğ¹ w (Branch A) â†’ ğ¹ w (List A Ã— Maybe (Root A))</a>
<a id="2634" class="Comment">--   popMin = map (mapâ‚‚ â‹ƒ) âˆ˜ flatten</a>
</pre></body></html>