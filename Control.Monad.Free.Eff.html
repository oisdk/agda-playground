<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Control.Monad.Free.Eff</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">module</a> <a id="8" href="Control.Monad.Free.Eff.html" class="Module">Control.Monad.Free.Eff</a> <a id="31" class="Keyword">where</a>

<a id="38" class="Keyword">open</a> <a id="43" class="Keyword">import</a> <a id="50" href="Prelude.html" class="Module">Prelude</a>
<a id="58" class="Keyword">open</a> <a id="63" class="Keyword">import</a> <a id="70" href="Data.Set.html" class="Module">Data.Set</a>
<a id="79" class="Keyword">open</a> <a id="84" class="Keyword">import</a> <a id="91" href="Data.Set.Member.html" class="Module">Data.Set.Member</a>
<a id="107" class="Keyword">open</a> <a id="112" class="Keyword">import</a> <a id="119" href="Data.Set.Union.html" class="Module">Data.Set.Union</a>


<a id="136" class="Keyword">module</a> <a id="143" href="Control.Monad.Free.Eff.html#143" class="Module">_</a> <a id="145" class="Symbol">(</a><a id="146" href="Control.Monad.Free.Eff.html#146" class="Bound">Univ</a> <a id="151" class="Symbol">:</a> <a id="153" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="157" class="Symbol">)</a> <a id="159" class="Symbol">(</a><a id="160" href="Control.Monad.Free.Eff.html#160" class="Bound Operator">⟦_⟧</a> <a id="164" class="Symbol">:</a> <a id="166" href="Control.Monad.Free.Eff.html#146" class="Bound">Univ</a> <a id="171" class="Symbol">→</a> <a id="173" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="178" class="Symbol">→</a> <a id="180" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="184" class="Symbol">)</a> <a id="186" class="Symbol">(</a><a id="187" href="Control.Monad.Free.Eff.html#187" class="Bound Operator">_≟_</a> <a id="191" class="Symbol">:</a> <a id="193" href="Relation.Nullary.Discrete.html#150" class="Function">Discrete</a> <a id="202" href="Control.Monad.Free.Eff.html#146" class="Bound">Univ</a><a id="206" class="Symbol">)</a> <a id="208" class="Keyword">where</a>
  <a id="216" class="Keyword">open</a> <a id="221" href="Data.Set.Member.html#421" class="Module">WithDecEq</a> <a id="231" href="Control.Monad.Free.Eff.html#187" class="Bound Operator">_≟_</a>

  <a id="238" class="Keyword">private</a> <a id="246" class="Keyword">variable</a> 
    <a id="260" href="Control.Monad.Free.Eff.html#260" class="Generalizable">F</a> <a id="262" href="Control.Monad.Free.Eff.html#262" class="Generalizable">G</a> <a id="264" class="Symbol">:</a> <a id="266" href="Control.Monad.Free.Eff.html#146" class="Bound">Univ</a>
    <a id="275" href="Control.Monad.Free.Eff.html#275" class="Generalizable">Fs</a> <a id="278" href="Control.Monad.Free.Eff.html#278" class="Generalizable">Gs</a> <a id="281" class="Symbol">:</a> <a id="283" href="Data.Set.Definition.html#107" class="Datatype">𝒦</a> <a id="285" href="Control.Monad.Free.Eff.html#146" class="Bound">Univ</a>

  <a id="293" class="Keyword">data</a> <a id="298" href="Control.Monad.Free.Eff.html#298" class="Datatype">Eff</a> <a id="302" class="Symbol">(</a><a id="303" href="Control.Monad.Free.Eff.html#303" class="Bound">E</a> <a id="305" class="Symbol">:</a> <a id="307" href="Data.Set.Definition.html#107" class="Datatype">𝒦</a> <a id="309" href="Control.Monad.Free.Eff.html#146" class="Bound">Univ</a><a id="313" class="Symbol">)</a> <a id="315" class="Symbol">(</a><a id="316" href="Control.Monad.Free.Eff.html#316" class="Bound">A</a> <a id="318" class="Symbol">:</a> <a id="320" href="Agda.Primitive.html#326" class="Primitive">Type</a><a id="324" class="Symbol">)</a> <a id="326" class="Symbol">:</a> <a id="328" href="Agda.Primitive.html#326" class="Primitive">Type₁</a> <a id="334" class="Keyword">where</a>
    <a id="344" href="Control.Monad.Free.Eff.html#344" class="InductiveConstructor">pure</a> <a id="349" class="Symbol">:</a> <a id="351" href="Control.Monad.Free.Eff.html#316" class="Bound">A</a> <a id="353" class="Symbol">→</a> <a id="355" href="Control.Monad.Free.Eff.html#298" class="Datatype">Eff</a> <a id="359" href="Control.Monad.Free.Eff.html#303" class="Bound">E</a> <a id="361" href="Control.Monad.Free.Eff.html#316" class="Bound">A</a>
    <a id="367" href="Control.Monad.Free.Eff.html#367" class="InductiveConstructor">Impure</a> <a id="374" class="Symbol">:</a> <a id="376" class="Symbol">(</a><a id="377" href="Control.Monad.Free.Eff.html#377" class="Bound">f∈</a> <a id="380" class="Symbol">:</a> <a id="382" href="Control.Monad.Free.Eff.html#260" class="Generalizable">F</a> <a id="384" href="Data.Set.Member.html#408" class="Function Operator">∈</a> <a id="386" href="Control.Monad.Free.Eff.html#303" class="Bound">E</a><a id="387" class="Symbol">)</a> <a id="389" class="Symbol">→</a> <a id="391" class="Symbol">(</a><a id="392" href="Control.Monad.Free.Eff.html#392" class="Bound">x</a> <a id="394" class="Symbol">:</a> <a id="396" href="Control.Monad.Free.Eff.html#160" class="Bound Operator">⟦</a> <a id="398" href="Control.Monad.Free.Eff.html#260" class="Generalizable">F</a> <a id="400" href="Control.Monad.Free.Eff.html#160" class="Bound Operator">⟧</a> <a id="402" href="Level.html#296" class="Generalizable">B</a><a id="403" class="Symbol">)</a> <a id="405" class="Symbol">→</a> <a id="407" class="Symbol">(</a><a id="408" href="Control.Monad.Free.Eff.html#408" class="Bound">k</a> <a id="410" class="Symbol">:</a> <a id="412" href="Level.html#296" class="Generalizable">B</a> <a id="414" class="Symbol">→</a> <a id="416" href="Control.Monad.Free.Eff.html#298" class="Datatype">Eff</a> <a id="420" href="Control.Monad.Free.Eff.html#303" class="Bound">E</a> <a id="422" href="Control.Monad.Free.Eff.html#316" class="Bound">A</a><a id="423" class="Symbol">)</a> <a id="425" class="Symbol">→</a> <a id="427" href="Control.Monad.Free.Eff.html#298" class="Datatype">Eff</a> <a id="431" href="Control.Monad.Free.Eff.html#303" class="Bound">E</a> <a id="433" href="Control.Monad.Free.Eff.html#316" class="Bound">A</a>

  <a id="438" class="Comment">-- bind : (A → Eff Fs B) → Eff Fs A → Eff Fs B</a>
  <a id="487" class="Comment">-- bind k (pure x) = k x</a>
  <a id="514" class="Comment">-- bind k (Impure f∈e x ks) = Impure f∈e x (bind k ∘ ks)</a>

  <a id="574" class="Comment">-- weaken : Eff Fs A → Eff (Fs ∪ Gs) A</a>
  <a id="615" class="Comment">-- weaken (pure x) = pure x</a>
  <a id="645" class="Comment">-- weaken {Fs = Fs} (Impure f∈ x k) = Impure (◇-∪ _ Fs _ f∈) x (weaken ∘ k)</a>

  <a id="724" class="Comment">-- weaken′ : Eff Fs A → Eff (Gs ∪ Fs) A</a>
  <a id="766" class="Comment">-- weaken′ {Fs = Fs} {Gs = Gs} = subst (flip Eff _) (∪-com Fs Gs) ∘′ weaken</a>

  <a id="845" class="Comment">-- bind′ : (A → Eff Gs B) → Eff Fs A → Eff (Fs ∪ Gs) B</a>
  <a id="902" class="Comment">-- bind′ {Fs = Fs} k (pure x) = weaken′ {Gs = Fs} (k x)</a>
  <a id="960" class="Comment">-- bind′ {Fs = Fs} k (Impure f∈e x ks) = Impure (◇-∪ _ Fs _ f∈e) x (bind′ k ∘ ks)</a>

  <a id="1045" class="Comment">-- extend′ : (Eff Gs A → B) → Eff (Fs ∪ Gs) A → Eff Fs B</a>
  <a id="1104" class="Comment">-- extend′ k (pure x) = pure (k (pure x))</a>
  <a id="1148" class="Comment">-- extend′ {Gs = Gs} {Fs = Fs} k (Impure {F = F} f∈ x ks) with F ∈? Gs </a>
  <a id="1222" class="Comment">-- extend′ {Gs = Gs} {Fs = Fs} k (Impure {F = F} f∈ x ks) | yes F∈Gs = {!!}</a>
  <a id="1300" class="Comment">-- extend′ {Gs = Gs} {Fs = Fs} k (Impure {F = F} f∈ x ks) | no  F∉Gs = Impure {F = F} (◇⁻-∪ˡ F Fs Gs F∉Gs f∈) x (extend′ k ∘ ks)</a>
</pre></body></html>