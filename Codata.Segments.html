<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Codata.Segments</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Keyword">open</a> <a id="6" class="Keyword">import</a> <a id="13" href="Prelude.html" class="Module">Prelude</a>
<a id="21" class="Keyword">open</a> <a id="26" class="Keyword">import</a> <a id="33" href="Algebra.html" class="Module">Algebra</a>
<a id="41" class="Keyword">open</a> <a id="46" class="Keyword">import</a> <a id="53" href="Algebra.Monus.html" class="Module">Algebra.Monus</a>

<a id="68" class="Keyword">module</a> <a id="75" href="Codata.Segments.html" class="Module">Codata.Segments</a>
  <a id="93" class="Symbol">{</a><a id="94" href="Codata.Segments.html#94" class="Bound">â„“</a><a id="95" class="Symbol">}</a>
  <a id="99" class="Symbol">(</a><a id="100" href="Codata.Segments.html#100" class="Bound">mon</a> <a id="104" class="Symbol">:</a> <a id="106" href="Algebra.Monus.html#10165" class="Record">CTMAPOM</a> <a id="114" href="Codata.Segments.html#94" class="Bound">â„“</a><a id="115" class="Symbol">)</a>
  <a id="119" class="Keyword">where</a>

<a id="126" class="Keyword">open</a> <a id="131" href="Algebra.Monus.html#10165" class="Module">CTMAPOM</a> <a id="139" href="Codata.Segments.html#100" class="Bound">mon</a>

<a id="144" class="Keyword">private</a> <a id="152" class="Keyword">variable</a> <a id="161" href="Codata.Segments.html#161" class="Generalizable">i</a> <a id="163" href="Codata.Segments.html#163" class="Generalizable">j</a> <a id="165" class="Symbol">:</a> <a id="167" href="Algebra.html#1401" class="Function">ğ‘†</a>

<a id="170" class="Comment">-- This is a type which contains some finite and some infinite lists.</a>
<a id="240" class="Comment">-- The idea is that each entry contains a parameter (w) which says</a>
<a id="307" class="Comment">-- how much coinductive &quot;fuel&quot; it uses.</a>
<a id="347" class="Comment">-- The Colistâ€² A i type represents a colist which is defined down to depth</a>
<a id="422" class="Comment">-- i; the Colist A type represents a &quot;true&quot; colist, i.e. a colist defined for</a>
<a id="500" class="Comment">-- any given depth.</a>
<a id="520" class="Keyword">infixr</a> <a id="527" class="Number">5</a> <a id="529" href="Codata.Segments.html#595" class="InductiveConstructor Operator">_â—ƒ_</a>
<a id="533" class="Keyword">data</a> <a id="Colistâ€²"></a><a id="538" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="546" class="Symbol">{</a><a id="547" href="Codata.Segments.html#547" class="Bound">a</a><a id="548" class="Symbol">}</a> <a id="550" class="Symbol">(</a><a id="551" href="Codata.Segments.html#551" class="Bound">A</a> <a id="553" class="Symbol">:</a> <a id="555" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="560" href="Codata.Segments.html#547" class="Bound">a</a><a id="561" class="Symbol">)</a> <a id="563" class="Symbol">(</a><a id="564" href="Codata.Segments.html#564" class="Bound">i</a> <a id="566" class="Symbol">:</a> <a id="568" href="Algebra.html#1401" class="Function">ğ‘†</a><a id="569" class="Symbol">)</a> <a id="571" class="Symbol">:</a> <a id="573" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="578" class="Symbol">(</a><a id="579" href="Codata.Segments.html#547" class="Bound">a</a> <a id="581" href="Agda.Primitive.html#810" class="Primitive Operator">â„“âŠ”</a> <a id="584" href="Codata.Segments.html#94" class="Bound">â„“</a><a id="585" class="Symbol">)</a> <a id="587" class="Keyword">where</a>
  <a id="Colistâ€²._â—ƒ_"></a><a id="595" href="Codata.Segments.html#595" class="InductiveConstructor Operator">_â—ƒ_</a> <a id="599" class="Symbol">:</a> <a id="601" class="Symbol">âˆ€</a> <a id="603" href="Codata.Segments.html#603" class="Bound">w</a> <a id="605" class="Symbol">â†’</a> <a id="607" class="Comment">-- Segment size</a>
          <a id="633" class="Symbol">(</a>  <a id="636" class="Symbol">(</a><a id="637" href="Codata.Segments.html#637" class="Bound">w&lt;i</a> <a id="641" class="Symbol">:</a> <a id="643" href="Codata.Segments.html#603" class="Bound">w</a> <a id="645" href="Relation.Binary.html#1847" class="Function Operator">&lt;</a> <a id="647" href="Codata.Segments.html#564" class="Bound">i</a><a id="648" class="Symbol">)</a> <a id="650" class="Symbol">â†’</a> <a id="652" class="Comment">-- If there is enough fuel left (i is the fuel)</a>
                             <a id="729" class="Comment">-- (also the _&lt;_ type is a proposition)</a>
             <a id="782" href="Codata.Segments.html#551" class="Bound">A</a> <a id="784" href="Data.Sigma.Base.html#455" class="Function Operator">Ã—</a> <a id="786" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="794" href="Codata.Segments.html#551" class="Bound">A</a> <a id="796" class="Symbol">(</a><a id="797" href="Codata.Segments.html#564" class="Bound">i</a> <a id="799" href="Algebra.Monus.html#4570" class="Function Operator">âˆ¸</a> <a id="801" href="Codata.Segments.html#603" class="Bound">w</a><a id="802" class="Symbol">)</a> <a id="804" class="Comment">-- Produce an element followed by the rest of</a>
                                   <a id="885" class="Comment">-- the list, with w taken out of the fuel.</a>
             <a id="941" class="Symbol">)</a> <a id="943" class="Symbol">â†’</a>
          <a id="955" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="963" href="Codata.Segments.html#551" class="Bound">A</a> <a id="965" href="Codata.Segments.html#564" class="Bound">i</a>

<a id="Colist"></a><a id="968" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="975" class="Symbol">:</a> <a id="977" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="982" href="Level.html#239" class="Generalizable">a</a> <a id="984" class="Symbol">â†’</a> <a id="986" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="991" class="Symbol">(</a><a id="992" href="Level.html#239" class="Generalizable">a</a> <a id="994" href="Agda.Primitive.html#810" class="Primitive Operator">â„“âŠ”</a> <a id="997" href="Codata.Segments.html#94" class="Bound">â„“</a><a id="998" class="Symbol">)</a>
<a id="1000" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="1007" href="Codata.Segments.html#1007" class="Bound">A</a> <a id="1009" class="Symbol">=</a> <a id="1011" class="Symbol">âˆ€</a> <a id="1013" class="Symbol">{</a><a id="1014" href="Codata.Segments.html#1014" class="Bound">i</a><a id="1015" class="Symbol">}</a> <a id="1017" class="Symbol">â†’</a> <a id="1019" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="1027" href="Codata.Segments.html#1007" class="Bound">A</a> <a id="1029" href="Codata.Segments.html#1014" class="Bound">i</a>

<a id="1032" class="Comment">-- The main interesting things tyhis type can do are the following:</a>
<a id="1100" class="Comment">-- * Infinite lists.</a>
<a id="1121" class="Comment">-- * The &quot;fuel&quot; parameter can be an arbitrary monoid, not just â„•</a>
<a id="1186" class="Comment">-- * Finite lists can also be specified, and the way we say something is</a>
<a id="1259" class="Comment">--   finite is by taking no fuel.</a>
<a id="1293" class="Comment">-- * Everything seems to correspond correctly to the monus axioms.</a>

<a id="1361" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1442" class="Comment">-- Finite colists</a>
<a id="1460" class="Comment">--------------------------------------------------------------------------------</a>

<a id="1542" class="Comment">-- By adding a finite prefix you don&#39;t have to use any of the fuel.</a>

<a id="_âˆ¹_"></a><a id="1611" href="Codata.Segments.html#1611" class="Function Operator">_âˆ¹_</a> <a id="1615" class="Symbol">:</a> <a id="1617" href="Level.html#255" class="Generalizable">A</a> <a id="1619" class="Symbol">â†’</a> <a id="1621" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="1628" href="Level.html#255" class="Generalizable">A</a> <a id="1630" class="Symbol">â†’</a> <a id="1632" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="1639" href="Level.html#255" class="Generalizable">A</a>
<a id="1641" href="Codata.Segments.html#1641" class="Bound">x</a> <a id="1643" href="Codata.Segments.html#1611" class="Function Operator">âˆ¹</a> <a id="1645" href="Codata.Segments.html#1645" class="Bound">xs</a> <a id="1648" class="Symbol">=</a> <a id="1650" href="Algebra.html#1444" class="Function">Îµ</a> <a id="1652" href="Codata.Segments.html#595" class="InductiveConstructor Operator">â—ƒ</a> <a id="1654" class="Symbol">Î»</a> <a id="1656" href="Codata.Segments.html#1656" class="Bound">_</a> <a id="1658" class="Symbol">â†’</a> <a id="1660" href="Codata.Segments.html#1641" class="Bound">x</a> <a id="1662" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1664" href="Codata.Segments.html#1645" class="Bound">xs</a>

<a id="1668" class="Comment">--------------------------------------------------------------------------------</a>
<a id="1749" class="Comment">-- Empty colists</a>
<a id="1766" class="Comment">--------------------------------------------------------------------------------</a>

<a id="1848" class="Comment">-- To terminate computation you use all the fuel, making an empty list.</a>
<a id="1920" class="Comment">-- (I&#39;m not sure how principled this is: semantically I don&#39;t know if I like</a>
<a id="1997" class="Comment">-- that the size of a segment can depend on the supplied size parameter).</a>
<a id="empty"></a><a id="2071" href="Codata.Segments.html#2071" class="Function">empty</a> <a id="2077" class="Symbol">:</a> <a id="2079" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="2086" href="Level.html#255" class="Generalizable">A</a>
<a id="2088" href="Codata.Segments.html#2071" class="Function">empty</a> <a id="2094" class="Symbol">{</a><a id="2095" class="Argument">i</a> <a id="2097" class="Symbol">=</a> <a id="2099" href="Codata.Segments.html#2099" class="Bound">i</a><a id="2100" class="Symbol">}</a> <a id="2102" class="Symbol">=</a> <a id="2104" href="Codata.Segments.html#2099" class="Bound">i</a> <a id="2106" href="Codata.Segments.html#595" class="InductiveConstructor Operator">â—ƒ</a> <a id="2108" class="Symbol">Î»</a> <a id="2110" href="Codata.Segments.html#2110" class="Bound">i&lt;i</a> <a id="2114" class="Symbol">â†’</a> <a id="2116" href="Data.Empty.Base.html#154" class="Function">âŠ¥-elim</a> <a id="2123" class="Symbol">(</a><a id="2124" href="Relation.Binary.html#1900" class="Function">irrefl</a> <a id="2131" href="Codata.Segments.html#2110" class="Bound">i&lt;i</a><a id="2134" class="Symbol">)</a>

<a id="2137" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2218" class="Comment">-- Finite derived colists</a>
<a id="2244" class="Comment">--------------------------------------------------------------------------------</a>

<a id="2326" class="Comment">-- singleton</a>
<a id="pure"></a><a id="2339" href="Codata.Segments.html#2339" class="Function">pure</a> <a id="2344" class="Symbol">:</a> <a id="2346" href="Level.html#255" class="Generalizable">A</a> <a id="2348" class="Symbol">â†’</a> <a id="2350" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="2357" href="Level.html#255" class="Generalizable">A</a>
<a id="2359" href="Codata.Segments.html#2339" class="Function">pure</a> <a id="2364" href="Codata.Segments.html#2364" class="Bound">x</a> <a id="2366" class="Symbol">=</a> <a id="2368" href="Codata.Segments.html#2364" class="Bound">x</a> <a id="2370" href="Codata.Segments.html#1611" class="Function Operator">âˆ¹</a> <a id="2372" href="Codata.Segments.html#2071" class="Function">empty</a>

<a id="replicate"></a><a id="2379" href="Codata.Segments.html#2379" class="Function">replicate</a> <a id="2389" class="Symbol">:</a> <a id="2391" href="Agda.Builtin.Nat.html#192" class="Datatype">â„•</a> <a id="2393" class="Symbol">â†’</a> <a id="2395" href="Level.html#255" class="Generalizable">A</a> <a id="2397" class="Symbol">â†’</a> <a id="2399" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="2406" href="Level.html#255" class="Generalizable">A</a>
<a id="2408" href="Codata.Segments.html#2379" class="Function">replicate</a> <a id="2418" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="2426" href="Codata.Segments.html#2426" class="Bound">x</a> <a id="2428" class="Symbol">=</a> <a id="2430" href="Codata.Segments.html#2071" class="Function">empty</a>
<a id="2436" href="Codata.Segments.html#2379" class="Function">replicate</a> <a id="2446" class="Symbol">(</a><a id="2447" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2451" href="Codata.Segments.html#2451" class="Bound">n</a><a id="2452" class="Symbol">)</a> <a id="2454" href="Codata.Segments.html#2454" class="Bound">x</a> <a id="2456" class="Symbol">=</a> <a id="2458" href="Codata.Segments.html#2454" class="Bound">x</a> <a id="2460" href="Codata.Segments.html#1611" class="Function Operator">âˆ¹</a> <a id="2462" href="Codata.Segments.html#2379" class="Function">replicate</a> <a id="2472" href="Codata.Segments.html#2451" class="Bound">n</a> <a id="2474" href="Codata.Segments.html#2454" class="Bound">x</a>

<a id="2477" class="Comment">--------------------------------------------------------------------------------</a>
<a id="2558" class="Comment">-- Infinite colists</a>
<a id="2578" class="Comment">--------------------------------------------------------------------------------</a>

<a id="2660" class="Comment">-- This unfold function produces an infinite list; it needs every size segment</a>
<a id="2739" class="Comment">-- be non empty so that each step uses some fuel. This is what provides the</a>
<a id="2815" class="Comment">-- termination argument.</a>

<a id="2841" class="Keyword">module</a> <a id="2848" href="Codata.Segments.html#2848" class="Module">_</a>
    <a id="2854" class="Symbol">(</a><a id="2855" href="Codata.Segments.html#2855" class="Bound">B</a> <a id="2857" class="Symbol">:</a> <a id="2859" href="Algebra.html#1401" class="Function">ğ‘†</a> <a id="2861" class="Symbol">â†’</a> <a id="2863" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="2868" href="Level.html#241" class="Generalizable">b</a><a id="2869" class="Symbol">)</a> <a id="2871" class="Comment">-- The seed type</a>
    <a id="2892" class="Symbol">(</a><a id="2893" href="Codata.Segments.html#2893" class="Bound">Ï•</a> <a id="2895" class="Symbol">:</a> <a id="2897" class="Symbol">âˆ€</a> <a id="2899" class="Symbol">{</a><a id="2900" href="Codata.Segments.html#2900" class="Bound">i</a><a id="2901" class="Symbol">}</a> <a id="2903" class="Symbol">â†’</a> <a id="2905" class="Comment">-- At depth i</a>
           <a id="2930" href="Codata.Segments.html#2855" class="Bound">B</a> <a id="2932" href="Codata.Segments.html#2900" class="Bound">i</a> <a id="2934" class="Symbol">â†’</a> <a id="2936" class="Comment">-- With this seed</a>
           <a id="2965" href="Data.Sigma.Base.html#173" class="Function">âˆƒ</a> <a id="2967" href="Codata.Segments.html#2967" class="Bound">w</a> <a id="2969" href="Data.Sigma.Base.html#173" class="Function">Ã—</a> <a id="2971" class="Comment">-- Produce a segment of size w</a>
           <a id="3013" class="Symbol">(</a><a id="3014" href="Codata.Segments.html#2967" class="Bound">w</a> <a id="3016" href="Path.html#524" class="Function Operator">â‰¢</a> <a id="3018" href="Algebra.html#1444" class="Function">Îµ</a><a id="3019" class="Symbol">)</a> <a id="3021" href="Data.Sigma.Base.html#455" class="Function Operator">Ã—</a> <a id="3023" class="Comment">-- w can&#39;t be Îµ, so that we use some of the fuel to prove</a>
                     <a id="3102" class="Comment">-- termination</a>
           <a id="3128" class="Symbol">((</a><a id="3130" href="Codata.Segments.html#3130" class="Bound">w&lt;i</a> <a id="3134" class="Symbol">:</a> <a id="3136" href="Codata.Segments.html#2967" class="Bound">w</a> <a id="3138" href="Relation.Binary.html#1847" class="Function Operator">&lt;</a> <a id="3140" href="Codata.Segments.html#2900" class="Bound">i</a><a id="3141" class="Symbol">)</a> <a id="3143" class="Symbol">â†’</a> <a id="3145" href="Level.html#255" class="Generalizable">A</a> <a id="3147" href="Data.Sigma.Base.html#455" class="Function Operator">Ã—</a> <a id="3149" href="Codata.Segments.html#2855" class="Bound">B</a> <a id="3151" class="Symbol">(</a><a id="3152" href="Codata.Segments.html#2900" class="Bound">i</a> <a id="3154" href="Algebra.Monus.html#4570" class="Function Operator">âˆ¸</a> <a id="3156" href="Codata.Segments.html#2967" class="Bound">w</a><a id="3157" class="Symbol">))</a> <a id="3160" class="Comment">-- And produce the cons constructor.</a>
           <a id="3208" class="Symbol">)</a>
    <a id="3214" class="Comment">-- ^ The step function</a>
    <a id="3241" class="Keyword">where</a>
    <a id="3251" href="Codata.Segments.html#3251" class="Function">unfoldâ€²</a> <a id="3259" class="Symbol">:</a> <a id="3261" href="WellFounded.html#85" class="Datatype">Acc</a> <a id="3265" href="Relation.Binary.html#1847" class="Function Operator">_&lt;_</a> <a id="3269" href="Codata.Segments.html#161" class="Generalizable">i</a> <a id="3271" class="Symbol">â†’</a> <a id="3273" href="Codata.Segments.html#2855" class="Bound">B</a> <a id="3275" href="Codata.Segments.html#161" class="Generalizable">i</a> <a id="3277" class="Symbol">â†’</a> <a id="3279" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="3287" href="Codata.Segments.html#3145" class="Bound">A</a> <a id="3289" href="Codata.Segments.html#161" class="Generalizable">i</a>
    <a id="3295" href="Codata.Segments.html#3251" class="Function">unfoldâ€²</a> <a id="3303" href="Codata.Segments.html#3303" class="Bound">a</a> <a id="3305" class="Symbol">=</a> <a id="3307" href="Data.Sigma.Base.html#711" class="Function">uncurry</a> <a id="3315" href="Codata.Segments.html#595" class="InductiveConstructor Operator">_â—ƒ_</a>
              <a id="3333" href="Function.html#97" class="Function Operator">âˆ˜</a> <a id="3335" href="Data.Sigma.Base.html#1309" class="Function">mapâ‚‚</a>
                <a id="3356" class="Symbol">(Î»</a> <a id="3359" class="Symbol">{</a> <a id="3361" class="Symbol">(</a><a id="3362" href="Codata.Segments.html#3362" class="Bound">wâ‰¢Îµ</a> <a id="3366" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="3368" href="Codata.Segments.html#3368" class="Bound">xsâ€²</a><a id="3371" class="Symbol">)</a> <a id="3373" href="Codata.Segments.html#3373" class="Bound">w&lt;i</a> <a id="3377" class="Symbol">â†’</a>
                       <a id="3402" href="Data.Sigma.Base.html#1309" class="Function">mapâ‚‚</a> <a id="3407" class="Symbol">(</a><a id="3408" href="Function.html#1099" class="Function Operator">case</a> <a id="3413" href="Codata.Segments.html#3303" class="Bound">a</a> <a id="3415" href="Function.html#1099" class="Function Operator">of</a>
                              <a id="3448" class="Symbol">Î»</a> <a id="3450" class="Symbol">{</a> <a id="3452" class="Symbol">(</a><a id="3453" href="WellFounded.html#161" class="InductiveConstructor">acc</a> <a id="3457" href="Codata.Segments.html#3457" class="Bound">wf</a><a id="3459" class="Symbol">)</a> <a id="3461" class="Symbol">â†’</a>
                                    <a id="3499" href="Codata.Segments.html#3251" class="Function">unfoldâ€²</a> <a id="3507" class="Symbol">(</a><a id="3508" href="Codata.Segments.html#3457" class="Bound">wf</a> <a id="3511" class="Symbol">_</a> <a id="3513" class="Symbol">(</a><a id="3514" href="Algebra.Monus.html#12973" class="Function">âˆ¸â€¿&lt;-&lt;</a> <a id="3520" class="Symbol">_</a> <a id="3522" class="Symbol">_</a> <a id="3524" href="Codata.Segments.html#3373" class="Bound">w&lt;i</a> <a id="3528" href="Codata.Segments.html#3362" class="Bound">wâ‰¢Îµ</a><a id="3531" class="Symbol">))</a> <a id="3534" class="Symbol">})</a>
                            <a id="3565" class="Symbol">(</a><a id="3566" href="Codata.Segments.html#3368" class="Bound">xsâ€²</a> <a id="3570" href="Codata.Segments.html#3373" class="Bound">w&lt;i</a><a id="3573" class="Symbol">)</a> <a id="3575" class="Symbol">})</a>
              <a id="3592" href="Function.html#97" class="Function Operator">âˆ˜</a> <a id="3594" href="Codata.Segments.html#2893" class="Bound">Ï•</a>

<a id="unfold"></a><a id="3597" href="Codata.Segments.html#3597" class="Function">unfold</a> <a id="3604" class="Symbol">:</a> <a id="3606" class="Symbol">(</a><a id="3607" href="Codata.Segments.html#3607" class="Bound">fdc</a> <a id="3611" class="Symbol">:</a> <a id="3613" href="WellFounded.html#383" class="Function">WellFounded</a> <a id="3625" href="Relation.Binary.html#1847" class="Function Operator">_&lt;_</a><a id="3628" class="Symbol">)</a>
         <a id="3639" class="Symbol">(</a><a id="3640" href="Codata.Segments.html#3640" class="Bound">B</a> <a id="3642" class="Symbol">:</a> <a id="3644" href="Algebra.html#1401" class="Function">ğ‘†</a> <a id="3646" class="Symbol">â†’</a> <a id="3648" href="Agda.Primitive.html#326" class="Primitive">Type</a> <a id="3653" href="Level.html#241" class="Generalizable">b</a><a id="3654" class="Symbol">)</a>
         <a id="3665" class="Symbol">(</a><a id="3666" href="Codata.Segments.html#3666" class="Bound">Ï•</a> <a id="3668" class="Symbol">:</a> <a id="3670" class="Symbol">âˆ€</a> <a id="3672" class="Symbol">{</a><a id="3673" href="Codata.Segments.html#3673" class="Bound">i</a><a id="3674" class="Symbol">}</a> <a id="3676" class="Symbol">â†’</a> <a id="3678" href="Codata.Segments.html#3640" class="Bound">B</a> <a id="3680" href="Codata.Segments.html#3673" class="Bound">i</a> <a id="3682" class="Symbol">â†’</a> <a id="3684" href="Data.Sigma.Base.html#173" class="Function">âˆƒ</a> <a id="3686" href="Codata.Segments.html#3686" class="Bound">w</a> <a id="3688" href="Data.Sigma.Base.html#173" class="Function">Ã—</a> <a id="3690" class="Symbol">(</a><a id="3691" href="Codata.Segments.html#3686" class="Bound">w</a> <a id="3693" href="Path.html#524" class="Function Operator">â‰¢</a> <a id="3695" href="Algebra.html#1444" class="Function">Îµ</a><a id="3696" class="Symbol">)</a> <a id="3698" href="Data.Sigma.Base.html#455" class="Function Operator">Ã—</a> <a id="3700" class="Symbol">((</a><a id="3702" href="Codata.Segments.html#3702" class="Bound">w&lt;i</a> <a id="3706" class="Symbol">:</a> <a id="3708" href="Codata.Segments.html#3686" class="Bound">w</a> <a id="3710" href="Relation.Binary.html#1847" class="Function Operator">&lt;</a> <a id="3712" href="Codata.Segments.html#3673" class="Bound">i</a><a id="3713" class="Symbol">)</a> <a id="3715" class="Symbol">â†’</a> <a id="3717" href="Level.html#255" class="Generalizable">A</a> <a id="3719" href="Data.Sigma.Base.html#455" class="Function Operator">Ã—</a> <a id="3721" href="Codata.Segments.html#3640" class="Bound">B</a> <a id="3723" class="Symbol">(</a><a id="3724" href="Codata.Segments.html#3673" class="Bound">i</a> <a id="3726" href="Algebra.Monus.html#4570" class="Function Operator">âˆ¸</a> <a id="3728" href="Codata.Segments.html#3686" class="Bound">w</a><a id="3729" class="Symbol">)))</a> <a id="3733" class="Symbol">â†’</a>
         <a id="3744" class="Symbol">(âˆ€</a> <a id="3747" class="Symbol">{</a><a id="3748" href="Codata.Segments.html#3748" class="Bound">i</a><a id="3749" class="Symbol">}</a> <a id="3751" class="Symbol">â†’</a> <a id="3753" href="Codata.Segments.html#3640" class="Bound">B</a> <a id="3755" href="Codata.Segments.html#3748" class="Bound">i</a><a id="3756" class="Symbol">)</a> <a id="3758" class="Symbol">â†’</a> <a id="3760" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="3767" href="Level.html#255" class="Generalizable">A</a>
<a id="3769" href="Codata.Segments.html#3597" class="Function">unfold</a> <a id="3776" href="Codata.Segments.html#3776" class="Bound">fdc</a> <a id="3780" href="Codata.Segments.html#3780" class="Bound">B</a> <a id="3782" href="Codata.Segments.html#3782" class="Bound">Ï•</a> <a id="3784" href="Codata.Segments.html#3784" class="Bound">xs</a> <a id="3787" class="Symbol">{</a><a id="3788" href="Codata.Segments.html#3788" class="Bound">i</a><a id="3789" class="Symbol">}</a> <a id="3791" class="Symbol">=</a> <a id="3793" href="Codata.Segments.html#3251" class="Function">unfoldâ€²</a> <a id="3801" href="Codata.Segments.html#3780" class="Bound">B</a> <a id="3803" href="Codata.Segments.html#3782" class="Bound">Ï•</a> <a id="3805" class="Symbol">(</a><a id="3806" href="Codata.Segments.html#3776" class="Bound">fdc</a> <a id="3810" href="Codata.Segments.html#3788" class="Bound">i</a><a id="3811" class="Symbol">)</a> <a id="3813" href="Codata.Segments.html#3784" class="Bound">xs</a>

<a id="3817" class="Comment">-- Here&#39;s a simple example using the unfold function: this produces infinitely</a>
<a id="3896" class="Comment">-- repeated values, with segment size s.</a>
<a id="repeat"></a><a id="3937" href="Codata.Segments.html#3937" class="Function">repeat</a> <a id="3944" class="Symbol">:</a> <a id="3946" class="Symbol">(</a><a id="3947" href="Codata.Segments.html#3947" class="Bound">fdc</a> <a id="3951" class="Symbol">:</a> <a id="3953" href="WellFounded.html#383" class="Function">WellFounded</a> <a id="3965" href="Relation.Binary.html#1847" class="Function Operator">_&lt;_</a><a id="3968" class="Symbol">)</a> <a id="3970" class="Symbol">(</a><a id="3971" href="Codata.Segments.html#3971" class="Bound">s</a> <a id="3973" class="Symbol">:</a> <a id="3975" href="Algebra.html#1401" class="Function">ğ‘†</a><a id="3976" class="Symbol">)</a> <a id="3978" class="Symbol">(</a><a id="3979" href="Codata.Segments.html#3979" class="Bound">sâ‰¢Îµ</a> <a id="3983" class="Symbol">:</a> <a id="3985" href="Codata.Segments.html#3971" class="Bound">s</a> <a id="3987" href="Path.html#524" class="Function Operator">â‰¢</a> <a id="3989" href="Algebra.html#1444" class="Function">Îµ</a><a id="3990" class="Symbol">)</a> <a id="3992" class="Symbol">(</a><a id="3993" href="Codata.Segments.html#3993" class="Bound">x</a> <a id="3995" class="Symbol">:</a> <a id="3997" href="Level.html#255" class="Generalizable">A</a><a id="3998" class="Symbol">)</a> <a id="4000" class="Symbol">â†’</a> <a id="4002" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="4009" href="Level.html#255" class="Generalizable">A</a>
<a id="4011" href="Codata.Segments.html#3937" class="Function">repeat</a> <a id="4018" href="Codata.Segments.html#4018" class="Bound">fdc</a> <a id="4022" href="Codata.Segments.html#4022" class="Bound">s</a> <a id="4024" href="Codata.Segments.html#4024" class="Bound">sâ‰¢Îµ</a> <a id="4028" href="Codata.Segments.html#4028" class="Bound">x</a> <a id="4030" class="Symbol">=</a> <a id="4032" href="Codata.Segments.html#3597" class="Function">unfold</a> <a id="4039" href="Codata.Segments.html#4018" class="Bound">fdc</a> <a id="4043" class="Symbol">(</a><a id="4044" href="Function.html#589" class="Function">const</a> <a id="4050" href="Agda.Builtin.Unit.html#164" class="Record">âŠ¤</a><a id="4051" class="Symbol">)</a> <a id="4053" class="Symbol">(Î»</a> <a id="4056" href="Codata.Segments.html#4056" class="Bound">_</a> <a id="4058" class="Symbol">â†’</a> <a id="4060" href="Codata.Segments.html#4022" class="Bound">s</a> <a id="4062" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4064" href="Codata.Segments.html#4024" class="Bound">sâ‰¢Îµ</a> <a id="4068" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4070" href="Function.html#589" class="Function">const</a> <a id="4076" class="Symbol">(</a><a id="4077" href="Codata.Segments.html#4028" class="Bound">x</a> <a id="4079" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4081" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a><a id="4083" class="Symbol">))</a> <a id="4086" href="Agda.Builtin.Unit.html#201" class="InductiveConstructor">tt</a>

<a id="4090" class="Comment">--------------------------------------------------------------------------------</a>
<a id="4171" class="Comment">-- Manipulating colists</a>
<a id="4195" class="Comment">--------------------------------------------------------------------------------</a>

<a id="4277" class="Comment">-- One important thing to note about the Colist type: it is inductive!</a>
<a id="4348" class="Comment">-- Although it does technically represent &quot;coinduction&quot;, the constructors and</a>
<a id="4426" class="Comment">-- type itself are inductive as far as Agda can see. For that reason functions</a>
<a id="4505" class="Comment">-- like map pass the termination checker with no extra ceremony.</a>
<a id="map"></a><a id="4570" href="Codata.Segments.html#4570" class="Function">map</a> <a id="4574" class="Symbol">:</a> <a id="4576" class="Symbol">(</a><a id="4577" href="Level.html#255" class="Generalizable">A</a> <a id="4579" class="Symbol">â†’</a> <a id="4581" href="Level.html#269" class="Generalizable">B</a><a id="4582" class="Symbol">)</a> <a id="4584" class="Symbol">â†’</a> <a id="4586" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="4594" href="Level.html#255" class="Generalizable">A</a> <a id="4596" href="Codata.Segments.html#161" class="Generalizable">i</a> <a id="4598" class="Symbol">â†’</a> <a id="4600" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="4608" href="Level.html#269" class="Generalizable">B</a> <a id="4610" href="Codata.Segments.html#161" class="Generalizable">i</a>
<a id="4612" href="Codata.Segments.html#4570" class="Function">map</a> <a id="4616" href="Codata.Segments.html#4616" class="Bound">f</a> <a id="4618" class="Symbol">(</a><a id="4619" href="Codata.Segments.html#4619" class="Bound">w</a> <a id="4621" href="Codata.Segments.html#595" class="InductiveConstructor Operator">â—ƒ</a> <a id="4623" href="Codata.Segments.html#4623" class="Bound">xs</a><a id="4625" class="Symbol">)</a> <a id="4627" class="Symbol">=</a> <a id="4629" href="Codata.Segments.html#4619" class="Bound">w</a> <a id="4631" href="Codata.Segments.html#595" class="InductiveConstructor Operator">â—ƒ</a> <a id="4633" class="Symbol">Î»</a> <a id="4635" href="Codata.Segments.html#4635" class="Bound">w&lt;i</a> <a id="4639" class="Symbol">â†’</a> <a id="4641" href="Function.html#1099" class="Function Operator">case</a> <a id="4646" href="Codata.Segments.html#4623" class="Bound">xs</a> <a id="4649" href="Codata.Segments.html#4635" class="Bound">w&lt;i</a> <a id="4653" href="Function.html#1099" class="Function Operator">of</a> <a id="4656" class="Symbol">Î»</a> <a id="4658" class="Symbol">{</a> <a id="4660" class="Symbol">(</a><a id="4661" href="Codata.Segments.html#4661" class="Bound">y</a> <a id="4663" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4665" href="Codata.Segments.html#4665" class="Bound">ys</a><a id="4667" class="Symbol">)</a> <a id="4669" class="Symbol">â†’</a> <a id="4671" href="Codata.Segments.html#4616" class="Bound">f</a> <a id="4673" href="Codata.Segments.html#4661" class="Bound">y</a> <a id="4675" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4677" href="Codata.Segments.html#4570" class="Function">map</a> <a id="4681" href="Codata.Segments.html#4616" class="Bound">f</a> <a id="4683" href="Codata.Segments.html#4665" class="Bound">ys</a> <a id="4686" class="Symbol">}</a>

<a id="4689" class="Comment">-- You can extract a finite prefix of the colist.</a>
<a id="4739" class="Keyword">open</a> <a id="4744" class="Keyword">import</a> <a id="4751" href="Data.List.html" class="Module">Data.List</a> <a id="4761" class="Keyword">using</a> <a id="4767" class="Symbol">(</a><a id="4768" href="Agda.Builtin.List.html#148" class="Datatype">List</a><a id="4772" class="Symbol">;</a> <a id="4774" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">_âˆ·_</a><a id="4777" class="Symbol">;</a> <a id="4779" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a><a id="4781" class="Symbol">)</a>

<a id="takeâ€²"></a><a id="4784" href="Codata.Segments.html#4784" class="Function">takeâ€²</a> <a id="4790" class="Symbol">:</a> <a id="4792" class="Symbol">âˆ€</a> <a id="4794" href="Codata.Segments.html#4794" class="Bound">i</a> <a id="4796" class="Symbol">â†’</a> <a id="4798" href="Codata.Segments.html#538" class="Datatype">Colistâ€²</a> <a id="4806" href="Level.html#255" class="Generalizable">A</a> <a id="4808" href="Codata.Segments.html#4794" class="Bound">i</a> <a id="4810" class="Symbol">â†’</a> <a id="4812" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4817" href="Level.html#255" class="Generalizable">A</a>
<a id="4819" href="Codata.Segments.html#4784" class="Function">takeâ€²</a> <a id="4825" href="Codata.Segments.html#4825" class="Bound">i</a> <a id="4827" class="Symbol">(</a><a id="4828" href="Codata.Segments.html#4828" class="Bound">w</a> <a id="4830" href="Codata.Segments.html#595" class="InductiveConstructor Operator">â—ƒ</a> <a id="4832" href="Codata.Segments.html#4832" class="Bound">xs</a><a id="4834" class="Symbol">)</a> <a id="4836" class="Keyword">with</a> <a id="4841" href="Codata.Segments.html#4828" class="Bound">w</a> <a id="4843" href="Relation.Binary.html#2987" class="Function Operator">&lt;?</a> <a id="4846" href="Codata.Segments.html#4825" class="Bound">i</a>
<a id="4848" class="Symbol">...</a> <a id="4852" class="Symbol">|</a> <a id="4854" href="Relation.Nullary.Decidable.html#433" class="InductiveConstructor">no</a> <a id="4857" class="Symbol">_</a> <a id="4859" class="Symbol">=</a> <a id="4861" href="Agda.Builtin.List.html#185" class="InductiveConstructor">[]</a>
<a id="4864" class="Symbol">...</a> <a id="4868" class="Symbol">|</a> <a id="4870" href="Relation.Nullary.Decidable.html#399" class="InductiveConstructor">yes</a> <a id="4874" href="Codata.Segments.html#4874" class="Bound">w&lt;i</a> <a id="4878" class="Keyword">with</a> <a id="4883" class="Bound">xs</a> <a id="4886" href="Codata.Segments.html#4874" class="Bound">w&lt;i</a>
<a id="4890" class="Symbol">...</a> <a id="4894" class="Symbol">|</a> <a id="4896" href="Codata.Segments.html#4896" class="Bound">y</a> <a id="4898" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="4900" href="Codata.Segments.html#4900" class="Bound">ys</a> <a id="4903" class="Symbol">=</a> <a id="4905" href="Codata.Segments.html#4896" class="Bound">y</a> <a id="4907" href="Agda.Builtin.List.html#200" class="InductiveConstructor Operator">âˆ·</a> <a id="4909" href="Codata.Segments.html#4784" class="Function">takeâ€²</a> <a id="4915" class="Symbol">_</a> <a id="4917" href="Codata.Segments.html#4900" class="Bound">ys</a>

<a id="take"></a><a id="4921" href="Codata.Segments.html#4921" class="Function">take</a> <a id="4926" class="Symbol">:</a> <a id="4928" href="Algebra.html#1401" class="Function">ğ‘†</a> <a id="4930" class="Symbol">â†’</a> <a id="4932" href="Codata.Segments.html#968" class="Function">Colist</a> <a id="4939" href="Level.html#255" class="Generalizable">A</a> <a id="4941" class="Symbol">â†’</a> <a id="4943" href="Agda.Builtin.List.html#148" class="Datatype">List</a> <a id="4948" href="Level.html#255" class="Generalizable">A</a>
<a id="4950" href="Codata.Segments.html#4921" class="Function">take</a> <a id="4955" href="Codata.Segments.html#4955" class="Bound">x</a> <a id="4957" href="Codata.Segments.html#4957" class="Bound">xs</a> <a id="4960" class="Symbol">=</a> <a id="4962" href="Codata.Segments.html#4784" class="Function">takeâ€²</a> <a id="4968" href="Codata.Segments.html#4955" class="Bound">x</a> <a id="4970" href="Codata.Segments.html#4957" class="Bound">xs</a>
</pre></body></html>