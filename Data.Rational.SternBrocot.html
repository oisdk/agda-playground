<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Rational.SternBrocot</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="Data.Rational.SternBrocot.html" class="Module">Data.Rational.SternBrocot</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Prelude.html" class="Module">Prelude</a>
<a id="95" class="Keyword">import</a> <a id="102" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="111" class="Symbol">as</a> <a id="114" class="Module">ℕ</a>
<a id="116" class="Keyword">import</a> <a id="123" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="143" class="Symbol">as</a> <a id="146" class="Module">ℕ</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Bits.html" class="Module">Data.Bits</a> <a id="170" class="Keyword">renaming</a> <a id="179" class="Symbol">(</a><a id="180" href="Data.Bits.html#102" class="Datatype">Bits</a> <a id="185" class="Symbol">to</a> <a id="Bits"></a><a id="188" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a><a id="190" class="Symbol">;</a> <a id="192" href="Data.Bits.html#123" class="InductiveConstructor">[]</a> <a id="195" class="Symbol">to</a> <a id="[]"></a><a id="198" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a><a id="200" class="Symbol">;</a> <a id="202" href="Data.Bits.html#135" class="InductiveConstructor Operator">0∷_</a> <a id="206" class="Symbol">to</a> <a id="0∷_"></a><a id="209" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor Operator">lℚ</a><a id="211" class="Symbol">;</a> <a id="213" href="Data.Bits.html#155" class="InductiveConstructor Operator">1∷_</a> <a id="217" class="Symbol">to</a> <a id="1∷_"></a><a id="220" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor Operator">rℚ</a><a id="222" class="Symbol">)</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Data.Bits.Equatable.html" class="Module">Data.Bits.Equatable</a>

<a id="257" class="Comment">-- ⟦_⇓⟧ : ℚ⁺ → (ℕ × ℕ)</a>
<a id="280" class="Comment">-- ⟦ 1ℚ ⇓⟧ = 1 , 1</a>
<a id="299" class="Comment">-- ⟦ lℚ x ⇓⟧ = let p , q = ⟦ x ⇓⟧ in p , p ℕ.+ q</a>
<a id="348" class="Comment">-- ⟦ rℚ x ⇓⟧ = let p , q = ⟦ x ⇓⟧ in p ℕ.+ q , q</a>

<a id="398" class="Comment">-- module TerminationProofs where</a>
<a id="432" class="Comment">--   Tᴮ⇒≡ : {n m : ℕ} → n ≡ m → T (n ℕ.≡ᴮ m)</a>
<a id="477" class="Comment">--   Tᴮ⇒≡ {n} {m} n≡m = subst (λ n′ → T (n ℕ.≡ᴮ n′)) n≡m (ℕ.complete-== n)</a>

<a id="553" class="Comment">--   lift-suc-≡ : ∀ {n m} s → m ≡ n → T (n ℕ.≡ᴮ s) → T (m ℕ.≡ᴮ s)</a>
<a id="619" class="Comment">--   lift-suc-≡ {n} {m} s  m≡n p = Tᴮ⇒≡ (m≡n ; ℕ.sound-== (n) s p)</a>

<a id="687" class="Comment">--   lemma₁ : ∀ a m → a ℕ.+ m ℕ.+ zero ≡ m ℕ.+ a</a>
<a id="736" class="Comment">--   lemma₁ a m = ℕ.+-idʳ (a ℕ.+ m) ; ℕ.+-comm a m</a>

<a id="788" class="Comment">--   lemma₂ : ∀ n a m → n ℕ.+ m ℕ.+ suc a ≡ n ℕ.+ suc m ℕ.+ a</a>
<a id="850" class="Comment">--   lemma₂ n a m = ℕ.+-assoc n m (suc a) ; cong (n ℕ.+_) (ℕ.+-suc m a) ; sym (ℕ.+-assoc n (suc m) a)</a>

<a id="953" class="Comment">--   lemma₃ : ∀ n a → n ℕ.+ a ℕ.+ zero ≡ n ℕ.+ zero ℕ.+ a</a>
<a id="1011" class="Comment">--   lemma₃ n a = ℕ.+-idʳ (n ℕ.+ a) ; cong (ℕ._+ a) (sym (ℕ.+-idʳ n))</a>

<a id="1082" class="Comment">-- _+1/_+1 : ℕ → ℕ → ℚ⁺</a>
<a id="1106" class="Comment">-- n +1/ m +1 = go zero n m (n ℕ.+ m)</a>
<a id="1144" class="Comment">--   where</a>
<a id="1155" class="Comment">--   go : (a n m s : ℕ) → ℚ⁺</a>
<a id="1184" class="Comment">--   go a zero    (suc m) (suc s) = lℚ (go zero a m s)</a>
<a id="1239" class="Comment">--   go a (suc n) (suc m) (suc s) = go (suc a) n m s</a>
<a id="1292" class="Comment">--   go a (suc n) zero    (suc s) = rℚ (go zero n a s)</a>
<a id="1347" class="Comment">--   go _ _       _       _       = 1ℚ</a>

<a id="euclidian"></a><a id="1387" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1397" class="Symbol">:</a> <a id="1399" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1401" class="Symbol">→</a> <a id="1403" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1405" class="Symbol">→</a> <a id="1407" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a>
<a id="1414" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1424" href="Data.Rational.SternBrocot.html#1424" class="Bound">n</a> <a id="1426" href="Data.Rational.SternBrocot.html#1426" class="Bound">m</a> <a id="1428" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1436" class="Symbol">=</a> <a id="1438" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a>
<a id="1441" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1451" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1453" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a> <a id="1455" class="Symbol">(</a><a id="1456" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1460" href="Data.Rational.SternBrocot.html#1460" class="Bound">s</a><a id="1461" class="Symbol">)</a> <a id="1463" class="Symbol">=</a>
  <a id="1467" href="Data.Bool.Base.html#516" class="Function Operator">if</a> <a id="1470" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1472" href="Data.Nat.Properties.html#164" class="Primitive Operator">ℕ.≡ᴮ</a> <a id="1477" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a>
  <a id="1481" href="Data.Bool.Base.html#516" class="Function Operator">then</a> <a id="1486" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a>
  <a id="1491" href="Data.Bool.Base.html#516" class="Function Operator">else</a> <a id="1496" href="Data.Bool.Base.html#516" class="Function Operator">if</a> <a id="1499" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1501" href="Data.Nat.Properties.html#150" class="Primitive Operator">ℕ.&lt;ᴮ</a> <a id="1506" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a>
  <a id="1510" href="Data.Bool.Base.html#516" class="Function Operator">then</a> <a id="1515" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor">lℚ</a> <a id="1518" class="Symbol">(</a><a id="1519" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1529" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a> <a id="1534" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="1538" class="Symbol">(</a><a id="1539" class="Number">1</a> <a id="1541" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1545" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a><a id="1546" class="Symbol">))</a> <a id="1549" href="Data.Rational.SternBrocot.html#1460" class="Bound">s</a><a id="1550" class="Symbol">)</a>
  <a id="1554" href="Data.Bool.Base.html#516" class="Function Operator">else</a> <a id="1559" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor">rℚ</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1576" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="1580" class="Symbol">(</a><a id="1581" class="Number">1</a> <a id="1583" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1587" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a><a id="1588" class="Symbol">))</a> <a id="1591" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a> <a id="1593" href="Data.Rational.SternBrocot.html#1460" class="Bound">s</a><a id="1594" class="Symbol">)</a>

<a id="normalise-suc"></a><a id="1597" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="1611" class="Symbol">:</a> <a id="1613" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1619" class="Symbol">→</a> <a id="1621" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a>
<a id="1624" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="1638" href="Data.Rational.SternBrocot.html#1638" class="Bound">n</a> <a id="1640" href="Data.Rational.SternBrocot.html#1640" class="Bound">m</a> <a id="1642" class="Symbol">=</a> <a id="1644" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1654" href="Data.Rational.SternBrocot.html#1638" class="Bound">n</a> <a id="1656" href="Data.Rational.SternBrocot.html#1640" class="Bound">m</a> <a id="1658" class="Symbol">(</a><a id="1659" href="Data.Rational.SternBrocot.html#1638" class="Bound">n</a> <a id="1661" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1665" href="Data.Rational.SternBrocot.html#1640" class="Bound">m</a><a id="1666" class="Symbol">)</a>

<a id="ℚ"></a><a id="1669" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="1671" class="Symbol">:</a> <a id="1673" href="Level.html#242" class="Function">Type₀</a>
<a id="1679" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="1681" class="Symbol">=</a> <a id="1683" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a>

<a id="1687" class="Keyword">import</a> <a id="1694" href="Data.Rational.Unnormalised.html" class="Module">Data.Rational.Unnormalised</a> <a id="1721" class="Symbol">as</a> <a id="1724" class="Module">F</a>
<a id="1726" class="Keyword">open</a> <a id="1731" class="Keyword">import</a> <a id="1738" href="Data.Rational.Unnormalised.html" class="Module">Data.Rational.Unnormalised</a> <a id="1765" class="Keyword">using</a> <a id="1771" class="Symbol">(</a><a id="1772" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">_/suc_</a><a id="1778" class="Symbol">;</a> <a id="1780" href="Data.Rational.Unnormalised.html#395" class="Function Operator">_/_</a><a id="1783" class="Symbol">)</a>
<a id="1785" class="Keyword">import</a> <a id="1792" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="1805" class="Symbol">as</a> <a id="1808" class="Module">ℤ</a>
<a id="1810" class="Keyword">open</a> <a id="1815" class="Keyword">import</a> <a id="1822" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="1835" class="Keyword">using</a> <a id="1841" class="Symbol">(</a><a id="1842" href="Data.Integer.html#204" class="Datatype">ℤ</a><a id="1843" class="Symbol">;</a> <a id="1845" href="Data.Integer.html#222" class="InductiveConstructor">⁺</a><a id="1846" class="Symbol">;</a> <a id="1848" href="Data.Integer.html#236" class="InductiveConstructor">⁻suc</a><a id="1852" class="Symbol">;</a> <a id="1854" href="Data.Integer.html#250" class="Function">⁻</a><a id="1855" class="Symbol">)</a>
<a id="1857" class="Keyword">open</a> <a id="1862" class="Keyword">import</a> <a id="1869" href="Data.Bits.Fold.html" class="Module">Data.Bits.Fold</a>

<a id="zer"></a><a id="1885" href="Data.Rational.SternBrocot.html#1885" class="Function">zer</a> <a id="1889" class="Symbol">:</a> <a id="1891" class="Symbol">(</a><a id="1892" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1894" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="1896" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1897" class="Symbol">)</a> <a id="1899" class="Symbol">→</a> <a id="1901" class="Symbol">(</a><a id="1902" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1904" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="1906" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1907" class="Symbol">)</a>
<a id="1909" href="Data.Rational.SternBrocot.html#1885" class="Function">zer</a> <a id="1913" class="Symbol">(</a><a id="1914" href="Data.Rational.SternBrocot.html#1914" class="Bound">p</a> <a id="1916" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1918" href="Data.Rational.SternBrocot.html#1918" class="Bound">q</a><a id="1919" class="Symbol">)</a> <a id="1921" class="Symbol">=</a> <a id="1923" href="Data.Rational.SternBrocot.html#1914" class="Bound">p</a> <a id="1925" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1927" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1931" href="Data.Rational.SternBrocot.html#1914" class="Bound">p</a> <a id="1933" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1937" href="Data.Rational.SternBrocot.html#1918" class="Bound">q</a>

<a id="one"></a><a id="1940" href="Data.Rational.SternBrocot.html#1940" class="Function">one</a> <a id="1944" class="Symbol">:</a> <a id="1946" class="Symbol">(</a><a id="1947" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1949" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="1951" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1952" class="Symbol">)</a> <a id="1954" class="Symbol">→</a> <a id="1956" class="Symbol">(</a><a id="1957" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1959" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="1961" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1962" class="Symbol">)</a>
<a id="1964" href="Data.Rational.SternBrocot.html#1940" class="Function">one</a> <a id="1968" class="Symbol">(</a><a id="1969" href="Data.Rational.SternBrocot.html#1969" class="Bound">p</a> <a id="1971" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1973" href="Data.Rational.SternBrocot.html#1973" class="Bound">q</a><a id="1974" class="Symbol">)</a> <a id="1976" class="Symbol">=</a> <a id="1978" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1982" href="Data.Rational.SternBrocot.html#1969" class="Bound">p</a> <a id="1984" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1988" href="Data.Rational.SternBrocot.html#1973" class="Bound">q</a> <a id="1990" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1992" href="Data.Rational.SternBrocot.html#1973" class="Bound">q</a>

<a id="fraction"></a><a id="1995" href="Data.Rational.SternBrocot.html#1995" class="Function">fraction</a> <a id="2004" class="Symbol">:</a> <a id="2006" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="2008" class="Symbol">→</a> <a id="2010" class="Symbol">(</a><a id="2011" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2013" href="Data.Sigma.Base.html#519" class="Function Operator">×</a> <a id="2015" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2016" class="Symbol">)</a>
<a id="2018" href="Data.Rational.SternBrocot.html#1995" class="Function">fraction</a> <a id="2027" class="Symbol">=</a> <a id="2029" href="Data.Bits.Fold.html#199" class="Function">foldr-bits</a> <a id="2040" href="Data.Rational.SternBrocot.html#1885" class="Function">zer</a> <a id="2044" href="Data.Rational.SternBrocot.html#1940" class="Function">one</a> <a id="2048" class="Symbol">(</a><a id="2049" class="Number">0</a> <a id="2051" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2053" class="Number">0</a><a id="2054" class="Symbol">)</a>

<a id="⟦_⇓⟧"></a><a id="2057" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⟦_⇓⟧</a> <a id="2062" class="Symbol">:</a> <a id="2064" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="2066" class="Symbol">→</a> <a id="2068" href="Data.Rational.Unnormalised.html#274" class="Record">F.ℚ</a>
<a id="2072" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⟦</a> <a id="2074" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a> <a id="2077" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⇓⟧</a> <a id="2080" class="Symbol">=</a> <a id="2082" href="Data.Integer.html#222" class="InductiveConstructor">⁺</a> <a id="2084" class="Number">0</a> <a id="2086" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">F./suc</a> <a id="2093" class="Number">0</a>
<a id="2095" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⟦</a> <a id="2097" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor">lℚ</a> <a id="2100" href="Data.Rational.SternBrocot.html#2100" class="Bound">xs</a> <a id="2103" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⇓⟧</a> <a id="2106" class="Symbol">=</a> <a id="2108" class="Keyword">let</a> <a id="2112" href="Data.Rational.SternBrocot.html#2112" class="Bound">n</a> <a id="2114" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2116" href="Data.Rational.SternBrocot.html#2116" class="Bound">d</a> <a id="2118" class="Symbol">=</a> <a id="2120" href="Data.Rational.SternBrocot.html#1995" class="Function">fraction</a> <a id="2129" href="Data.Rational.SternBrocot.html#2100" class="Bound">xs</a> <a id="2132" class="Keyword">in</a> <a id="2135" href="Data.Integer.html#236" class="InductiveConstructor">⁻suc</a> <a id="2140" href="Data.Rational.SternBrocot.html#2112" class="Bound">n</a> <a id="2142" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">/suc</a> <a id="2147" href="Data.Rational.SternBrocot.html#2116" class="Bound">d</a>
<a id="2149" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⟦</a> <a id="2151" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor">rℚ</a> <a id="2154" href="Data.Rational.SternBrocot.html#2154" class="Bound">xs</a> <a id="2157" href="Data.Rational.SternBrocot.html#2057" class="Function Operator">⇓⟧</a> <a id="2160" class="Symbol">=</a> <a id="2162" class="Keyword">let</a> <a id="2166" href="Data.Rational.SternBrocot.html#2166" class="Bound">n</a> <a id="2168" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2170" href="Data.Rational.SternBrocot.html#2170" class="Bound">d</a> <a id="2172" class="Symbol">=</a> <a id="2174" href="Data.Rational.SternBrocot.html#1995" class="Function">fraction</a> <a id="2183" href="Data.Rational.SternBrocot.html#2154" class="Bound">xs</a> <a id="2186" class="Keyword">in</a> <a id="2189" href="Data.Integer.html#222" class="InductiveConstructor">⁺</a> <a id="2191" class="Symbol">(</a><a id="2192" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2196" href="Data.Rational.SternBrocot.html#2166" class="Bound">n</a><a id="2197" class="Symbol">)</a> <a id="2199" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">/suc</a> <a id="2204" href="Data.Rational.SternBrocot.html#2170" class="Bound">d</a>

<a id="⟦_⇑⟧"></a><a id="2207" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⟦_⇑⟧</a> <a id="2212" class="Symbol">:</a> <a id="2214" href="Data.Rational.Unnormalised.html#274" class="Record">F.ℚ</a> <a id="2218" class="Symbol">→</a> <a id="2220" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a>
<a id="2222" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⟦</a> <a id="2224" href="Data.Integer.html#222" class="InductiveConstructor">⁺</a> <a id="2226" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2231" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">/suc</a> <a id="2236" href="Data.Rational.SternBrocot.html#2236" class="Bound">den-pred</a> <a id="2245" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⇑⟧</a> <a id="2248" class="Symbol">=</a> <a id="2250" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a>
<a id="2253" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⟦</a> <a id="2255" href="Data.Integer.html#222" class="InductiveConstructor">⁺</a> <a id="2257" class="Symbol">(</a><a id="2258" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2262" href="Data.Rational.SternBrocot.html#2262" class="Bound">x</a><a id="2263" class="Symbol">)</a> <a id="2265" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">/suc</a> <a id="2270" href="Data.Rational.SternBrocot.html#2270" class="Bound">den-pred</a> <a id="2279" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⇑⟧</a> <a id="2282" class="Symbol">=</a> <a id="2284" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor">rℚ</a> <a id="2287" class="Symbol">(</a><a id="2288" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="2302" href="Data.Rational.SternBrocot.html#2262" class="Bound">x</a> <a id="2304" href="Data.Rational.SternBrocot.html#2270" class="Bound">den-pred</a><a id="2312" class="Symbol">)</a>
<a id="2314" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⟦</a> <a id="2316" href="Data.Integer.html#236" class="InductiveConstructor">⁻suc</a> <a id="2321" href="Data.Rational.SternBrocot.html#2321" class="Bound">x</a> <a id="2323" href="Data.Rational.Unnormalised.html#304" class="InductiveConstructor Operator">/suc</a> <a id="2328" href="Data.Rational.SternBrocot.html#2328" class="Bound">den-pred</a> <a id="2337" href="Data.Rational.SternBrocot.html#2207" class="Function Operator">⇑⟧</a> <a id="2340" class="Symbol">=</a> <a id="2342" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor">lℚ</a> <a id="2345" class="Symbol">(</a><a id="2346" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="2360" href="Data.Rational.SternBrocot.html#2321" class="Bound">x</a> <a id="2362" href="Data.Rational.SternBrocot.html#2328" class="Bound">den-pred</a><a id="2370" class="Symbol">)</a>

<a id="2373" class="Comment">-- open import Path.Reasoning</a>

<a id="2404" class="Comment">-- n≢sn+d : ∀ n d → (n ℕ.≡ᴮ suc (n ℕ.+ d)) ≡ false</a>
<a id="2455" class="Comment">-- n≢sn+d zero d = refl</a>
<a id="2479" class="Comment">-- n≢sn+d (suc n) d = n≢sn+d n d</a>

<a id="2513" class="Comment">-- n&lt;sn+d : ∀ n d → (n ℕ.&lt;ᴮ suc (n ℕ.+ d)) ≡ true</a>
<a id="2563" class="Comment">-- n&lt;sn+d zero d = refl</a>
<a id="2587" class="Comment">-- n&lt;sn+d (suc n) d = n&lt;sn+d n d</a>

<a id="2621" class="Comment">-- n+d-n≡d : ∀ n d → n ℕ.+ d ℕ.∸ n ≡ d</a>
<a id="2660" class="Comment">-- n+d-n≡d zero d = refl</a>
<a id="2685" class="Comment">-- n+d-n≡d (suc n) d = n+d-n≡d n d</a>

<a id="2721" class="Comment">-- euclidian-term-helper : ∀ n d s₁ s₂ → (n ℕ.+ d ℕ.≤ s₁) → (n ℕ.+ d ℕ.≤ s₂) → euclidian n d s₁ ≡ euclidian n d s₂</a>
<a id="2836" class="Comment">-- euclidian-term-helper zero zero zero zero p₁ p₂ = refl</a>
<a id="2894" class="Comment">-- euclidian-term-helper zero zero zero (suc s₂) p₁ p₂ = refl</a>
<a id="2956" class="Comment">-- euclidian-term-helper zero zero (suc s₁) zero p₁ p₂ = refl</a>
<a id="3018" class="Comment">-- euclidian-term-helper zero zero (suc s₁) (suc s₂) p₁ p₂ = refl</a>
<a id="3084" class="Comment">-- euclidian-term-helper zero (suc d) (suc s₁) (suc s₂) p₁ p₂ = cong lℚ (euclidian-term-helper zero d s₁ s₂ (ℕ.p≤p d s₁ p₁) (ℕ.p≤p d s₂ p₂))</a>
<a id="3225" class="Comment">-- euclidian-term-helper (suc n) zero (suc s₁) (suc s₂) p₁ p₂ = cong rℚ (euclidian-term-helper n zero s₁ s₂ (ℕ.p≤p (n ℕ.+ zero) s₁ p₁) (ℕ.p≤p (n ℕ.+ zero) s₂ p₂))</a>
<a id="3388" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ with n ℕ.≡ᴮ d | n ℕ.&lt;ᴮ d</a>
<a id="3478" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ | false | false = cong rℚ (euclidian-term-helper (n ℕ.∸ suc d) (suc d) s₁ s₂ {!!} {!!})</a>
<a id="3631" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ | false | true  = cong lℚ (euclidian-term-helper (suc n) (d ℕ.∸ suc n) s₁ s₂ {!!} {!!})</a>
<a id="3784" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ | true  | _ = refl</a>

<a id="3869" class="Comment">-- norm-l : ∀ n d → normalise-suc n (suc n ℕ.+ d) ≡ lℚ (normalise-suc n d)</a>
<a id="3944" class="Comment">-- norm-l n d =</a>
<a id="3960" class="Comment">--   normalise-suc n (suc n ℕ.+ d) ≡⟨⟩</a>
<a id="3999" class="Comment">--   euclidian n (suc n ℕ.+ d) (n ℕ.+ (suc n ℕ.+ d)) ≡⟨ cong (euclidian n (suc n ℕ.+ d)) (ℕ.+-suc n (n ℕ.+ d)) ⟩</a>
<a id="4112" class="Comment">--   euclidian n (suc n ℕ.+ d) (suc n ℕ.+ (n ℕ.+ d)) ≡⟨⟩</a>
<a id="4169" class="Comment">--   (if n ℕ.≡ᴮ suc (n ℕ.+ d) then 1ℚ else</a>
<a id="4212" class="Comment">--        if n ℕ.&lt;ᴮ suc (n ℕ.+ d) then lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) else rℚ (euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d)))) ≡⟨ cong (if_then 1ℚ else if n ℕ.&lt;ᴮ suc (n ℕ.+ d) then lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) else rℚ (euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d)))) (n≢sn+d n d) ⟩</a>
<a id="4588" class="Comment">--   (if n ℕ.&lt;ᴮ suc (n ℕ.+ d) then</a>
<a id="4623" class="Comment">--        lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) else</a>
<a id="4689" class="Comment">--        rℚ (euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d)))) ≡⟨ cong (if_then lℚ ((euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d)))) else rℚ ((euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d))))) (n&lt;sn+d n d) ⟩</a>
<a id="4947" class="Comment">--   lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) ≡⟨ cong (λ ndn → lℚ (euclidian n ndn (n ℕ.+ (n ℕ.+ d)))) (n+d-n≡d n d) ⟩</a>
<a id="5076" class="Comment">--   lℚ (euclidian n d (n ℕ.+ (n ℕ.+ d))) ≡⟨ {!!} ⟩</a>
<a id="5128" class="Comment">--   lℚ (euclidian n d (n ℕ.+ d)) ≡⟨⟩</a>
<a id="5166" class="Comment">--   lℚ (normalise-suc n d) ∎</a>


<a id="5198" class="Comment">-- ℚ-retract′ : ∀ x → normalise-suc (fst (fraction x)) (snd (fraction x)) ≡ x</a>
<a id="5276" class="Comment">-- ℚ-retract′ 1ℚ = refl</a>
<a id="5300" class="Comment">-- ℚ-retract′ (rℚ x) = {!!}</a>
<a id="5328" class="Comment">-- ℚ-retract′ (lℚ x) = let n , d = fraction x in</a>
<a id="5377" class="Comment">--   normalise-suc n (suc (n ℕ.+ d)) ≡⟨ {!!} ⟩</a>
<a id="5424" class="Comment">--   lℚ x ∎</a>

<a id="5437" class="Comment">-- ℚ-retract : ∀ x → ⟦ ⟦ x ⇓⟧ ⇑⟧ ≡ x</a>
<a id="5474" class="Comment">-- ℚ-retract 1ℚ = refl</a>
<a id="5497" class="Comment">-- ℚ-retract (lℚ x) = cong lℚ (ℚ-retract′ x)</a>
<a id="5542" class="Comment">-- ℚ-retract (rℚ x) = cong rℚ (ℚ-retract′ x)</a>
</pre></body></html>