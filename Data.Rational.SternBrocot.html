<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Data.Rational.SternBrocot</title><link rel="stylesheet" href="Agda.css"></head><body><pre class="Agda"><a id="1" class="Symbol">{-#</a> <a id="5" class="Keyword">OPTIONS</a> <a id="13" class="Pragma">--cubical</a> <a id="23" class="Pragma">--safe</a> <a id="30" class="Symbol">#-}</a>

<a id="35" class="Keyword">module</a> <a id="42" href="Data.Rational.SternBrocot.html" class="Module">Data.Rational.SternBrocot</a> <a id="68" class="Keyword">where</a>

<a id="75" class="Keyword">open</a> <a id="80" class="Keyword">import</a> <a id="87" href="Prelude.html" class="Module">Prelude</a>
<a id="95" class="Keyword">import</a> <a id="102" href="Data.Nat.html" class="Module">Data.Nat</a> <a id="111" class="Symbol">as</a> <a id="114" class="Module">ℕ</a>
<a id="116" class="Keyword">import</a> <a id="123" href="Data.Nat.Properties.html" class="Module">Data.Nat.Properties</a> <a id="143" class="Symbol">as</a> <a id="146" class="Module">ℕ</a>
<a id="148" class="Keyword">open</a> <a id="153" class="Keyword">import</a> <a id="160" href="Data.Bits.html" class="Module">Data.Bits</a> <a id="170" class="Keyword">renaming</a> <a id="179" class="Symbol">(</a><a id="180" href="Data.Bits.html#102" class="Datatype">Bits</a> <a id="185" class="Symbol">to</a> <a id="188" class="Datatype">ℚ⁺</a><a id="190" class="Symbol">;</a> <a id="192" href="Data.Bits.html#122" class="InductiveConstructor">[]</a> <a id="195" class="Symbol">to</a> <a id="198" class="InductiveConstructor">1ℚ</a><a id="200" class="Symbol">;</a> <a id="202" href="Data.Bits.html#134" class="InductiveConstructor Operator">0∷_</a> <a id="206" class="Symbol">to</a> <a id="209" class="InductiveConstructor Operator">lℚ</a><a id="211" class="Symbol">;</a> <a id="213" href="Data.Bits.html#154" class="InductiveConstructor Operator">1∷_</a> <a id="217" class="Symbol">to</a> <a id="220" class="InductiveConstructor Operator">rℚ</a><a id="222" class="Symbol">)</a>
<a id="224" class="Keyword">open</a> <a id="229" class="Keyword">import</a> <a id="236" href="Data.Bits.Equatable.html" class="Module">Data.Bits.Equatable</a>

<a id="257" class="Comment">-- ⟦_⇓⟧ : ℚ⁺ → (ℕ × ℕ)</a>
<a id="280" class="Comment">-- ⟦ 1ℚ ⇓⟧ = 1 , 1</a>
<a id="299" class="Comment">-- ⟦ lℚ x ⇓⟧ = let p , q = ⟦ x ⇓⟧ in p , p ℕ.+ q</a>
<a id="348" class="Comment">-- ⟦ rℚ x ⇓⟧ = let p , q = ⟦ x ⇓⟧ in p ℕ.+ q , q</a>

<a id="398" class="Comment">-- module TerminationProofs where</a>
<a id="432" class="Comment">--   Tᴮ⇒≡ : {n m : ℕ} → n ≡ m → T (n ℕ.≡ᴮ m)</a>
<a id="477" class="Comment">--   Tᴮ⇒≡ {n} {m} n≡m = subst (λ n′ → T (n ℕ.≡ᴮ n′)) n≡m (ℕ.complete-== n)</a>

<a id="553" class="Comment">--   lift-suc-≡ : ∀ {n m} s → m ≡ n → T (n ℕ.≡ᴮ s) → T (m ℕ.≡ᴮ s)</a>
<a id="619" class="Comment">--   lift-suc-≡ {n} {m} s  m≡n p = Tᴮ⇒≡ (m≡n ; ℕ.sound-== (n) s p)</a>

<a id="687" class="Comment">--   lemma₁ : ∀ a m → a ℕ.+ m ℕ.+ zero ≡ m ℕ.+ a</a>
<a id="736" class="Comment">--   lemma₁ a m = ℕ.+-idʳ (a ℕ.+ m) ; ℕ.+-comm a m</a>

<a id="788" class="Comment">--   lemma₂ : ∀ n a m → n ℕ.+ m ℕ.+ suc a ≡ n ℕ.+ suc m ℕ.+ a</a>
<a id="850" class="Comment">--   lemma₂ n a m = ℕ.+-assoc n m (suc a) ; cong (n ℕ.+_) (ℕ.+-suc m a) ; sym (ℕ.+-assoc n (suc m) a)</a>

<a id="953" class="Comment">--   lemma₃ : ∀ n a → n ℕ.+ a ℕ.+ zero ≡ n ℕ.+ zero ℕ.+ a</a>
<a id="1011" class="Comment">--   lemma₃ n a = ℕ.+-idʳ (n ℕ.+ a) ; cong (ℕ._+ a) (sym (ℕ.+-idʳ n))</a>

<a id="1082" class="Comment">-- _+1/_+1 : ℕ → ℕ → ℚ⁺</a>
<a id="1106" class="Comment">-- n +1/ m +1 = go zero n m (n ℕ.+ m)</a>
<a id="1144" class="Comment">--   where</a>
<a id="1155" class="Comment">--   go : (a n m s : ℕ) → ℚ⁺</a>
<a id="1184" class="Comment">--   go a zero    (suc m) (suc s) = lℚ (go zero a m s)</a>
<a id="1239" class="Comment">--   go a (suc n) (suc m) (suc s) = go (suc a) n m s</a>
<a id="1292" class="Comment">--   go a (suc n) zero    (suc s) = rℚ (go zero n a s)</a>
<a id="1347" class="Comment">--   go _ _       _       _       = 1ℚ</a>

<a id="euclidian"></a><a id="1387" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1397" class="Symbol">:</a> <a id="1399" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1401" class="Symbol">→</a> <a id="1403" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1405" class="Symbol">→</a> <a id="1407" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1409" class="Symbol">→</a> <a id="1411" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a>
<a id="1414" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1424" href="Data.Rational.SternBrocot.html#1424" class="Bound">n</a> <a id="1426" href="Data.Rational.SternBrocot.html#1426" class="Bound">m</a> <a id="1428" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a>    <a id="1436" class="Symbol">=</a> <a id="1438" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a>
<a id="1441" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1451" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1453" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a> <a id="1455" class="Symbol">(</a><a id="1456" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1460" href="Data.Rational.SternBrocot.html#1460" class="Bound">s</a><a id="1461" class="Symbol">)</a> <a id="1463" class="Symbol">=</a>
  <a id="1467" href="Data.Bool.Base.html#596" class="Function Operator">if</a> <a id="1470" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1472" href="Data.Nat.Properties.html#164" class="Primitive Operator">ℕ.≡ᴮ</a> <a id="1477" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a>
  <a id="1481" href="Data.Bool.Base.html#596" class="Function Operator">then</a> <a id="1486" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a>
  <a id="1491" href="Data.Bool.Base.html#596" class="Function Operator">else</a> <a id="1496" href="Data.Bool.Base.html#596" class="Function Operator">if</a> <a id="1499" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1501" href="Data.Nat.Properties.html#150" class="Primitive Operator">ℕ.&lt;ᴮ</a> <a id="1506" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a>
  <a id="1510" href="Data.Bool.Base.html#596" class="Function Operator">then</a> <a id="1515" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor">lℚ</a> <a id="1518" class="Symbol">(</a><a id="1519" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1529" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1531" class="Symbol">(</a><a id="1532" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a> <a id="1534" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="1538" class="Symbol">(</a><a id="1539" class="Number">1</a> <a id="1541" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1545" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a><a id="1546" class="Symbol">))</a> <a id="1549" href="Data.Rational.SternBrocot.html#1460" class="Bound">s</a><a id="1550" class="Symbol">)</a>
  <a id="1554" href="Data.Bool.Base.html#596" class="Function Operator">else</a> <a id="1559" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor">rℚ</a> <a id="1562" class="Symbol">(</a><a id="1563" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1573" class="Symbol">(</a><a id="1574" href="Data.Rational.SternBrocot.html#1451" class="Bound">n</a> <a id="1576" href="Data.Nat.Base.html#160" class="Primitive Operator">ℕ.∸</a> <a id="1580" class="Symbol">(</a><a id="1581" class="Number">1</a> <a id="1583" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1587" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a><a id="1588" class="Symbol">))</a> <a id="1591" href="Data.Rational.SternBrocot.html#1453" class="Bound">m</a> <a id="1593" href="Data.Rational.SternBrocot.html#1460" class="Bound">s</a><a id="1594" class="Symbol">)</a>

<a id="normalise-suc"></a><a id="1597" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="1611" class="Symbol">:</a> <a id="1613" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1619" class="Symbol">→</a> <a id="1621" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a>
<a id="1624" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="1638" href="Data.Rational.SternBrocot.html#1638" class="Bound">n</a> <a id="1640" href="Data.Rational.SternBrocot.html#1640" class="Bound">m</a> <a id="1642" class="Symbol">=</a> <a id="1644" href="Data.Rational.SternBrocot.html#1387" class="Function">euclidian</a> <a id="1654" href="Data.Rational.SternBrocot.html#1638" class="Bound">n</a> <a id="1656" href="Data.Rational.SternBrocot.html#1640" class="Bound">m</a> <a id="1658" class="Symbol">(</a><a id="1659" href="Data.Rational.SternBrocot.html#1638" class="Bound">n</a> <a id="1661" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1665" href="Data.Rational.SternBrocot.html#1640" class="Bound">m</a><a id="1666" class="Symbol">)</a>

<a id="ℚ"></a><a id="1669" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="1671" class="Symbol">:</a> <a id="1673" href="Agda.Primitive.html#326" class="Primitive">Type</a>
<a id="1678" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="1680" class="Symbol">=</a> <a id="1682" href="Data.Rational.SternBrocot.html#188" class="Datatype">ℚ⁺</a>

<a id="1686" class="Keyword">import</a> <a id="1693" href="Data.Rational.Unnormalised.html" class="Module">Data.Rational.Unnormalised</a> <a id="1720" class="Symbol">as</a> <a id="1723" class="Module">F</a>
<a id="1725" class="Keyword">open</a> <a id="1730" class="Keyword">import</a> <a id="1737" href="Data.Rational.Unnormalised.html" class="Module">Data.Rational.Unnormalised</a> <a id="1764" class="Keyword">using</a> <a id="1770" class="Symbol">(</a><a id="1771" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">_/suc_</a><a id="1777" class="Symbol">;</a> <a id="1779" href="Data.Rational.Unnormalised.html#394" class="Function Operator">_/_</a><a id="1782" class="Symbol">)</a>
<a id="1784" class="Keyword">import</a> <a id="1791" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="1804" class="Symbol">as</a> <a id="1807" class="Module">ℤ</a>
<a id="1809" class="Keyword">open</a> <a id="1814" class="Keyword">import</a> <a id="1821" href="Data.Integer.html" class="Module">Data.Integer</a> <a id="1834" class="Keyword">using</a> <a id="1840" class="Symbol">(</a><a id="1841" href="Data.Integer.html#204" class="Datatype">ℤ</a><a id="1842" class="Symbol">;</a> <a id="1844" href="Data.Integer.html#221" class="InductiveConstructor">⁺</a><a id="1845" class="Symbol">;</a> <a id="1847" href="Data.Integer.html#235" class="InductiveConstructor">⁻suc</a><a id="1851" class="Symbol">;</a> <a id="1853" href="Data.Integer.html#249" class="Function">⁻</a><a id="1854" class="Symbol">)</a>
<a id="1856" class="Keyword">open</a> <a id="1861" class="Keyword">import</a> <a id="1868" href="Data.Bits.Fold.html" class="Module">Data.Bits.Fold</a>

<a id="zer"></a><a id="1884" href="Data.Rational.SternBrocot.html#1884" class="Function">zer</a> <a id="1888" class="Symbol">:</a> <a id="1890" class="Symbol">(</a><a id="1891" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1893" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="1895" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1896" class="Symbol">)</a> <a id="1898" class="Symbol">→</a> <a id="1900" class="Symbol">(</a><a id="1901" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1903" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="1905" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1906" class="Symbol">)</a>
<a id="1908" href="Data.Rational.SternBrocot.html#1884" class="Function">zer</a> <a id="1912" class="Symbol">(</a><a id="1913" href="Data.Rational.SternBrocot.html#1913" class="Bound">p</a> <a id="1915" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1917" href="Data.Rational.SternBrocot.html#1917" class="Bound">q</a><a id="1918" class="Symbol">)</a> <a id="1920" class="Symbol">=</a> <a id="1922" href="Data.Rational.SternBrocot.html#1913" class="Bound">p</a> <a id="1924" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1926" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1930" href="Data.Rational.SternBrocot.html#1913" class="Bound">p</a> <a id="1932" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1936" href="Data.Rational.SternBrocot.html#1917" class="Bound">q</a>

<a id="one"></a><a id="1939" href="Data.Rational.SternBrocot.html#1939" class="Function">one</a> <a id="1943" class="Symbol">:</a> <a id="1945" class="Symbol">(</a><a id="1946" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1948" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="1950" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1951" class="Symbol">)</a> <a id="1953" class="Symbol">→</a> <a id="1955" class="Symbol">(</a><a id="1956" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="1958" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="1960" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="1961" class="Symbol">)</a>
<a id="1963" href="Data.Rational.SternBrocot.html#1939" class="Function">one</a> <a id="1967" class="Symbol">(</a><a id="1968" href="Data.Rational.SternBrocot.html#1968" class="Bound">p</a> <a id="1970" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1972" href="Data.Rational.SternBrocot.html#1972" class="Bound">q</a><a id="1973" class="Symbol">)</a> <a id="1975" class="Symbol">=</a> <a id="1977" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="1981" href="Data.Rational.SternBrocot.html#1968" class="Bound">p</a> <a id="1983" href="Agda.Builtin.Nat.html#325" class="Primitive Operator">ℕ.+</a> <a id="1987" href="Data.Rational.SternBrocot.html#1972" class="Bound">q</a> <a id="1989" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="1991" href="Data.Rational.SternBrocot.html#1972" class="Bound">q</a>

<a id="fraction"></a><a id="1994" href="Data.Rational.SternBrocot.html#1994" class="Function">fraction</a> <a id="2003" class="Symbol">:</a> <a id="2005" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="2007" class="Symbol">→</a> <a id="2009" class="Symbol">(</a><a id="2010" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a> <a id="2012" href="Data.Sigma.Base.html#455" class="Function Operator">×</a> <a id="2014" href="Agda.Builtin.Nat.html#192" class="Datatype">ℕ</a><a id="2015" class="Symbol">)</a>
<a id="2017" href="Data.Rational.SternBrocot.html#1994" class="Function">fraction</a> <a id="2026" class="Symbol">=</a> <a id="2028" href="Data.Bits.Fold.html#199" class="Function">foldr-bits</a> <a id="2039" href="Data.Rational.SternBrocot.html#1884" class="Function">zer</a> <a id="2043" href="Data.Rational.SternBrocot.html#1939" class="Function">one</a> <a id="2047" class="Symbol">(</a><a id="2048" class="Number">0</a> <a id="2050" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2052" class="Number">0</a><a id="2053" class="Symbol">)</a>

<a id="⟦_⇓⟧"></a><a id="2056" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⟦_⇓⟧</a> <a id="2061" class="Symbol">:</a> <a id="2063" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a> <a id="2065" class="Symbol">→</a> <a id="2067" href="Data.Rational.Unnormalised.html#274" class="Record">F.ℚ</a>
<a id="2071" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⟦</a> <a id="2073" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a> <a id="2076" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⇓⟧</a> <a id="2079" class="Symbol">=</a> <a id="2081" href="Data.Integer.html#221" class="InductiveConstructor">⁺</a> <a id="2083" class="Number">0</a> <a id="2085" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">F./suc</a> <a id="2092" class="Number">0</a>
<a id="2094" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⟦</a> <a id="2096" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor">lℚ</a> <a id="2099" href="Data.Rational.SternBrocot.html#2099" class="Bound">xs</a> <a id="2102" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⇓⟧</a> <a id="2105" class="Symbol">=</a> <a id="2107" class="Keyword">let</a> <a id="2111" href="Data.Rational.SternBrocot.html#2111" class="Bound">n</a> <a id="2113" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2115" href="Data.Rational.SternBrocot.html#2115" class="Bound">d</a> <a id="2117" class="Symbol">=</a> <a id="2119" href="Data.Rational.SternBrocot.html#1994" class="Function">fraction</a> <a id="2128" href="Data.Rational.SternBrocot.html#2099" class="Bound">xs</a> <a id="2131" class="Keyword">in</a> <a id="2134" href="Data.Integer.html#235" class="InductiveConstructor">⁻suc</a> <a id="2139" href="Data.Rational.SternBrocot.html#2111" class="Bound">n</a> <a id="2141" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">/suc</a> <a id="2146" href="Data.Rational.SternBrocot.html#2115" class="Bound">d</a>
<a id="2148" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⟦</a> <a id="2150" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor">rℚ</a> <a id="2153" href="Data.Rational.SternBrocot.html#2153" class="Bound">xs</a> <a id="2156" href="Data.Rational.SternBrocot.html#2056" class="Function Operator">⇓⟧</a> <a id="2159" class="Symbol">=</a> <a id="2161" class="Keyword">let</a> <a id="2165" href="Data.Rational.SternBrocot.html#2165" class="Bound">n</a> <a id="2167" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">,</a> <a id="2169" href="Data.Rational.SternBrocot.html#2169" class="Bound">d</a> <a id="2171" class="Symbol">=</a> <a id="2173" href="Data.Rational.SternBrocot.html#1994" class="Function">fraction</a> <a id="2182" href="Data.Rational.SternBrocot.html#2153" class="Bound">xs</a> <a id="2185" class="Keyword">in</a> <a id="2188" href="Data.Integer.html#221" class="InductiveConstructor">⁺</a> <a id="2190" class="Symbol">(</a><a id="2191" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2195" href="Data.Rational.SternBrocot.html#2165" class="Bound">n</a><a id="2196" class="Symbol">)</a> <a id="2198" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">/suc</a> <a id="2203" href="Data.Rational.SternBrocot.html#2169" class="Bound">d</a>

<a id="⟦_⇑⟧"></a><a id="2206" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⟦_⇑⟧</a> <a id="2211" class="Symbol">:</a> <a id="2213" href="Data.Rational.Unnormalised.html#274" class="Record">F.ℚ</a> <a id="2217" class="Symbol">→</a> <a id="2219" href="Data.Rational.SternBrocot.html#1669" class="Function">ℚ</a>
<a id="2221" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⟦</a> <a id="2223" href="Data.Integer.html#221" class="InductiveConstructor">⁺</a> <a id="2225" href="Agda.Builtin.Nat.html#210" class="InductiveConstructor">zero</a> <a id="2230" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">/suc</a> <a id="2235" href="Data.Rational.SternBrocot.html#2235" class="Bound">den-pred</a> <a id="2244" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⇑⟧</a> <a id="2247" class="Symbol">=</a> <a id="2249" href="Data.Rational.SternBrocot.html#198" class="InductiveConstructor">1ℚ</a>
<a id="2252" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⟦</a> <a id="2254" href="Data.Integer.html#221" class="InductiveConstructor">⁺</a> <a id="2256" class="Symbol">(</a><a id="2257" href="Agda.Builtin.Nat.html#223" class="InductiveConstructor">suc</a> <a id="2261" href="Data.Rational.SternBrocot.html#2261" class="Bound">x</a><a id="2262" class="Symbol">)</a> <a id="2264" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">/suc</a> <a id="2269" href="Data.Rational.SternBrocot.html#2269" class="Bound">den-pred</a> <a id="2278" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⇑⟧</a> <a id="2281" class="Symbol">=</a> <a id="2283" href="Data.Rational.SternBrocot.html#220" class="InductiveConstructor">rℚ</a> <a id="2286" class="Symbol">(</a><a id="2287" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="2301" href="Data.Rational.SternBrocot.html#2261" class="Bound">x</a> <a id="2303" href="Data.Rational.SternBrocot.html#2269" class="Bound">den-pred</a><a id="2311" class="Symbol">)</a>
<a id="2313" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⟦</a> <a id="2315" href="Data.Integer.html#235" class="InductiveConstructor">⁻suc</a> <a id="2320" href="Data.Rational.SternBrocot.html#2320" class="Bound">x</a> <a id="2322" href="Data.Rational.Unnormalised.html#303" class="InductiveConstructor Operator">/suc</a> <a id="2327" href="Data.Rational.SternBrocot.html#2327" class="Bound">den-pred</a> <a id="2336" href="Data.Rational.SternBrocot.html#2206" class="Function Operator">⇑⟧</a> <a id="2339" class="Symbol">=</a> <a id="2341" href="Data.Rational.SternBrocot.html#209" class="InductiveConstructor">lℚ</a> <a id="2344" class="Symbol">(</a><a id="2345" href="Data.Rational.SternBrocot.html#1597" class="Function">normalise-suc</a> <a id="2359" href="Data.Rational.SternBrocot.html#2320" class="Bound">x</a> <a id="2361" href="Data.Rational.SternBrocot.html#2327" class="Bound">den-pred</a><a id="2369" class="Symbol">)</a>

<a id="2372" class="Comment">-- open import Path.Reasoning</a>

<a id="2403" class="Comment">-- n≢sn+d : ∀ n d → (n ℕ.≡ᴮ suc (n ℕ.+ d)) ≡ false</a>
<a id="2454" class="Comment">-- n≢sn+d zero d = refl</a>
<a id="2478" class="Comment">-- n≢sn+d (suc n) d = n≢sn+d n d</a>

<a id="2512" class="Comment">-- n&lt;sn+d : ∀ n d → (n ℕ.&lt;ᴮ suc (n ℕ.+ d)) ≡ true</a>
<a id="2562" class="Comment">-- n&lt;sn+d zero d = refl</a>
<a id="2586" class="Comment">-- n&lt;sn+d (suc n) d = n&lt;sn+d n d</a>

<a id="2620" class="Comment">-- n+d-n≡d : ∀ n d → n ℕ.+ d ℕ.∸ n ≡ d</a>
<a id="2659" class="Comment">-- n+d-n≡d zero d = refl</a>
<a id="2684" class="Comment">-- n+d-n≡d (suc n) d = n+d-n≡d n d</a>

<a id="2720" class="Comment">-- euclidian-term-helper : ∀ n d s₁ s₂ → (n ℕ.+ d ℕ.≤ s₁) → (n ℕ.+ d ℕ.≤ s₂) → euclidian n d s₁ ≡ euclidian n d s₂</a>
<a id="2835" class="Comment">-- euclidian-term-helper zero zero zero zero p₁ p₂ = refl</a>
<a id="2893" class="Comment">-- euclidian-term-helper zero zero zero (suc s₂) p₁ p₂ = refl</a>
<a id="2955" class="Comment">-- euclidian-term-helper zero zero (suc s₁) zero p₁ p₂ = refl</a>
<a id="3017" class="Comment">-- euclidian-term-helper zero zero (suc s₁) (suc s₂) p₁ p₂ = refl</a>
<a id="3083" class="Comment">-- euclidian-term-helper zero (suc d) (suc s₁) (suc s₂) p₁ p₂ = cong lℚ (euclidian-term-helper zero d s₁ s₂ (ℕ.p≤p d s₁ p₁) (ℕ.p≤p d s₂ p₂))</a>
<a id="3224" class="Comment">-- euclidian-term-helper (suc n) zero (suc s₁) (suc s₂) p₁ p₂ = cong rℚ (euclidian-term-helper n zero s₁ s₂ (ℕ.p≤p (n ℕ.+ zero) s₁ p₁) (ℕ.p≤p (n ℕ.+ zero) s₂ p₂))</a>
<a id="3387" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ with n ℕ.≡ᴮ d | n ℕ.&lt;ᴮ d</a>
<a id="3477" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ | false | false = cong rℚ (euclidian-term-helper (n ℕ.∸ suc d) (suc d) s₁ s₂ {!!} {!!})</a>
<a id="3630" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ | false | true  = cong lℚ (euclidian-term-helper (suc n) (d ℕ.∸ suc n) s₁ s₂ {!!} {!!})</a>
<a id="3783" class="Comment">-- euclidian-term-helper (suc n) (suc d) (suc s₁) (suc s₂) p₁ p₂ | true  | _ = refl</a>

<a id="3868" class="Comment">-- norm-l : ∀ n d → normalise-suc n (suc n ℕ.+ d) ≡ lℚ (normalise-suc n d)</a>
<a id="3943" class="Comment">-- norm-l n d =</a>
<a id="3959" class="Comment">--   normalise-suc n (suc n ℕ.+ d) ≡⟨⟩</a>
<a id="3998" class="Comment">--   euclidian n (suc n ℕ.+ d) (n ℕ.+ (suc n ℕ.+ d)) ≡⟨ cong (euclidian n (suc n ℕ.+ d)) (ℕ.+-suc n (n ℕ.+ d)) ⟩</a>
<a id="4111" class="Comment">--   euclidian n (suc n ℕ.+ d) (suc n ℕ.+ (n ℕ.+ d)) ≡⟨⟩</a>
<a id="4168" class="Comment">--   (if n ℕ.≡ᴮ suc (n ℕ.+ d) then 1ℚ else</a>
<a id="4211" class="Comment">--        if n ℕ.&lt;ᴮ suc (n ℕ.+ d) then lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) else rℚ (euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d)))) ≡⟨ cong (if_then 1ℚ else if n ℕ.&lt;ᴮ suc (n ℕ.+ d) then lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) else rℚ (euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d)))) (n≢sn+d n d) ⟩</a>
<a id="4587" class="Comment">--   (if n ℕ.&lt;ᴮ suc (n ℕ.+ d) then</a>
<a id="4622" class="Comment">--        lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) else</a>
<a id="4688" class="Comment">--        rℚ (euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d)))) ≡⟨ cong (if_then lℚ ((euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d)))) else rℚ ((euclidian (n ℕ.∸ suc (suc (n ℕ.+ d))) (suc (n ℕ.+ d)) (n ℕ.+ (n ℕ.+ d))))) (n&lt;sn+d n d) ⟩</a>
<a id="4946" class="Comment">--   lℚ (euclidian n (n ℕ.+ d ℕ.∸ n) (n ℕ.+ (n ℕ.+ d))) ≡⟨ cong (λ ndn → lℚ (euclidian n ndn (n ℕ.+ (n ℕ.+ d)))) (n+d-n≡d n d) ⟩</a>
<a id="5075" class="Comment">--   lℚ (euclidian n d (n ℕ.+ (n ℕ.+ d))) ≡⟨ {!!} ⟩</a>
<a id="5127" class="Comment">--   lℚ (euclidian n d (n ℕ.+ d)) ≡⟨⟩</a>
<a id="5165" class="Comment">--   lℚ (normalise-suc n d) ∎</a>


<a id="5197" class="Comment">-- ℚ-retract′ : ∀ x → normalise-suc (fst (fraction x)) (snd (fraction x)) ≡ x</a>
<a id="5275" class="Comment">-- ℚ-retract′ 1ℚ = refl</a>
<a id="5299" class="Comment">-- ℚ-retract′ (rℚ x) = {!!}</a>
<a id="5327" class="Comment">-- ℚ-retract′ (lℚ x) = let n , d = fraction x in</a>
<a id="5376" class="Comment">--   normalise-suc n (suc (n ℕ.+ d)) ≡⟨ {!!} ⟩</a>
<a id="5423" class="Comment">--   lℚ x ∎</a>

<a id="5436" class="Comment">-- ℚ-retract : ∀ x → ⟦ ⟦ x ⇓⟧ ⇑⟧ ≡ x</a>
<a id="5473" class="Comment">-- ℚ-retract 1ℚ = refl</a>
<a id="5496" class="Comment">-- ℚ-retract (lℚ x) = cong lℚ (ℚ-retract′ x)</a>
<a id="5541" class="Comment">-- ℚ-retract (rℚ x) = cong rℚ (ℚ-retract′ x)</a>
</pre></body></html>